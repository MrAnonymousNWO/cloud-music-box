(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{37915:function(e,t,r){Promise.resolve().then(r.bind(r,88163)),Promise.resolve().then(r.t.bind(r,47960,23)),Promise.resolve().then(r.bind(r,78356)),Promise.resolve().then(r.bind(r,95707)),Promise.resolve().then(r.bind(r,14888)),Promise.resolve().then(r.bind(r,98087)),Promise.resolve().then(r.bind(r,47239)),Promise.resolve().then(r.t.bind(r,88003,23)),Promise.resolve().then(r.bind(r,32879))},88163:function(e,t,r){"use strict";let n,i,a,o,s,l,c,u,d;r.d(t,{AppLayout:function(){return yF}});var h,p,f,m,g={};r.r(g),r.d(g,{ACESFilmicToneMapping:function(){return ru},AddEquation:function(){return tB},AddOperation:function(){return ra},AdditiveAnimationBlendMode:function(){return nF},AdditiveBlending:function(){return tL},AgXToneMapping:function(){return rh},AlphaFormat:function(){return rZ},AlwaysCompare:function(){return iv},AlwaysDepth:function(){return t6},AlwaysStencilFunc:function(){return ic},AmbientLight:function(){return fh},AnimationAction:function(){return f2},AnimationClip:function(){return pq},AnimationLoader:function(){return p1},AnimationMixer:function(){return f4},AnimationObjectGroup:function(){return f1},AnimationUtils:function(){return pP},ArcCurve:function(){return dJ},ArrayCamera:function(){return us},ArrowHelper:function(){return mB},AttachedBindMode:function(){return rf},Audio:function(){return fF},AudioAnalyser:function(){return fV},AudioContext:function(){return fE},AudioListener:function(){return fU},AudioLoader:function(){return fC},AxesHelper:function(){return mz},BackSide:function(){return tk},BasicDepthPacking:function(){return nj},BasicShadowMap:function(){return tC},BatchedMesh:function(){return dT},Bone:function(){return u0},BooleanKeyframeTrack:function(){return pF},Box2:function(){return ml},Box3:function(){return ab},Box3Helper:function(){return mD},BoxGeometry:function(){return sd},BoxHelper:function(){return mL},BufferAttribute:function(){return oU},BufferGeometry:function(){return o0},BufferGeometryLoader:function(){return fb},ByteType:function(){return rD},Cache:function(){return pX},Camera:function(){return s_},CameraHelper:function(){return mP},CanvasTexture:function(){return dK},CapsuleGeometry:function(){return hy},CatmullRomCurve3:function(){return d5},CineonToneMapping:function(){return rc},CircleGeometry:function(){return hv},ClampToEdgeWrapping:function(){return rT},Clock:function(){return fk},Color:function(){return oE},ColorKeyframeTrack:function(){return pB},ColorManagement:function(){return i9},CompressedArrayTexture:function(){return dX},CompressedCubeTexture:function(){return d$},CompressedTexture:function(){return dZ},CompressedTextureLoader:function(){return p2},ConeGeometry:function(){return h_},ConstantAlphaFactor:function(){return t3},ConstantColorFactor:function(){return t1},CubeCamera:function(){return sA},CubeReflectionMapping:function(){return ry},CubeRefractionMapping:function(){return rv},CubeTexture:function(){return sM},CubeTextureLoader:function(){return p4},CubeUVReflectionMapping:function(){return rw},CubicBezierCurve:function(){return ho},CubicBezierCurve3:function(){return hs},CubicInterpolant:function(){return pN},CullFaceBack:function(){return tT},CullFaceFront:function(){return tx},CullFaceFrontBack:function(){return tE},CullFaceNone:function(){return tS},Curve:function(){return dY},CurvePath:function(){return hf},CustomBlending:function(){return tF},CustomToneMapping:function(){return rd},CylinderGeometry:function(){return hb},Cylindrical:function(){return ma},Data3DTexture:function(){return ap},DataArrayTexture:function(){return ad},DataTexture:function(){return u1},DataTextureLoader:function(){return p5},DataUtils:function(){return oN},DecrementStencilOp:function(){return n8},DecrementWrapStencilOp:function(){return n9},DefaultLoadingManager:function(){return pK},DepthFormat:function(){return rQ},DepthStencilFormat:function(){return rJ},DepthTexture:function(){return lg},DetachedBindMode:function(){return rm},DirectionalLight:function(){return fd},DirectionalLightHelper:function(){return mI},DiscreteInterpolant:function(){return pD},DisplayP3ColorSpace:function(){return nY},DodecahedronGeometry:function(){return hS},DoubleSide:function(){return tP},DstAlphaFactor:function(){return tK},DstColorFactor:function(){return tQ},DynamicCopyUsage:function(){return iC},DynamicDrawUsage:function(){return i_},DynamicReadUsage:function(){return iT},EdgesGeometry:function(){return hA},EllipseCurve:function(){return dQ},EqualCompare:function(){return ih},EqualDepth:function(){return t9},EqualStencilFunc:function(){return ii},EquirectangularReflectionMapping:function(){return rb},EquirectangularRefractionMapping:function(){return r_},Euler:function(){return a2},EventDispatcher:function(){return iP},ExtrudeGeometry:function(){return pe},FileLoader:function(){return p0},Float16BufferAttribute:function(){return oq},Float32BufferAttribute:function(){return oW},FloatType:function(){return rH},Fog:function(){return uw},FogExp2:function(){return u_},FramebufferTexture:function(){return dW},FrontSide:function(){return tR},Frustum:function(){return sD},GLBufferAttribute:function(){return f9},GLSL1:function(){return iM},GLSL3:function(){return iI},GreaterCompare:function(){return im},GreaterDepth:function(){return rt},GreaterEqualCompare:function(){return iy},GreaterEqualDepth:function(){return re},GreaterEqualStencilFunc:function(){return il},GreaterStencilFunc:function(){return io},GridHelper:function(){return mx},Group:function(){return ul},HalfFloatType:function(){return rj},HemisphereLight:function(){return p7},HemisphereLightHelper:function(){return mT},IcosahedronGeometry:function(){return pn},ImageBitmapLoader:function(){return fx},ImageLoader:function(){return p3},ImageUtils:function(){return ar},IncrementStencilOp:function(){return n6},IncrementWrapStencilOp:function(){return n7},InstancedBufferAttribute:function(){return u5},InstancedBufferGeometry:function(){return fv},InstancedInterleavedBuffer:function(){return f7},InstancedMesh:function(){return dn},Int16BufferAttribute:function(){return oH},Int32BufferAttribute:function(){return oG},Int8BufferAttribute:function(){return oF},IntType:function(){return rB},InterleavedBuffer:function(){return uT},InterleavedBufferAttribute:function(){return uE},Interpolant:function(){return pO},InterpolateDiscrete:function(){return nk},InterpolateLinear:function(){return nP},InterpolateSmooth:function(){return nO},InvertStencilOp:function(){return ie},KeepStencilOp:function(){return n4},KeyframeTrack:function(){return pU},LOD:function(){return uG},LatheGeometry:function(){return hg},Layers:function(){return a3},LessCompare:function(){return id},LessDepth:function(){return t8},LessEqualCompare:function(){return ip},LessEqualDepth:function(){return t7},LessEqualStencilFunc:function(){return ia},LessStencilFunc:function(){return ir},Light:function(){return p8},LightProbe:function(){return fm},Line:function(){return dP},Line3:function(){return md},LineBasicMaterial:function(){return dx},LineCurve:function(){return hl},LineCurve3:function(){return hc},LineDashedMaterial:function(){return pE},LineLoop:function(){return dU},LineSegments:function(){return dD},LinearDisplayP3ColorSpace:function(){return nQ},LinearFilter:function(){return rR},LinearInterpolant:function(){return pL},LinearMipMapLinearFilter:function(){return rN},LinearMipMapNearestFilter:function(){return rP},LinearMipmapLinearFilter:function(){return rO},LinearMipmapNearestFilter:function(){return rk},LinearSRGBColorSpace:function(){return nK},LinearToneMapping:function(){return rs},LinearTransfer:function(){return nJ},Loader:function(){return pY},LoaderUtils:function(){return fy},LoadingManager:function(){return p$},LoopOnce:function(){return nM},LoopPingPong:function(){return nR},LoopRepeat:function(){return nI},LuminanceAlphaFormat:function(){return rY},LuminanceFormat:function(){return rK},MOUSE:function(){return t_},Material:function(){return oM},MaterialLoader:function(){return fg},MathUtils:function(){return iZ},Matrix2:function(){return mo},Matrix3:function(){return i$},Matrix4:function(){return aW},MaxEquation:function(){return tG},Mesh:function(){return sl},MeshBasicMaterial:function(){return oI},MeshDepthMaterial:function(){return c6},MeshDistanceMaterial:function(){return c8},MeshLambertMaterial:function(){return pT},MeshMatcapMaterial:function(){return px},MeshNormalMaterial:function(){return pS},MeshPhongMaterial:function(){return p_},MeshPhysicalMaterial:function(){return pb},MeshStandardMaterial:function(){return pv},MeshToonMaterial:function(){return pw},MinEquation:function(){return tj},MirroredRepeatWrapping:function(){return rx},MixOperation:function(){return ri},MultiplyBlending:function(){return tU},MultiplyOperation:function(){return rn},NearestFilter:function(){return rE},NearestMipMapLinearFilter:function(){return rI},NearestMipMapNearestFilter:function(){return rA},NearestMipmapLinearFilter:function(){return rM},NearestMipmapNearestFilter:function(){return rC},NeutralToneMapping:function(){return rp},NeverCompare:function(){return iu},NeverDepth:function(){return t5},NeverStencilFunc:function(){return it},NoBlending:function(){return tO},NoColorSpace:function(){return nX},NoToneMapping:function(){return ro},NormalAnimationBlendMode:function(){return nU},NormalBlending:function(){return tN},NotEqualCompare:function(){return ig},NotEqualDepth:function(){return rr},NotEqualStencilFunc:function(){return is},NumberKeyframeTrack:function(){return pz},Object3D:function(){return oc},ObjectLoader:function(){return f_},ObjectSpaceNormalMap:function(){return nZ},OctahedronGeometry:function(){return pi},OneFactor:function(){return tq},OneMinusConstantAlphaFactor:function(){return t4},OneMinusConstantColorFactor:function(){return t2},OneMinusDstAlphaFactor:function(){return tY},OneMinusDstColorFactor:function(){return tJ},OneMinusSrcAlphaFactor:function(){return t$},OneMinusSrcColorFactor:function(){return tZ},OrthographicCamera:function(){return sQ},P3Primaries:function(){return n2},PCFShadowMap:function(){return tA},PCFSoftShadowMap:function(){return tM},PMREMGenerator:function(){return lt},Path:function(){return hm},PerspectiveCamera:function(){return sx},Plane:function(){return sO},PlaneGeometry:function(){return sB},PlaneHelper:function(){return mU},PointLight:function(){return fc},PointLightHelper:function(){return mb},Points:function(){return dG},PointsMaterial:function(){return dF},PolarGridHelper:function(){return mE},PolyhedronGeometry:function(){return hw},PositionalAudio:function(){return fG},PropertyBinding:function(){return f0},PropertyMixer:function(){return fq},QuadraticBezierCurve:function(){return hu},QuadraticBezierCurve3:function(){return hd},Quaternion:function(){return am},QuaternionKeyframeTrack:function(){return pj},QuaternionLinearInterpolant:function(){return pH},RED_GREEN_RGTC2_Format:function(){return nC},RED_RGTC1_Format:function(){return nx},REVISION:function(){return tb},RGBADepthPacking:function(){return nG},RGBAFormat:function(){return r$},RGBAIntegerFormat:function(){return r5},RGBA_ASTC_10x10_Format:function(){return nv},RGBA_ASTC_10x5_Format:function(){return nm},RGBA_ASTC_10x6_Format:function(){return ng},RGBA_ASTC_10x8_Format:function(){return ny},RGBA_ASTC_12x10_Format:function(){return nb},RGBA_ASTC_12x12_Format:function(){return n_},RGBA_ASTC_4x4_Format:function(){return ns},RGBA_ASTC_5x4_Format:function(){return nl},RGBA_ASTC_5x5_Format:function(){return nc},RGBA_ASTC_6x5_Format:function(){return nu},RGBA_ASTC_6x6_Format:function(){return nd},RGBA_ASTC_8x5_Format:function(){return nh},RGBA_ASTC_8x6_Format:function(){return np},RGBA_ASTC_8x8_Format:function(){return nf},RGBA_BPTC_Format:function(){return nw},RGBA_ETC2_EAC_Format:function(){return no},RGBA_PVRTC_2BPPV1_Format:function(){return nn},RGBA_PVRTC_4BPPV1_Format:function(){return nr},RGBA_S3TC_DXT1_Format:function(){return r8},RGBA_S3TC_DXT3_Format:function(){return r7},RGBA_S3TC_DXT5_Format:function(){return r9},RGBDepthPacking:function(){return nV},RGBFormat:function(){return rX},RGBIntegerFormat:function(){return r4},RGB_BPTC_SIGNED_Format:function(){return nS},RGB_BPTC_UNSIGNED_Format:function(){return nT},RGB_ETC1_Format:function(){return ni},RGB_ETC2_Format:function(){return na},RGB_PVRTC_2BPPV1_Format:function(){return nt},RGB_PVRTC_4BPPV1_Format:function(){return ne},RGB_S3TC_DXT1_Format:function(){return r6},RGDepthPacking:function(){return nq},RGFormat:function(){return r2},RGIntegerFormat:function(){return r3},RawShaderMaterial:function(){return py},Ray:function(){return aq},Raycaster:function(){return mt},Rec709Primaries:function(){return n1},RectAreaLight:function(){return fp},RedFormat:function(){return r0},RedIntegerFormat:function(){return r1},ReinhardToneMapping:function(){return rl},RenderTarget:function(){return ac},RepeatWrapping:function(){return rS},ReplaceStencilOp:function(){return n5},ReverseSubtractEquation:function(){return tH},RingGeometry:function(){return pa},SIGNED_RED_GREEN_RGTC2_Format:function(){return nA},SIGNED_RED_RGTC1_Format:function(){return nE},SRGBColorSpace:function(){return n$},SRGBTransfer:function(){return n0},Scene:function(){return uS},ShaderChunk:function(){return sz},ShaderLib:function(){return sj},ShaderMaterial:function(){return sb},ShadowMaterial:function(){return pg},Shape:function(){return hM},ShapeGeometry:function(){return po},ShapePath:function(){return mH},ShapeUtils:function(){return h8},ShortType:function(){return rU},Skeleton:function(){return u4},SkeletonHelper:function(){return my},SkinnedMesh:function(){return uJ},Source:function(){return ai},Sphere:function(){return aU},SphereGeometry:function(){return pl},Spherical:function(){return mi},SphericalHarmonics3:function(){return ff},SplineCurve:function(){return hh},SpotLight:function(){return fi},SpotLightHelper:function(){return mp},Sprite:function(){return uB},SpriteMaterial:function(){return uC},SrcAlphaFactor:function(){return tX},SrcAlphaSaturateFactor:function(){return t0},SrcColorFactor:function(){return tW},StaticCopyUsage:function(){return iE},StaticDrawUsage:function(){return ib},StaticReadUsage:function(){return iS},StereoCamera:function(){return fR},StreamCopyUsage:function(){return iA},StreamDrawUsage:function(){return iw},StreamReadUsage:function(){return ix},StringKeyframeTrack:function(){return pG},SubtractEquation:function(){return tz},SubtractiveBlending:function(){return tD},TOUCH:function(){return tw},TangentSpaceNormalMap:function(){return nW},TetrahedronGeometry:function(){return pc},Texture:function(){return as},TextureLoader:function(){return p6},TextureUtils:function(){return ui},TorusGeometry:function(){return pu},TorusKnotGeometry:function(){return pd},Triangle:function(){return o_},TriangleFanDrawMode:function(){return nH},TriangleStripDrawMode:function(){return nz},TrianglesDrawMode:function(){return nB},TubeGeometry:function(){return ph},UVMapping:function(){return rg},Uint16BufferAttribute:function(){return oj},Uint32BufferAttribute:function(){return oV},Uint8BufferAttribute:function(){return oB},Uint8ClampedBufferAttribute:function(){return oz},Uniform:function(){return f5},UniformsGroup:function(){return f8},UniformsLib:function(){return sH},UniformsUtils:function(){return sg},UnsignedByteType:function(){return rL},UnsignedInt248Type:function(){return rq},UnsignedInt5999Type:function(){return rW},UnsignedIntType:function(){return rz},UnsignedShort4444Type:function(){return rG},UnsignedShort5551Type:function(){return rV},UnsignedShortType:function(){return rF},VSMShadowMap:function(){return tI},Vector2:function(){return iX},Vector3:function(){return ag},Vector4:function(){return al},VectorKeyframeTrack:function(){return pV},VideoTexture:function(){return dq},WebGL3DRenderTarget:function(){return af},WebGLArrayRenderTarget:function(){return ah},WebGLCoordinateSystem:function(){return iR},WebGLCubeRenderTarget:function(){return sI},WebGLMultipleRenderTargets:function(){return mj},WebGLRenderTarget:function(){return au},WebGLRenderer:function(){return ub},WebGLUtils:function(){return uo},WebGPUCoordinateSystem:function(){return ik},WireframeGeometry:function(){return pp},WrapAroundEnding:function(){return nD},ZeroCurvatureEnding:function(){return nN},ZeroFactor:function(){return tV},ZeroSlopeEnding:function(){return nL},ZeroStencilOp:function(){return n3},createCanvasElement:function(){return i1}});var y=r(81595),v=r(2265),b=r(70594),_=r(64654),w=r(39963),S=r(4784),T=r.n(S);let x=(0,v.createContext)({frame:{timeSeconds:0,pitch0:-1,pitch1:-1,rms0:0,rms1:0,sampleRate:0,samples0:new Float32Array(0),samples1:new Float32Array(0)}}),E=(0,v.createContext)(()=>{}),C=()=>{let e=(0,v.useContext)(x),t=(0,v.useContext)(E);return[e,{setFrame:e=>{t({type:"setFrame",payload:{frame:e}})}}]},A=(e,t)=>"setFrame"===t.type?{...e,frame:t.payload.frame}:e,M=e=>{let{children:t}=e,[r,n]=(0,v.useReducer)(A,{frame:{timeSeconds:0,pitch0:-1,pitch1:-1,rms0:0,rms1:0,sampleRate:0,samples0:new Float32Array(0),samples1:new Float32Array(0)}});return(0,y.tZ)(x.Provider,{value:r,children:(0,y.tZ)(E.Provider,{value:n,children:t})})};var I=r(43890),R=r.n(I);let k=()=>{let e,t,r;let n=!1,i=2048,a=44100,o=new(R())(i),s=o.createComplexArray(),l=new Float32Array(i),c=o.createComplexArray(),u=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(!e||t)&&(e=new OfflineAudioContext({numberOfChannels:2,length:.5*a,sampleRate:a}))},d=(e,t)=>{let r=0,n=e.length;for(let t=0;t<n;t++){let n=e[t];r+=n*n}if((r=Math.sqrt(r/n))<.01)return[-1,r];let a=0,u=n-1,d=.2;for(let t=0;t<n/2;t++)if(Math.abs(e[t])<d){a=t;break}for(let t=1;t<n/2;t++)if(Math.abs(e[n-t])<d){u=n-t;break}for(let t=0;t<a;t++)e[t]=0;for(let t=u+1;t<e.length;t++)e[t]=0;o.realTransform(s,e),o.completeSpectrum(s);for(let e=0;e<i;e++)l[e]=s[2*e]*s[2*e]+s[2*e+1]*s[2*e+1];o.realTransform(c,l),o.completeSpectrum(c);let h=0;for(;c[2*h]>c[2*(h+1)];)h++;let p=-1,f=-1;for(let e=h;e<n/2;e++)c[2*e]>p&&(p=c[2*e],f=e);let m=f,g=c[2*(m-1)],y=c[m],v=c[2*(m+1)],b=(g+v-2*y)/2,_=(v-g)/2;return b&&(m-=_/(2*b)),[t/m,r]};return{setBuffer:async t=>{u(),r=await e.decodeAudioData(await t.arrayBuffer())},requestAnalyze:async o=>{if(!r)throw Error("Audio buffer not set");if(n)throw Error("Analyzing in progress");return t&&(t.stop(),t.disconnect()),u(!0),(t=e.createBufferSource()).buffer=r,t.connect(e.destination),t.start(0,o,1),e.startRendering().then(e=>{let t=e.getChannelData(0),r=e.getChannelData(1),[n,s]=d(t.slice(0,i),a),[l,c]=d(r.slice(0,i),a);return{timeSeconds:o,pitch0:n,pitch1:l,rms0:s,rms1:c,sampleRate:e.sampleRate,samples0:t,samples1:r}})}}},P=e=>{console.log("msSetPlaybackState",e);let t=window.navigator.mediaSession;t&&(t.playbackState=e)},O=e=>{var t,r,n,i,a;console.log("msSetPlayingTrack",e.file.name);let o=window.navigator.mediaSession;if(!o)return;o.metadata&&o.metadata.artwork.length>0&&URL.revokeObjectURL(o.metadata.artwork[0].src);let s=w.S5(null===(t=e.file.metadata)||void 0===t?void 0:t.common.picture),l=[];if(s){let e=URL.createObjectURL(new Blob([new Uint8Array(s.data)],{type:s.format}));l.push({src:e,sizes:"512x512",type:s.format})}else l.push({src:"./track-cover-512x512.png",sizes:"512x512",type:"image/png"});o.metadata=new MediaMetadata({title:(null===(r=e.file.metadata)||void 0===r?void 0:r.common.title)||e.file.name,artist:null===(i=e.file.metadata)||void 0===i?void 0:null===(n=i.common.artists)||void 0===n?void 0:n.join(", "),album:null===(a=e.file.metadata)||void 0===a?void 0:a.common.album,artwork:l}),o.playbackState="playing"},N=()=>{let[e,t]=(0,b.nP)(),[,r]=C(),n=(0,v.useRef)(r),i=(0,v.useRef)(null),a=(0,v.useRef)(null),o=(0,v.useMemo)(()=>k(),[]),s=(0,v.useRef)(null);return(0,v.useEffect)(()=>{let e=i.current,r=a.current;if(!e||!r)return;console.log("Initializing audio player");let s=e=>{console.error(e),t.pause(),(0,_.yv)("".concat(e),{variant:"error"})},l=()=>{t.setDuration(e.duration)},c=()=>{t.setCurrentTime(e.currentTime),o.requestAnalyze(e.currentTime).then(e=>{n.current.setFrame(e)}).catch(e=>{console.warn("Failed to analyze audio",e)})},u=()=>{console.log("Track started playing")},d=()=>{console.log("Track ended"),t.playNextTrack()};return e.addEventListener("error",s),e.addEventListener("ended",d),e.addEventListener("durationchange",l),e.addEventListener("timeupdate",c),e.addEventListener("play",u),console.log("Audio player initialized"),()=>{e.removeEventListener("ended",d),e.removeEventListener("error",s),e.removeEventListener("durationchange",l),e.removeEventListener("timeupdate",c),e.removeEventListener("play",u),e.pause(),r.removeAttribute("src"),r.removeAttribute("type"),e.load(),console.log("Audio player disposed")}},[]),(0,v.useEffect)(()=>{if(!e.currentTimeChanged)return;let t=i.current;t&&(t.currentTime=e.currentTime)},[e.currentTimeChanged]),(0,v.useEffect)(()=>{var r,n;let l=i.current,c=a.current;if(!l||!c){console.error("Audio player not initialized");return}if(!e.isPlaying){l.pause(),P("paused");return}if(e.isActiveTrackLoading)return;let u=e.activeTrack;if(u&&u.file.id!==(null===(r=s.current)||void 0===r?void 0:r.file.id)){if(s.current=u,c.src){let e=c.src;c.src="",c.removeAttribute("src"),URL.revokeObjectURL(e)}T()(null==u?void 0:u.blob);let e=URL.createObjectURL(u.blob);c.src=e,c.type=u.file.mimeType,console.log("Setting source",e,c.type),l.load(),O(u)}l.play().then(()=>{console.log("Played");let e=null==u?void 0:u.blob;e&&o.setBuffer(e)}).catch(e=>{t.pause(),console.error(e),(0,_.yv)("".concat(e),{variant:"error"})}),console.log("To Playing");let d=(null==u?void 0:null===(n=u.file.metadata)||void 0===n?void 0:n.common.title)||(null==u?void 0:u.file.name)||"Unknown";console.log(d),(0,_.yv)((0,y.BX)("span",{children:["Playing"," ",(0,y.tZ)("span",{style:{fontWeight:"bold"},children:d})]}))},[e.isActiveTrackLoading,e.isPlaying,e.activeTrack]),(0,v.useEffect)(()=>{let e=window.navigator.mediaSession;if(!e){console.error("Media session not available");return}let r=i.current;if(!r){console.log("Audio not initialized");return}return r.pause(),r.load(),e.playbackState="paused",console.log("Setting media session handlers",e),e.setActionHandler("play",()=>{console.log("Play"),t.play()}),e.setActionHandler("pause",()=>{console.log("Pause"),t.pause()}),e.setActionHandler("previoustrack",()=>{console.log("Click previous track"),t.playPreviousTrack()}),e.setActionHandler("nexttrack",()=>{console.log("Click next track"),t.playNextTrack()}),e.setActionHandler("seekbackward",null),e.setActionHandler("seekforward",null),e.setActionHandler("seekto",e=>{console.log("Seek to",e),e.fastSeek||void 0===e.seekTime||t.changeCurrentTime(e.seekTime)}),()=>{e.setActionHandler("play",null),e.setActionHandler("pause",null),e.setActionHandler("previoustrack",null),e.setActionHandler("nexttrack",null),e.setActionHandler("seekbackward",null),e.setActionHandler("seekforward",null),console.log("Unsetting media session handlers")}},[]),(0,y.tZ)("audio",{ref:i,children:(0,y.tZ)("source",{ref:a})})};var L=r(94630),D=r(57437),U=(0,L.Z)((0,D.jsx)("path",{d:"M7 6c.55 0 1 .45 1 1v10c0 .55-.45 1-1 1s-1-.45-1-1V7c0-.55.45-1 1-1m3.66 6.82 5.77 4.07c.66.47 1.58-.01 1.58-.82V7.93c0-.81-.91-1.28-1.58-.82l-5.77 4.07c-.57.4-.57 1.24 0 1.64"}),"SkipPreviousRounded"),F=(0,L.Z)((0,D.jsx)("path",{d:"m7.58 16.89 5.77-4.07c.56-.4.56-1.24 0-1.63L7.58 7.11C6.91 6.65 6 7.12 6 7.93v8.14c0 .81.91 1.28 1.58.82M16 7v10c0 .55.45 1 1 1s1-.45 1-1V7c0-.55-.45-1-1-1s-1 .45-1 1"}),"SkipNextRounded"),B=(0,L.Z)((0,D.jsx)("path",{d:"M8 6h8c1.1 0 2 .9 2 2v8c0 1.1-.9 2-2 2H8c-1.1 0-2-.9-2-2V8c0-1.1.9-2 2-2"}),"StopRounded"),z=(0,L.Z)((0,D.jsx)("path",{d:"M8 6.82v10.36c0 .79.87 1.27 1.54.84l8.14-5.18c.62-.39.62-1.29 0-1.69L9.54 5.98C8.87 5.55 8 6.03 8 6.82"}),"PlayArrowRounded"),H=(0,L.Z)((0,D.jsx)("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8"}),"Undo"),j=r(59832),G=r(1899),V=r(78826),q=r(19472),W=r(90486),Z=r(59253),X=r(71495),$=r(71004),K=r(67208),Y=r(88064),Q=r(32879),J=r(74610),ee=r(1119),et=r(61994),er=r(20801),en=r(14031),ei=r(77126),ea=r(15988),eo=r(27835),es=r(72786),el=r(38462),ec=r(11189),eu=r(2005),ed=r(23947),eh=r(3450),ep=r(8659),ef={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},em=r(44393),eg=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;return e.length===t.length&&e.every((e,n)=>r(e,t[n]))};let ey=2;function ev(e,t){return e-t}function eb(e,t){var r;let{index:n}=null!=(r=e.reduce((e,r,n)=>{let i=Math.abs(t-r);return null===e||i<e.distance||i===e.distance?{distance:i,index:n}:e},null))?r:{};return n}function e_(e,t){if(void 0!==t.current&&e.changedTouches){let r=e;for(let e=0;e<r.changedTouches.length;e+=1){let n=r.changedTouches[e];if(n.identifier===t.current)return{x:n.clientX,y:n.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function ew(e,t,r){return(e-t)*100/(r-t)}function eS(e,t,r){return(r-t)*e+t}function eT(e){if(1>Math.abs(e)){let t=e.toExponential().split("e-"),r=t[0].split(".")[1];return(r?r.length:0)+parseInt(t[1],10)}let t=e.toString().split(".")[1];return t?t.length:0}function ex(e,t,r){return Number((Math.round((e-r)/t)*t+r).toFixed(eT(t)))}function eE(e){let{values:t,newValue:r,index:n}=e,i=t.slice();return i[n]=r,i.sort(ev)}function eC(e){var t,r,n;let{sliderRef:i,activeIndex:a,setActive:o}=e,s=(0,es.Z)(i.current);null!=(t=i.current)&&t.contains(s.activeElement)&&Number(null==s||null==(r=s.activeElement)?void 0:r.getAttribute("data-index"))===a||null==(n=i.current)||n.querySelector('[type="range"][data-index="'.concat(a,'"]')).focus(),o&&o(a)}function eA(e,t){return"number"==typeof e&&"number"==typeof t?e===t:"object"==typeof e&&"object"==typeof t&&eg(e,t)}let eM={horizontal:{offset:e=>({left:"".concat(e,"%")}),leap:e=>({width:"".concat(e,"%")})},"horizontal-reverse":{offset:e=>({right:"".concat(e,"%")}),leap:e=>({width:"".concat(e,"%")})},vertical:{offset:e=>({bottom:"".concat(e,"%")}),leap:e=>({height:"".concat(e,"%")})}},eI=e=>e;function eR(){return void 0===n&&("undefined"!=typeof CSS&&"function"==typeof CSS.supports?n=CSS.supports("touch-action","none"):n=!0),n}function ek(e){let{"aria-labelledby":t,defaultValue:r,disabled:n=!1,disableSwap:i=!1,isRtl:a=!1,marks:o=!1,max:s=100,min:l=0,name:c,onChange:u,onChangeCommitted:d,orientation:h="horizontal",rootRef:p,scale:f=eI,step:m=1,shiftStep:g=10,tabIndex:y,value:b}=e,_=v.useRef(void 0),[w,S]=v.useState(-1),[T,x]=v.useState(-1),[E,C]=v.useState(!1),A=v.useRef(0),[M,I]=(0,el.Z)({controlled:b,default:null!=r?r:l,name:"Slider"}),R=u&&((e,t,r)=>{let n=e.nativeEvent||e,i=new n.constructor(n.type,n);Object.defineProperty(i,"target",{writable:!0,value:{value:t,name:c}}),u(i,t,r)}),k=Array.isArray(M),P=k?M.slice().sort(ev):[M];P=P.map(e=>null==e?l:(0,ec.Z)(e,l,s));let O=!0===o&&null!==m?[...Array(Math.floor((s-l)/m)+1)].map((e,t)=>({value:l+m*t})):o||[],N=O.map(e=>e.value),{isFocusVisibleRef:L,onBlur:D,onFocus:U,ref:F}=(0,eu.Z)(),[B,z]=v.useState(-1),H=v.useRef(null),j=(0,ed.Z)(F,H),G=(0,ed.Z)(p,j),V=e=>t=>{var r;let n=Number(t.currentTarget.getAttribute("data-index"));U(t),!0===L.current&&z(n),x(n),null==e||null==(r=e.onFocus)||r.call(e,t)},q=e=>t=>{var r;D(t),!1===L.current&&z(-1),x(-1),null==e||null==(r=e.onBlur)||r.call(e,t)},W=(e,t)=>{let r=Number(e.currentTarget.getAttribute("data-index")),n=P[r],a=N.indexOf(n),o=t;if(O&&null==m){let e=N[N.length-1];o=o>e?e:o<N[0]?N[0]:o<n?N[a-1]:N[a+1]}if(o=(0,ec.Z)(o,l,s),k){i&&(o=(0,ec.Z)(o,P[r-1]||-1/0,P[r+1]||1/0));let e=o;o=eE({values:P,newValue:o,index:r});let t=r;i||(t=o.indexOf(e)),eC({sliderRef:H,activeIndex:t})}I(o),z(r),R&&!eA(o,M)&&R(e,o,r),d&&d(e,o)},Z=e=>t=>{var r;if(null!==m){let e=P[Number(t.currentTarget.getAttribute("data-index"))],r=null;("ArrowLeft"===t.key||"ArrowDown"===t.key)&&t.shiftKey||"PageDown"===t.key?r=Math.max(e-g,l):(("ArrowRight"===t.key||"ArrowUp"===t.key)&&t.shiftKey||"PageUp"===t.key)&&(r=Math.min(e+g,s)),null!==r&&(W(t,r),t.preventDefault())}null==e||null==(r=e.onKeyDown)||r.call(e,t)};(0,eh.Z)(()=>{if(n&&H.current.contains(document.activeElement)){var e;null==(e=document.activeElement)||e.blur()}},[n]),n&&-1!==w&&S(-1),n&&-1!==B&&z(-1);let X=e=>t=>{var r;null==(r=e.onChange)||r.call(e,t),W(t,t.target.valueAsNumber)},$=v.useRef(void 0),K=h;a&&"horizontal"===h&&(K+="-reverse");let Y=e=>{let t,r,{finger:n,move:a=!1}=e,{current:o}=H,{width:c,height:u,bottom:d,left:h}=o.getBoundingClientRect();if(t=0===K.indexOf("vertical")?(d-n.y)/u:(n.x-h)/c,-1!==K.indexOf("-reverse")&&(t=1-t),r=eS(t,l,s),m)r=ex(r,m,l);else{let e=eb(N,r);r=N[e]}r=(0,ec.Z)(r,l,s);let p=0;if(k){p=a?$.current:eb(P,r),i&&(r=(0,ec.Z)(r,P[p-1]||-1/0,P[p+1]||1/0));let e=r;r=eE({values:P,newValue:r,index:p}),i&&a||(p=r.indexOf(e),$.current=p)}return{newValue:r,activeIndex:p}},Q=(0,ep.Z)(e=>{let t=e_(e,_);if(!t)return;if(A.current+=1,"mousemove"===e.type&&0===e.buttons){J(e);return}let{newValue:r,activeIndex:n}=Y({finger:t,move:!0});eC({sliderRef:H,activeIndex:n,setActive:S}),I(r),!E&&A.current>ey&&C(!0),R&&!eA(r,M)&&R(e,r,n)}),J=(0,ep.Z)(e=>{let t=e_(e,_);if(C(!1),!t)return;let{newValue:r}=Y({finger:t,move:!0});S(-1),"touchend"===e.type&&x(-1),d&&d(e,r),_.current=void 0,er()}),et=(0,ep.Z)(e=>{if(n)return;eR()||e.preventDefault();let t=e.changedTouches[0];null!=t&&(_.current=t.identifier);let r=e_(e,_);if(!1!==r){let{newValue:t,activeIndex:n}=Y({finger:r});eC({sliderRef:H,activeIndex:n,setActive:S}),I(t),R&&!eA(t,M)&&R(e,t,n)}A.current=0;let i=(0,es.Z)(H.current);i.addEventListener("touchmove",Q,{passive:!0}),i.addEventListener("touchend",J,{passive:!0})}),er=v.useCallback(()=>{let e=(0,es.Z)(H.current);e.removeEventListener("mousemove",Q),e.removeEventListener("mouseup",J),e.removeEventListener("touchmove",Q),e.removeEventListener("touchend",J)},[J,Q]);v.useEffect(()=>{let{current:e}=H;return e.addEventListener("touchstart",et,{passive:eR()}),()=>{e.removeEventListener("touchstart",et),er()}},[er,et]),v.useEffect(()=>{n&&er()},[n,er]);let en=e=>t=>{var r;if(null==(r=e.onMouseDown)||r.call(e,t),n||t.defaultPrevented||0!==t.button)return;t.preventDefault();let i=e_(t,_);if(!1!==i){let{newValue:e,activeIndex:r}=Y({finger:i});eC({sliderRef:H,activeIndex:r,setActive:S}),I(e),R&&!eA(e,M)&&R(t,e,r)}A.current=0;let a=(0,es.Z)(H.current);a.addEventListener("mousemove",Q,{passive:!0}),a.addEventListener("mouseup",J)},ei=ew(k?P[0]:l,l,s),ea=ew(P[P.length-1],l,s)-ei,eo=e=>t=>{var r;null==(r=e.onMouseOver)||r.call(e,t),x(Number(t.currentTarget.getAttribute("data-index")))},eg=e=>t=>{var r;null==(r=e.onMouseLeave)||r.call(e,t),x(-1)},eT=e=>({pointerEvents:-1!==w&&w!==e?"none":void 0});return{active:w,axis:K,axisProps:eM,dragging:E,focusedThumbIndex:B,getHiddenInputProps:function(){var r;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,em.Z)(i),u={onChange:X(o||{}),onFocus:V(o||{}),onBlur:q(o||{}),onKeyDown:Z(o||{})},d=(0,ee.Z)({},o,u);return(0,ee.Z)({tabIndex:y,"aria-labelledby":t,"aria-orientation":h,"aria-valuemax":f(s),"aria-valuemin":f(l),name:c,type:"range",min:e.min,max:e.max,step:null===e.step&&e.marks?"any":null!=(r=e.step)?r:void 0,disabled:n},i,d,{style:(0,ee.Z)({},ef,{direction:a?"rtl":"ltr",width:"100%",height:"100%"})})},getRootProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,em.Z)(e),r={onMouseDown:en(t||{})},n=(0,ee.Z)({},t,r);return(0,ee.Z)({},e,{ref:G},n)},getThumbProps:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,em.Z)(e),r={onMouseOver:eo(t||{}),onMouseLeave:eg(t||{})};return(0,ee.Z)({},e,t,r)},marks:O,open:T,range:k,rootRef:G,trackLeap:ea,trackOffset:ei,values:P,getThumbStyle:eT}}var eP=r(16210),eO=r(37053),eN=r(99202),eL=e=>!e||!(0,eo.Z)(e),eD=r(85657),eU=r(94143),eF=r(50738);function eB(e){return(0,eF.ZP)("MuiSlider",e)}var ez=(0,eU.Z)("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]);let eH=e=>{let{open:t}=e;return{offset:(0,et.Z)(t&&ez.valueLabelOpen),circle:ez.valueLabelCircle,label:ez.valueLabelLabel}};function ej(e){let{children:t,className:r,value:n}=e,i=eH(e);return t?v.cloneElement(t,{className:(0,et.Z)(t.props.className)},(0,D.jsxs)(v.Fragment,{children:[t.props.children,(0,D.jsx)("span",{className:(0,et.Z)(i.offset,r),"aria-hidden":!0,children:(0,D.jsx)("span",{className:i.circle,children:(0,D.jsx)("span",{className:i.label,children:n})})})]})):null}let eG=["aria-label","aria-valuetext","aria-labelledby","component","components","componentsProps","color","classes","className","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","shiftStep","size","step","scale","slotProps","slots","tabIndex","track","value","valueLabelDisplay","valueLabelFormat"];function eV(e){return e}let eq=(0,eP.ZP)("span",{name:"MuiSlider",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t["color".concat((0,eD.Z)(r.color))],"medium"!==r.size&&t["size".concat((0,eD.Z)(r.size))],r.marked&&t.marked,"vertical"===r.orientation&&t.vertical,"inverted"===r.track&&t.trackInverted,!1===r.track&&t.trackFalse]}})(e=>{var t;let{theme:r}=e;return{borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},["&.".concat(ez.disabled)]:{pointerEvents:"none",cursor:"default",color:(r.vars||r).palette.grey[400]},["&.".concat(ez.dragging)]:{["& .".concat(ez.thumb,", & .").concat(ez.track)]:{transition:"none"}},variants:[...Object.keys((null!=(t=r.vars)?t:r).palette).filter(e=>{var t;return(null!=(t=r.vars)?t:r).palette[e].main}).map(e=>({props:{color:e},style:{color:(r.vars||r).palette[e].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}}),eW=(0,eP.ZP)("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(e,t)=>t.rail})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),eZ=(0,eP.ZP)("span",{name:"MuiSlider",slot:"Track",overridesResolver:(e,t)=>t.track})(e=>{var t;let{theme:r}=e;return{display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:r.transitions.create(["left","width","bottom","height"],{duration:r.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.keys((null!=(t=r.vars)?t:r).palette).filter(e=>{var t;return(null!=(t=r.vars)?t:r).palette[e].main}).map(e=>({props:{color:e,track:"inverted"},style:(0,ee.Z)({},r.vars?{backgroundColor:r.vars.palette.Slider["".concat(e,"Track")],borderColor:r.vars.palette.Slider["".concat(e,"Track")]}:(0,ee.Z)({backgroundColor:(0,en.$n)(r.palette[e].main,.62),borderColor:(0,en.$n)(r.palette[e].main,.62)},r.applyStyles("dark",{backgroundColor:(0,en._j)(r.palette[e].main,.5)}),r.applyStyles("dark",{borderColor:(0,en._j)(r.palette[e].main,.5)})))}))]}}),eX=(0,eP.ZP)("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.thumb,t["thumbColor".concat((0,eD.Z)(r.color))],"medium"!==r.size&&t["thumbSize".concat((0,eD.Z)(r.size))]]}})(e=>{var t;let{theme:r}=e;return{position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:r.transitions.create(["box-shadow","left","bottom"],{duration:r.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(r.vars||r).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},["&.".concat(ez.disabled)]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.keys((null!=(t=r.vars)?t:r).palette).filter(e=>{var t;return(null!=(t=r.vars)?t:r).palette[e].main}).map(e=>({props:{color:e},style:{["&:hover, &.".concat(ez.focusVisible)]:(0,ee.Z)({},r.vars?{boxShadow:"0px 0px 0px 8px rgba(".concat(r.vars.palette[e].mainChannel," / 0.16)")}:{boxShadow:"0px 0px 0px 8px ".concat((0,en.Fq)(r.palette[e].main,.16))},{"@media (hover: none)":{boxShadow:"none"}}),["&.".concat(ez.active)]:(0,ee.Z)({},r.vars?{boxShadow:"0px 0px 0px 14px rgba(".concat(r.vars.palette[e].mainChannel," / 0.16)")}:{boxShadow:"0px 0px 0px 14px ".concat((0,en.Fq)(r.palette[e].main,.16))})}}))]}}),e$=(0,eP.ZP)(ej,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(e,t)=>t.valueLabel})(e=>{let{theme:t}=e;return(0,ee.Z)({zIndex:1,whiteSpace:"nowrap"},t.typography.body2,{fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},["&.".concat(ez.valueLabelOpen)]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},["&.".concat(ez.valueLabelOpen)]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]})}),eK=(0,eP.ZP)("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:e=>(0,eN.Z)(e)&&"markActive"!==e,overridesResolver:(e,t)=>{let{markActive:r}=e;return[t.mark,r&&t.markActive]}})(e=>{let{theme:t}=e;return{position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]}}),eY=(0,eP.ZP)("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:e=>(0,eN.Z)(e)&&"markLabelActive"!==e,overridesResolver:(e,t)=>t.markLabel})(e=>{let{theme:t}=e;return(0,ee.Z)({},t.typography.body2,{color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]})}),eQ=e=>{let{disabled:t,dragging:r,marked:n,orientation:i,track:a,classes:o,color:s,size:l}=e,c={root:["root",t&&"disabled",r&&"dragging",n&&"marked","vertical"===i&&"vertical","inverted"===a&&"trackInverted",!1===a&&"trackFalse",s&&"color".concat((0,eD.Z)(s)),l&&"size".concat((0,eD.Z)(l))],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",t&&"disabled",l&&"thumbSize".concat((0,eD.Z)(l)),s&&"thumbColor".concat((0,eD.Z)(s))],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return(0,er.Z)(c,eB,o)},eJ=e=>{let{children:t}=e;return t};var e0=v.forwardRef(function(e,t){var r,n,i,a,o,s,l,c,u,d,h,p,f,m,g,y,b,_,w,S,T,x,E,C;let A=(0,eO.i)({props:e,name:"MuiSlider"}),M=(0,ei.V)(),{"aria-label":I,"aria-valuetext":R,"aria-labelledby":k,component:P="span",components:O={},componentsProps:N={},color:L="primary",classes:U,className:F,disableSwap:B=!1,disabled:z=!1,getAriaLabel:H,getAriaValueText:j,marks:G=!1,max:V=100,min:q=0,orientation:W="horizontal",shiftStep:Z=10,size:X="medium",step:$=1,scale:K=eV,slotProps:Y,slots:Q,track:er="normal",valueLabelDisplay:en="off",valueLabelFormat:es=eV}=A,el=(0,J.Z)(A,eG),ec=(0,ee.Z)({},A,{isRtl:M,max:V,min:q,classes:U,disabled:z,disableSwap:B,orientation:W,marks:G,color:L,size:X,step:$,shiftStep:Z,scale:K,track:er,valueLabelDisplay:en,valueLabelFormat:es}),{axisProps:eu,getRootProps:ed,getHiddenInputProps:eh,getThumbProps:ep,open:ef,active:em,axis:eg,focusedThumbIndex:ey,range:ev,dragging:eb,marks:e_,values:eS,trackOffset:eT,trackLeap:ex,getThumbStyle:eE}=ek((0,ee.Z)({},ec,{rootRef:t}));ec.marked=e_.length>0&&e_.some(e=>e.label),ec.dragging=eb,ec.focusedThumbIndex=ey;let eC=eQ(ec),eA=null!=(r=null!=(n=null==Q?void 0:Q.root)?n:O.Root)?r:eq,eM=null!=(i=null!=(a=null==Q?void 0:Q.rail)?a:O.Rail)?i:eW,eI=null!=(o=null!=(s=null==Q?void 0:Q.track)?s:O.Track)?o:eZ,eR=null!=(l=null!=(c=null==Q?void 0:Q.thumb)?c:O.Thumb)?l:eX,eP=null!=(u=null!=(d=null==Q?void 0:Q.valueLabel)?d:O.ValueLabel)?u:e$,eN=null!=(h=null!=(p=null==Q?void 0:Q.mark)?p:O.Mark)?h:eK,eD=null!=(f=null!=(m=null==Q?void 0:Q.markLabel)?m:O.MarkLabel)?f:eY,eU=null!=(g=null!=(y=null==Q?void 0:Q.input)?y:O.Input)?g:"input",eF=null!=(b=null==Y?void 0:Y.root)?b:N.root,eB=null!=(_=null==Y?void 0:Y.rail)?_:N.rail,ez=null!=(w=null==Y?void 0:Y.track)?w:N.track,eH=null!=(S=null==Y?void 0:Y.thumb)?S:N.thumb,ej=null!=(T=null==Y?void 0:Y.valueLabel)?T:N.valueLabel,e0=null!=(x=null==Y?void 0:Y.mark)?x:N.mark,e1=null!=(E=null==Y?void 0:Y.markLabel)?E:N.markLabel,e2=null!=(C=null==Y?void 0:Y.input)?C:N.input,e3=(0,ea.Z)({elementType:eA,getSlotProps:ed,externalSlotProps:eF,externalForwardedProps:el,additionalProps:(0,ee.Z)({},eL(eA)&&{as:P}),ownerState:(0,ee.Z)({},ec,null==eF?void 0:eF.ownerState),className:[eC.root,F]}),e4=(0,ea.Z)({elementType:eM,externalSlotProps:eB,ownerState:ec,className:eC.rail}),e5=(0,ea.Z)({elementType:eI,externalSlotProps:ez,additionalProps:{style:(0,ee.Z)({},eu[eg].offset(eT),eu[eg].leap(ex))},ownerState:(0,ee.Z)({},ec,null==ez?void 0:ez.ownerState),className:eC.track}),e6=(0,ea.Z)({elementType:eR,getSlotProps:ep,externalSlotProps:eH,ownerState:(0,ee.Z)({},ec,null==eH?void 0:eH.ownerState),className:eC.thumb}),e8=(0,ea.Z)({elementType:eP,externalSlotProps:ej,ownerState:(0,ee.Z)({},ec,null==ej?void 0:ej.ownerState),className:eC.valueLabel}),e7=(0,ea.Z)({elementType:eN,externalSlotProps:e0,ownerState:ec,className:eC.mark}),e9=(0,ea.Z)({elementType:eD,externalSlotProps:e1,ownerState:ec,className:eC.markLabel}),te=(0,ea.Z)({elementType:eU,getSlotProps:eh,externalSlotProps:e2,ownerState:ec});return(0,D.jsxs)(eA,(0,ee.Z)({},e3,{children:[(0,D.jsx)(eM,(0,ee.Z)({},e4)),(0,D.jsx)(eI,(0,ee.Z)({},e5)),e_.filter(e=>e.value>=q&&e.value<=V).map((e,t)=>{let r;let n=ew(e.value,q,V),i=eu[eg].offset(n);return r=!1===er?-1!==eS.indexOf(e.value):"normal"===er&&(ev?e.value>=eS[0]&&e.value<=eS[eS.length-1]:e.value<=eS[0])||"inverted"===er&&(ev?e.value<=eS[0]||e.value>=eS[eS.length-1]:e.value>=eS[0]),(0,D.jsxs)(v.Fragment,{children:[(0,D.jsx)(eN,(0,ee.Z)({"data-index":t},e7,!(0,eo.Z)(eN)&&{markActive:r},{style:(0,ee.Z)({},i,e7.style),className:(0,et.Z)(e7.className,r&&eC.markActive)})),null!=e.label?(0,D.jsx)(eD,(0,ee.Z)({"aria-hidden":!0,"data-index":t},e9,!(0,eo.Z)(eD)&&{markLabelActive:r},{style:(0,ee.Z)({},i,e9.style),className:(0,et.Z)(eC.markLabel,e9.className,r&&eC.markLabelActive),children:e.label})):null]},t)}),eS.map((e,t)=>{let r=ew(e,q,V),n=eu[eg].offset(r),i="off"===en?eJ:eP;return(0,D.jsx)(i,(0,ee.Z)({},!(0,eo.Z)(i)&&{valueLabelFormat:es,valueLabelDisplay:en,value:"function"==typeof es?es(K(e),t):es,index:t,open:ef===t||em===t||"on"===en,disabled:z},e8,{children:(0,D.jsx)(eR,(0,ee.Z)({"data-index":t},e6,{className:(0,et.Z)(eC.thumb,e6.className,em===t&&eC.active,ey===t&&eC.focusVisible),style:(0,ee.Z)({},n,eE(t),e6.style),children:(0,D.jsx)(eU,(0,ee.Z)({"data-index":t,"aria-label":H?H(t):I,"aria-valuenow":K(e),"aria-labelledby":k,"aria-valuetext":j?j(K(e),t):R,value:eS[t]},te))}))}),t)})]}))}),e1=r(5002),e2=r(37995),e3=r(3146);let e4=e=>"".concat(e<10?"0":"").concat(e),e5=e=>{if("number"!=typeof e||!Number.isFinite(e)||e<0)return"--:--";let t=Math.floor(e/60/60),r=Math.floor(e%3600/60),n=Math.floor(e%3600%60),i=[e4(r),e4(n)];return t&&i.unshift(t),i.join(":")},e6=(0,e3.iv)({display:"flex",flexDirection:"column"}),e8=(0,v.memo)(e=>{let{value:t}=e;return(0,y.tZ)(e0,{sx:{height:8,"& .MuiSlider-thumb":{width:4,height:16,borderRadius:1,"&.Mui-active":{boxShadow:e=>"0px 0px 0px 6px ".concat((0,Y.Fq)(e.palette.primary.main,.16))}},"& .MuiSlider-track":{height:8},"& .MuiSlider-rail":{height:8}},size:"small",value:t,max:1e3})});e8.displayName="TimeSlider";let e7=(0,v.memo)(e=>{let{currentTime:t,duration:r,color:n}=e;return(0,y.BX)("div",{css:(0,e3.iv)({display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:-16}),children:[(0,y.tZ)(e1.Z,{variant:"caption",color:n,children:e5(t)}),(0,y.tZ)(e1.Z,{variant:"caption",color:n,children:e5(r)})]})});e7.displayName="TimeDisplay";let e9=e=>{let[t]=(0,b.nP)(),[r]=(0,Q.fl)(),n=t.duration,i=t.currentTime,[a,o]=(0,v.useState)(0),s=(0,e2.PQ)(e2.YI.onSurfaceVariant.getArgb(r.scheme));return(0,v.useEffect)(()=>{o(i?i/n*1e3:0)},[i,n]),(0,y.BX)("div",{css:e6,...e,children:[(0,y.tZ)(e8,{value:a}),(0,y.tZ)(e7,{currentTime:~~i,duration:n,color:s})]})};var te=r(64571),tt=r(28757),tr=r(78567);let tn=(0,v.createContext)({dynamicsEffectAppeal:!1}),ti=(0,v.createContext)(()=>{}),ta=()=>{let e=(0,v.useContext)(tn),t=(0,v.useContext)(ti);return(0,v.useRef)(e).current=e,[e,(0,v.useMemo)(()=>({setDynamicsEffectAppeal:e=>{t({type:"setDynamicsEffectAppeal",payload:{dynamicsEffectAppeal:e}})}}),[])]},to=(e,t)=>"setDynamicsEffectAppeal"===t.type?{...e,dynamicsEffectAppeal:t.payload.dynamicsEffectAppeal}:e,ts=e=>{let{children:t}=e,[r,n]=(0,v.useReducer)(to,{dynamicsEffectAppeal:!1});return(0,y.tZ)(tn.Provider,{value:r,children:(0,y.tZ)(ti.Provider,{value:n,children:t})})},tl=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e3,[t,r]=(0,v.useState)(!0),n=(0,v.useRef)(null),i=(0,v.useRef)(null),a=(0,v.useCallback)(()=>{r(!0),n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{r(!1)},e)},[e]);return(0,v.useEffect)(()=>{let t=i.current;if(t)return t.addEventListener("mousemove",a),n.current=setTimeout(()=>{r(!1)},e),()=>{t.removeEventListener("mousemove",a),n.current&&clearTimeout(n.current)}},[a,e]),{showCursor:t,containerRef:i}},tc=e=>{let{onClick:t,size:r="medium"}=e;return(0,y.tZ)(j.Z,{onClick:t,size:r,children:(0,y.tZ)(U,{fontSize:"inherit"})})},tu=e=>{let{onClick:t,size:r="medium"}=e;return(0,y.tZ)(j.Z,{onClick:t,size:r,children:(0,y.tZ)(F,{fontSize:"inherit"})})},td=e=>{let{onClick:t,isPlaying:r,primaryColor:n,onPrimaryColor:i}=e;return(0,y.tZ)(j.Z,{size:"large",sx:{backgroundColor:n,color:i,"&:hover":{backgroundColor:n}},onClick:t,children:(0,y.BX)(G.Z,{component:"div",sx:{position:"relative",width:"32px",height:"32px",display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,y.tZ)(V.Z,{in:r,timeout:500,appear:!1,children:(0,y.tZ)(B,{sx:{fontSize:32,position:"absolute"}})}),(0,y.tZ)(V.Z,{in:!r,timeout:500,appear:!1,children:(0,y.tZ)(z,{sx:{fontSize:32,position:"absolute"}})})]})})},th=(0,v.memo)(e=>{var t;let{activeTrack:r,coverUrl:n,title:i,onExpand:a,isPlaying:o,isActiveTrackLoading:s,playSourceUrl:l,routerPathname:c,routerHash:u,onGoBack:d,onPlayPrevious:h,onPlayPause:p,onPlayNext:f}=e,[m]=(0,Q.fl)(),g=(0,e2.PQ)(e2.YI.onSurfaceVariant.getArgb(m.scheme)),v=(0,e2.PQ)(e2.YI.onSurface.getArgb(m.scheme)),b=(0,e2.PQ)(e2.YI.primary.getArgb(m.scheme)),_=(0,e2.PQ)(e2.YI.onPrimary.getArgb(m.scheme)),w=!!l&&"".concat(c).concat(u)!==l;return(0,y.BX)("div",{css:(0,e3.iv)({position:"relative"}),children:[(0,y.tZ)("div",{css:(0,e3.iv)({position:"absolute",top:0,left:0,right:0}),children:w?(0,y.tZ)(j.Z,{size:"small",onClick:d,sx:{color:g},children:(0,y.tZ)(H,{fontSize:"inherit"})}):null}),(0,y.tZ)(e9,{css:(0,e3.iv)({marginTop:8,marginBottom:8,marginLeft:32,marginRight:32})}),(0,y.BX)("div",{css:(0,e3.iv)({display:"flex",alignItems:"center",width:"100%",paddingLeft:16,paddingRight:16,paddingBottom:8}),children:[(0,y.tZ)(q.Z,{sx:{mr:2,p:0,borderRadius:"10%"},onClick:a,children:(0,y.tZ)(tr.N,{coverUrl:n})}),(0,y.BX)("div",{css:(0,e3.iv)({flexGrow:1,minWidth:0}),children:[(0,y.tZ)(te.b,{text:i,color:v}),(0,y.tZ)(te.b,{text:(null==r?void 0:null===(t=r.file.metadata)||void 0===t?void 0:t.common.artist)||"",color:g})]}),(0,y.tZ)(tc,{onClick:h}),(0,y.tZ)(td,{onClick:p,isPlaying:o,primaryColor:b,onPrimaryColor:_}),(0,y.tZ)(tu,{onClick:f})]}),(0,y.tZ)("div",{css:(0,e3.iv)({position:"absolute",bottom:0,left:0,right:0}),children:(0,y.tZ)(W.Z,{in:s,style:{transitionDelay:s?"800ms":"0ms"},unmountOnExit:!0,children:(0,y.tZ)(Z.Z,{sx:{width:"100%"}})})})]})});th.displayName="MiniPlayerContentInner";let tp=e=>{let{activeTrack:t,coverUrl:r,title:n,onExpand:i}=e,[a,o]=(0,b.nP)(),[s,l]=(0,tt.tv)(),c=(0,v.useCallback)(()=>{let e=a.playSourceUrl;e&&l.go(e)},[a.playSourceUrl,l]),u=(0,v.useCallback)(()=>{o.playPreviousTrack()},[o]),d=(0,v.useCallback)(()=>{a.isPlaying?o.pause():o.play()},[a.isPlaying,o]),h=(0,v.useCallback)(()=>{o.playNextTrack()},[o]);return(0,y.tZ)(th,{activeTrack:t,title:n,coverUrl:r,onExpand:i,isPlaying:a.isPlaying,isActiveTrackLoading:a.isActiveTrackLoading,playSourceUrl:a.playSourceUrl,routerPathname:s.pathname,routerHash:s.hash,onGoBack:c,onPlayPrevious:u,onPlayPause:d,onPlayNext:h})},tf=(0,v.memo)(e=>{var t;let{onShrink:r,title:n,activeTrack:i,coverUrl:a,isPlaying:o,showCursor:s,containerRef:l,trackCoverWrapperRef:c,trackCoverRef:u,onPlayPrevious:d,onPlayPause:h,onPlayNext:p,onCoverClick:f}=e,[m]=(0,Q.fl)(),g=(0,e2.PQ)(e2.YI.primary.getArgb(m.scheme)),v=(0,e2.PQ)(e2.YI.onPrimary.getArgb(m.scheme));return(0,y.BX)("div",{ref:l,css:(0,e3.iv)({width:"100%",height:"100%",cursor:s?"default":"none"}),children:[(0,y.tZ)(X.Z,{sx:{backgroundColor:"transparent"},elevation:0,children:(0,y.tZ)($.Z,{children:(0,y.tZ)(j.Z,{size:"large",edge:"start",color:"inherit",onClick:r,children:(0,y.tZ)(H,{})})})}),(0,y.BX)("div",{css:(0,e3.iv)({display:"flex",flexDirection:"column",width:"100%",height:"100%",position:"relative"}),children:[(0,y.tZ)("div",{css:(0,e3.iv)({"@media (orientation: portrait)":{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:80,paddingBottom:8,paddingLeft:32,paddingRight:32},"@media (orientation: landscape)":{position:"absolute",bottom:0,left:0,width:"auto",height:"auto",maxWidth:"min(25%, 280px)",maxHeight:"50%",paddingBottom:"max(40px, env(safe-area-inset-bottom, 0))",paddingLeft:"max(40px, env(safe-area-inset-left, 0))"}}),ref:c,children:(0,y.tZ)(tr.N,{sx:{aspectRatio:"1 / 1",width:"auto",height:"auto",maxWidth:"100%",maxHeight:"100%",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.25)",boxSizing:"border-box","@media (orientation: portrait)":{maxWidth:"min(50vw, 240px)",maxHeight:"min(50vw, 240px)"},"@media (orientation: landscape)":{maxWidth:"min(25vw, 280px)",maxHeight:"min(40vh, 280px)"}},coverUrl:a,ref:u,onClick:f})}),(0,y.BX)("div",{css:(0,e3.iv)({display:"flex",flexDirection:"column",justifyContent:"center",minWidth:0,"@media (orientation: portrait)":{flexGrow:1,justifyContent:"flex-end",paddingBottom:"calc(env(safe-area-inset-bottom, 0) + 80px)",paddingRight:"calc(env(safe-area-inset-right, 0) + 40px)",paddingLeft:"calc(env(safe-area-inset-left, 0) + 40px)"},"@media (orientation: landscape)":{position:"absolute",bottom:0,right:0,width:"min(50%, 600px)",paddingBottom:"max(40px, env(safe-area-inset-bottom, 0))",paddingRight:"max(40px, env(safe-area-inset-right, 0))",paddingLeft:"40px"}}),children:[(0,y.tZ)(te.b,{text:n,variant:"h4",typographySx:{fontWeight:"bold"}}),(0,y.tZ)(te.b,{text:(null==i?void 0:null===(t=i.file.metadata)||void 0===t?void 0:t.common.artist)||"",variant:"subtitle1"}),(0,y.tZ)(e9,{css:(0,e3.iv)({marginTop:8})}),(0,y.BX)("div",{css:(0,e3.iv)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:40}),children:[(0,y.tZ)(tc,{onClick:d,size:"large"}),(0,y.tZ)(td,{onClick:h,isPlaying:o,primaryColor:g,onPrimaryColor:v}),(0,y.tZ)(tu,{onClick:p,size:"large"})]})]})]})]})});tf.displayName="FullPlayerContentInner";let tm=e=>{let{activeTrack:t}=e,[r,n]=(0,b.nP)(),i=(0,v.useRef)(null),a=(0,v.useRef)(null),[,o]=ta(),{showCursor:s,containerRef:l}=tl(3e3);(0,v.useEffect)(()=>{let e=new ResizeObserver(e=>{if(a.current)for(let t of e){let{width:e,height:r}=t.contentRect;e<r?(a.current.style.width="100%",a.current.style.height="auto"):(a.current.style.width="auto",a.current.style.height="100%")}});return i.current&&e.observe(i.current),()=>{e.disconnect()}},[]);let c=(0,v.useCallback)(()=>{n.playPreviousTrack()},[n]),u=(0,v.useCallback)(()=>{r.isPlaying?n.pause():n.play()},[r.isPlaying,n]),d=(0,v.useCallback)(()=>{n.playNextTrack()},[n]),h=(0,v.useCallback)(()=>{o.setDynamicsEffectAppeal(!0)},[o]);return(0,y.tZ)(tf,{onShrink:e.onShrink,title:e.title,activeTrack:t,coverUrl:e.coverUrl,isPlaying:r.isPlaying,showCursor:s,containerRef:l,trackCoverWrapperRef:i,trackCoverRef:a,onPlayPrevious:c,onPlayPause:u,onPlayNext:d,onCoverClick:h})},tg=e=>{let[t]=(0,b.nP)(),r=t.activeTrack,n=t.isActiveTrackLoading;return(0,y.tZ)(ty,{...e,activeTrack:r,isActiveTrackLoading:n})},ty=(0,v.memo)(function(e){var t,r;let{activeTrack:n,isActiveTrackLoading:i,...a}=e,[o]=(0,Q.fl)(),[s,l]=(0,v.useState)(void 0),c=(0,v.useRef)(null),u=(0,v.useRef)(null);(0,v.useEffect)(()=>{var e;let t;s&&URL.revokeObjectURL(s);let r=w.S5(null==n?void 0:null===(e=n.file.metadata)||void 0===e?void 0:e.common.picture);return r&&(t=URL.createObjectURL(new Blob([new Uint8Array(r.data)],{type:r.format}))),l(t),()=>{s&&URL.revokeObjectURL(s)}},[null==n?void 0:null===(t=n.file.metadata)||void 0===t?void 0:t.common.picture]);let d=(null==n?void 0:null===(r=n.file.metadata)||void 0===r?void 0:r.common.title)||(null==n?void 0:n.file.name)||"No track playing",h=(0,e2.PQ)(e2.YI.surfaceContainerHighest.getArgb(o.scheme));return(0,y.BX)("div",{children:[(0,y.tZ)(G.Z,{component:"div",style:{transform:a.expand?"perspective(160px) translateZ(80px)":"none"},sx:{position:"fixed",transition:"transform 1s",bottom:"calc(env(safe-area-inset-bottom, 0) + 8px)",right:"calc(env(safe-area-inset-right, 0) + 8px)",left:"calc(env(safe-area-inset-left, 0) + 8px)",transformOrigin:"bottom",pointerEvents:"none"},children:(0,y.tZ)(W.Z,{in:!a.expand,timeout:1e3,unmountOnExit:!0,children:(0,y.tZ)(K.Z,{sx:{display:"flex",flexDirection:"column",backdropFilter:"blur(16px)",maxWidth:640,background:(0,Y.Fq)(h,.5),borderRadius:"12px",m:"auto",pointerEvents:"auto"},ref:c,children:(0,y.tZ)(tp,{activeTrack:n,coverUrl:s,title:d,onExpand:a.onExpand})})})}),(0,y.tZ)(G.Z,{component:"div",style:{transform:a.expand?"none":"perspective(160px) translateZ(-800px)"},sx:{position:"fixed",transition:"transform 1s",bottom:0,right:0,left:0,top:0,transformOrigin:"bottom",pointerEvents:"none"},children:(0,y.tZ)(W.Z,{in:a.expand,timeout:1e3,unmountOnExit:!0,children:(0,y.tZ)(G.Z,{component:"div",sx:{width:"100%",height:"100%",pointerEvents:"auto"},children:(0,y.tZ)(tm,{onShrink:a.onShrink,coverRef:u,coverUrl:s,title:d,activeTrack:n})})})})]})});var tv=r(86083);let tb="167",t_={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},tw={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},tS=0,tT=1,tx=2,tE=3,tC=0,tA=1,tM=2,tI=3,tR=0,tk=1,tP=2,tO=0,tN=1,tL=2,tD=3,tU=4,tF=5,tB=100,tz=101,tH=102,tj=103,tG=104,tV=200,tq=201,tW=202,tZ=203,tX=204,t$=205,tK=206,tY=207,tQ=208,tJ=209,t0=210,t1=211,t2=212,t3=213,t4=214,t5=0,t6=1,t8=2,t7=3,t9=4,re=5,rt=6,rr=7,rn=0,ri=1,ra=2,ro=0,rs=1,rl=2,rc=3,ru=4,rd=5,rh=6,rp=7,rf="attached",rm="detached",rg=300,ry=301,rv=302,rb=303,r_=304,rw=306,rS=1e3,rT=1001,rx=1002,rE=1003,rC=1004,rA=1004,rM=1005,rI=1005,rR=1006,rk=1007,rP=1007,rO=1008,rN=1008,rL=1009,rD=1010,rU=1011,rF=1012,rB=1013,rz=1014,rH=1015,rj=1016,rG=1017,rV=1018,rq=1020,rW=35902,rZ=1021,rX=1022,r$=1023,rK=1024,rY=1025,rQ=1026,rJ=1027,r0=1028,r1=1029,r2=1030,r3=1031,r4=1032,r5=1033,r6=33776,r8=33777,r7=33778,r9=33779,ne=35840,nt=35841,nr=35842,nn=35843,ni=36196,na=37492,no=37496,ns=37808,nl=37809,nc=37810,nu=37811,nd=37812,nh=37813,np=37814,nf=37815,nm=37816,ng=37817,ny=37818,nv=37819,nb=37820,n_=37821,nw=36492,nS=36494,nT=36495,nx=36283,nE=36284,nC=36285,nA=36286,nM=2200,nI=2201,nR=2202,nk=2300,nP=2301,nO=2302,nN=2400,nL=2401,nD=2402,nU=2500,nF=2501,nB=0,nz=1,nH=2,nj=3200,nG=3201,nV=3202,nq=3203,nW=0,nZ=1,nX="",n$="srgb",nK="srgb-linear",nY="display-p3",nQ="display-p3-linear",nJ="linear",n0="srgb",n1="rec709",n2="p3",n3=0,n4=7680,n5=7681,n6=7682,n8=7683,n7=34055,n9=34056,ie=5386,it=512,ir=513,ii=514,ia=515,io=516,is=517,il=518,ic=519,iu=512,id=513,ih=514,ip=515,im=516,ig=517,iy=518,iv=519,ib=35044,i_=35048,iw=35040,iS=35045,iT=35049,ix=35041,iE=35046,iC=35050,iA=35042,iM="100",iI="300 es",iR=2e3,ik=2001;class iP{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});let r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;let r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;let r=this._listeners[e];if(void 0!==r){let e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;let t=this._listeners[e.type];if(void 0!==t){e.target=this;let r=t.slice(0);for(let t=0,n=r.length;t<n;t++)r[t].call(this,e);e.target=null}}}let iO=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],iN=1234567,iL=Math.PI/180,iD=180/Math.PI;function iU(){let e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(iO[255&e]+iO[e>>8&255]+iO[e>>16&255]+iO[e>>24&255]+"-"+iO[255&t]+iO[t>>8&255]+"-"+iO[t>>16&15|64]+iO[t>>24&255]+"-"+iO[63&r|128]+iO[r>>8&255]+"-"+iO[r>>16&255]+iO[r>>24&255]+iO[255&n]+iO[n>>8&255]+iO[n>>16&255]+iO[n>>24&255]).toLowerCase()}function iF(e,t,r){return Math.max(t,Math.min(r,e))}function iB(e,t){return(e%t+t)%t}function iz(e,t,r){return(1-r)*e+r*t}function iH(e,t,r,n){return iz(e,t,1-Math.exp(-r*n))}function ij(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(iB(e,2*t)-t)}function iG(e){return e*iL}function iV(e){return e*iD}function iq(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw Error("Invalid component type.")}}function iW(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw Error("Invalid component type.")}}let iZ={DEG2RAD:iL,RAD2DEG:iD,generateUUID:iU,clamp:iF,euclideanModulo:iB,mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},inverseLerp:function(e,t,r){return e!==t?(r-e)/(t-e):0},lerp:iz,damp:iH,pingpong:ij,smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(iN=e);let t=iN+=1831565813;return t=Math.imul(t^t>>>15,1|t),(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/4294967296},degToRad:iG,radToDeg:iV,isPowerOfTwo:function(e){return(e&e-1)==0&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,r,n,i){let a=Math.cos,o=Math.sin,s=a(r/2),l=o(r/2),c=a((t+n)/2),u=o((t+n)/2),d=a((t-n)/2),h=o((t-n)/2),p=a((n-t)/2),f=o((n-t)/2);switch(i){case"XYX":e.set(s*u,l*d,l*h,s*c);break;case"YZY":e.set(l*h,s*u,l*d,s*c);break;case"ZXZ":e.set(l*d,l*h,s*u,s*c);break;case"XZX":e.set(s*u,l*f,l*p,s*c);break;case"YXY":e.set(l*p,s*u,l*f,s*c);break;case"ZYZ":e.set(l*f,l*p,s*u,s*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:iW,denormalize:iq};class iX{get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());return 0===t?Math.PI/2:Math.acos(iF(this.dot(e)/t,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),n=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*r-a*n+e.x,this.y=i*n+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}constructor(e=0,t=0){iX.prototype.isVector2=!0,this.x=e,this.y=t}}class i${set(e,t,r,n,i,a,o,s,l){let c=this.elements;return c[0]=e,c[1]=n,c[2]=o,c[3]=t,c[4]=i,c[5]=s,c[6]=r,c[7]=a,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,i=this.elements,a=r[0],o=r[3],s=r[6],l=r[1],c=r[4],u=r[7],d=r[2],h=r[5],p=r[8],f=n[0],m=n[3],g=n[6],y=n[1],v=n[4],b=n[7],_=n[2],w=n[5],S=n[8];return i[0]=a*f+o*y+s*_,i[3]=a*m+o*v+s*w,i[6]=a*g+o*b+s*S,i[1]=l*f+c*y+u*_,i[4]=l*m+c*v+u*w,i[7]=l*g+c*b+u*S,i[2]=d*f+h*y+p*_,i[5]=d*m+h*v+p*w,i[8]=d*g+h*b+p*S,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8];return t*a*c-t*o*l-r*i*c+r*o*s+n*i*l-n*a*s}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=c*a-o*l,d=o*s-c*i,h=l*i-a*s,p=t*u+r*d+n*h;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);let f=1/p;return e[0]=u*f,e[1]=(n*l-c*r)*f,e[2]=(o*r-n*a)*f,e[3]=d*f,e[4]=(c*t-n*s)*f,e[5]=(n*i-o*t)*f,e[6]=h*f,e[7]=(r*s-l*t)*f,e[8]=(a*t-r*i)*f,this}transpose(){let e;let t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,i,a,o){let s=Math.cos(i),l=Math.sin(i);return this.set(r*s,r*l,-r*(s*a+l*o)+a+e,-n*l,n*s,-n*(-l*a+s*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(iK.makeScale(e,t)),this}rotate(e){return this.premultiply(iK.makeRotation(-e)),this}translate(e,t){return this.premultiply(iK.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,r=e.elements;for(let e=0;e<9;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}constructor(e,t,r,n,i,a,o,s,l){i$.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,r,n,i,a,o,s,l)}}let iK=new i$;function iY(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}let iQ={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function iJ(e,t){return new iQ[e](t)}function i0(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function i1(){let e=i0("canvas");return e.style.display="block",e}let i2={};function i3(e){e in i2||(i2[e]=!0,console.warn(e))}function i4(e,t,r){return new Promise(function(n,i){function a(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:i();break;case e.TIMEOUT_EXPIRED:setTimeout(a,r);break;default:n()}}setTimeout(a,r)})}let i5=new i$().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),i6=new i$().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),i8={[nK]:{transfer:nJ,primaries:n1,luminanceCoefficients:[.2126,.7152,.0722],toReference:e=>e,fromReference:e=>e},[n$]:{transfer:n0,primaries:n1,luminanceCoefficients:[.2126,.7152,.0722],toReference:e=>e.convertSRGBToLinear(),fromReference:e=>e.convertLinearToSRGB()},[nQ]:{transfer:nJ,primaries:n2,luminanceCoefficients:[.2289,.6917,.0793],toReference:e=>e.applyMatrix3(i6),fromReference:e=>e.applyMatrix3(i5)},[nY]:{transfer:n0,primaries:n2,luminanceCoefficients:[.2289,.6917,.0793],toReference:e=>e.convertSRGBToLinear().applyMatrix3(i6),fromReference:e=>e.applyMatrix3(i5).convertLinearToSRGB()}},i7=new Set([nK,nQ]),i9={enabled:!0,_workingColorSpace:nK,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(colorSpace){if(!i7.has(colorSpace))throw Error('Unsupported working color space, "'.concat(colorSpace,'".'));this._workingColorSpace=colorSpace},convert:function(e,t,r){if(!1===this.enabled||t===r||!t||!r)return e;let n=i8[t].toReference;return(0,i8[r].fromReference)(n(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this._workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this._workingColorSpace)},getPrimaries:function(e){return i8[e].primaries},getTransfer:function(e){return e===nX?nJ:i8[e].transfer},getLuminanceCoefficients:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._workingColorSpace;return e.fromArray(i8[t].luminanceCoefficients)}};function ae(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function at(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}class ar{static getDataURL(e){let t;if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===i&&(i=i0("canvas")),i.width=e.width,i.height=e.height;let r=i.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=i}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){let t=i0("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let n=r.getImageData(0,0,e.width,e.height),i=n.data;for(let e=0;e<i.length;e++)i[e]=255*ae(i[e]/255);return r.putImageData(n,0,0),t}if(!e.data)return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e;{let t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*ae(t[e]/255)):t[e]=ae(t[e]);return{data:t,width:e.width,height:e.height}}}}let an=0;class ai{set needsUpdate(e){!0===e&&this.version++}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];let r={uuid:this.uuid,url:""},n=this.data;if(null!==n){let e;if(Array.isArray(n)){e=[];for(let t=0,r=n.length;t<r;t++)n[t].isDataTexture?e.push(aa(n[t].image)):e.push(aa(n[t]))}else e=aa(n);r.url=e}return t||(e.images[this.uuid]=r),r}constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:an++}),this.uuid=iU(),this.data=e,this.dataReady=!0,this.version=0}}function aa(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?ar.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let ao=0;class as extends iP{get image(){return this.source.data}set image(e){void 0===e&&(e=null),this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];let r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==rg)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case rS:e.x=e.x-Math.floor(e.x);break;case rT:e.x=e.x<0?0:1;break;case rx:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case rS:e.y=e.y-Math.floor(e.y);break;case rT:e.y=e.y<0?0:1;break;case rx:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}constructor(e=as.DEFAULT_IMAGE,t=as.DEFAULT_MAPPING,r=rT,n=rT,i=rR,a=rO,o=r$,s=rL,l=as.DEFAULT_ANISOTROPY,c=nX){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:ao++}),this.uuid=iU(),this.name="",this.source=new ai(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=n,this.magFilter=i,this.minFilter=a,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=s,this.offset=new iX(0,0),this.repeat=new iX(1,1),this.center=new iX(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new i$,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}}as.DEFAULT_IMAGE=null,as.DEFAULT_MAPPING=rg,as.DEFAULT_ANISOTROPY=1;class al{get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*n+a[12]*i,this.y=a[1]*t+a[5]*r+a[9]*n+a[13]*i,this.z=a[2]*t+a[6]*r+a[10]*n+a[14]*i,this.w=a[3]*t+a[7]*r+a[11]*n+a[15]*i,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,i;let a=.01,o=.1,s=e.elements,l=s[0],c=s[4],u=s[8],d=s[1],h=s[5],p=s[9],f=s[2],m=s[6],g=s[10];if(Math.abs(c-d)<a&&Math.abs(u-f)<a&&Math.abs(p-m)<a){if(Math.abs(c+d)<o&&Math.abs(u+f)<o&&Math.abs(p+m)<o&&Math.abs(l+h+g-3)<o)return this.set(1,0,0,0),this;t=Math.PI;let e=(l+1)/2,s=(h+1)/2,y=(g+1)/2,v=(c+d)/4,b=(u+f)/4,_=(p+m)/4;return e>s&&e>y?e<a?(r=0,n=.707106781,i=.707106781):(n=v/(r=Math.sqrt(e)),i=b/r):s>y?s<a?(r=.707106781,n=0,i=.707106781):(r=v/(n=Math.sqrt(s)),i=_/n):y<a?(r=.707106781,n=.707106781,i=0):(r=b/(i=Math.sqrt(y)),n=_/i),this.set(r,n,i,t),this}let y=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(d-c)*(d-c));return .001>Math.abs(y)&&(y=1),this.x=(m-p)/y,this.y=(u-f)/y,this.z=(d-c)/y,this.w=Math.acos((l+h+g-1)/2),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}constructor(e=0,t=0,r=0,n=1){al.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=n}}class ac extends iP{get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let n=0,i=this.textures.length;n<i;n++)this.textures[n].image.width=e,this.textures[n].image.height=t,this.textures[n].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,r=e.textures.length;t<r;t++)this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new ai(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new al(0,0,e,t),this.scissorTest=!1,this.viewport=new al(0,0,e,t);let n=new as({width:e,height:t,depth:1},(r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:rR,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},r)).mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);n.flipY=!1,n.generateMipmaps=r.generateMipmaps,n.internalFormat=r.internalFormat,this.textures=[];let i=r.count;for(let e=0;e<i;e++)this.textures[e]=n.clone(),this.textures[e].isRenderTargetTexture=!0;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}}class au extends ac{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class ad extends as{addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}constructor(e=null,t=1,r=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=rE,this.minFilter=rE,this.wrapR=rT,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}}class ah extends au{constructor(e=1,t=1,r=1,n={}){super(e,t,n),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new ad(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class ap extends as{constructor(e=null,t=1,r=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=rE,this.minFilter=rE,this.wrapR=rT,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class af extends au{constructor(e=1,t=1,r=1,n={}){super(e,t,n),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new ap(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class am{static slerpFlat(e,t,r,n,i,a,o){let s=r[n+0],l=r[n+1],c=r[n+2],u=r[n+3],d=i[a+0],h=i[a+1],p=i[a+2],f=i[a+3];if(0===o){e[t+0]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u;return}if(1===o){e[t+0]=d,e[t+1]=h,e[t+2]=p,e[t+3]=f;return}if(u!==f||s!==d||l!==h||c!==p){let e=1-o,t=s*d+l*h+c*p+u*f,r=t>=0?1:-1,n=1-t*t;if(n>Number.EPSILON){let i=Math.sqrt(n),a=Math.atan2(i,t*r);e=Math.sin(e*a)/i,o=Math.sin(o*a)/i}let i=o*r;if(s=s*e+d*i,l=l*e+h*i,c=c*e+p*i,u=u*e+f*i,e===1-o){let e=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=e,l*=e,c*=e,u*=e}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,n,i,a){let o=r[n],s=r[n+1],l=r[n+2],c=r[n+3],u=i[a],d=i[a+1],h=i[a+2],p=i[a+3];return e[t]=o*p+c*u+s*h-l*d,e[t+1]=s*p+c*d+l*u-o*h,e[t+2]=l*p+c*h+o*d-s*u,e[t+3]=c*p-o*u-s*d-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=e._x,n=e._y,i=e._z,a=e._order,o=Math.cos,s=Math.sin,l=o(r/2),c=o(n/2),u=o(i/2),d=s(r/2),h=s(n/2),p=s(i/2);switch(a){case"XYZ":this._x=d*c*u+l*h*p,this._y=l*h*u-d*c*p,this._z=l*c*p+d*h*u,this._w=l*c*u-d*h*p;break;case"YXZ":this._x=d*c*u+l*h*p,this._y=l*h*u-d*c*p,this._z=l*c*p-d*h*u,this._w=l*c*u+d*h*p;break;case"ZXY":this._x=d*c*u-l*h*p,this._y=l*h*u+d*c*p,this._z=l*c*p+d*h*u,this._w=l*c*u-d*h*p;break;case"ZYX":this._x=d*c*u-l*h*p,this._y=l*h*u+d*c*p,this._z=l*c*p-d*h*u,this._w=l*c*u+d*h*p;break;case"YZX":this._x=d*c*u+l*h*p,this._y=l*h*u+d*c*p,this._z=l*c*p-d*h*u,this._w=l*c*u-d*h*p;break;case"XZY":this._x=d*c*u-l*h*p,this._y=l*h*u-d*c*p,this._z=l*c*p+d*h*u,this._w=l*c*u+d*h*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],n=t[4],i=t[8],a=t[1],o=t[5],s=t[9],l=t[2],c=t[6],u=t[10],d=r+o+u;if(d>0){let e=.5/Math.sqrt(d+1);this._w=.25/e,this._x=(c-s)*e,this._y=(i-l)*e,this._z=(a-n)*e}else if(r>o&&r>u){let e=2*Math.sqrt(1+r-o-u);this._w=(c-s)/e,this._x=.25*e,this._y=(n+a)/e,this._z=(i+l)/e}else if(o>u){let e=2*Math.sqrt(1+o-r-u);this._w=(i-l)/e,this._x=(n+a)/e,this._y=.25*e,this._z=(s+c)/e}else{let e=2*Math.sqrt(1+u-r-o);this._w=(a-n)/e,this._x=(i+l)/e,this._y=(s+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x),this._w=r,this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(iF(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(0===r)return this;let n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,n=e._y,i=e._z,a=e._w,o=t._x,s=t._y,l=t._z,c=t._w;return this._x=r*c+a*o+n*l-i*s,this._y=n*c+a*s+i*o-r*l,this._z=i*c+a*l+r*s-n*o,this._w=a*c-r*o-n*s-i*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);let r=this._x,n=this._y,i=this._z,a=this._w,o=a*e._w+r*e._x+n*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=r,this._y=n,this._z=i,this;let s=1-o*o;if(s<=Number.EPSILON){let e=1-t;return this._w=e*a+t*this._w,this._x=e*r+t*this._x,this._y=e*n+t*this._y,this._z=e*i+t*this._z,this.normalize(),this}let l=Math.sqrt(s),c=Math.atan2(l,o),u=Math.sin((1-t)*c)/l,d=Math.sin(t*c)/l;return this._w=a*u+this._w*d,this._x=r*u+this._x*d,this._y=n*u+this._y*d,this._z=i*u+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),n=Math.sqrt(1-r),i=Math.sqrt(r);return this.set(n*Math.sin(e),n*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}constructor(e=0,t=0,r=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=n}}class ag{set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(av.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(av.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,i=e.elements,a=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*a,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*a,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*a,this}applyQuaternion(e){let t=this.x,r=this.y,n=this.z,i=e.x,a=e.y,o=e.z,s=e.w,l=2*(a*n-o*r),c=2*(o*t-i*n),u=2*(i*r-a*t);return this.x=t+s*l+a*u-o*c,this.y=r+s*c+o*l-i*u,this.z=n+s*u+i*c-a*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,n=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=n*s-i*o,this.y=i*a-r*s,this.z=r*o-n*a,this}projectOnVector(e){let t=e.lengthSq();if(0===t)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return ay.copy(this).projectOnVector(e),this.sub(ay)}reflect(e){return this.sub(ay.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());return 0===t?Math.PI/2:Math.acos(iF(this.dot(e)/t,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=2*Math.random()-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}constructor(e=0,t=0,r=0){ag.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}}let ay=new ag,av=new am;class ab{set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(aw.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(aw.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=aw.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);let r=e.geometry;if(void 0!==r){let n=r.getAttribute("position");if(!0===t&&void 0!==n&&!0!==e.isInstancedMesh)for(let t=0,r=n.count;t<r;t++)!0===e.isMesh?e.getVertexPosition(t,aw):aw.fromBufferAttribute(n,t),aw.applyMatrix4(e.matrixWorld),this.expandByPoint(aw);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),aS.copy(e.boundingBox)):(null===r.boundingBox&&r.computeBoundingBox(),aS.copy(r.boundingBox)),aS.applyMatrix4(e.matrixWorld),this.union(aS)}let n=e.children;for(let e=0,r=n.length;e<r;e++)this.expandByObject(n[e],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,aw),aw.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(aI),aR.subVectors(this.max,aI),aT.subVectors(e.a,aI),ax.subVectors(e.b,aI),aE.subVectors(e.c,aI),aC.subVectors(ax,aT),aA.subVectors(aE,ax),aM.subVectors(aT,aE);let t=[0,-aC.z,aC.y,0,-aA.z,aA.y,0,-aM.z,aM.y,aC.z,0,-aC.x,aA.z,0,-aA.x,aM.z,0,-aM.x,-aC.y,aC.x,0,-aA.y,aA.x,0,-aM.y,aM.x,0];return!!(aO(t,aT,ax,aE,aR)&&aO(t=[1,0,0,0,1,0,0,0,1],aT,ax,aE,aR))&&(ak.crossVectors(aC,aA),aO(t=[ak.x,ak.y,ak.z],aT,ax,aE,aR))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,aw).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(aw).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(a_[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),a_[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),a_[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),a_[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),a_[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),a_[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),a_[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),a_[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(a_)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}constructor(e=new ag(Infinity,Infinity,Infinity),t=new ag(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}}let a_=[new ag,new ag,new ag,new ag,new ag,new ag,new ag,new ag],aw=new ag,aS=new ab,aT=new ag,ax=new ag,aE=new ag,aC=new ag,aA=new ag,aM=new ag,aI=new ag,aR=new ag,ak=new ag,aP=new ag;function aO(e,t,r,n,i){for(let a=0,o=e.length-3;a<=o;a+=3){aP.fromArray(e,a);let o=i.x*Math.abs(aP.x)+i.y*Math.abs(aP.y)+i.z*Math.abs(aP.z),s=t.dot(aP),l=r.dot(aP),c=n.dot(aP);if(Math.max(-Math.max(s,l,c),Math.min(s,l,c))>o)return!1}return!0}let aN=new ab,aL=new ag,aD=new ag;class aU{set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;void 0!==t?r.copy(t):aN.setFromPoints(e).getCenter(r);let n=0;for(let t=0,i=e.length;t<i;t++)n=Math.max(n,r.distanceToSquared(e[t]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?e.makeEmpty():(e.set(this.center,this.center),e.expandByScalar(this.radius)),e}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;aL.subVectors(e,this.center);let t=aL.lengthSq();if(t>this.radius*this.radius){let e=Math.sqrt(t),r=(e-this.radius)*.5;this.center.addScaledVector(aL,r/e),this.radius+=r}return this}union(e){return e.isEmpty()||(this.isEmpty()?this.copy(e):!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(aD.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(aL.copy(e.center).add(aD)),this.expandByPoint(aL.copy(e.center).sub(aD)))),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}constructor(e=new ag,t=-1){this.isSphere=!0,this.center=e,this.radius=t}}let aF=new ag,aB=new ag,az=new ag,aH=new ag,aj=new ag,aG=new ag,aV=new ag;class aq{set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,aF)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=aF.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(aF.copy(this.origin).addScaledVector(this.direction,t),aF.distanceToSquared(e))}distanceSqToSegment(e,t,r,n){let i,a,o,s;aB.copy(e).add(t).multiplyScalar(.5),az.copy(t).sub(e).normalize(),aH.copy(this.origin).sub(aB);let l=.5*e.distanceTo(t),c=-this.direction.dot(az),u=aH.dot(this.direction),d=-aH.dot(az),h=aH.lengthSq(),p=Math.abs(1-c*c);if(p>0){if(i=c*d-u,a=c*u-d,s=l*p,i>=0){if(a>=-s){if(a<=s){let e=1/p;i*=e,a*=e,o=i*(i+c*a+2*u)+a*(c*i+a+2*d)+h}else o=-(i=Math.max(0,-(c*(a=l)+u)))*i+a*(a+2*d)+h}else o=-(i=Math.max(0,-(c*(a=-l)+u)))*i+a*(a+2*d)+h}else a<=-s?(a=(i=Math.max(0,-(-c*l+u)))>0?-l:Math.min(Math.max(-l,-d),l),o=-i*i+a*(a+2*d)+h):a<=s?(i=0,o=(a=Math.min(Math.max(-l,-d),l))*(a+2*d)+h):(a=(i=Math.max(0,-(c*l+u)))>0?l:Math.min(Math.max(-l,-d),l),o=-i*i+a*(a+2*d)+h)}else a=c>0?-l:l,o=-(i=Math.max(0,-(c*a+u)))*i+a*(a+2*d)+h;return r&&r.copy(this.origin).addScaledVector(this.direction,i),n&&n.copy(aB).addScaledVector(az,a),o}intersectSphere(e,t){aF.subVectors(e.center,this.origin);let r=aF.dot(this.direction),n=aF.dot(aF)-r*r,i=e.radius*e.radius;if(n>i)return null;let a=Math.sqrt(i-n),o=r-a,s=r+a;return s<0?null:o<0?this.at(s,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return null===r?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return!!(0===t||e.normal.dot(this.direction)*t<0)}intersectBox(e,t){let r,n,i,a,o,s;let l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,d=this.origin;return(l>=0?(r=(e.min.x-d.x)*l,n=(e.max.x-d.x)*l):(r=(e.max.x-d.x)*l,n=(e.min.x-d.x)*l),c>=0?(i=(e.min.y-d.y)*c,a=(e.max.y-d.y)*c):(i=(e.max.y-d.y)*c,a=(e.min.y-d.y)*c),r>a||i>n)?null:((i>r||isNaN(r))&&(r=i),(a<n||isNaN(n))&&(n=a),u>=0?(o=(e.min.z-d.z)*u,s=(e.max.z-d.z)*u):(o=(e.max.z-d.z)*u,s=(e.min.z-d.z)*u),r>s||o>n)?null:((o>r||r!=r)&&(r=o),(s<n||n!=n)&&(n=s),n<0)?null:this.at(r>=0?r:n,t)}intersectsBox(e){return null!==this.intersectBox(e,aF)}intersectTriangle(e,t,r,n,i){let a;aj.subVectors(t,e),aG.subVectors(r,e),aV.crossVectors(aj,aG);let o=this.direction.dot(aV);if(o>0){if(n)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}aH.subVectors(this.origin,e);let s=a*this.direction.dot(aG.crossVectors(aH,aG));if(s<0)return null;let l=a*this.direction.dot(aj.cross(aH));if(l<0||s+l>o)return null;let c=-a*aH.dot(aV);return c<0?null:this.at(c/o,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}constructor(e=new ag,t=new ag(0,0,-1)){this.origin=e,this.direction=t}}class aW{set(e,t,r,n,i,a,o,s,l,c,u,d,h,p,f,m){let g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=n,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=d,g[3]=h,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new aW().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,n=1/aZ.setFromMatrixColumn(e,0).length(),i=1/aZ.setFromMatrixColumn(e,1).length(),a=1/aZ.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*i,t[5]=r[5]*i,t[6]=r[6]*i,t[7]=0,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,r=e.x,n=e.y,i=e.z,a=Math.cos(r),o=Math.sin(r),s=Math.cos(n),l=Math.sin(n),c=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){let e=a*c,r=a*u,n=o*c,i=o*u;t[0]=s*c,t[4]=-s*u,t[8]=l,t[1]=r+n*l,t[5]=e-i*l,t[9]=-o*s,t[2]=i-e*l,t[6]=n+r*l,t[10]=a*s}else if("YXZ"===e.order){let e=s*c,r=s*u,n=l*c,i=l*u;t[0]=e+i*o,t[4]=n*o-r,t[8]=a*l,t[1]=a*u,t[5]=a*c,t[9]=-o,t[2]=r*o-n,t[6]=i+e*o,t[10]=a*s}else if("ZXY"===e.order){let e=s*c,r=s*u,n=l*c,i=l*u;t[0]=e-i*o,t[4]=-a*u,t[8]=n+r*o,t[1]=r+n*o,t[5]=a*c,t[9]=i-e*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){let e=a*c,r=a*u,n=o*c,i=o*u;t[0]=s*c,t[4]=n*l-r,t[8]=e*l+i,t[1]=s*u,t[5]=i*l+e,t[9]=r*l-n,t[2]=-l,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){let e=a*s,r=a*l,n=o*s,i=o*l;t[0]=s*c,t[4]=i-e*u,t[8]=n*u+r,t[1]=u,t[5]=a*c,t[9]=-o*c,t[2]=-l*c,t[6]=r*u+n,t[10]=e-i*u}else if("XZY"===e.order){let e=a*s,r=a*l,n=o*s,i=o*l;t[0]=s*c,t[4]=-u,t[8]=l*c,t[1]=e*u+i,t[5]=a*c,t[9]=r*u-n,t[2]=n*u-r,t[6]=o*c,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(a$,e,aK)}lookAt(e,t,r){let n=this.elements;return aJ.subVectors(e,t),0===aJ.lengthSq()&&(aJ.z=1),aJ.normalize(),aY.crossVectors(r,aJ),0===aY.lengthSq()&&(1===Math.abs(r.z)?aJ.x+=1e-4:aJ.z+=1e-4,aJ.normalize(),aY.crossVectors(r,aJ)),aY.normalize(),aQ.crossVectors(aJ,aY),n[0]=aY.x,n[4]=aQ.x,n[8]=aJ.x,n[1]=aY.y,n[5]=aQ.y,n[9]=aJ.y,n[2]=aY.z,n[6]=aQ.z,n[10]=aJ.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,i=this.elements,a=r[0],o=r[4],s=r[8],l=r[12],c=r[1],u=r[5],d=r[9],h=r[13],p=r[2],f=r[6],m=r[10],g=r[14],y=r[3],v=r[7],b=r[11],_=r[15],w=n[0],S=n[4],T=n[8],x=n[12],E=n[1],C=n[5],A=n[9],M=n[13],I=n[2],R=n[6],k=n[10],P=n[14],O=n[3],N=n[7],L=n[11],D=n[15];return i[0]=a*w+o*E+s*I+l*O,i[4]=a*S+o*C+s*R+l*N,i[8]=a*T+o*A+s*k+l*L,i[12]=a*x+o*M+s*P+l*D,i[1]=c*w+u*E+d*I+h*O,i[5]=c*S+u*C+d*R+h*N,i[9]=c*T+u*A+d*k+h*L,i[13]=c*x+u*M+d*P+h*D,i[2]=p*w+f*E+m*I+g*O,i[6]=p*S+f*C+m*R+g*N,i[10]=p*T+f*A+m*k+g*L,i[14]=p*x+f*M+m*P+g*D,i[3]=y*w+v*E+b*I+_*O,i[7]=y*S+v*C+b*R+_*N,i[11]=y*T+v*A+b*k+_*L,i[15]=y*x+v*M+b*P+_*D,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],a=e[1],o=e[5],s=e[9],l=e[13],c=e[2],u=e[6],d=e[10],h=e[14],p=e[3];return p*(+i*s*u-n*l*u-i*o*d+r*l*d+n*o*h-r*s*h)+e[7]*(+t*s*h-t*l*d+i*a*d-n*a*h+n*l*c-i*s*c)+e[11]*(+t*l*u-t*o*h-i*a*u+r*a*h+i*o*c-r*l*c)+e[15]*(-n*o*c-t*s*u+t*o*d+n*a*u-r*a*d+r*s*c)}transpose(){let e;let t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(e,t,r){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=e[9],d=e[10],h=e[11],p=e[12],f=e[13],m=e[14],g=e[15],y=u*m*l-f*d*l+f*s*h-o*m*h-u*s*g+o*d*g,v=p*d*l-c*m*l-p*s*h+a*m*h+c*s*g-a*d*g,b=c*f*l-p*u*l+p*o*h-a*f*h-c*o*g+a*u*g,_=p*u*s-c*f*s-p*o*d+a*f*d+c*o*m-a*u*m,w=t*y+r*v+n*b+i*_;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let S=1/w;return e[0]=y*S,e[1]=(f*d*i-u*m*i-f*n*h+r*m*h+u*n*g-r*d*g)*S,e[2]=(o*m*i-f*s*i+f*n*l-r*m*l-o*n*g+r*s*g)*S,e[3]=(u*s*i-o*d*i-u*n*l+r*d*l+o*n*h-r*s*h)*S,e[4]=v*S,e[5]=(c*m*i-p*d*i+p*n*h-t*m*h-c*n*g+t*d*g)*S,e[6]=(p*s*i-a*m*i-p*n*l+t*m*l+a*n*g-t*s*g)*S,e[7]=(a*d*i-c*s*i+c*n*l-t*d*l-a*n*h+t*s*h)*S,e[8]=b*S,e[9]=(p*u*i-c*f*i-p*r*h+t*f*h+c*r*g-t*u*g)*S,e[10]=(a*f*i-p*o*i+p*r*l-t*f*l-a*r*g+t*o*g)*S,e[11]=(c*o*i-a*u*i-c*r*l+t*u*l+a*r*h-t*o*h)*S,e[12]=_*S,e[13]=(c*f*n-p*u*n+p*r*d-t*f*d-c*r*m+t*u*m)*S,e[14]=(p*o*n-a*f*n-p*r*s+t*f*s+a*r*m-t*o*m)*S,e[15]=(a*u*n-c*o*n+c*r*s-t*u*s-a*r*d+t*o*d)*S,this}scale(e){let t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this}getMaxScaleOnAxis(){let e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),n=Math.sin(t),i=1-r,a=e.x,o=e.y,s=e.z,l=i*a,c=i*o;return this.set(l*a+r,l*o-n*s,l*s+n*o,0,l*o+n*s,c*o+r,c*s-n*a,0,l*s-n*o,c*s+n*a,i*s*s+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,i,a){return this.set(1,r,i,0,e,1,a,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){let n=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,l=i+i,c=a+a,u=o+o,d=i*l,h=i*c,p=i*u,f=a*c,m=a*u,g=o*u,y=s*l,v=s*c,b=s*u,_=r.x,w=r.y,S=r.z;return n[0]=(1-(f+g))*_,n[1]=(h+b)*_,n[2]=(p-v)*_,n[3]=0,n[4]=(h-b)*w,n[5]=(1-(d+g))*w,n[6]=(m+y)*w,n[7]=0,n[8]=(p+v)*S,n[9]=(m-y)*S,n[10]=(1-(d+f))*S,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){let n=this.elements,i=aZ.set(n[0],n[1],n[2]).length(),a=aZ.set(n[4],n[5],n[6]).length(),o=aZ.set(n[8],n[9],n[10]).length();0>this.determinant()&&(i=-i),e.x=n[12],e.y=n[13],e.z=n[14],aX.copy(this);let s=1/i,l=1/a,c=1/o;return aX.elements[0]*=s,aX.elements[1]*=s,aX.elements[2]*=s,aX.elements[4]*=l,aX.elements[5]*=l,aX.elements[6]*=l,aX.elements[8]*=c,aX.elements[9]*=c,aX.elements[10]*=c,t.setFromRotationMatrix(aX),r.x=i,r.y=a,r.z=o,this}makePerspective(e,t,r,n,i,a){let o,s,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:iR,c=this.elements,u=2*i/(t-e),d=2*i/(r-n),h=(t+e)/(t-e),p=(r+n)/(r-n);if(l===iR)o=-(a+i)/(a-i),s=-2*a*i/(a-i);else if(l===ik)o=-a/(a-i),s=-a*i/(a-i);else throw Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return c[0]=u,c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=d,c[9]=p,c[13]=0,c[2]=0,c[6]=0,c[10]=o,c[14]=s,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,r,n,i,a){let o,s,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:iR,c=this.elements,u=1/(t-e),d=1/(r-n),h=1/(a-i),p=(t+e)*u,f=(r+n)*d;if(l===iR)o=(a+i)*h,s=-2*h;else if(l===ik)o=i*h,s=-1*h;else throw Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return c[0]=2*u,c[4]=0,c[8]=0,c[12]=-p,c[1]=0,c[5]=2*d,c[9]=0,c[13]=-f,c[2]=0,c[6]=0,c[10]=s,c[14]=-o,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let e=0;e<16;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}constructor(e,t,r,n,i,a,o,s,l,c,u,d,h,p,f,m){aW.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,r,n,i,a,o,s,l,c,u,d,h,p,f,m)}}let aZ=new ag,aX=new aW,a$=new ag(0,0,0),aK=new ag(1,1,1),aY=new ag,aQ=new ag,aJ=new ag,a0=new aW,a1=new am;class a2{get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=e.elements,i=n[0],a=n[4],o=n[8],s=n[1],l=n[5],c=n[9],u=n[2],d=n[6],h=n[10];switch(t){case"XYZ":this._y=Math.asin(iF(o,-1,1)),.9999999>Math.abs(o)?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-iF(c,-1,1)),.9999999>Math.abs(c)?(this._y=Math.atan2(o,h),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(iF(d,-1,1)),.9999999>Math.abs(d)?(this._y=Math.atan2(-u,h),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,i));break;case"ZYX":this._y=Math.asin(-iF(u,-1,1)),.9999999>Math.abs(u)?(this._x=Math.atan2(d,h),this._z=Math.atan2(s,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(iF(s,-1,1)),.9999999>Math.abs(s)?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(o,h));break;case"XZY":this._z=Math.asin(-iF(a,-1,1)),.9999999>Math.abs(a)?(this._x=Math.atan2(d,l),this._y=Math.atan2(o,i)):(this._x=Math.atan2(-c,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===r&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return a0.makeRotationFromQuaternion(e),this.setFromRotationMatrix(a0,t,r)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return a1.setFromEuler(this),this.setFromQuaternion(a1,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}constructor(e=0,t=0,r=0,n=a2.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=n}}a2.DEFAULT_ORDER="XYZ";class a3{set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}isEnabled(e){return(this.mask&(1<<e|0))!=0}constructor(){this.mask=1}}let a4=0,a5=new ag,a6=new am,a8=new aW,a7=new ag,a9=new ag,oe=new ag,ot=new am,or=new ag(1,0,0),on=new ag(0,1,0),oi=new ag(0,0,1),oa={type:"added"},oo={type:"removed"},os={type:"childadded",child:null},ol={type:"childremoved",child:null};class oc extends iP{onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return a6.setFromAxisAngle(e,t),this.quaternion.multiply(a6),this}rotateOnWorldAxis(e,t){return a6.setFromAxisAngle(e,t),this.quaternion.premultiply(a6),this}rotateX(e){return this.rotateOnAxis(or,e)}rotateY(e){return this.rotateOnAxis(on,e)}rotateZ(e){return this.rotateOnAxis(oi,e)}translateOnAxis(e,t){return a5.copy(e).applyQuaternion(this.quaternion),this.position.add(a5.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(or,e)}translateY(e){return this.translateOnAxis(on,e)}translateZ(e){return this.translateOnAxis(oi,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(a8.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?a7.copy(e):a7.set(e,t,r);let n=this.parent;this.updateWorldMatrix(!0,!1),a9.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?a8.lookAt(a9,a7,this.up):a8.lookAt(a7,a9,this.up),this.quaternion.setFromRotationMatrix(a8),n&&(a8.extractRotation(n.matrixWorld),a6.setFromRotationMatrix(a8),this.quaternion.premultiply(a6.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(oa),os.child=e,this.dispatchEvent(os),os.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}let t=this.children.indexOf(e);return -1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(oo),ol.child=e,this.dispatchEvent(ol),ol.child=null),this}removeFromParent(){let e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),a8.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),a8.multiply(e.parent.matrixWorld)),e.applyMatrix4(a8),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(oa),os.child=e,this.dispatchEvent(os),os.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){let n=this.children[r].getObjectByProperty(e,t);if(void 0!==n)return n}}getObjectsByProperty(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&r.push(this);let n=this.children;for(let i=0,a=n.length;i<a;i++)n[i].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(a9,e,oe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(a9,ot,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){let r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){let e=this.children;for(let t=0,r=e.length;t<r;t++)e[t].updateWorldMatrix(!1,!0)}}toJSON(e){let t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let n={};function i(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map(e=>({boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()})),n.maxInstanceCount=this._maxInstanceCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(e),null!==this._colorsTexture&&(n.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),null!==this.boundingBox&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=i(e.geometries,this.geometry);let t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){let r=t.shapes;if(Array.isArray(r))for(let t=0,n=r.length;t<n;t++){let n=r[t];i(e.shapes,n)}else i(e.shapes,r)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material){if(Array.isArray(this.material)){let t=[];for(let r=0,n=this.material.length;r<n;r++)t.push(i(e.materials,this.material[r]));n.material=t}else n.material=i(e.materials,this.material)}if(this.children.length>0){n.children=[];for(let t=0;t<this.children.length;t++)n.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let t=0;t<this.animations.length;t++){let r=this.animations[t];n.animations.push(i(e.animations,r))}}if(t){let t=a(e.geometries),n=a(e.materials),i=a(e.textures),o=a(e.images),s=a(e.shapes),l=a(e.skeletons),c=a(e.animations),u=a(e.nodes);t.length>0&&(r.geometries=t),n.length>0&&(r.materials=n),i.length>0&&(r.textures=i),o.length>0&&(r.images=o),s.length>0&&(r.shapes=s),l.length>0&&(r.skeletons=l),c.length>0&&(r.animations=c),u.length>0&&(r.nodes=u)}return r.object=n,r;function a(e){let t=[];for(let r in e){let n=e[r];delete n.metadata,t.push(n)}return t}}clone(e){return new this.constructor().copy(this,e)}copy(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){let r=e.children[t];this.add(r.clone())}return this}constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:a4++}),this.uuid=iU(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=oc.DEFAULT_UP.clone();let e=new ag,t=new a2,r=new am,n=new ag(1,1,1);function i(){r.setFromEuler(t,!1)}function a(){t.setFromQuaternion(r,void 0,!1)}t._onChange(i),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new aW},normalMatrix:{value:new i$}}),this.matrix=new aW,this.matrixWorld=new aW,this.matrixAutoUpdate=oc.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=oc.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new a3,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}}oc.DEFAULT_UP=new ag(0,1,0),oc.DEFAULT_MATRIX_AUTO_UPDATE=!0,oc.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;let ou=new ag,od=new ag,oh=new ag,op=new ag,of=new ag,om=new ag,og=new ag,oy=new ag,ov=new ag,ob=new ag;class o_{static getNormal(e,t,r,n){n.subVectors(r,t),ou.subVectors(e,t),n.cross(ou);let i=n.lengthSq();return i>0?n.multiplyScalar(1/Math.sqrt(i)):n.set(0,0,0)}static getBarycoord(e,t,r,n,i){ou.subVectors(n,t),od.subVectors(r,t),oh.subVectors(e,t);let a=ou.dot(ou),o=ou.dot(od),s=ou.dot(oh),l=od.dot(od),c=od.dot(oh),u=a*l-o*o;if(0===u)return i.set(0,0,0),null;let d=1/u,h=(l*s-o*c)*d,p=(a*c-o*s)*d;return i.set(1-h-p,p,h)}static containsPoint(e,t,r,n){return null!==this.getBarycoord(e,t,r,n,op)&&op.x>=0&&op.y>=0&&op.x+op.y<=1}static getInterpolation(e,t,r,n,i,a,o,s){return null===this.getBarycoord(e,t,r,n,op)?(s.x=0,s.y=0,"z"in s&&(s.z=0),"w"in s&&(s.w=0),null):(s.setScalar(0),s.addScaledVector(i,op.x),s.addScaledVector(a,op.y),s.addScaledVector(o,op.z),s)}static isFrontFacing(e,t,r,n){return ou.subVectors(r,t),od.subVectors(e,t),0>ou.cross(od).dot(n)}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,r,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ou.subVectors(this.c,this.b),od.subVectors(this.a,this.b),.5*ou.cross(od).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return o_.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return o_.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,n,i){return o_.getInterpolation(e,this.a,this.b,this.c,t,r,n,i)}containsPoint(e){return o_.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return o_.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r,n;let i=this.a,a=this.b,o=this.c;of.subVectors(a,i),om.subVectors(o,i),oy.subVectors(e,i);let s=of.dot(oy),l=om.dot(oy);if(s<=0&&l<=0)return t.copy(i);ov.subVectors(e,a);let c=of.dot(ov),u=om.dot(ov);if(c>=0&&u<=c)return t.copy(a);let d=s*u-c*l;if(d<=0&&s>=0&&c<=0)return r=s/(s-c),t.copy(i).addScaledVector(of,r);ob.subVectors(e,o);let h=of.dot(ob),p=om.dot(ob);if(p>=0&&h<=p)return t.copy(o);let f=h*l-s*p;if(f<=0&&l>=0&&p<=0)return n=l/(l-p),t.copy(i).addScaledVector(om,n);let m=c*p-h*u;if(m<=0&&u-c>=0&&h-p>=0)return og.subVectors(o,a),n=(u-c)/(u-c+(h-p)),t.copy(a).addScaledVector(og,n);let g=1/(m+f+d);return r=f*g,n=d*g,t.copy(i).addScaledVector(of,r).addScaledVector(om,n)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}constructor(e=new ag,t=new ag,r=new ag){this.a=e,this.b=t,this.c=r}}let ow={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},oS={h:0,s:0,l:0},oT={h:0,s:0,l:0};function ox(e,t,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?e+(t-e)*6*r:r<.5?t:r<2/3?e+(t-e)*6*(2/3-r):e}class oE{set(e,t,r){if(void 0===t&&void 0===r){let t=e;t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n$;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,i9.toWorkingColorSpace(this,t),this}setRGB(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i9.workingColorSpace;return this.r=e,this.g=t,this.b=r,i9.toWorkingColorSpace(this,n),this}setHSL(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i9.workingColorSpace;if(e=iB(e,1),t=iF(t,0,1),r=iF(r,0,1),0===t)this.r=this.g=this.b=r;else{let n=r<=.5?r*(1+t):r+t-r*t,i=2*r-n;this.r=ox(i,n,e+1/3),this.g=ox(i,n,e),this.b=ox(i,n,e-1/3)}return i9.toWorkingColorSpace(this,n),this}setStyle(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n$;function n(t){void 0!==t&&1>parseFloat(t)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;let a=t[1],o=t[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,r);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,r);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,r);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){let n=t[1],i=n.length;if(3===i)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,r);if(6===i)return this.setHex(parseInt(n,16),r);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,r);return this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n$,r=ow[e.toLowerCase()];return void 0!==r?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ae(e.r),this.g=ae(e.g),this.b=ae(e.b),this}copyLinearToSRGB(e){return this.r=at(e.r),this.g=at(e.g),this.b=at(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n$;return i9.fromWorkingColorSpace(oC.copy(this),e),65536*Math.round(iF(255*oC.r,0,255))+256*Math.round(iF(255*oC.g,0,255))+Math.round(iF(255*oC.b,0,255))}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n$;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i9.workingColorSpace;i9.fromWorkingColorSpace(oC.copy(this),n);let i=oC.r,a=oC.g,o=oC.b,s=Math.max(i,a,o),l=Math.min(i,a,o),c=(l+s)/2;if(l===s)t=0,r=0;else{let e=s-l;switch(r=c<=.5?e/(s+l):e/(2-s-l),s){case i:t=(a-o)/e+(a<o?6:0);break;case a:t=(o-i)/e+2;break;case o:t=(i-a)/e+4}t/=6}return e.h=t,e.s=r,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i9.workingColorSpace;return i9.fromWorkingColorSpace(oC.copy(this),t),e.r=oC.r,e.g=oC.g,e.b=oC.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n$;i9.fromWorkingColorSpace(oC.copy(this),e);let t=oC.r,r=oC.g,n=oC.b;return e!==n$?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(r.toFixed(3)," ").concat(n.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*r),",").concat(Math.round(255*n),")")}offsetHSL(e,t,r){return this.getHSL(oS),this.setHSL(oS.h+e,oS.s+t,oS.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(oS),e.getHSL(oT);let r=iz(oS.h,oT.h,t),n=iz(oS.s,oT.s,t),i=iz(oS.l,oT.l,t);return this.setHSL(r,n,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,r=this.g,n=this.b,i=e.elements;return this.r=i[0]*t+i[3]*r+i[6]*n,this.g=i[1]*t+i[4]*r+i[7]*n,this.b=i[2]*t+i[5]*r+i[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}}let oC=new oE;oE.NAMES=ow;let oA=0;class oM extends iP{get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(let t in e){let r=e[t];if(void 0===r){console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."));continue}let n=this[t];if(void 0===n){console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."));continue}n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r}}toJSON(e){let t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});let r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function n(e){let t=[];for(let r in e){let n=e[r];delete n.metadata,t.push(n)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(r.dispersion=this.dispersion),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(r.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapRotation&&(r.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==tN&&(r.blending=this.blending),this.side!==tR&&(r.side=this.side),!0===this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=!0),this.blendSrc!==tX&&(r.blendSrc=this.blendSrc),this.blendDst!==t$&&(r.blendDst=this.blendDst),this.blendEquation!==tB&&(r.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(r.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(r.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==t7&&(r.depthFunc=this.depthFunc),!1===this.depthTest&&(r.depthTest=this.depthTest),!1===this.depthWrite&&(r.depthWrite=this.depthWrite),!1===this.colorWrite&&(r.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==ic&&(r.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(r.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==n4&&(r.stencilFail=this.stencilFail),this.stencilZFail!==n4&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==n4&&(r.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(r.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaHash&&(r.alphaHash=!0),!0===this.alphaToCoverage&&(r.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=!0),!0===this.forceSinglePass&&(r.forceSinglePass=!0),!0===this.wireframe&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=!0),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData),t){let t=n(e.textures),i=n(e.images);t.length>0&&(r.textures=t),i.length>0&&(r.images=i)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(null!==t){let e=t.length;r=Array(e);for(let n=0;n!==e;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}onBeforeRender(){console.warn("Material: onBeforeRender() has been removed.")}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:oA++}),this.uuid=iU(),this.name="",this.type="Material",this.blending=tN,this.side=tR,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=tX,this.blendDst=t$,this.blendEquation=tB,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new oE(0,0,0),this.blendAlpha=0,this.depthFunc=t7,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ic,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=n4,this.stencilZFail=n4,this.stencilZPass=n4,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}}class oI extends oM{copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new oE(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new a2,this.combine=rn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}}let oR=ok();function ok(){let e=new ArrayBuffer(4),t=new Float32Array(e),r=new Uint32Array(e),n=new Uint32Array(512),i=new Uint32Array(512);for(let e=0;e<256;++e){let t=e-127;t<-27?(n[e]=0,n[256|e]=32768,i[e]=24,i[256|e]=24):t<-14?(n[e]=1024>>-t-14,n[256|e]=1024>>-t-14|32768,i[e]=-t-1,i[256|e]=-t-1):t<=15?(n[e]=t+15<<10,n[256|e]=t+15<<10|32768,i[e]=13,i[256|e]=13):t<128?(n[e]=31744,n[256|e]=64512,i[e]=24,i[256|e]=24):(n[e]=31744,n[256|e]=64512,i[e]=13,i[256|e]=13)}let a=new Uint32Array(2048),o=new Uint32Array(64),s=new Uint32Array(64);for(let e=1;e<1024;++e){let t=e<<13,r=0;for(;(8388608&t)==0;)t<<=1,r-=8388608;t&=-8388609,r+=947912704,a[e]=t|r}for(let e=1024;e<2048;++e)a[e]=939524096+(e-1024<<13);for(let e=1;e<31;++e)o[e]=e<<23;o[31]=1199570944,o[32]=2147483648;for(let e=33;e<63;++e)o[e]=2147483648+(e-32<<23);o[63]=3347054592;for(let e=1;e<64;++e)32!==e&&(s[e]=1024);return{floatView:t,uint32View:r,baseTable:n,shiftTable:i,mantissaTable:a,exponentTable:o,offsetTable:s}}function oP(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=iF(e,-65504,65504),oR.floatView[0]=e;let t=oR.uint32View[0],r=t>>23&511;return oR.baseTable[r]+((8388607&t)>>oR.shiftTable[r])}function oO(e){let t=e>>10;return oR.uint32View[0]=oR.mantissaTable[oR.offsetTable[t]+(1023&e)]+oR.exponentTable[t],oR.floatView[0]}let oN={toHalfFloat:oP,fromHalfFloat:oO},oL=new ag,oD=new iX;class oU{onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return i3("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)oD.fromBufferAttribute(this,t),oD.applyMatrix3(e),this.setXY(t,oD.x,oD.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)oL.fromBufferAttribute(this,t),oL.applyMatrix3(e),this.setXYZ(t,oL.x,oL.y,oL.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)oL.fromBufferAttribute(this,t),oL.applyMatrix4(e),this.setXYZ(t,oL.x,oL.y,oL.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)oL.fromBufferAttribute(this,t),oL.applyNormalMatrix(e),this.setXYZ(t,oL.x,oL.y,oL.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)oL.fromBufferAttribute(this,t),oL.transformDirection(e),this.setXYZ(t,oL.x,oL.y,oL.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=iq(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=iW(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=iq(t,this.array)),t}setX(e,t){return this.normalized&&(t=iW(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=iq(t,this.array)),t}setY(e,t){return this.normalized&&(t=iW(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=iq(t,this.array)),t}setZ(e,t){return this.normalized&&(t=iW(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=iq(t,this.array)),t}setW(e,t){return this.normalized&&(t=iW(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=iW(t,this.array),r=iW(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,n){return e*=this.itemSize,this.normalized&&(t=iW(t,this.array),r=iW(r,this.array),n=iW(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this}setXYZW(e,t,r,n,i){return e*=this.itemSize,this.normalized&&(t=iW(t,this.array),r=iW(r,this.array),n=iW(n,this.array),i=iW(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==ib&&(e.usage=this.usage),e}constructor(e,t,r=!1){if(Array.isArray(e))throw TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=r,this.usage=ib,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=rH,this.version=0}}class oF extends oU{constructor(e,t,r){super(new Int8Array(e),t,r)}}class oB extends oU{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class oz extends oU{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class oH extends oU{constructor(e,t,r){super(new Int16Array(e),t,r)}}class oj extends oU{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class oG extends oU{constructor(e,t,r){super(new Int32Array(e),t,r)}}class oV extends oU{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class oq extends oU{getX(e){let t=oO(this.array[e*this.itemSize]);return this.normalized&&(t=iq(t,this.array)),t}setX(e,t){return this.normalized&&(t=iW(t,this.array)),this.array[e*this.itemSize]=oP(t),this}getY(e){let t=oO(this.array[e*this.itemSize+1]);return this.normalized&&(t=iq(t,this.array)),t}setY(e,t){return this.normalized&&(t=iW(t,this.array)),this.array[e*this.itemSize+1]=oP(t),this}getZ(e){let t=oO(this.array[e*this.itemSize+2]);return this.normalized&&(t=iq(t,this.array)),t}setZ(e,t){return this.normalized&&(t=iW(t,this.array)),this.array[e*this.itemSize+2]=oP(t),this}getW(e){let t=oO(this.array[e*this.itemSize+3]);return this.normalized&&(t=iq(t,this.array)),t}setW(e,t){return this.normalized&&(t=iW(t,this.array)),this.array[e*this.itemSize+3]=oP(t),this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=iW(t,this.array),r=iW(r,this.array)),this.array[e+0]=oP(t),this.array[e+1]=oP(r),this}setXYZ(e,t,r,n){return e*=this.itemSize,this.normalized&&(t=iW(t,this.array),r=iW(r,this.array),n=iW(n,this.array)),this.array[e+0]=oP(t),this.array[e+1]=oP(r),this.array[e+2]=oP(n),this}setXYZW(e,t,r,n,i){return e*=this.itemSize,this.normalized&&(t=iW(t,this.array),r=iW(r,this.array),n=iW(n,this.array),i=iW(i,this.array)),this.array[e+0]=oP(t),this.array[e+1]=oP(r),this.array[e+2]=oP(n),this.array[e+3]=oP(i),this}constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}}class oW extends oU{constructor(e,t,r){super(new Float32Array(e),t,r)}}let oZ=0,oX=new aW,o$=new oc,oK=new ag,oY=new ab,oQ=new ab,oJ=new ag;class o0 extends iP{getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(iY(e)?oV:oj)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(void 0!==r){let t=new i$().getNormalMatrix(e);r.applyNormalMatrix(t),r.needsUpdate=!0}let n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return oX.makeRotationFromQuaternion(e),this.applyMatrix4(oX),this}rotateX(e){return oX.makeRotationX(e),this.applyMatrix4(oX),this}rotateY(e){return oX.makeRotationY(e),this.applyMatrix4(oX),this}rotateZ(e){return oX.makeRotationZ(e),this.applyMatrix4(oX),this}translate(e,t,r){return oX.makeTranslation(e,t,r),this.applyMatrix4(oX),this}scale(e,t,r){return oX.makeScale(e,t,r),this.applyMatrix4(oX),this}lookAt(e){return o$.lookAt(e),o$.updateMatrix(),this.applyMatrix4(o$.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(oK).negate(),this.translate(oK.x,oK.y,oK.z),this}setFromPoints(e){let t=[];for(let r=0,n=e.length;r<n;r++){let n=e[r];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new oW(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new ab);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ag(-1/0,-1/0,-1/0),new ag(Infinity,Infinity,Infinity));return}if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){let r=t[e];oY.setFromBufferAttribute(r),this.morphTargetsRelative?(oJ.addVectors(this.boundingBox.min,oY.min),this.boundingBox.expandByPoint(oJ),oJ.addVectors(this.boundingBox.max,oY.max),this.boundingBox.expandByPoint(oJ)):(this.boundingBox.expandByPoint(oY.min),this.boundingBox.expandByPoint(oY.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new aU);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ag,1/0);return}if(e){let r=this.boundingSphere.center;if(oY.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){let r=t[e];oQ.setFromBufferAttribute(r),this.morphTargetsRelative?(oJ.addVectors(oY.min,oQ.min),oY.expandByPoint(oJ),oJ.addVectors(oY.max,oQ.max),oY.expandByPoint(oJ)):(oY.expandByPoint(oQ.min),oY.expandByPoint(oQ.max))}oY.getCenter(r);let n=0;for(let t=0,i=e.count;t<i;t++)oJ.fromBufferAttribute(e,t),n=Math.max(n,r.distanceToSquared(oJ));if(t)for(let i=0,a=t.length;i<a;i++){let a=t[i],o=this.morphTargetsRelative;for(let t=0,i=a.count;t<i;t++)oJ.fromBufferAttribute(a,t),o&&(oK.fromBufferAttribute(e,t),oJ.add(oK)),n=Math.max(n,r.distanceToSquared(oJ))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=t.position,n=t.normal,i=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new oU(new Float32Array(4*r.count),4));let a=this.getAttribute("tangent"),o=[],s=[];for(let e=0;e<r.count;e++)o[e]=new ag,s[e]=new ag;let l=new ag,c=new ag,u=new ag,d=new iX,h=new iX,p=new iX,f=new ag,m=new ag;function g(e,t,n){l.fromBufferAttribute(r,e),c.fromBufferAttribute(r,t),u.fromBufferAttribute(r,n),d.fromBufferAttribute(i,e),h.fromBufferAttribute(i,t),p.fromBufferAttribute(i,n),c.sub(l),u.sub(l),h.sub(d),p.sub(d);let a=1/(h.x*p.y-p.x*h.y);isFinite(a)&&(f.copy(c).multiplyScalar(p.y).addScaledVector(u,-h.y).multiplyScalar(a),m.copy(u).multiplyScalar(h.x).addScaledVector(c,-p.x).multiplyScalar(a),o[e].add(f),o[t].add(f),o[n].add(f),s[e].add(m),s[t].add(m),s[n].add(m))}let y=this.groups;0===y.length&&(y=[{start:0,count:e.count}]);for(let t=0,r=y.length;t<r;++t){let r=y[t],n=r.start,i=r.count;for(let t=n,r=n+i;t<r;t+=3)g(e.getX(t+0),e.getX(t+1),e.getX(t+2))}let v=new ag,b=new ag,_=new ag,w=new ag;function S(e){_.fromBufferAttribute(n,e),w.copy(_);let t=o[e];v.copy(t),v.sub(_.multiplyScalar(_.dot(t))).normalize(),b.crossVectors(w,t);let r=0>b.dot(s[e])?-1:1;a.setXYZW(e,v.x,v.y,v.z,r)}for(let t=0,r=y.length;t<r;++t){let r=y[t],n=r.start,i=r.count;for(let t=n,r=n+i;t<r;t+=3)S(e.getX(t+0)),S(e.getX(t+1)),S(e.getX(t+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new oU(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let e=0,t=r.count;e<t;e++)r.setXYZ(e,0,0,0);let n=new ag,i=new ag,a=new ag,o=new ag,s=new ag,l=new ag,c=new ag,u=new ag;if(e)for(let d=0,h=e.count;d<h;d+=3){let h=e.getX(d+0),p=e.getX(d+1),f=e.getX(d+2);n.fromBufferAttribute(t,h),i.fromBufferAttribute(t,p),a.fromBufferAttribute(t,f),c.subVectors(a,i),u.subVectors(n,i),c.cross(u),o.fromBufferAttribute(r,h),s.fromBufferAttribute(r,p),l.fromBufferAttribute(r,f),o.add(c),s.add(c),l.add(c),r.setXYZ(h,o.x,o.y,o.z),r.setXYZ(p,s.x,s.y,s.z),r.setXYZ(f,l.x,l.y,l.z)}else for(let e=0,o=t.count;e<o;e+=3)n.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),c.subVectors(a,i),u.subVectors(n,i),c.cross(u),r.setXYZ(e+0,c.x,c.y,c.z),r.setXYZ(e+1,c.x,c.y,c.z),r.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)oJ.fromBufferAttribute(e,t),oJ.normalize(),e.setXYZ(t,oJ.x,oJ.y,oJ.z)}toNonIndexed(){function e(e,t){let r=e.array,n=e.itemSize,i=e.normalized,a=new r.constructor(t.length*n),o=0,s=0;for(let i=0,l=t.length;i<l;i++){o=e.isInterleavedBufferAttribute?t[i]*e.data.stride+e.offset:t[i]*n;for(let e=0;e<n;e++)a[s++]=r[o++]}return new oU(a,n,i)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new o0,r=this.index.array,n=this.attributes;for(let i in n){let a=e(n[i],r);t.setAttribute(i,a)}let i=this.morphAttributes;for(let n in i){let a=[],o=i[n];for(let t=0,n=o.length;t<n;t++){let n=e(o[t],r);a.push(n)}t.morphAttributes[n]=a}t.morphTargetsRelative=this.morphTargetsRelative;let a=this.groups;for(let e=0,r=a.length;e<r;e++){let r=a[e];t.addGroup(r.start,r.count,r.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){let t=this.parameters;for(let r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};let t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let t in r){let n=r[t];e.data.attributes[t]=n.toJSON(e.data)}let n={},i=!1;for(let t in this.morphAttributes){let r=this.morphAttributes[t],a=[];for(let t=0,n=r.length;t<n;t++){let n=r[t];a.push(n.toJSON(e.data))}a.length>0&&(n[t]=a,i=!0)}i&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));let o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;null!==r&&this.setIndex(r.clone(t));let n=e.attributes;for(let e in n){let r=n[e];this.setAttribute(e,r.clone(t))}let i=e.morphAttributes;for(let e in i){let r=[],n=i[e];for(let e=0,i=n.length;e<i;e++)r.push(n[e].clone(t));this.morphAttributes[e]=r}this.morphTargetsRelative=e.morphTargetsRelative;let a=e.groups;for(let e=0,t=a.length;e<t;e++){let t=a[e];this.addGroup(t.start,t.count,t.materialIndex)}let o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());let s=e.boundingSphere;return null!==s&&(this.boundingSphere=s.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:oZ++}),this.uuid=iU(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}}let o1=new aW,o2=new aq,o3=new aU,o4=new ag,o5=new ag,o6=new ag,o8=new ag,o7=new ag,o9=new ag,se=new iX,st=new iX,sr=new iX,sn=new ag,si=new ag,sa=new ag,so=new ag,ss=new ag;class sl extends oc{copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){let t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){let r=this.geometry,n=r.attributes.position,i=r.morphAttributes.position,a=r.morphTargetsRelative;t.fromBufferAttribute(n,e);let o=this.morphTargetInfluences;if(i&&o){o9.set(0,0,0);for(let r=0,n=i.length;r<n;r++){let n=o[r],s=i[r];0!==n&&(o7.fromBufferAttribute(s,e),a?o9.addScaledVector(o7,n):o9.addScaledVector(o7.sub(t),n))}t.add(o9)}return t}raycast(e,t){let r=this.geometry,n=this.material,i=this.matrixWorld;if(void 0!==n){if(null===r.boundingSphere&&r.computeBoundingSphere(),o3.copy(r.boundingSphere),o3.applyMatrix4(i),o2.copy(e.ray).recast(e.near),!1===o3.containsPoint(o2.origin)&&(null===o2.intersectSphere(o3,o4)||o2.origin.distanceToSquared(o4)>(e.far-e.near)**2)||(o1.copy(i).invert(),o2.copy(e.ray).applyMatrix4(o1),null!==r.boundingBox&&!1===o2.intersectsBox(r.boundingBox)))return;this._computeIntersections(e,t,o2)}}_computeIntersections(e,t,r){let n;let i=this.geometry,a=this.material,o=i.index,s=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv1,u=i.attributes.normal,d=i.groups,h=i.drawRange;if(null!==o){if(Array.isArray(a))for(let i=0,s=d.length;i<s;i++){let s=d[i],p=a[s.materialIndex],f=Math.max(s.start,h.start),m=Math.min(o.count,Math.min(s.start+s.count,h.start+h.count));for(let i=f,a=m;i<a;i+=3)(n=su(this,p,e,r,l,c,u,o.getX(i),o.getX(i+1),o.getX(i+2)))&&(n.faceIndex=Math.floor(i/3),n.face.materialIndex=s.materialIndex,t.push(n))}else{let i=Math.max(0,h.start),s=Math.min(o.count,h.start+h.count);for(let d=i,h=s;d<h;d+=3)(n=su(this,a,e,r,l,c,u,o.getX(d),o.getX(d+1),o.getX(d+2)))&&(n.faceIndex=Math.floor(d/3),t.push(n))}}else if(void 0!==s){if(Array.isArray(a))for(let i=0,o=d.length;i<o;i++){let o=d[i],p=a[o.materialIndex],f=Math.max(o.start,h.start),m=Math.min(s.count,Math.min(o.start+o.count,h.start+h.count));for(let i=f,a=m;i<a;i+=3)(n=su(this,p,e,r,l,c,u,i,i+1,i+2))&&(n.faceIndex=Math.floor(i/3),n.face.materialIndex=o.materialIndex,t.push(n))}else{let i=Math.max(0,h.start),o=Math.min(s.count,h.start+h.count);for(let s=i,d=o;s<d;s+=3)(n=su(this,a,e,r,l,c,u,s,s+1,s+2))&&(n.faceIndex=Math.floor(s/3),t.push(n))}}}constructor(e=new o0,t=new oI){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}}function sc(e,t,r,n,i,a,o,s){let l;if(null===(l=t.side===tk?n.intersectTriangle(o,a,i,!0,s):n.intersectTriangle(i,a,o,t.side===tR,s)))return null;ss.copy(s),ss.applyMatrix4(e.matrixWorld);let c=r.ray.origin.distanceTo(ss);return c<r.near||c>r.far?null:{distance:c,point:ss.clone(),object:e}}function su(e,t,r,n,i,a,o,s,l,c){e.getVertexPosition(s,o5),e.getVertexPosition(l,o6),e.getVertexPosition(c,o8);let u=sc(e,t,r,n,o5,o6,o8,so);if(u){i&&(se.fromBufferAttribute(i,s),st.fromBufferAttribute(i,l),sr.fromBufferAttribute(i,c),u.uv=o_.getInterpolation(so,o5,o6,o8,se,st,sr,new iX)),a&&(se.fromBufferAttribute(a,s),st.fromBufferAttribute(a,l),sr.fromBufferAttribute(a,c),u.uv1=o_.getInterpolation(so,o5,o6,o8,se,st,sr,new iX)),o&&(sn.fromBufferAttribute(o,s),si.fromBufferAttribute(o,l),sa.fromBufferAttribute(o,c),u.normal=o_.getInterpolation(so,o5,o6,o8,sn,si,sa,new ag),u.normal.dot(n.direction)>0&&u.normal.multiplyScalar(-1));let e={a:s,b:l,c:c,normal:new ag,materialIndex:0};o_.getNormal(o5,o6,o8,e.normal),u.face=e}return u}class sd extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sd(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}constructor(e=1,t=1,r=1,n=1,i=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:a};let o=this;n=Math.floor(n),i=Math.floor(i);let s=[],l=[],c=[],u=[],d=0,h=0;function p(e,t,r,n,i,a,p,f,m,g,y){let v=a/m,b=p/g,_=a/2,w=p/2,S=f/2,T=m+1,x=g+1,E=0,C=0,A=new ag;for(let a=0;a<x;a++){let o=a*b-w;for(let s=0;s<T;s++){let d=s*v-_;A[e]=d*n,A[t]=o*i,A[r]=S,l.push(A.x,A.y,A.z),A[e]=0,A[t]=0,A[r]=f>0?1:-1,c.push(A.x,A.y,A.z),u.push(s/m),u.push(1-a/g),E+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){let r=d+t+T*e,n=d+t+T*(e+1),i=d+(t+1)+T*(e+1),a=d+(t+1)+T*e;s.push(r,n,a),s.push(n,i,a),C+=6}o.addGroup(h,C,y),h+=C,d+=E}p("z","y","x",-1,-1,r,t,e,a=Math.floor(a),i,0),p("z","y","x",1,-1,r,t,-e,a,i,1),p("x","z","y",1,1,e,r,t,n,a,2),p("x","z","y",1,-1,e,r,-t,n,a,3),p("x","y","z",1,-1,e,t,r,n,i,4),p("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(s),this.setAttribute("position",new oW(l,3)),this.setAttribute("normal",new oW(c,3)),this.setAttribute("uv",new oW(u,2))}}function sh(e){let t={};for(let r in e)for(let n in t[r]={},e[r]){let i=e[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[r][n]=null):t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}return t}function sp(e){let t={};for(let r=0;r<e.length;r++){let n=sh(e[r]);for(let e in n)t[e]=n[e]}return t}function sf(e){let t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}function sm(e){let t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:i9.workingColorSpace}let sg={clone:sh,merge:sp};var sy="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",sv="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";class sb extends oM{copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=sh(e.uniforms),this.uniformsGroups=sf(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);for(let r in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){let n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let r={};for(let e in this.extensions)!0===this.extensions[e]&&(r[e]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=sy,this.fragmentShader=sv,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}}class s_ extends oc{copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new aW,this.projectionMatrix=new aW,this.projectionMatrixInverse=new aW,this.coordinateSystem=iR}}let sw=new ag,sS=new iX,sT=new iX;class sx extends s_{copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=2*iD*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(.5*iL*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*iD*Math.atan(Math.tan(.5*iL*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){sw.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(sw.x,sw.y).multiplyScalar(-e/sw.z),sw.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(sw.x,sw.y).multiplyScalar(-e/sw.z)}getViewSize(e,t){return this.getViewBounds(e,sS,sT),t.subVectors(sT,sS)}setViewOffset(e,t,r,n,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(.5*iL*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n,a=this.view;if(null!==this.view&&this.view.enabled){let e=a.fullWidth,o=a.fullHeight;i+=a.offsetX*n/e,t-=a.offsetY*r/o,n*=a.width/e,r*=a.height/o}let o=this.filmOffset;0!==o&&(i+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}constructor(e=50,t=1,r=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}}let sE=-90,sC=1;class sA extends oc{updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[r,n,i,a,o,s]=t;for(let e of t)this.remove(e);if(e===iR)r.up.set(0,1,0),r.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),s.up.set(0,1,0),s.lookAt(0,0,-1);else if(e===ik)r.up.set(0,-1,0),r.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),s.up.set(0,-1,0),s.lookAt(0,0,-1);else throw Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let e of t)this.add(e),e.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();let{renderTarget:r,activeMipmapLevel:n}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[i,a,o,s,l,c]=this.children,u=e.getRenderTarget(),d=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;let f=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,n),e.render(t,i),e.setRenderTarget(r,1,n),e.render(t,a),e.setRenderTarget(r,2,n),e.render(t,o),e.setRenderTarget(r,3,n),e.render(t,s),e.setRenderTarget(r,4,n),e.render(t,l),r.texture.generateMipmaps=f,e.setRenderTarget(r,5,n),e.render(t,c),e.setRenderTarget(u,d,h),e.xr.enabled=p,r.texture.needsPMREMUpdate=!0}constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;let n=new sx(sE,sC,e,t);n.layers=this.layers,this.add(n);let i=new sx(sE,sC,e,t);i.layers=this.layers,this.add(i);let a=new sx(sE,sC,e,t);a.layers=this.layers,this.add(a);let o=new sx(sE,sC,e,t);o.layers=this.layers,this.add(o);let s=new sx(sE,sC,e,t);s.layers=this.layers,this.add(s);let l=new sx(sE,sC,e,t);l.layers=this.layers,this.add(l)}}class sM extends as{get images(){return this.image}set images(e){this.image=e}constructor(e,t,r,n,i,a,o,s,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:ry,r,n,i,a,o,s,l,c),this.isCubeTexture=!0,this.flipY=!1}}class sI extends au{fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={tEquirect:{value:null}},n="\n\n				varying vec3 vWorldDirection;\n\n				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n				}\n\n				void main() {\n\n					vWorldDirection = transformDirection( position, modelMatrix );\n\n					#include <begin_vertex>\n					#include <project_vertex>\n\n				}\n			",i="\n\n				uniform sampler2D tEquirect;\n\n				varying vec3 vWorldDirection;\n\n				#include <common>\n\n				void main() {\n\n					vec3 direction = normalize( vWorldDirection );\n\n					vec2 sampleUV = equirectUv( direction );\n\n					gl_FragColor = texture2D( tEquirect, sampleUV );\n\n				}\n			",a=new sd(5,5,5),o=new sb({name:"CubemapFromEquirect",uniforms:sh(r),vertexShader:n,fragmentShader:i,side:tk,blending:tO});o.uniforms.tEquirect.value=t;let s=new sl(a,o),l=t.minFilter;return t.minFilter===rO&&(t.minFilter=rR),new sA(1,10,this).update(e,s),t.minFilter=l,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,n){let i=e.getRenderTarget();for(let i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,r,n);e.setRenderTarget(i)}constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1},n=[r,r,r,r,r,r];this.texture=new sM(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:rR}}let sR=new ag,sk=new ag,sP=new i$;class sO{set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let n=sR.subVectors(r,t).cross(sk.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let r=e.delta(sR),n=this.normal.dot(r);if(0===n)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;let i=-(e.start.dot(this.normal)+this.constant)/n;return i<0||i>1?null:t.copy(e.start).addScaledVector(r,i)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||sP.getNormalMatrix(e),n=this.coplanarPoint(sR).applyMatrix4(e),i=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}constructor(e=new ag(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}}let sN=new aU,sL=new ag;class sD{set(e,t,r,n,i,a){let o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(n),o[4].copy(i),o[5].copy(a),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:iR,r=this.planes,n=e.elements,i=n[0],a=n[1],o=n[2],s=n[3],l=n[4],c=n[5],u=n[6],d=n[7],h=n[8],p=n[9],f=n[10],m=n[11],g=n[12],y=n[13],v=n[14],b=n[15];if(r[0].setComponents(s-i,d-l,m-h,b-g).normalize(),r[1].setComponents(s+i,d+l,m+h,b+g).normalize(),r[2].setComponents(s+a,d+c,m+p,b+y).normalize(),r[3].setComponents(s-a,d-c,m-p,b-y).normalize(),r[4].setComponents(s-o,d-u,m-f,b-v).normalize(),t===iR)r[5].setComponents(s+o,d+u,m+f,b+v).normalize();else if(t===ik)r[5].setComponents(o,u,f,v).normalize();else throw Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),sN.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),sN.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(sN)}intersectsSprite(e){return sN.center.set(0,0,0),sN.radius=.7071067811865476,sN.applyMatrix4(e.matrixWorld),this.intersectsSphere(sN)}intersectsSphere(e){let t=this.planes,r=e.center,n=-e.radius;for(let e=0;e<6;e++)if(t[e].distanceToPoint(r)<n)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let n=t[r];if(sL.x=n.normal.x>0?e.max.x:e.min.x,sL.y=n.normal.y>0?e.max.y:e.min.y,sL.z=n.normal.z>0?e.max.z:e.min.z,0>n.distanceToPoint(sL))return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(0>t[r].distanceToPoint(e))return!1;return!0}clone(){return new this.constructor().copy(this)}constructor(e=new sO,t=new sO,r=new sO,n=new sO,i=new sO,a=new sO){this.planes=[e,t,r,n,i,a]}}function sU(){let e=null,t=!1,r=null,n=null;function i(t,a){r(t,a),n=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==r&&(n=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(e){r=e},setContext:function(t){e=t}}}function sF(e){let t=new WeakMap;function r(t,r){let n;let i=t.array,a=t.usage,o=i.byteLength,s=e.createBuffer();if(e.bindBuffer(r,s),e.bufferData(r,i,a),t.onUploadCallback(),i instanceof Float32Array)n=e.FLOAT;else if(i instanceof Uint16Array)n=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(i instanceof Int16Array)n=e.SHORT;else if(i instanceof Uint32Array)n=e.UNSIGNED_INT;else if(i instanceof Int32Array)n=e.INT;else if(i instanceof Int8Array)n=e.BYTE;else if(i instanceof Uint8Array)n=e.UNSIGNED_BYTE;else if(i instanceof Uint8ClampedArray)n=e.UNSIGNED_BYTE;else throw Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);return{buffer:s,type:n,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version,size:o}}function n(t,r,n){let i=r.array,a=r._updateRange,o=r.updateRanges;if(e.bindBuffer(n,t),-1===a.count&&0===o.length&&e.bufferSubData(n,0,i),0!==o.length){for(let t=0,r=o.length;t<r;t++){let r=o[t];e.bufferSubData(n,r.start*i.BYTES_PER_ELEMENT,i,r.start,r.count)}r.clearUpdateRanges()}-1!==a.count&&(e.bufferSubData(n,a.offset*i.BYTES_PER_ELEMENT,i,a.offset,a.count),a.count=-1),r.onUploadCallback()}return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(r){r.isInterleavedBufferAttribute&&(r=r.data);let n=t.get(r);n&&(e.deleteBuffer(n.buffer),t.delete(r))},update:function(e,i){if(e.isInterleavedBufferAttribute&&(e=e.data),e.isGLBufferAttribute){let r=t.get(e);(!r||r.version<e.version)&&t.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version});return}let a=t.get(e);if(void 0===a)t.set(e,r(e,i));else if(a.version<e.version){if(a.size!==e.array.byteLength)throw Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(a.buffer,e,i),a.version=e.version}}}}class sB extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sB(e.width,e.height,e.widthSegments,e.heightSegments)}constructor(e=1,t=1,r=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};let i=e/2,a=t/2,o=Math.floor(r),s=Math.floor(n),l=o+1,c=s+1,u=e/o,d=t/s,h=[],p=[],f=[],m=[];for(let e=0;e<c;e++){let t=e*d-a;for(let r=0;r<l;r++){let n=r*u-i;p.push(n,-t,0),f.push(0,0,1),m.push(r/o),m.push(1-e/s)}}for(let e=0;e<s;e++)for(let t=0;t<o;t++){let r=t+l*e,n=t+l*(e+1),i=t+1+l*(e+1),a=t+1+l*e;h.push(r,n,a),h.push(n,i,a)}this.setIndex(h),this.setAttribute("position",new oW(p,3)),this.setAttribute("normal",new oW(f,3)),this.setAttribute("uv",new oW(m,2))}}let sz={alphahash_fragment:"#ifdef USE_ALPHAHASH\n	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n	const float ALPHA_HASH_SCALE = 0.05;\n	float hash2D( vec2 value ) {\n		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n	}\n	float hash3D( vec3 value ) {\n		return hash2D( vec2( hash2D( value.xy ), value.z ) );\n	}\n	float getAlphaHashThreshold( vec3 position ) {\n		float maxDeriv = max(\n			length( dFdx( position.xyz ) ),\n			length( dFdy( position.xyz ) )\n		);\n		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n		vec2 pixScales = vec2(\n			exp2( floor( log2( pixScale ) ) ),\n			exp2( ceil( log2( pixScale ) ) )\n		);\n		vec2 alpha = vec2(\n			hash3D( floor( pixScales.x * position.xyz ) ),\n			hash3D( floor( pixScales.y * position.xyz ) )\n		);\n		float lerpFactor = fract( log2( pixScale ) );\n		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n		float a = min( lerpFactor, 1.0 - lerpFactor );\n		vec3 cases = vec3(\n			x * x / ( 2.0 * a * ( 1.0 - a ) ),\n			( x - 0.5 * a ) / ( 1.0 - a ),\n			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n		);\n		float threshold = ( x < ( 1.0 - a ) )\n			? ( ( x < a ) ? cases.x : cases.y )\n			: cases.z;\n		return clamp( threshold , 1.0e-6, 1.0 );\n	}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n	#ifdef ALPHA_TO_COVERAGE\n	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n	if ( diffuseColor.a == 0.0 ) discard;\n	#else\n	if ( diffuseColor.a < alphaTest ) discard;\n	#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n	uniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n	reflectedLight.indirectDiffuse *= ambientOcclusion;\n	#if defined( USE_CLEARCOAT ) \n		clearcoatSpecularIndirect *= ambientOcclusion;\n	#endif\n	#if defined( USE_SHEEN ) \n		sheenSpecularIndirect *= ambientOcclusion;\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD )\n		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n	#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n	#if ! defined( GL_ANGLE_multi_draw )\n	#define gl_DrawID _gl_DrawID\n	uniform int _gl_DrawID;\n	#endif\n	uniform highp sampler2D batchingTexture;\n	uniform highp usampler2D batchingIdTexture;\n	mat4 getBatchingMatrix( const in float i ) {\n		int size = textureSize( batchingTexture, 0 ).x;\n		int j = int( i ) * 4;\n		int x = j % size;\n		int y = j / size;\n		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n		return mat4( v1, v2, v3, v4 );\n	}\n	float getIndirectIndex( const in int i ) {\n		int size = textureSize( batchingIdTexture, 0 ).x;\n		int x = i % size;\n		int y = i / size;\n		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n	}\n#endif\n#ifdef USE_BATCHING_COLOR\n	uniform sampler2D batchingColorTexture;\n	vec3 getBatchingColor( const in float i ) {\n		int size = textureSize( batchingColorTexture, 0 ).x;\n		int j = int( i );\n		int x = j % size;\n		int y = j / size;\n		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n	}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n	vPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n	vec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n	return 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotVH = saturate( dot( viewDir, halfDir ) );\n	vec3 F = F_Schlick( specularColor, 1.0, dotVH );\n	float G = G_BlinnPhong_Implicit( );\n	float D = D_BlinnPhong( shininess, dotNH );\n	return F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n	const mat3 XYZ_TO_REC709 = mat3(\n		 3.2404542, -0.9692660,  0.0556434,\n		-1.5371385,  1.8760108, -0.2040259,\n		-0.4985314,  0.0415560,  1.0572252\n	);\n	vec3 Fresnel0ToIor( vec3 fresnel0 ) {\n		vec3 sqrtF0 = sqrt( fresnel0 );\n		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n	}\n	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n	}\n	float IorToFresnel0( float transmittedIor, float incidentIor ) {\n		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n	}\n	vec3 evalSensitivity( float OPD, vec3 shift ) {\n		float phase = 2.0 * PI * OPD * 1.0e-9;\n		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n		xyz /= 1.0685e-7;\n		vec3 rgb = XYZ_TO_REC709 * xyz;\n		return rgb;\n	}\n	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n		vec3 I;\n		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n		float cosTheta2Sq = 1.0 - sinTheta2Sq;\n		if ( cosTheta2Sq < 0.0 ) {\n			return vec3( 1.0 );\n		}\n		float cosTheta2 = sqrt( cosTheta2Sq );\n		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n		float R12 = F_Schlick( R0, 1.0, cosTheta1 );\n		float T121 = 1.0 - R12;\n		float phi12 = 0.0;\n		if ( iridescenceIOR < outsideIOR ) phi12 = PI;\n		float phi21 = PI - phi12;\n		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n		vec3 phi23 = vec3( 0.0 );\n		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n		vec3 phi = vec3( phi21 ) + phi23;\n		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n		vec3 r123 = sqrt( R123 );\n		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n		vec3 C0 = R12 + Rs;\n		I = C0;\n		vec3 Cm = Rs - T121;\n		for ( int m = 1; m <= 2; ++ m ) {\n			Cm *= r123;\n			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n			I += Cm * Sm;\n		}\n		return max( I, vec3( 0.0 ) );\n	}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n	vec2 dHdxy_fwd() {\n		vec2 dSTdx = dFdx( vBumpMapUv );\n		vec2 dSTdy = dFdy( vBumpMapUv );\n		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n		return vec2( dBx, dBy );\n	}\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n		vec3 vN = surf_norm;\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n		float fDet = dot( vSigmaX, R1 ) * faceDirection;\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n	}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n	vec4 plane;\n	#ifdef ALPHA_TO_COVERAGE\n		float distanceToPlane, distanceGradient;\n		float clipOpacity = 1.0;\n		#pragma unroll_loop_start\n		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n			plane = clippingPlanes[ i ];\n			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n			distanceGradient = fwidth( distanceToPlane ) / 2.0;\n			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n			if ( clipOpacity == 0.0 ) discard;\n		}\n		#pragma unroll_loop_end\n		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n			float unionClipOpacity = 1.0;\n			#pragma unroll_loop_start\n			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n				plane = clippingPlanes[ i ];\n				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n				distanceGradient = fwidth( distanceToPlane ) / 2.0;\n				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n			}\n			#pragma unroll_loop_end\n			clipOpacity *= 1.0 - unionClipOpacity;\n		#endif\n		diffuseColor.a *= clipOpacity;\n		if ( diffuseColor.a == 0.0 ) discard;\n	#else\n		#pragma unroll_loop_start\n		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n			plane = clippingPlanes[ i ];\n			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n		}\n		#pragma unroll_loop_end\n		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n			bool clipped = true;\n			#pragma unroll_loop_start\n			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n				plane = clippingPlanes[ i ];\n				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n			}\n			#pragma unroll_loop_end\n			if ( clipped ) discard;\n		#endif\n	#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n	vClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n	diffuseColor *= vColor;\n#elif defined( USE_COLOR )\n	diffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n	varying vec4 vColor;\n#elif defined( USE_COLOR )\n	varying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n	varying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n	varying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n	vColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n	vColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n	vColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n	vColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n	vColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n	const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n	return fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n	float precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n	float precisionSafeLength( vec3 v ) {\n		float maxComponent = max3( abs( v ) );\n		return length( v / maxComponent ) * maxComponent;\n	}\n#endif\nstruct IncidentLight {\n	vec3 color;\n	vec3 direction;\n	bool visible;\n};\nstruct ReflectedLight {\n	vec3 directDiffuse;\n	vec3 directSpecular;\n	vec3 indirectDiffuse;\n	vec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n	varying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n	mat3 tmp;\n	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n	return tmp;\n}\nbool isPerspectiveMatrix( mat4 m ) {\n	return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n	return vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n	return RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n	#define cubeUV_minMipLevel 4.0\n	#define cubeUV_minTileSize 16.0\n	float getFace( vec3 direction ) {\n		vec3 absDirection = abs( direction );\n		float face = - 1.0;\n		if ( absDirection.x > absDirection.z ) {\n			if ( absDirection.x > absDirection.y )\n				face = direction.x > 0.0 ? 0.0 : 3.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		} else {\n			if ( absDirection.z > absDirection.y )\n				face = direction.z > 0.0 ? 2.0 : 5.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		}\n		return face;\n	}\n	vec2 getUV( vec3 direction, float face ) {\n		vec2 uv;\n		if ( face == 0.0 ) {\n			uv = vec2( direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 1.0 ) {\n			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n		} else if ( face == 2.0 ) {\n			uv = vec2( - direction.x, direction.y ) / abs( direction.z );\n		} else if ( face == 3.0 ) {\n			uv = vec2( - direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 4.0 ) {\n			uv = vec2( - direction.x, direction.z ) / abs( direction.y );\n		} else {\n			uv = vec2( direction.x, direction.y ) / abs( direction.z );\n		}\n		return 0.5 * ( uv + 1.0 );\n	}\n	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n		float face = getFace( direction );\n		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n		mipInt = max( mipInt, cubeUV_minMipLevel );\n		float faceSize = exp2( mipInt );\n		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n		if ( face > 2.0 ) {\n			uv.y += faceSize;\n			face -= 3.0;\n		}\n		uv.x += face * faceSize;\n		uv.x += filterInt * 3.0 * cubeUV_minTileSize;\n		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n		uv.x *= CUBEUV_TEXEL_WIDTH;\n		uv.y *= CUBEUV_TEXEL_HEIGHT;\n		#ifdef texture2DGradEXT\n			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n		#else\n			return texture2D( envMap, uv ).rgb;\n		#endif\n	}\n	#define cubeUV_r0 1.0\n	#define cubeUV_m0 - 2.0\n	#define cubeUV_r1 0.8\n	#define cubeUV_m1 - 1.0\n	#define cubeUV_r4 0.4\n	#define cubeUV_m4 2.0\n	#define cubeUV_r5 0.305\n	#define cubeUV_m5 3.0\n	#define cubeUV_r6 0.21\n	#define cubeUV_m6 4.0\n	float roughnessToMip( float roughness ) {\n		float mip = 0.0;\n		if ( roughness >= cubeUV_r1 ) {\n			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n		} else if ( roughness >= cubeUV_r4 ) {\n			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n		} else if ( roughness >= cubeUV_r5 ) {\n			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n		} else if ( roughness >= cubeUV_r6 ) {\n			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n		} else {\n			mip = - 2.0 * log2( 1.16 * roughness );		}\n		return mip;\n	}\n	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n		float mipF = fract( mip );\n		float mipInt = floor( mip );\n		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n		if ( mipF == 0.0 ) {\n			return vec4( color0, 1.0 );\n		} else {\n			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n			return vec4( mix( color0, color1, mipF ), 1.0 );\n		}\n	}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n	vec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n	mat3 bm = mat3( batchingMatrix );\n	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n	transformedNormal = bm * transformedNormal;\n	#ifdef USE_TANGENT\n		transformedTangent = bm * transformedTangent;\n	#endif\n#endif\n#ifdef USE_INSTANCING\n	mat3 im = mat3( instanceMatrix );\n	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n	transformedNormal = im * transformedNormal;\n	#ifdef USE_TANGENT\n		transformedTangent = im * transformedTangent;\n	#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n	transformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n	#ifdef FLIP_SIDED\n		transformedTangent = - transformedTangent;\n	#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n	totalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n	uniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n	vec3( 0.8224621, 0.177538, 0.0 ),\n	vec3( 0.0331941, 0.9668058, 0.0 ),\n	vec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n	vec3( 1.2249401, - 0.2249404, 0.0 ),\n	vec3( - 0.0420569, 1.0420571, 0.0 ),\n	vec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n	return value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vec3 cameraToFrag;\n		if ( isOrthographic ) {\n			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToFrag = normalize( vWorldPosition - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( cameraToFrag, worldNormal );\n		#else\n			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n		#endif\n	#else\n		vec3 reflectVec = vReflect;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n	#else\n		vec4 envColor = vec4( 0.0 );\n	#endif\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_MIX )\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_ADD )\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n	#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float envMapIntensity;\n	uniform float flipEnvMap;\n	uniform mat3 envMapRotation;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float reflectivity;\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		varying vec3 vWorldPosition;\n		uniform float refractionRatio;\n	#else\n		varying vec3 vReflect;\n	#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		\n		varying vec3 vWorldPosition;\n	#else\n		varying vec3 vReflect;\n		uniform float refractionRatio;\n	#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n	vec3 getIBLIrradiance( const in vec3 normal ) {\n		#ifdef ENVMAP_TYPE_CUBE_UV\n			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n			return PI * envMapColor.rgb * envMapIntensity;\n		#else\n			return vec3( 0.0 );\n		#endif\n	}\n	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n		#ifdef ENVMAP_TYPE_CUBE_UV\n			vec3 reflectVec = reflect( - viewDir, normal );\n			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n			return envMapColor.rgb * envMapIntensity;\n		#else\n			return vec3( 0.0 );\n		#endif\n	}\n	#ifdef USE_ANISOTROPY\n		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n			#ifdef ENVMAP_TYPE_CUBE_UV\n				vec3 bentNormal = cross( bitangent, viewDir );\n				bentNormal = normalize( cross( bentNormal, bitangent ) );\n				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n				return getIBLRadiance( viewDir, bentNormal, roughness );\n			#else\n				return vec3( 0.0 );\n			#endif\n		}\n	#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vWorldPosition = worldPosition.xyz;\n	#else\n		vec3 cameraToVertex;\n		if ( isOrthographic ) {\n			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vReflect = reflect( cameraToVertex, worldNormal );\n		#else\n			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n	vFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n	varying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n	#ifdef FOG_EXP2\n		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n	#else\n		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n	#endif\n	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n	uniform vec3 fogColor;\n	varying float vFogDepth;\n	#ifdef FOG_EXP2\n		uniform float fogDensity;\n	#else\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n	uniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n	float dotNL = dot( normal, lightDirection );\n	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n	#ifdef USE_GRADIENTMAP\n		return vec3( texture2D( gradientMap, coord ).r );\n	#else\n		vec2 fw = fwidth( coord ) * 0.5;\n		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n	#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n	vec3 diffuseColor;\n	float specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Lambert\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n	uniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n	float x = normal.x, y = normal.y, z = normal.z;\n	vec3 result = shCoefficients[ 0 ] * 0.886227;\n	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n	return result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n	return irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n	vec3 irradiance = ambientLightColor;\n	return irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n	if ( cutoffDistance > 0.0 ) {\n		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n	}\n	return distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n	return smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n	struct DirectionalLight {\n		vec3 direction;\n		vec3 color;\n	};\n	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n		light.color = directionalLight.color;\n		light.direction = directionalLight.direction;\n		light.visible = true;\n	}\n#endif\n#if NUM_POINT_LIGHTS > 0\n	struct PointLight {\n		vec3 position;\n		vec3 color;\n		float distance;\n		float decay;\n	};\n	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n		vec3 lVector = pointLight.position - geometryPosition;\n		light.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		light.color = pointLight.color;\n		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n		light.visible = ( light.color != vec3( 0.0 ) );\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	struct SpotLight {\n		vec3 position;\n		vec3 direction;\n		vec3 color;\n		float distance;\n		float decay;\n		float coneCos;\n		float penumbraCos;\n	};\n	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n		vec3 lVector = spotLight.position - geometryPosition;\n		light.direction = normalize( lVector );\n		float angleCos = dot( light.direction, spotLight.direction );\n		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n		if ( spotAttenuation > 0.0 ) {\n			float lightDistance = length( lVector );\n			light.color = spotLight.color * spotAttenuation;\n			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n			light.visible = ( light.color != vec3( 0.0 ) );\n		} else {\n			light.color = vec3( 0.0 );\n			light.visible = false;\n		}\n	}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n	struct RectAreaLight {\n		vec3 color;\n		vec3 position;\n		vec3 halfWidth;\n		vec3 halfHeight;\n	};\n	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;\n	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	struct HemisphereLight {\n		vec3 direction;\n		vec3 skyColor;\n		vec3 groundColor;\n	};\n	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n		float dotNL = dot( normal, hemiLight.direction );\n		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n		return irradiance;\n	}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n	vec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Toon\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n	vec3 diffuseColor;\n	vec3 specularColor;\n	float specularShininess;\n	float specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_BlinnPhong\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n	material.ior = ior;\n	#ifdef USE_SPECULAR\n		float specularIntensityFactor = specularIntensity;\n		vec3 specularColorFactor = specularColor;\n		#ifdef USE_SPECULAR_COLORMAP\n			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n		#endif\n		#ifdef USE_SPECULAR_INTENSITYMAP\n			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n		#endif\n		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n	#else\n		float specularIntensityFactor = 1.0;\n		vec3 specularColorFactor = vec3( 1.0 );\n		material.specularF90 = 1.0;\n	#endif\n	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n	material.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n	material.clearcoat = clearcoat;\n	material.clearcoatRoughness = clearcoatRoughness;\n	material.clearcoatF0 = vec3( 0.04 );\n	material.clearcoatF90 = 1.0;\n	#ifdef USE_CLEARCOATMAP\n		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n	#endif\n	#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n	#endif\n	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n	material.clearcoatRoughness += geometryRoughness;\n	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n	material.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n	material.iridescence = iridescence;\n	material.iridescenceIOR = iridescenceIOR;\n	#ifdef USE_IRIDESCENCEMAP\n		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n	#endif\n	#ifdef USE_IRIDESCENCE_THICKNESSMAP\n		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n	#else\n		material.iridescenceThickness = iridescenceThicknessMaximum;\n	#endif\n#endif\n#ifdef USE_SHEEN\n	material.sheenColor = sheenColor;\n	#ifdef USE_SHEEN_COLORMAP\n		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n	#endif\n	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n	#ifdef USE_SHEEN_ROUGHNESSMAP\n		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n	#endif\n#endif\n#ifdef USE_ANISOTROPY\n	#ifdef USE_ANISOTROPYMAP\n		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n	#else\n		vec2 anisotropyV = anisotropyVector;\n	#endif\n	material.anisotropy = length( anisotropyV );\n	if( material.anisotropy == 0.0 ) {\n		anisotropyV = vec2( 1.0, 0.0 );\n	} else {\n		anisotropyV /= material.anisotropy;\n		material.anisotropy = saturate( material.anisotropy );\n	}\n	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n	vec3 diffuseColor;\n	float roughness;\n	vec3 specularColor;\n	float specularF90;\n	float dispersion;\n	#ifdef USE_CLEARCOAT\n		float clearcoat;\n		float clearcoatRoughness;\n		vec3 clearcoatF0;\n		float clearcoatF90;\n	#endif\n	#ifdef USE_IRIDESCENCE\n		float iridescence;\n		float iridescenceIOR;\n		float iridescenceThickness;\n		vec3 iridescenceFresnel;\n		vec3 iridescenceF0;\n	#endif\n	#ifdef USE_SHEEN\n		vec3 sheenColor;\n		float sheenRoughness;\n	#endif\n	#ifdef IOR\n		float ior;\n	#endif\n	#ifdef USE_TRANSMISSION\n		float transmission;\n		float transmissionAlpha;\n		float thickness;\n		float attenuationDistance;\n		vec3 attenuationColor;\n	#endif\n	#ifdef USE_ANISOTROPY\n		float anisotropy;\n		float alphaT;\n		vec3 anisotropyT;\n		vec3 anisotropyB;\n	#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	return 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n	float a2 = pow2( alpha );\n	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n	return RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n		float v = 0.5 / ( gv + gl );\n		return saturate(v);\n	}\n	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n		float a2 = alphaT * alphaB;\n		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n		highp float v2 = dot( v, v );\n		float w2 = a2 / v2;\n		return RECIPROCAL_PI * a2 * pow2 ( w2 );\n	}\n#endif\n#ifdef USE_CLEARCOAT\n	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n		vec3 f0 = material.clearcoatF0;\n		float f90 = material.clearcoatF90;\n		float roughness = material.clearcoatRoughness;\n		float alpha = pow2( roughness );\n		vec3 halfDir = normalize( lightDir + viewDir );\n		float dotNL = saturate( dot( normal, lightDir ) );\n		float dotNV = saturate( dot( normal, viewDir ) );\n		float dotNH = saturate( dot( normal, halfDir ) );\n		float dotVH = saturate( dot( viewDir, halfDir ) );\n		vec3 F = F_Schlick( f0, f90, dotVH );\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n		return F * ( V * D );\n	}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n	vec3 f0 = material.specularColor;\n	float f90 = material.specularF90;\n	float roughness = material.roughness;\n	float alpha = pow2( roughness );\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotVH = saturate( dot( viewDir, halfDir ) );\n	vec3 F = F_Schlick( f0, f90, dotVH );\n	#ifdef USE_IRIDESCENCE\n		F = mix( F, material.iridescenceFresnel, material.iridescence );\n	#endif\n	#ifdef USE_ANISOTROPY\n		float dotTL = dot( material.anisotropyT, lightDir );\n		float dotTV = dot( material.anisotropyT, viewDir );\n		float dotTH = dot( material.anisotropyT, halfDir );\n		float dotBL = dot( material.anisotropyB, lightDir );\n		float dotBV = dot( material.anisotropyB, viewDir );\n		float dotBH = dot( material.anisotropyB, halfDir );\n		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n	#else\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n	#endif\n	return F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n	const float LUT_SIZE = 64.0;\n	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n	const float LUT_BIAS = 0.5 / LUT_SIZE;\n	float dotNV = saturate( dot( N, V ) );\n	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n	uv = uv * LUT_SCALE + LUT_BIAS;\n	return uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n	float l = length( f );\n	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n	float x = dot( v1, v2 );\n	float y = abs( x );\n	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n	float b = 3.4175940 + ( 4.1616724 + y ) * y;\n	float v = a / b;\n	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n	return cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n	vec3 lightNormal = cross( v1, v2 );\n	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n	vec3 T1, T2;\n	T1 = normalize( V - N * dot( V, N ) );\n	T2 = - cross( N, T1 );\n	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n	vec3 coords[ 4 ];\n	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n	coords[ 0 ] = normalize( coords[ 0 ] );\n	coords[ 1 ] = normalize( coords[ 1 ] );\n	coords[ 2 ] = normalize( coords[ 2 ] );\n	coords[ 3 ] = normalize( coords[ 3 ] );\n	vec3 vectorFormFactor = vec3( 0.0 );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n	return vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n	float alpha = pow2( roughness );\n	float invAlpha = 1.0 / alpha;\n	float cos2h = dotNH * dotNH;\n	float sin2h = max( 1.0 - cos2h, 0.0078125 );\n	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float D = D_Charlie( sheenRoughness, dotNH );\n	float V = V_Neubelt( dotNV, dotNL );\n	return sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float r2 = roughness * roughness;\n	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n	return saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n	vec4 r = roughness * c0 + c1;\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n	return fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	return specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	#ifdef USE_IRIDESCENCE\n		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n	#else\n		vec3 Fr = specularColor;\n	#endif\n	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n	float Ess = fab.x + fab.y;\n	float Ems = 1.0 - Ess;\n	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n	singleScatter += FssEss;\n	multiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n		vec3 normal = geometryNormal;\n		vec3 viewDir = geometryViewDir;\n		vec3 position = geometryPosition;\n		vec3 lightPos = rectAreaLight.position;\n		vec3 halfWidth = rectAreaLight.halfWidth;\n		vec3 halfHeight = rectAreaLight.halfHeight;\n		vec3 lightColor = rectAreaLight.color;\n		float roughness = material.roughness;\n		vec3 rectCoords[ 4 ];\n		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n		vec2 uv = LTC_Uv( normal, viewDir, roughness );\n		vec4 t1 = texture2D( ltc_1, uv );\n		vec4 t2 = texture2D( ltc_2, uv );\n		mat3 mInv = mat3(\n			vec3( t1.x, 0, t1.y ),\n			vec3(    0, 1,    0 ),\n			vec3( t1.z, 0, t1.w )\n		);\n		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n	}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifdef USE_CLEARCOAT\n		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n		vec3 ccIrradiance = dotNLcc * directLight.color;\n		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n	#endif\n	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n	#ifdef USE_CLEARCOAT\n		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n	#endif\n	vec3 singleScattering = vec3( 0.0 );\n	vec3 multiScattering = vec3( 0.0 );\n	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n	#ifdef USE_IRIDESCENCE\n		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n	#else\n		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n	#endif\n	vec3 totalScattering = singleScattering + multiScattering;\n	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n	reflectedLight.indirectSpecular += radiance * singleScattering;\n	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct				RE_Direct_Physical\n#define RE_Direct_RectArea		RE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular		RE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n	geometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n	float dotNVi = saturate( dot( normal, geometryViewDir ) );\n	if ( material.iridescenceThickness == 0.0 ) {\n		material.iridescence = 0.0;\n	} else {\n		material.iridescence = saturate( material.iridescence );\n	}\n	if ( material.iridescence > 0.0 ) {\n		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n	}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n	PointLight pointLight;\n	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		getPointLightInfo( pointLight, geometryPosition, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n		pointLightShadow = pointLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n	SpotLight spotLight;\n	vec4 spotColor;\n	vec3 spotLightCoord;\n	bool inSpotLightMap;\n	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		getSpotLightInfo( spotLight, geometryPosition, directLight );\n		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n		#else\n		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n		#endif\n		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n		#endif\n		#undef SPOT_LIGHT_MAP_INDEX\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		spotLightShadow = spotLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n	DirectionalLight directionalLight;\n	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		getDirectionalLightInfo( directionalLight, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n		directionalLightShadow = directionalLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n	RectAreaLight rectAreaLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n		rectAreaLight = rectAreaLights[ i ];\n		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n	vec3 iblIrradiance = vec3( 0.0 );\n	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n	#if defined( USE_LIGHT_PROBES )\n		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n	#endif\n	#if ( NUM_HEMI_LIGHTS > 0 )\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if defined( RE_IndirectSpecular )\n	vec3 radiance = vec3( 0.0 );\n	vec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n		irradiance += lightMapIrradiance;\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n		iblIrradiance += getIBLIrradiance( geometryNormal );\n	#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n	#ifdef USE_ANISOTROPY\n		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n	#else\n		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n	#endif\n	#ifdef USE_CLEARCOAT\n		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n	#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF )\n	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF )\n	uniform float logDepthBufFC;\n	varying float vFragDepth;\n	varying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n	varying float vFragDepth;\n	varying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n	vFragDepth = 1.0 + gl_Position.w;\n	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n	vec4 sampledDiffuseColor = texture2D( map, vMapUv );\n	#ifdef DECODE_VIDEO_TEXTURE\n		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n	\n	#endif\n	diffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n	uniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n	#if defined( USE_POINTS_UV )\n		vec2 uv = vUv;\n	#else\n		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n	#endif\n#endif\n#ifdef USE_MAP\n	diffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n	varying vec2 vUv;\n#else\n	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n		uniform mat3 uvTransform;\n	#endif\n#endif\n#ifdef USE_MAP\n	uniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n	metalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n	uniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n	float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n	}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n	vColor *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		#if defined( USE_COLOR_ALPHA )\n			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n		#elif defined( USE_COLOR )\n			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n		#endif\n	}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n	objectNormal *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n	}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n	#ifndef USE_INSTANCING_MORPH\n		uniform float morphTargetBaseInfluence;\n		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n	#endif\n	uniform sampler2DArray morphTargetsTexture;\n	uniform ivec2 morphTargetsTextureSize;\n	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n		int y = texelIndex / morphTargetsTextureSize.x;\n		int x = texelIndex - y * morphTargetsTextureSize.x;\n		ivec3 morphUV = ivec3( x, y, morphTargetIndex );\n		return texelFetch( morphTargetsTexture, morphUV, 0 );\n	}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n	transformed *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n	}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n	vec3 fdx = dFdx( vViewPosition );\n	vec3 fdy = dFdy( vViewPosition );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n#else\n	vec3 normal = normalize( vNormal );\n	#ifdef DOUBLE_SIDED\n		normal *= faceDirection;\n	#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n	#ifdef USE_TANGENT\n		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n	#else\n		mat3 tbn = getTangentFrame( - vViewPosition, normal,\n		#if defined( USE_NORMALMAP )\n			vNormalMapUv\n		#elif defined( USE_CLEARCOAT_NORMALMAP )\n			vClearcoatNormalMapUv\n		#else\n			vUv\n		#endif\n		);\n	#endif\n	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n		tbn[0] *= faceDirection;\n		tbn[1] *= faceDirection;\n	#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	#ifdef USE_TANGENT\n		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n	#else\n		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n	#endif\n	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n		tbn2[0] *= faceDirection;\n		tbn2[1] *= faceDirection;\n	#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n	#ifdef FLIP_SIDED\n		normal = - normal;\n	#endif\n	#ifdef DOUBLE_SIDED\n		normal = normal * faceDirection;\n	#endif\n	normal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n	mapN.xy *= normalScale;\n	normal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n	#ifdef USE_TANGENT\n		vTangent = normalize( transformedTangent );\n		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n	#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n	uniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( uv.st );\n		vec2 st1 = dFdy( uv.st );\n		vec3 N = surf_norm;\n		vec3 q1perp = cross( q1, N );\n		vec3 q0perp = cross( N, q0 );\n		vec3 T = q1perp * st0.x + q0perp * st1.x;\n		vec3 B = q1perp * st0.y + q0perp * st1.y;\n		float det = max( dot( T, T ), dot( B, B ) );\n		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n		return mat3( T * scale, B * scale, N );\n	}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n	vec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n	clearcoatMapN.xy *= clearcoatNormalScale;\n	clearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n	uniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform sampler2D clearcoatNormalMap;\n	uniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n	uniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	uniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n	return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n	return 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n	if( v <= 0.0 )\n		return vec4( 0., 0., 0., 0. );\n	if( v >= 1.0 )\n		return vec4( 1., 1., 1., 1. );\n	float vuf;\n	float af = modf( v * PackFactors.a, vuf );\n	float bf = modf( vuf * ShiftRight8, vuf );\n	float gf = modf( vuf * ShiftRight8, vuf );\n	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n	if( v <= 0.0 )\n		return vec3( 0., 0., 0. );\n	if( v >= 1.0 )\n		return vec3( 1., 1., 1. );\n	float vuf;\n	float bf = modf( v * PackFactors.b, vuf );\n	float gf = modf( vuf * ShiftRight8, vuf );\n	return vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n	if( v <= 0.0 )\n		return vec2( 0., 0. );\n	if( v >= 1.0 )\n		return vec2( 1., 1. );\n	float vuf;\n	float gf = modf( v * 256., vuf );\n	return vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n	return dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n	return dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n	return depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n	return ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n	gl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n	mvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n	mvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n	gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n	vec3 dithering( vec3 color ) {\n		float grid_position = rand( gl_FragCoord.xy );\n		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n		return color + dither_shift_RGB;\n	}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n	roughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n	uniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n		struct SpotLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n	}\n	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n		return unpackRGBATo2Half( texture2D( shadow, uv ) );\n	}\n	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n		float occlusion = 1.0;\n		vec2 distribution = texture2DDistribution( shadow, uv );\n		float hard_shadow = step( compare , distribution.x );\n		if (hard_shadow != 1.0 ) {\n			float distance = compare - distribution.x ;\n			float variance = max( 0.00000, distribution.y * distribution.y );\n			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n		}\n		return occlusion;\n	}\n	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		float shadow = 1.0;\n		shadowCoord.xyz /= shadowCoord.w;\n		shadowCoord.z += shadowBias;\n		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n		if ( frustumTest ) {\n		#if defined( SHADOWMAP_TYPE_PCF )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			float dx2 = dx0 / 2.0;\n			float dy2 = dy0 / 2.0;\n			float dx3 = dx1 / 2.0;\n			float dy3 = dy1 / 2.0;\n			shadow = (\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 17.0 );\n		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx = texelSize.x;\n			float dy = texelSize.y;\n			vec2 uv = shadowCoord.xy;\n			vec2 f = fract( uv * shadowMapSize + 0.5 );\n			uv -= f * texelSize;\n			shadow = (\n				texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n						  f.x ),\n					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n						  f.x ),\n					 f.y )\n			) * ( 1.0 / 9.0 );\n		#elif defined( SHADOWMAP_TYPE_VSM )\n			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#else\n			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#endif\n		}\n		return mix( 1.0, shadow, shadowIntensity );\n	}\n	vec2 cubeToUV( vec3 v, float texelSizeY ) {\n		vec3 absV = abs( v );\n		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n		absV *= scaleToCube;\n		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n		vec2 planar = v.xy;\n		float almostATexel = 1.5 * texelSizeY;\n		float almostOne = 1.0 - almostATexel;\n		if ( absV.z >= almostOne ) {\n			if ( v.z > 0.0 )\n				planar.x = 4.0 - v.x;\n		} else if ( absV.x >= almostOne ) {\n			float signX = sign( v.x );\n			planar.x = v.z * signX + 2.0 * signX;\n		} else if ( absV.y >= almostOne ) {\n			float signY = sign( v.y );\n			planar.x = v.x + 2.0 * signY + 2.0;\n			planar.y = v.z * signY - 2.0;\n		}\n		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n	}\n	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n		float shadow = 1.0;\n		vec3 lightToPosition = shadowCoord.xyz;\n		\n		float lightToPositionLength = length( lightToPosition );\n		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {\n			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;\n			vec3 bd3D = normalize( lightToPosition );\n			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n				shadow = (\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n				) * ( 1.0 / 9.0 );\n			#else\n				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n			#endif\n		}\n		return mix( 1.0, shadow, shadowIntensity );\n	}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		struct SpotLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowIntensity;\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n	vec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n		}\n		#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n		shadowWorldPosition = worldPosition;\n		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n		#endif\n		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n	float shadow = 1.0;\n	#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n		directionalLight = directionalLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n		spotLight = spotLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n		pointLight = pointLightShadows[ i ];\n		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#endif\n	return shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n	uniform highp sampler2D boneTexture;\n	mat4 getBoneMatrix( const in float i ) {\n		int size = textureSize( boneTexture, 0 ).x;\n		int j = int( i ) * 4;\n		int x = j % size;\n		int y = j / size;\n		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n		return mat4( v1, v2, v3, v4 );\n	}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	transformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n	#ifdef USE_TANGENT\n		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n	specularStrength = texelSpecular.r;\n#else\n	specularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n	return saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	return saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	color = max( vec3( 0.0 ), color - 0.004 );\n	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n	return a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n	const mat3 ACESInputMat = mat3(\n		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),\n		vec3( 0.04823, 0.01566, 0.83777 )\n	);\n	const mat3 ACESOutputMat = mat3(\n		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),\n		vec3( -0.07367, -0.00605,  1.07602 )\n	);\n	color *= toneMappingExposure / 0.6;\n	color = ACESInputMat * color;\n	color = RRTAndODTFit( color );\n	color = ACESOutputMat * color;\n	return saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n	vec3( 1.6605, - 0.1246, - 0.0182 ),\n	vec3( - 0.5876, 1.1329, - 0.1006 ),\n	vec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n	vec3( 0.6274, 0.0691, 0.0164 ),\n	vec3( 0.3293, 0.9195, 0.0880 ),\n	vec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n	vec3 x2 = x * x;\n	vec3 x4 = x2 * x2;\n	return + 15.5 * x4 * x2\n		- 40.14 * x4 * x\n		+ 31.96 * x4\n		- 6.868 * x2 * x\n		+ 0.4298 * x2\n		+ 0.1191 * x\n		- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n	const mat3 AgXInsetMatrix = mat3(\n		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n	);\n	const mat3 AgXOutsetMatrix = mat3(\n		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n	);\n	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;\n	color *= toneMappingExposure;\n	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n	color = AgXInsetMatrix * color;\n	color = max( color, 1e-10 );	color = log2( color );\n	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n	color = clamp( color, 0.0, 1.0 );\n	color = agxDefaultContrastApprox( color );\n	color = AgXOutsetMatrix * color;\n	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n	color = clamp( color, 0.0, 1.0 );\n	return color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n	const float StartCompression = 0.8 - 0.04;\n	const float Desaturation = 0.15;\n	color *= toneMappingExposure;\n	float x = min( color.r, min( color.g, color.b ) );\n	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n	color -= offset;\n	float peak = max( color.r, max( color.g, color.b ) );\n	if ( peak < StartCompression ) return color;\n	float d = 1. - StartCompression;\n	float newPeak = 1. - d * d / ( peak + d - StartCompression );\n	color *= newPeak / peak;\n	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n	return mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n	material.transmission = transmission;\n	material.transmissionAlpha = 1.0;\n	material.thickness = thickness;\n	material.attenuationDistance = attenuationDistance;\n	material.attenuationColor = attenuationColor;\n	#ifdef USE_TRANSMISSIONMAP\n		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n	#endif\n	#ifdef USE_THICKNESSMAP\n		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n	#endif\n	vec3 pos = vWorldPosition;\n	vec3 v = normalize( cameraPosition - pos );\n	vec3 n = inverseTransformDirection( normal, viewMatrix );\n	vec4 transmitted = getIBLVolumeRefraction(\n		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n		material.attenuationColor, material.attenuationDistance );\n	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n	uniform float transmission;\n	uniform float thickness;\n	uniform float attenuationDistance;\n	uniform vec3 attenuationColor;\n	#ifdef USE_TRANSMISSIONMAP\n		uniform sampler2D transmissionMap;\n	#endif\n	#ifdef USE_THICKNESSMAP\n		uniform sampler2D thicknessMap;\n	#endif\n	uniform vec2 transmissionSamplerSize;\n	uniform sampler2D transmissionSamplerMap;\n	uniform mat4 modelMatrix;\n	uniform mat4 projectionMatrix;\n	varying vec3 vWorldPosition;\n	float w0( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n	}\n	float w1( float a ) {\n		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n	}\n	float w2( float a ){\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n	}\n	float w3( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * a * a );\n	}\n	float g0( float a ) {\n		return w0( a ) + w1( a );\n	}\n	float g1( float a ) {\n		return w2( a ) + w3( a );\n	}\n	float h0( float a ) {\n		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n	}\n	float h1( float a ) {\n		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n	}\n	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n		uv = uv * texelSize.zw + 0.5;\n		vec2 iuv = floor( uv );\n		vec2 fuv = fract( uv );\n		float g0x = g0( fuv.x );\n		float g1x = g1( fuv.x );\n		float h0x = h0( fuv.x );\n		float h1x = h1( fuv.x );\n		float h0y = h0( fuv.y );\n		float h1y = h1( fuv.y );\n		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n	}\n	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n		vec2 fLodSizeInv = 1.0 / fLodSize;\n		vec2 cLodSizeInv = 1.0 / cLodSize;\n		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n		return mix( fSample, cSample, fract( lod ) );\n	}\n	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n		vec3 modelScale;\n		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n		return normalize( refractionVector ) * thickness * modelScale;\n	}\n	float applyIorToRoughness( const in float roughness, const in float ior ) {\n		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n	}\n	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n	}\n	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n		if ( isinf( attenuationDistance ) ) {\n			return vec3( 1.0 );\n		} else {\n			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;\n		}\n	}\n	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n		const in vec3 attenuationColor, const in float attenuationDistance ) {\n		vec4 transmittedLight;\n		vec3 transmittance;\n		#ifdef USE_DISPERSION\n			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n			for ( int i = 0; i < 3; i ++ ) {\n				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n				vec3 refractedRayExit = position + transmissionRay;\n		\n				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n				vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n				refractionCoords += 1.0;\n				refractionCoords /= 2.0;\n		\n				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n				transmittedLight[ i ] = transmissionSample[ i ];\n				transmittedLight.a += transmissionSample.a;\n				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n			}\n			transmittedLight.a /= 3.0;\n		\n		#else\n		\n			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n			vec3 refractedRayExit = position + transmissionRay;\n			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n			vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n			refractionCoords += 1.0;\n			refractionCoords /= 2.0;\n			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n		\n		#endif\n		vec3 attenuatedColor = transmittance * transmittedLight.rgb;\n		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n	}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	varying vec2 vUv;\n#endif\n#ifdef USE_MAP\n	varying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n	varying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n	varying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n	varying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n	varying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n	varying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n	varying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n	varying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	varying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	varying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n	varying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	varying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	varying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	varying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	varying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	varying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	varying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n	varying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	varying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	varying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	uniform mat3 transmissionMapTransform;\n	varying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n	uniform mat3 thicknessMapTransform;\n	varying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	varying vec2 vUv;\n#endif\n#ifdef USE_MAP\n	uniform mat3 mapTransform;\n	varying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform mat3 alphaMapTransform;\n	varying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n	uniform mat3 lightMapTransform;\n	varying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n	uniform mat3 aoMapTransform;\n	varying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n	uniform mat3 bumpMapTransform;\n	varying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n	uniform mat3 normalMapTransform;\n	varying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n	uniform mat3 displacementMapTransform;\n	varying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n	uniform mat3 emissiveMapTransform;\n	varying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n	uniform mat3 metalnessMapTransform;\n	varying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	uniform mat3 roughnessMapTransform;\n	varying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	uniform mat3 anisotropyMapTransform;\n	varying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n	uniform mat3 clearcoatMapTransform;\n	varying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform mat3 clearcoatNormalMapTransform;\n	varying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform mat3 clearcoatRoughnessMapTransform;\n	varying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	uniform mat3 sheenColorMapTransform;\n	varying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	uniform mat3 sheenRoughnessMapTransform;\n	varying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	uniform mat3 iridescenceMapTransform;\n	varying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	uniform mat3 iridescenceThicknessMapTransform;\n	varying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n	uniform mat3 specularMapTransform;\n	varying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	uniform mat3 specularColorMapTransform;\n	varying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	uniform mat3 specularIntensityMapTransform;\n	varying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	uniform mat3 transmissionMapTransform;\n	varying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n	uniform mat3 thicknessMapTransform;\n	varying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	vUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n	vec4 worldPosition = vec4( transformed, 1.0 );\n	#ifdef USE_BATCHING\n		worldPosition = batchingMatrix * worldPosition;\n	#endif\n	#ifdef USE_INSTANCING\n		worldPosition = instanceMatrix * worldPosition;\n	#endif\n	worldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	gl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n	vec4 texColor = texture2D( t2D, vUv );\n	#ifdef DECODE_VIDEO_TEXTURE\n		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n	#endif\n	texColor.rgb *= backgroundIntensity;\n	gl_FragColor = texColor;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n	uniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n	uniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n	#elif defined( ENVMAP_TYPE_CUBE_UV )\n		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n	#else\n		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n	#endif\n	texColor.rgb *= backgroundIntensity;\n	gl_FragColor = texColor;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n	gl_FragColor = texColor;\n	gl_FragColor.a *= opacity;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <uv_vertex>\n	#include <batching_vertex>\n	#include <skinbase_vertex>\n	#include <morphinstance_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n	uniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	vec4 diffuseColor = vec4( 1.0 );\n	#include <clipping_planes_fragment>\n	#if DEPTH_PACKING == 3200\n		diffuseColor.a = opacity;\n	#endif\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <logdepthbuf_fragment>\n	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n	#if DEPTH_PACKING == 3200\n		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n	#elif DEPTH_PACKING == 3201\n		gl_FragColor = packDepthToRGBA( fragCoordZ );\n	#elif DEPTH_PACKING == 3202\n		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n	#elif DEPTH_PACKING == 3203\n		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n	#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <batching_vertex>\n	#include <skinbase_vertex>\n	#include <morphinstance_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	vWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n	vec4 diffuseColor = vec4( 1.0 );\n	#include <clipping_planes_fragment>\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	float dist = length( vWorldPosition - referencePosition );\n	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n	dist = saturate( dist );\n	gl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vec3 direction = normalize( vWorldDirection );\n	vec2 sampleUV = equirectUv( direction );\n	gl_FragColor = texture2D( tEquirect, sampleUV );\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	vLineDistance = scale * lineDistance;\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	if ( mod( vLineDistance, totalSize ) > dashSize ) {\n		discard;\n	}\n	vec3 outgoingLight = vec3( 0.0 );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinbase_vertex>\n		#include <skinnormal_vertex>\n		#include <defaultnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n	#else\n		reflectedLight.indirectDiffuse += vec3( 1.0 );\n	#endif\n	#include <aomap_fragment>\n	reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n	vec3 outgoingLight = reflectedLight.indirectDiffuse;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_lambert_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n	vViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	vec3 viewDir = normalize( vViewPosition );\n	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n	vec3 y = cross( viewDir, x );\n	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n	#ifdef USE_MATCAP\n		vec4 matcapColor = texture2D( matcap, uv );\n	#else\n		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n	#endif\n	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	varying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphinstance_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	vViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	varying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n	#ifdef OPAQUE\n		gl_FragColor.a = 1.0;\n	#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphinstance_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_phong_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n	varying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n	vWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n	#define IOR\n	#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n	uniform float ior;\n#endif\n#ifdef USE_SPECULAR\n	uniform float specularIntensity;\n	uniform vec3 specularColor;\n	#ifdef USE_SPECULAR_COLORMAP\n		uniform sampler2D specularColorMap;\n	#endif\n	#ifdef USE_SPECULAR_INTENSITYMAP\n		uniform sampler2D specularIntensityMap;\n	#endif\n#endif\n#ifdef USE_CLEARCOAT\n	uniform float clearcoat;\n	uniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n	uniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n	uniform float iridescence;\n	uniform float iridescenceIOR;\n	uniform float iridescenceThicknessMinimum;\n	uniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n	uniform vec3 sheenColor;\n	uniform float sheenRoughness;\n	#ifdef USE_SHEEN_COLORMAP\n		uniform sampler2D sheenColorMap;\n	#endif\n	#ifdef USE_SHEEN_ROUGHNESSMAP\n		uniform sampler2D sheenRoughnessMap;\n	#endif\n#endif\n#ifdef USE_ANISOTROPY\n	uniform vec2 anisotropyVector;\n	#ifdef USE_ANISOTROPYMAP\n		uniform sampler2D anisotropyMap;\n	#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <roughnessmap_fragment>\n	#include <metalnessmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <clearcoat_normal_fragment_begin>\n	#include <clearcoat_normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_physical_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n	#include <transmission_fragment>\n	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n	#ifdef USE_SHEEN\n		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n	#endif\n	#ifdef USE_CLEARCOAT\n		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n	#endif\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_toon_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n	varying vec2 vUv;\n	uniform mat3 uvTransform;\n#endif\nvoid main() {\n	#ifdef USE_POINTS_UV\n		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	#endif\n	#include <color_vertex>\n	#include <morphinstance_vertex>\n	#include <morphcolor_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	gl_PointSize = size;\n	#ifdef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n	#endif\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	#include <logdepthbuf_fragment>\n	#include <map_particle_fragment>\n	#include <color_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n	#include <batching_vertex>\n	#include <beginnormal_vertex>\n	#include <morphinstance_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n	#include <logdepthbuf_fragment>\n	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n	vec2 scale;\n	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n	#ifndef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) scale *= - mvPosition.z;\n	#endif\n	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n	vec2 rotatedPosition;\n	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n	mvPosition.xy += rotatedPosition;\n	gl_Position = projectionMatrix * mvPosition;\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n}"},sH={common:{diffuse:{value:new oE(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new i$},alphaMap:{value:null},alphaMapTransform:{value:new i$},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new i$}},envmap:{envMap:{value:null},envMapRotation:{value:new i$},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new i$}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new i$}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new i$},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new i$},normalScale:{value:new iX(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new i$},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new i$}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new i$}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new i$}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new oE(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new oE(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new i$},alphaTest:{value:0},uvTransform:{value:new i$}},sprite:{diffuse:{value:new oE(16777215)},opacity:{value:1},center:{value:new iX(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new i$},alphaMap:{value:null},alphaMapTransform:{value:new i$},alphaTest:{value:0}}},sj={basic:{uniforms:sp([sH.common,sH.specularmap,sH.envmap,sH.aomap,sH.lightmap,sH.fog]),vertexShader:sz.meshbasic_vert,fragmentShader:sz.meshbasic_frag},lambert:{uniforms:sp([sH.common,sH.specularmap,sH.envmap,sH.aomap,sH.lightmap,sH.emissivemap,sH.bumpmap,sH.normalmap,sH.displacementmap,sH.fog,sH.lights,{emissive:{value:new oE(0)}}]),vertexShader:sz.meshlambert_vert,fragmentShader:sz.meshlambert_frag},phong:{uniforms:sp([sH.common,sH.specularmap,sH.envmap,sH.aomap,sH.lightmap,sH.emissivemap,sH.bumpmap,sH.normalmap,sH.displacementmap,sH.fog,sH.lights,{emissive:{value:new oE(0)},specular:{value:new oE(1118481)},shininess:{value:30}}]),vertexShader:sz.meshphong_vert,fragmentShader:sz.meshphong_frag},standard:{uniforms:sp([sH.common,sH.envmap,sH.aomap,sH.lightmap,sH.emissivemap,sH.bumpmap,sH.normalmap,sH.displacementmap,sH.roughnessmap,sH.metalnessmap,sH.fog,sH.lights,{emissive:{value:new oE(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:sz.meshphysical_vert,fragmentShader:sz.meshphysical_frag},toon:{uniforms:sp([sH.common,sH.aomap,sH.lightmap,sH.emissivemap,sH.bumpmap,sH.normalmap,sH.displacementmap,sH.gradientmap,sH.fog,sH.lights,{emissive:{value:new oE(0)}}]),vertexShader:sz.meshtoon_vert,fragmentShader:sz.meshtoon_frag},matcap:{uniforms:sp([sH.common,sH.bumpmap,sH.normalmap,sH.displacementmap,sH.fog,{matcap:{value:null}}]),vertexShader:sz.meshmatcap_vert,fragmentShader:sz.meshmatcap_frag},points:{uniforms:sp([sH.points,sH.fog]),vertexShader:sz.points_vert,fragmentShader:sz.points_frag},dashed:{uniforms:sp([sH.common,sH.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:sz.linedashed_vert,fragmentShader:sz.linedashed_frag},depth:{uniforms:sp([sH.common,sH.displacementmap]),vertexShader:sz.depth_vert,fragmentShader:sz.depth_frag},normal:{uniforms:sp([sH.common,sH.bumpmap,sH.normalmap,sH.displacementmap,{opacity:{value:1}}]),vertexShader:sz.meshnormal_vert,fragmentShader:sz.meshnormal_frag},sprite:{uniforms:sp([sH.sprite,sH.fog]),vertexShader:sz.sprite_vert,fragmentShader:sz.sprite_frag},background:{uniforms:{uvTransform:{value:new i$},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:sz.background_vert,fragmentShader:sz.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new i$}},vertexShader:sz.backgroundCube_vert,fragmentShader:sz.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:sz.cube_vert,fragmentShader:sz.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:sz.equirect_vert,fragmentShader:sz.equirect_frag},distanceRGBA:{uniforms:sp([sH.common,sH.displacementmap,{referencePosition:{value:new ag},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:sz.distanceRGBA_vert,fragmentShader:sz.distanceRGBA_frag},shadow:{uniforms:sp([sH.lights,sH.fog,{color:{value:new oE(0)},opacity:{value:1}}]),vertexShader:sz.shadow_vert,fragmentShader:sz.shadow_frag}};sj.physical={uniforms:sp([sj.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new i$},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new i$},clearcoatNormalScale:{value:new iX(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new i$},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new i$},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new i$},sheen:{value:0},sheenColor:{value:new oE(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new i$},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new i$},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new i$},transmissionSamplerSize:{value:new iX},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new i$},attenuationDistance:{value:0},attenuationColor:{value:new oE(0)},specularColor:{value:new oE(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new i$},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new i$},anisotropyVector:{value:new iX},anisotropyMap:{value:null},anisotropyMapTransform:{value:new i$}}]),vertexShader:sz.meshphysical_vert,fragmentShader:sz.meshphysical_frag};let sG={r:0,b:0,g:0},sV=new a2,sq=new aW;function sW(e,t,r,n,i,a,o){let s,l;let c=new oE(0),u=!0===a?0:1,d=null,h=0,p=null;function f(e){let n=!0===e.isScene?e.background:null;return n&&n.isTexture&&(n=(e.backgroundBlurriness>0?r:t).get(n)),n}function m(t,r){t.getRGB(sG,sm(e)),n.buffers.color.setClear(sG.r,sG.g,sG.b,r,o)}return{getClearColor:function(){return c},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;c.set(e),m(c,u=t)},getClearAlpha:function(){return u},setClearAlpha:function(e){m(c,u=e)},render:function(t){let r=!1,i=f(t);null===i?m(c,u):i&&i.isColor&&(m(i,1),r=!0);let a=e.xr.getEnvironmentBlendMode();"additive"===a?n.buffers.color.setClear(0,0,0,1,o):"alpha-blend"===a&&n.buffers.color.setClear(0,0,0,0,o),(e.autoClear||r)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,r){let n=f(r);n&&(n.isCubeTexture||n.mapping===rw)?(void 0===l&&((l=new sl(new sd(1,1,1),new sb({name:"BackgroundCubeMaterial",uniforms:sh(sj.backgroundCube.uniforms),vertexShader:sj.backgroundCube.vertexShader,fragmentShader:sj.backgroundCube.fragmentShader,side:tk,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(l)),sV.copy(r.backgroundRotation),sV.x*=-1,sV.y*=-1,sV.z*=-1,n.isCubeTexture&&!1===n.isRenderTargetTexture&&(sV.y*=-1,sV.z*=-1),l.material.uniforms.envMap.value=n,l.material.uniforms.flipEnvMap.value=n.isCubeTexture&&!1===n.isRenderTargetTexture?-1:1,l.material.uniforms.backgroundBlurriness.value=r.backgroundBlurriness,l.material.uniforms.backgroundIntensity.value=r.backgroundIntensity,l.material.uniforms.backgroundRotation.value.setFromMatrix4(sq.makeRotationFromEuler(sV)),l.material.toneMapped=i9.getTransfer(n.colorSpace)!==n0,(d!==n||h!==n.version||p!==e.toneMapping)&&(l.material.needsUpdate=!0,d=n,h=n.version,p=e.toneMapping),l.layers.enableAll(),t.unshift(l,l.geometry,l.material,0,0,null)):n&&n.isTexture&&(void 0===s&&((s=new sl(new sB(2,2),new sb({name:"BackgroundMaterial",uniforms:sh(sj.background.uniforms),vertexShader:sj.background.vertexShader,fragmentShader:sj.background.fragmentShader,side:tR,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(s)),s.material.uniforms.t2D.value=n,s.material.uniforms.backgroundIntensity.value=r.backgroundIntensity,s.material.toneMapped=i9.getTransfer(n.colorSpace)!==n0,!0===n.matrixAutoUpdate&&n.updateMatrix(),s.material.uniforms.uvTransform.value.copy(n.matrix),(d!==n||h!==n.version||p!==e.toneMapping)&&(s.material.needsUpdate=!0,d=n,h=n.version,p=e.toneMapping),s.layers.enableAll(),t.unshift(s,s.geometry,s.material,0,0,null))}}}function sZ(e,t){let r=e.getParameter(e.MAX_VERTEX_ATTRIBS),n={},i=d(null),a=i,o=!1;function s(){return e.createVertexArray()}function l(t){return e.bindVertexArray(t)}function c(t){return e.deleteVertexArray(t)}function u(e,t,r){let i=!0===r.wireframe,a=n[e.id];void 0===a&&(a={},n[e.id]=a);let o=a[t.id];void 0===o&&(o={},a[t.id]=o);let l=o[i];return void 0===l&&(l=d(s()),o[i]=l),l}function d(e){let t=[],n=[],i=[];for(let e=0;e<r;e++)t[e]=0,n[e]=0,i[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:i,object:e,attributes:{},index:null}}function h(e,t,r,n){let i=a.attributes,o=t.attributes,s=0,l=r.getAttributes();for(let t in l)if(l[t].location>=0){let r=i[t],n=o[t];if(void 0===n&&("instanceMatrix"===t&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(n=e.instanceColor)),void 0===r||r.attribute!==n||n&&r.data!==n.data)return!0;s++}return a.attributesNum!==s||a.index!==n}function p(e,t,r,n){let i={},o=t.attributes,s=0,l=r.getAttributes();for(let t in l)if(l[t].location>=0){let r=o[t];void 0===r&&("instanceMatrix"===t&&e.instanceMatrix&&(r=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(r=e.instanceColor));let n={};n.attribute=r,r&&r.data&&(n.data=r.data),i[t]=n,s++}a.attributes=i,a.attributesNum=s,a.index=n}function f(){let e=a.newAttributes;for(let t=0,r=e.length;t<r;t++)e[t]=0}function m(e){g(e,0)}function g(t,r){let n=a.newAttributes,i=a.enabledAttributes,o=a.attributeDivisors;n[t]=1,0===i[t]&&(e.enableVertexAttribArray(t),i[t]=1),o[t]!==r&&(e.vertexAttribDivisor(t,r),o[t]=r)}function y(){let t=a.newAttributes,r=a.enabledAttributes;for(let n=0,i=r.length;n<i;n++)r[n]!==t[n]&&(e.disableVertexAttribArray(n),r[n]=0)}function v(t,r,n,i,a,o,s){!0===s?e.vertexAttribIPointer(t,r,n,a,o):e.vertexAttribPointer(t,r,n,i,a,o)}function b(r,n,i,a){f();let o=a.attributes,s=i.getAttributes(),l=n.defaultAttributeValues;for(let n in s){let i=s[n];if(i.location>=0){let s=o[n];if(void 0===s&&("instanceMatrix"===n&&r.instanceMatrix&&(s=r.instanceMatrix),"instanceColor"===n&&r.instanceColor&&(s=r.instanceColor)),void 0!==s){let n=s.normalized,o=s.itemSize,l=t.get(s);if(void 0===l)continue;let c=l.buffer,u=l.type,d=l.bytesPerElement,h=u===e.INT||u===e.UNSIGNED_INT||s.gpuType===rB;if(s.isInterleavedBufferAttribute){let t=s.data,l=t.stride,p=s.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)g(i.location+e,t.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<i.locationSize;e++)m(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)v(i.location+e,o/i.locationSize,u,n,l*d,(p+o/i.locationSize*e)*d,h)}else{if(s.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)g(i.location+e,s.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let e=0;e<i.locationSize;e++)m(i.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<i.locationSize;e++)v(i.location+e,o/i.locationSize,u,n,o*d,o/i.locationSize*e*d,h)}}else if(void 0!==l){let t=l[n];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(i.location,t);break;case 3:e.vertexAttrib3fv(i.location,t);break;case 4:e.vertexAttrib4fv(i.location,t);break;default:e.vertexAttrib1fv(i.location,t)}}}}y()}function _(){for(let e in w(),n){let t=n[e];for(let e in t){let r=t[e];for(let e in r)c(r[e].object),delete r[e];delete t[e]}delete n[e]}}function w(){S(),o=!0,a!==i&&l((a=i).object)}function S(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:function(r,n,i,s,c){let d=!1,f=u(s,i,n);a!==f&&l((a=f).object),(d=h(r,s,i,c))&&p(r,s,i,c),null!==c&&t.update(c,e.ELEMENT_ARRAY_BUFFER),(d||o)&&(o=!1,b(r,n,i,s),null!==c&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(c).buffer))},reset:w,resetDefaultState:S,dispose:_,releaseStatesOfGeometry:function(e){if(void 0===n[e.id])return;let t=n[e.id];for(let e in t){let r=t[e];for(let e in r)c(r[e].object),delete r[e];delete t[e]}delete n[e.id]},releaseStatesOfProgram:function(e){for(let t in n){let r=n[t];if(void 0===r[e.id])continue;let i=r[e.id];for(let e in i)c(i[e].object),delete i[e];delete r[e.id]}},initAttributes:f,enableAttribute:m,disableUnusedAttributes:y}}function sX(e,t,r){let n;function i(e){n=e}function a(t,i){e.drawArrays(n,t,i),r.update(i,n,1)}function o(t,i,a){0!==a&&(e.drawArraysInstanced(n,t,i,a),r.update(i,n,a))}function s(e,i,a){if(0===a)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,e,0,i,0,a);let o=0;for(let e=0;e<a;e++)o+=i[e];r.update(o,n,1)}function l(e,i,a,s){if(0===a)return;let l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)o(e[t],i[t],s[t]);else{l.multiDrawArraysInstancedWEBGL(n,e,0,i,0,s,0,a);let t=0;for(let e=0;e<a;e++)t+=i[e];for(let e=0;e<s.length;e++)r.update(t,n,s[e])}}this.setMode=i,this.render=a,this.renderInstances=o,this.renderMultiDraw=s,this.renderMultiDrawInstances=l}function s$(e,t,r,n){let i;function a(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){let r=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(t){return t===r$||n.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)}function s(r){let i=r===rj&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return r===rL||n.convert(r)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)||r===rH||!!i}function l(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=void 0!==r.precision?r.precision:"highp",u=l(c);u!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);let d=!0===r.logarithmicDepthBuffer,h=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),p=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=e.getParameter(e.MAX_TEXTURE_SIZE),m=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),g=e.getParameter(e.MAX_VERTEX_ATTRIBS),y=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),v=e.getParameter(e.MAX_VARYING_VECTORS),b=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),_=p>0;return{isWebGL2:!0,getMaxAnisotropy:a,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:s,precision:c,logarithmicDepthBuffer:d,maxTextures:h,maxVertexTextures:p,maxTextureSize:f,maxCubemapSize:m,maxAttributes:g,maxVertexUniforms:y,maxVaryings:v,maxFragmentUniforms:b,vertexTextures:_,maxSamples:e.getParameter(e.MAX_SAMPLES)}}function sK(e){let t=this,r=null,n=0,i=!1,a=!1,o=new sO,s=new i$,l={value:null,needsUpdate:!1};function c(){l.value!==r&&(l.value=r,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(e,r,n,i){let a=null!==e?e.length:0,c=null;if(0!==a){if(c=l.value,!0!==i||null===c){let t=n+4*a,i=r.matrixWorldInverse;s.getNormalMatrix(i),(null===c||c.length<t)&&(c=new Float32Array(t));for(let t=0,r=n;t!==a;++t,r+=4)o.copy(e[t]).applyMatrix4(i,s),o.normal.toArray(c,r),c[r+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){let r=0!==e.length||t||0!==n||i;return i=t,n=e.length,r},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(e,t){r=u(e,t,0)},this.setState=function(t,o,s){let d=t.clippingPlanes,h=t.clipIntersection,p=t.clipShadows,f=e.get(t);if(i&&null!==d&&0!==d.length&&(!a||p)){let e=a?0:n,t=4*e,i=f.clippingState||null;l.value=i,i=u(d,o,t,s);for(let e=0;e!==t;++e)i[e]=r[e];f.clippingState=i,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=e}else a?u(null):c()}}function sY(e){let t=new WeakMap;function r(e,t){return t===rb?e.mapping=ry:t===r_&&(e.mapping=rv),e}function n(e){let r=e.target;r.removeEventListener("dispose",n);let i=t.get(r);void 0!==i&&(t.delete(r),i.dispose())}return{get:function(i){if(i&&i.isTexture){let a=i.mapping;if(a===rb||a===r_){if(t.has(i))return r(t.get(i).texture,i.mapping);{let a=i.image;if(!a||!(a.height>0))return null;{let o=new sI(a.height);return o.fromEquirectangularTexture(e,i),t.set(i,o),i.addEventListener("dispose",n),r(o.texture,i.mapping)}}}}return i},dispose:function(){t=new WeakMap}}}class sQ extends s_{copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,r,n,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-e,a=r+e,o=n+t,s=n-t;if(null!==this.view&&this.view.enabled){let e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,a=i+e*this.view.width,o-=t*this.view.offsetY,s=o-t*this.view.height}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}constructor(e=-1,t=1,r=1,n=-1,i=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=i,this.far=a,this.updateProjectionMatrix()}}let sJ=4,s0=[.125,.215,.35,.446,.526,.582],s1=20,s2=new sQ,s3=new oE,s4=null,s5=0,s6=0,s8=!1,s7=(1+Math.sqrt(5))/2,s9=1/s7,le=[new ag(-s7,s9,0),new ag(s7,s9,0),new ag(-s9,0,s7),new ag(s9,0,s7),new ag(0,s7,-s9),new ag(0,s7,s9),new ag(-1,1,-1),new ag(1,1,-1),new ag(-1,1,1),new ag(1,1,1)];class lt{fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;s4=this._renderer.getRenderTarget(),s5=this._renderer.getActiveCubeFace(),s6=this._renderer.getActiveMipmapLevel(),s8=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);let i=this._allocateTargets();return i.depthBuffer=!0,this._sceneToCubeUV(e,r,n,i),t>0&&this._blur(i,0,0,t),this._applyPMREM(i),this._cleanup(i),i}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=ls(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=lo(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(s4,s5,s6),this._renderer.xr.enabled=s8,e.scissorTest=!1,li(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ry||e.mapping===rv?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),s4=this._renderer.getRenderTarget(),s5=this._renderer.getActiveCubeFace(),s6=this._renderer.getActiveMipmapLevel(),s8=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:rR,minFilter:rR,generateMipmaps:!1,type:rj,format:r$,colorSpace:nK,depthBuffer:!1},n=ln(e,t,r);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=ln(e,t,r);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=lr(n)),this._blurMaterial=la(n,e,t)}return n}_compileMaterial(e){let t=new sl(this._lodPlanes[0],e);this._renderer.compile(t,s2)}_sceneToCubeUV(e,t,r,n){let i=new sx(90,1,t,r),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,c=s.toneMapping;s.getClearColor(s3),s.toneMapping=ro,s.autoClear=!1;let u=new oI({name:"PMREM.Background",side:tk,depthWrite:!1,depthTest:!1}),d=new sl(new sd,u),h=!1,p=e.background;p?p.isColor&&(u.color.copy(p),e.background=null,h=!0):(u.color.copy(s3),h=!0);for(let t=0;t<6;t++){let r=t%3;0===r?(i.up.set(0,a[t],0),i.lookAt(o[t],0,0)):1===r?(i.up.set(0,0,a[t]),i.lookAt(0,o[t],0)):(i.up.set(0,a[t],0),i.lookAt(0,0,o[t]));let l=this._cubeSize;li(n,r*l,t>2?l:0,l,l),s.setRenderTarget(n),h&&s.render(d,i),s.render(e,i)}d.geometry.dispose(),d.material.dispose(),s.toneMapping=c,s.autoClear=l,e.background=p}_textureToCubeUV(e,t){let r=this._renderer,n=e.mapping===ry||e.mapping===rv;n?(null===this._cubemapMaterial&&(this._cubemapMaterial=ls()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=lo());let i=n?this._cubemapMaterial:this._equirectMaterial,a=new sl(this._lodPlanes[0],i);i.uniforms.envMap.value=e;let o=this._cubeSize;li(t,0,0,3*o,2*o),r.setRenderTarget(t),r.render(a,s2)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;let n=this._lodPlanes.length;for(let t=1;t<n;t++){let r=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),i=le[(n-t-1)%le.length];this._blur(e,t-1,t,r,i)}t.autoClear=r}_blur(e,t,r,n,i){let a=this._pingPongRenderTarget;this._halfBlur(e,a,t,r,n,"latitudinal",i),this._halfBlur(a,e,r,r,n,"longitudinal",i)}_halfBlur(e,t,r,n,i,a,o){let s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,u=new sl(this._lodPlanes[n],l),d=l.uniforms,h=this._sizeLods[r]-1,p=isFinite(i)?Math.PI/(2*h):2*Math.PI/(2*s1-1),f=i/p,m=isFinite(i)?1+Math.floor(c*f):s1;m>s1&&console.warn("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(m," samples when the maximum is set to ").concat(s1));let g=[],y=0;for(let e=0;e<s1;++e){let t=e/f,r=Math.exp(-t*t/2);g.push(r),0===e?y+=r:e<m&&(y+=2*r)}for(let e=0;e<g.length;e++)g[e]=g[e]/y;d.envMap.value=e.texture,d.samples.value=m,d.weights.value=g,d.latitudinal.value="latitudinal"===a,o&&(d.poleAxis.value=o);let{_lodMax:v}=this;d.dTheta.value=p,d.mipInt.value=v-r;let b=this._sizeLods[n];li(t,3*b*(n>v-sJ?n-v+sJ:0),4*(this._cubeSize-b),3*b,2*b),s.setRenderTarget(t),s.render(u,s2)}constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}}function lr(e){let t=[],r=[],n=[],i=e,a=e-sJ+1+s0.length;for(let o=0;o<a;o++){let a=Math.pow(2,i);r.push(a);let s=1/a;o>e-sJ?s=s0[o-e+sJ-1]:0===o&&(s=0),n.push(s);let l=1/(a-2),c=-l,u=1+l,d=[c,c,u,c,u,u,c,c,u,u,c,u],h=6,p=6,f=3,m=2,g=1,y=new Float32Array(108),v=new Float32Array(m*p*h),b=new Float32Array(g*p*h);for(let e=0;e<h;e++){let t=e%3*2/3-1,r=e>2?0:-1,n=[t,r,0,t+2/3,r,0,t+2/3,r+1,0,t,r,0,t+2/3,r+1,0,t,r+1,0];y.set(n,f*p*e),v.set(d,m*p*e);let i=[e,e,e,e,e,e];b.set(i,g*p*e)}let _=new o0;_.setAttribute("position",new oU(y,f)),_.setAttribute("uv",new oU(v,m)),_.setAttribute("faceIndex",new oU(b,g)),t.push(_),i>sJ&&i--}return{lodPlanes:t,sizeLods:r,sigmas:n}}function ln(e,t,r){let n=new au(e,t,r);return n.texture.mapping=rw,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function li(e,t,r,n,i){e.viewport.set(t,r,n,i),e.scissor.set(t,r,n,i)}function la(e,t,r){let n=new Float32Array(s1),i=new ag(0,1,0);return new sb({name:"SphericalGaussianBlur",defines:{n:s1,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:ll(),fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			varying vec3 vOutputDirection;\n\n			uniform sampler2D envMap;\n			uniform int samples;\n			uniform float weights[ n ];\n			uniform bool latitudinal;\n			uniform float dTheta;\n			uniform float mipInt;\n			uniform vec3 poleAxis;\n\n			#define ENVMAP_TYPE_CUBE_UV\n			#include <cube_uv_reflection_fragment>\n\n			vec3 getSample( float theta, vec3 axis ) {\n\n				float cosTheta = cos( theta );\n				// Rodrigues' axis-angle rotation\n				vec3 sampleDirection = vOutputDirection * cosTheta\n					+ cross( axis, vOutputDirection ) * sin( theta )\n					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n				return bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n			}\n\n			void main() {\n\n				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n				}\n\n				axis = normalize( axis );\n\n				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n				for ( int i = 1; i < n; i++ ) {\n\n					if ( i >= samples ) {\n\n						break;\n\n					}\n\n					float theta = dTheta * float( i );\n					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n				}\n\n			}\n		",blending:tO,depthTest:!1,depthWrite:!1})}function lo(){return new sb({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:ll(),fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			varying vec3 vOutputDirection;\n\n			uniform sampler2D envMap;\n\n			#include <common>\n\n			void main() {\n\n				vec3 outputDirection = normalize( vOutputDirection );\n				vec2 uv = equirectUv( outputDirection );\n\n				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n			}\n		",blending:tO,depthTest:!1,depthWrite:!1})}function ls(){return new sb({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:ll(),fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			uniform float flipEnvMap;\n\n			varying vec3 vOutputDirection;\n\n			uniform samplerCube envMap;\n\n			void main() {\n\n				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n			}\n		",blending:tO,depthTest:!1,depthWrite:!1})}function ll(){return"\n\n		precision mediump float;\n		precision mediump int;\n\n		attribute float faceIndex;\n\n		varying vec3 vOutputDirection;\n\n		// RH coordinate system; PMREM face-indexing convention\n		vec3 getDirection( vec2 uv, float face ) {\n\n			uv = 2.0 * uv - 1.0;\n\n			vec3 direction = vec3( uv, 1.0 );\n\n			if ( face == 0.0 ) {\n\n				direction = direction.zyx; // ( 1, v, u ) pos x\n\n			} else if ( face == 1.0 ) {\n\n				direction = direction.xzy;\n				direction.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n			} else if ( face == 2.0 ) {\n\n				direction.x *= -1.0; // ( -u, v, 1 ) pos z\n\n			} else if ( face == 3.0 ) {\n\n				direction = direction.zyx;\n				direction.xz *= -1.0; // ( -1, v, -u ) neg x\n\n			} else if ( face == 4.0 ) {\n\n				direction = direction.xzy;\n				direction.xy *= -1.0; // ( -u, -1, v ) neg y\n\n			} else if ( face == 5.0 ) {\n\n				direction.z *= -1.0; // ( u, v, -1 ) neg z\n\n			}\n\n			return direction;\n\n		}\n\n		void main() {\n\n			vOutputDirection = getDirection( uv, faceIndex );\n			gl_Position = vec4( position, 1.0 );\n\n		}\n	"}function lc(e){let t=new WeakMap,r=null;function n(e){let t=0,r=6;for(let n=0;n<r;n++)void 0!==e[n]&&t++;return t===r}function i(e){let r=e.target;r.removeEventListener("dispose",i);let n=t.get(r);void 0!==n&&(t.delete(r),n.dispose())}return{get:function(a){if(a&&a.isTexture){let o=a.mapping,s=o===rb||o===r_,l=o===ry||o===rv;if(s||l){let o=t.get(a),c=void 0!==o?o.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==c)return null===r&&(r=new lt(e)),(o=s?r.fromEquirectangular(a,o):r.fromCubemap(a,o)).texture.pmremVersion=a.pmremVersion,t.set(a,o),o.texture;if(void 0!==o)return o.texture;{let c=a.image;return s&&c&&c.height>0||l&&c&&n(c)?(null===r&&(r=new lt(e)),(o=s?r.fromEquirectangular(a):r.fromCubemap(a)).texture.pmremVersion=a.pmremVersion,t.set(a,o),a.addEventListener("dispose",i),o.texture):null}}}return a},dispose:function(){t=new WeakMap,null!==r&&(r.dispose(),r=null)}}}function lu(e){let t={};function r(r){let n;if(void 0!==t[r])return t[r];switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(r)}return t[r]=n,n}return{has:function(e){return null!==r(e)},init:function(){r("EXT_color_buffer_float"),r("WEBGL_clip_cull_distance"),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture"),r("WEBGL_render_shared_exponent")},get:function(e){let t=r(e);return null===t&&i3("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function ld(e,t,r,n){let i={},a=new WeakMap;function o(e){let s=e.target;for(let e in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[e]);for(let e in s.morphAttributes){let r=s.morphAttributes[e];for(let e=0,n=r.length;e<n;e++)t.remove(r[e])}s.removeEventListener("dispose",o),delete i[s.id];let l=a.get(s);l&&(t.remove(l),a.delete(s)),n.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,r.memory.geometries--}function s(e){let r=[],n=e.index,i=e.attributes.position,o=0;if(null!==n){let e=n.array;o=n.version;for(let t=0,n=e.length;t<n;t+=3){let n=e[t+0],i=e[t+1],a=e[t+2];r.push(n,i,i,a,a,n)}}else{if(void 0===i)return;let e=i.array;o=i.version;for(let t=0,n=e.length/3-1;t<n;t+=3){let e=t+0,n=t+1,i=t+2;r.push(e,n,n,i,i,e)}}let s=new(iY(r)?oV:oj)(r,1);s.version=o;let l=a.get(e);l&&t.remove(l),a.set(e,s)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",o),i[t.id]=!0,r.memory.geometries++),t},update:function(r){let n=r.attributes;for(let r in n)t.update(n[r],e.ARRAY_BUFFER);let i=r.morphAttributes;for(let r in i){let n=i[r];for(let r=0,i=n.length;r<i;r++)t.update(n[r],e.ARRAY_BUFFER)}},getWireframeAttribute:function(e){let t=a.get(e);if(t){let r=e.index;null!==r&&t.version<r.version&&s(e)}else s(e);return a.get(e)}}}function lh(e,t,r){let n,i,a;function o(e){n=e}function s(e){i=e.type,a=e.bytesPerElement}function l(t,o){e.drawElements(n,o,i,t*a),r.update(o,n,1)}function c(t,o,s){0!==s&&(e.drawElementsInstanced(n,o,i,t*a,s),r.update(o,n,s))}function u(e,a,o){if(0===o)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,a,0,i,e,0,o);let s=0;for(let e=0;e<o;e++)s+=a[e];r.update(s,n,1)}function d(e,o,s,l){if(0===s)return;let u=t.get("WEBGL_multi_draw");if(null===u)for(let t=0;t<e.length;t++)c(e[t]/a,o[t],l[t]);else{u.multiDrawElementsInstancedWEBGL(n,o,0,i,e,0,l,0,s);let t=0;for(let e=0;e<s;e++)t+=o[e];for(let e=0;e<l.length;e++)r.update(t,n,l[e])}}this.setMode=o,this.setIndex=s,this.render=l,this.renderInstances=c,this.renderMultiDraw=u,this.renderMultiDrawInstances=d}function lp(e){let t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(r,n,i){switch(t.calls++,n){case e.TRIANGLES:t.triangles+=r/3*i;break;case e.LINES:t.lines+=r/2*i;break;case e.LINE_STRIP:t.lines+=i*(r-1);break;case e.LINE_LOOP:t.lines+=i*r;break;case e.POINTS:t.points+=i*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}function n(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:n,update:r}}function lf(e,t,r){let n=new WeakMap,i=new al;return{update:function(a,o,s){let l=a.morphTargetInfluences,c=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,u=void 0!==c?c.length:0,d=n.get(o);if(void 0===d||d.count!==u){void 0!==d&&d.texture.dispose();let e=void 0!==o.morphAttributes.position,r=void 0!==o.morphAttributes.normal,a=void 0!==o.morphAttributes.color,s=o.morphAttributes.position||[],l=o.morphAttributes.normal||[],c=o.morphAttributes.color||[],p=0;!0===e&&(p=1),!0===r&&(p=2),!0===a&&(p=3);let f=o.attributes.position.count*p,m=1;f>t.maxTextureSize&&(m=Math.ceil(f/t.maxTextureSize),f=t.maxTextureSize);let g=new Float32Array(f*m*4*u),y=new ad(g,f,m,u);y.type=rH,y.needsUpdate=!0;let v=4*p;for(let t=0;t<u;t++){let n=s[t],o=l[t],u=c[t],d=f*m*4*t;for(let t=0;t<n.count;t++){let s=t*v;!0===e&&(i.fromBufferAttribute(n,t),g[d+s+0]=i.x,g[d+s+1]=i.y,g[d+s+2]=i.z,g[d+s+3]=0),!0===r&&(i.fromBufferAttribute(o,t),g[d+s+4]=i.x,g[d+s+5]=i.y,g[d+s+6]=i.z,g[d+s+7]=0),!0===a&&(i.fromBufferAttribute(u,t),g[d+s+8]=i.x,g[d+s+9]=i.y,g[d+s+10]=i.z,g[d+s+11]=4===u.itemSize?i.w:1)}}function h(){y.dispose(),n.delete(o),o.removeEventListener("dispose",h)}d={count:u,texture:y,size:new iX(f,m)},n.set(o,d),o.addEventListener("dispose",h)}if(!0===a.isInstancedMesh&&null!==a.morphTexture)s.getUniforms().setValue(e,"morphTexture",a.morphTexture,r);else{let t=0;for(let e=0;e<l.length;e++)t+=l[e];let r=o.morphTargetsRelative?1:1-t;s.getUniforms().setValue(e,"morphTargetBaseInfluence",r),s.getUniforms().setValue(e,"morphTargetInfluences",l)}s.getUniforms().setValue(e,"morphTargetsTexture",d.texture,r),s.getUniforms().setValue(e,"morphTargetsTextureSize",d.size)}}}function lm(e,t,r,n){let i=new WeakMap;function a(e){let t=e.target;t.removeEventListener("dispose",a),r.remove(t.instanceMatrix),null!==t.instanceColor&&r.remove(t.instanceColor)}return{update:function(o){let s=n.render.frame,l=o.geometry,c=t.get(o,l);if(i.get(c)!==s&&(t.update(c),i.set(c,s)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",a)&&o.addEventListener("dispose",a),i.get(o)!==s&&(r.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&r.update(o.instanceColor,e.ARRAY_BUFFER),i.set(o,s))),o.isSkinnedMesh){let e=o.skeleton;i.get(e)!==s&&(e.update(),i.set(e,s))}return c},dispose:function(){i=new WeakMap}}}class lg extends as{copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}constructor(e,t,r,n,i,a,o,s,l,c=rQ){if(c!==rQ&&c!==rJ)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&c===rQ&&(r=rz),void 0===r&&c===rJ&&(r=rq),super(null,n,i,a,o,s,c,r,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==o?o:rE,this.minFilter=void 0!==s?s:rE,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}}let ly=new as,lv=new lg(1,1),lb=new ad,l_=new ap,lw=new sM,lS=[],lT=[],lx=new Float32Array(16),lE=new Float32Array(9),lC=new Float32Array(4);function lA(e,t,r){let n=e[0];if(n<=0||n>0)return e;let i=t*r,a=lS[i];if(void 0===a&&(a=new Float32Array(i),lS[i]=a),0!==t){n.toArray(a,0);for(let n=1,i=0;n!==t;++n)i+=r,e[n].toArray(a,i)}return a}function lM(e,t){if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function lI(e,t){for(let r=0,n=t.length;r<n;r++)e[r]=t[r]}function lR(e,t){let r=lT[t];void 0===r&&(r=new Int32Array(t),lT[t]=r);for(let n=0;n!==t;++n)r[n]=e.allocateTextureUnit();return r}function lk(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function lP(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(lM(r,t))return;e.uniform2fv(this.addr,t),lI(r,t)}}function lO(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(lM(r,t))return;e.uniform3fv(this.addr,t),lI(r,t)}}function lN(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(lM(r,t))return;e.uniform4fv(this.addr,t),lI(r,t)}}function lL(e,t){let r=this.cache,n=t.elements;if(void 0===n){if(lM(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),lI(r,t)}else{if(lM(r,n))return;lC.set(n),e.uniformMatrix2fv(this.addr,!1,lC),lI(r,n)}}function lD(e,t){let r=this.cache,n=t.elements;if(void 0===n){if(lM(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),lI(r,t)}else{if(lM(r,n))return;lE.set(n),e.uniformMatrix3fv(this.addr,!1,lE),lI(r,n)}}function lU(e,t){let r=this.cache,n=t.elements;if(void 0===n){if(lM(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),lI(r,t)}else{if(lM(r,n))return;lx.set(n),e.uniformMatrix4fv(this.addr,!1,lx),lI(r,n)}}function lF(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function lB(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(lM(r,t))return;e.uniform2iv(this.addr,t),lI(r,t)}}function lz(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(lM(r,t))return;e.uniform3iv(this.addr,t),lI(r,t)}}function lH(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(lM(r,t))return;e.uniform4iv(this.addr,t),lI(r,t)}}function lj(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function lG(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(lM(r,t))return;e.uniform2uiv(this.addr,t),lI(r,t)}}function lV(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(lM(r,t))return;e.uniform3uiv(this.addr,t),lI(r,t)}}function lq(e,t){let r=this.cache;if(void 0!==t.x)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(lM(r,t))return;e.uniform4uiv(this.addr,t),lI(r,t)}}function lW(e,t,r){let n;let i=this.cache,a=r.allocateTextureUnit();i[0]!==a&&(e.uniform1i(this.addr,a),i[0]=a),this.type===e.SAMPLER_2D_SHADOW?(lv.compareFunction=ip,n=lv):n=ly,r.setTexture2D(t||n,a)}function lZ(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(t||l_,i)}function lX(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTextureCube(t||lw,i)}function l$(e,t,r){let n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2DArray(t||lb,i)}function lK(e){switch(e){case 5126:return lk;case 35664:return lP;case 35665:return lO;case 35666:return lN;case 35674:return lL;case 35675:return lD;case 35676:return lU;case 5124:case 35670:return lF;case 35667:case 35671:return lB;case 35668:case 35672:return lz;case 35669:case 35673:return lH;case 5125:return lj;case 36294:return lG;case 36295:return lV;case 36296:return lq;case 35678:case 36198:case 36298:case 36306:case 35682:return lW;case 35679:case 36299:case 36307:return lZ;case 35680:case 36300:case 36308:case 36293:return lX;case 36289:case 36303:case 36311:case 36292:return l$}}function lY(e,t){e.uniform1fv(this.addr,t)}function lQ(e,t){let r=lA(t,this.size,2);e.uniform2fv(this.addr,r)}function lJ(e,t){let r=lA(t,this.size,3);e.uniform3fv(this.addr,r)}function l0(e,t){let r=lA(t,this.size,4);e.uniform4fv(this.addr,r)}function l1(e,t){let r=lA(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function l2(e,t){let r=lA(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function l3(e,t){let r=lA(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function l4(e,t){e.uniform1iv(this.addr,t)}function l5(e,t){e.uniform2iv(this.addr,t)}function l6(e,t){e.uniform3iv(this.addr,t)}function l8(e,t){e.uniform4iv(this.addr,t)}function l7(e,t){e.uniform1uiv(this.addr,t)}function l9(e,t){e.uniform2uiv(this.addr,t)}function ce(e,t){e.uniform3uiv(this.addr,t)}function ct(e,t){e.uniform4uiv(this.addr,t)}function cr(e,t,r){let n=this.cache,i=t.length,a=lR(r,i);lM(n,a)||(e.uniform1iv(this.addr,a),lI(n,a));for(let e=0;e!==i;++e)r.setTexture2D(t[e]||ly,a[e])}function cn(e,t,r){let n=this.cache,i=t.length,a=lR(r,i);lM(n,a)||(e.uniform1iv(this.addr,a),lI(n,a));for(let e=0;e!==i;++e)r.setTexture3D(t[e]||l_,a[e])}function ci(e,t,r){let n=this.cache,i=t.length,a=lR(r,i);lM(n,a)||(e.uniform1iv(this.addr,a),lI(n,a));for(let e=0;e!==i;++e)r.setTextureCube(t[e]||lw,a[e])}function ca(e,t,r){let n=this.cache,i=t.length,a=lR(r,i);lM(n,a)||(e.uniform1iv(this.addr,a),lI(n,a));for(let e=0;e!==i;++e)r.setTexture2DArray(t[e]||lb,a[e])}function co(e){switch(e){case 5126:return lY;case 35664:return lQ;case 35665:return lJ;case 35666:return l0;case 35674:return l1;case 35675:return l2;case 35676:return l3;case 5124:case 35670:return l4;case 35667:case 35671:return l5;case 35668:case 35672:return l6;case 35669:case 35673:return l8;case 5125:return l7;case 36294:return l9;case 36295:return ce;case 36296:return ct;case 35678:case 36198:case 36298:case 36306:case 35682:return cr;case 35679:case 36299:case 36307:return cn;case 35680:case 36300:case 36308:case 36293:return ci;case 36289:case 36303:case 36311:case 36292:return ca}}class cs{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=lK(t.type)}}class cl{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=co(t.type)}}class cc{setValue(e,t,r){let n=this.seq;for(let i=0,a=n.length;i!==a;++i){let a=n[i];a.setValue(e,t[a.id],r)}}constructor(e){this.id=e,this.seq=[],this.map={}}}let cu=/(\w+)(\])?(\[|\.)?/g;function cd(e,t){e.seq.push(t),e.map[t.id]=t}function ch(e,t,r){let n=e.name,i=n.length;for(cu.lastIndex=0;;){let a=cu.exec(n),o=cu.lastIndex,s=a[1],l="]"===a[2],c=a[3];if(l&&(s|=0),void 0===c||"["===c&&o+2===i){cd(r,void 0===c?new cs(s,e,t):new cl(s,e,t));break}{let e=r.map[s];void 0===e&&cd(r,e=new cc(s)),r=e}}}class cp{setValue(e,t,r,n){let i=this.map[t];void 0!==i&&i.setValue(e,r,n)}setOptional(e,t,r){let n=t[r];void 0!==n&&this.setValue(e,r,n)}static upload(e,t,r,n){for(let i=0,a=t.length;i!==a;++i){let a=t[i],o=r[a.id];!1!==o.needsUpdate&&a.setValue(e,o.value,n)}}static seqWithValue(e,t){let r=[];for(let n=0,i=e.length;n!==i;++n){let i=e[n];i.id in t&&r.push(i)}return r}constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let n=0;n<r;++n){let r=e.getActiveUniform(t,n),i=e.getUniformLocation(t,r.name);ch(r,i,this)}}}function cf(e,t,r){let n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}let cm=37297,cg=0;function cy(e,t){let r=e.split("\n"),n=[],i=Math.max(t-6,0),a=Math.min(t+6,r.length);for(let e=i;e<a;e++){let i=e+1;n.push("".concat(i===t?">":" "," ").concat(i,": ").concat(r[e]))}return n.join("\n")}function cv(e){let t;let r=i9.getPrimaries(i9.workingColorSpace),n=i9.getPrimaries(e);switch(r===n?t="":r===n2&&n===n1?t="LinearDisplayP3ToLinearSRGB":r===n1&&n===n2&&(t="LinearSRGBToLinearDisplayP3"),e){case nK:case nQ:return[t,"LinearTransferOETF"];case n$:case nY:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",e),[t,"LinearTransferOETF"]}}function cb(e,t,r){let n=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(n&&""===i)return"";let a=/ERROR: 0:(\d+)/.exec(i);if(!a)return i;{let n=parseInt(a[1]);return r.toUpperCase()+"\n\n"+i+"\n\n"+cy(e.getShaderSource(t),n)}}function c_(e,t){let r=cv(t);return"vec4 ".concat(e,"( vec4 value ) { return ").concat(r[0],"( ").concat(r[1],"( value ) ); }")}function cw(e,t){let r;switch(t){case rs:r="Linear";break;case rl:r="Reinhard";break;case rc:r="OptimizedCineon";break;case ru:r="ACESFilmic";break;case rh:r="AgX";break;case rp:r="Neutral";break;case rd:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}let cS=new ag;function cT(){i9.getLuminanceCoefficients(cS);let e=cS.x.toFixed(4),t=cS.y.toFixed(4),r=cS.z.toFixed(4);return["float luminance( const in vec3 rgb ) {","	const vec3 weights = vec3( ".concat(e,", ").concat(t,", ").concat(r," );"),"	return dot( weights, rgb );","}"].join("\n")}function cx(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(cA).join("\n")}function cE(e){let t=[];for(let r in e){let n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}function cC(e,t){let r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){let n=e.getActiveAttrib(t,i),a=n.name,o=1;n.type===e.FLOAT_MAT2&&(o=2),n.type===e.FLOAT_MAT3&&(o=3),n.type===e.FLOAT_MAT4&&(o=4),r[a]={type:n.type,location:e.getAttribLocation(t,a),locationSize:o}}return r}function cA(e){return""!==e}function cM(e,t){let r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function cI(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}let cR=/^[ \t]*#include +<([\w\d./]+)>/gm;function ck(e){return e.replace(cR,cO)}let cP=new Map;function cO(e,t){let r=sz[t];if(void 0===r){let e=cP.get(t);if(void 0!==e)r=sz[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e);else throw Error("Can not resolve #include <"+t+">")}return ck(r)}let cN=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function cL(e){return e.replace(cN,cD)}function cD(e,t,r,n){let i="";for(let e=parseInt(t);e<parseInt(r);e++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return i}function cU(e){let t="precision ".concat(e.precision," float;\n	precision ").concat(e.precision," int;\n	precision ").concat(e.precision," sampler2D;\n	precision ").concat(e.precision," samplerCube;\n	precision ").concat(e.precision," sampler3D;\n	precision ").concat(e.precision," sampler2DArray;\n	precision ").concat(e.precision," sampler2DShadow;\n	precision ").concat(e.precision," samplerCubeShadow;\n	precision ").concat(e.precision," sampler2DArrayShadow;\n	precision ").concat(e.precision," isampler2D;\n	precision ").concat(e.precision," isampler3D;\n	precision ").concat(e.precision," isamplerCube;\n	precision ").concat(e.precision," isampler2DArray;\n	precision ").concat(e.precision," usampler2D;\n	precision ").concat(e.precision," usampler3D;\n	precision ").concat(e.precision," usamplerCube;\n	precision ").concat(e.precision," usampler2DArray;\n	");return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function cF(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===tA?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===tM?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===tI&&(t="SHADOWMAP_TYPE_VSM"),t}function cB(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case ry:case rv:t="ENVMAP_TYPE_CUBE";break;case rw:t="ENVMAP_TYPE_CUBE_UV"}return t}function cz(e){let t="ENVMAP_MODE_REFLECTION";return e.envMap&&e.envMapMode===rv&&(t="ENVMAP_MODE_REFRACTION"),t}function cH(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case rn:t="ENVMAP_BLENDING_MULTIPLY";break;case ri:t="ENVMAP_BLENDING_MIX";break;case ra:t="ENVMAP_BLENDING_ADD"}return t}function cj(e){let t=e.envMapCubeUVHeight;if(null===t)return null;let r=Math.log2(t)-2;return{texelWidth:1/(3*Math.max(Math.pow(2,r),112)),texelHeight:1/t,maxMip:r}}function cG(e,t,r,n){let i,a,o,s;let l=e.getContext(),c=r.defines,u=r.vertexShader,d=r.fragmentShader,h=cF(r),p=cB(r),f=cz(r),m=cH(r),g=cj(r),y=cx(r),v=cE(c),b=l.createProgram(),_=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?((i=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,v].filter(cA).join("\n")).length>0&&(i+="\n"),(a=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,v].filter(cA).join("\n")).length>0&&(a+="\n")):(i=[cU(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,v,r.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",r.batching?"#define USE_BATCHING":"",r.batchingColor?"#define USE_BATCHING_COLOR":"",r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.instancingMorph?"#define USE_INSTANCING_MORPH":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+f:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.displacementMap?"#define USE_DISPLACEMENTMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.mapUv?"#define MAP_UV "+r.mapUv:"",r.alphaMapUv?"#define ALPHAMAP_UV "+r.alphaMapUv:"",r.lightMapUv?"#define LIGHTMAP_UV "+r.lightMapUv:"",r.aoMapUv?"#define AOMAP_UV "+r.aoMapUv:"",r.emissiveMapUv?"#define EMISSIVEMAP_UV "+r.emissiveMapUv:"",r.bumpMapUv?"#define BUMPMAP_UV "+r.bumpMapUv:"",r.normalMapUv?"#define NORMALMAP_UV "+r.normalMapUv:"",r.displacementMapUv?"#define DISPLACEMENTMAP_UV "+r.displacementMapUv:"",r.metalnessMapUv?"#define METALNESSMAP_UV "+r.metalnessMapUv:"",r.roughnessMapUv?"#define ROUGHNESSMAP_UV "+r.roughnessMapUv:"",r.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+r.anisotropyMapUv:"",r.clearcoatMapUv?"#define CLEARCOATMAP_UV "+r.clearcoatMapUv:"",r.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+r.clearcoatNormalMapUv:"",r.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+r.clearcoatRoughnessMapUv:"",r.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+r.iridescenceMapUv:"",r.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+r.iridescenceThicknessMapUv:"",r.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+r.sheenColorMapUv:"",r.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+r.sheenRoughnessMapUv:"",r.specularMapUv?"#define SPECULARMAP_UV "+r.specularMapUv:"",r.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+r.specularColorMapUv:"",r.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+r.specularIntensityMapUv:"",r.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+r.transmissionMapUv:"",r.thicknessMapUv?"#define THICKNESSMAP_UV "+r.thicknessMapUv:"",r.vertexTangents&&!1===r.flatShading?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.morphColors?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif","\n"].filter(cA).join("\n"),a=[cU(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,v,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+p:"",r.envMap?"#define "+f:"",r.envMap?"#define "+m:"",g?"#define CUBEUV_TEXEL_WIDTH "+g.texelWidth:"",g?"#define CUBEUV_TEXEL_HEIGHT "+g.texelHeight:"",g?"#define CUBEUV_MAX_MIP "+g.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.dispersion?"#define USE_DISPERSION":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.vertexTangents&&!1===r.flatShading?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor||r.batchingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+h:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==ro?"#define TONE_MAPPING":"",r.toneMapping!==ro?sz.tonemapping_pars_fragment:"",r.toneMapping!==ro?cw("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",sz.colorspace_pars_fragment,c_("linearToOutputTexel",r.outputColorSpace),cT(),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(cA).join("\n")),u=cI(u=cM(u=ck(u),r),r),d=cI(d=cM(d=ck(d),r),r),u=cL(u),d=cL(d),!0!==r.isRawShaderMaterial&&(_="#version 300 es\n",i=[y,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+i,a=["#define varying in",r.glslVersion===iI?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===iI?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+a);let w=_+i+u,S=_+a+d,T=cf(l,l.VERTEX_SHADER,w),x=cf(l,l.FRAGMENT_SHADER,S);function E(t){if(e.debug.checkShaderErrors){let r=l.getProgramInfoLog(b).trim(),n=l.getShaderInfoLog(T).trim(),o=l.getShaderInfoLog(x).trim(),s=!0,c=!0;if(!1===l.getProgramParameter(b,l.LINK_STATUS)){if(s=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(l,b,T,x);else{let e=cb(l,T,"vertex"),n=cb(l,x,"fragment");console.error("THREE.WebGLProgram: Shader Error "+l.getError()+" - VALIDATE_STATUS "+l.getProgramParameter(b,l.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+r+"\n"+e+"\n"+n)}}else""!==r?console.warn("THREE.WebGLProgram: Program Info Log:",r):(""===n||""===o)&&(c=!1);c&&(t.diagnostics={runnable:s,programLog:r,vertexShader:{log:n,prefix:i},fragmentShader:{log:o,prefix:a}})}l.deleteShader(T),l.deleteShader(x),o=new cp(l,b),s=cC(l,b)}l.attachShader(b,T),l.attachShader(b,x),void 0!==r.index0AttributeName?l.bindAttribLocation(b,0,r.index0AttributeName):!0===r.morphTargets&&l.bindAttribLocation(b,0,"position"),l.linkProgram(b),this.getUniforms=function(){return void 0===o&&E(this),o},this.getAttributes=function(){return void 0===s&&E(this),s};let C=!1===r.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===C&&(C=l.getProgramParameter(b,cm)),C},this.destroy=function(){n.releaseStatesOfProgram(this),l.deleteProgram(b),this.program=void 0},this.type=r.shaderType,this.name=r.shaderName,this.id=cg++,this.cacheKey=t,this.usedTimes=1,this.program=b,this.vertexShader=T,this.fragmentShader=x,this}let cV=0;class cq{update(e){let t=e.vertexShader,r=e.fragmentShader,n=this._getShaderStage(t),i=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return!1===a.has(n)&&(a.add(n),n.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}remove(e){for(let t of this.materialCache.get(e))t.usedTimes--,0===t.usedTimes&&this.shaderCache.delete(t.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return void 0===r&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return void 0===r&&(r=new cW(e),t.set(e,r)),r}constructor(){this.shaderCache=new Map,this.materialCache=new Map}}class cW{constructor(e){this.id=cV++,this.code=e,this.usedTimes=0}}function cZ(e,t,r,n,i,a,o){let s=new a3,l=new cq,c=new Set,u=[],d=i.logarithmicDepthBuffer,h=i.vertexTextures,p=i.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(e){return(c.add(e),0===e)?"uv":"uv".concat(e)}function g(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}function y(e,t){s.disableAll(),t.supportsVertexTextures&&s.enable(0),t.instancing&&s.enable(1),t.instancingColor&&s.enable(2),t.instancingMorph&&s.enable(3),t.matcap&&s.enable(4),t.envMap&&s.enable(5),t.normalMapObjectSpace&&s.enable(6),t.normalMapTangentSpace&&s.enable(7),t.clearcoat&&s.enable(8),t.iridescence&&s.enable(9),t.alphaTest&&s.enable(10),t.vertexColors&&s.enable(11),t.vertexAlphas&&s.enable(12),t.vertexUv1s&&s.enable(13),t.vertexUv2s&&s.enable(14),t.vertexUv3s&&s.enable(15),t.vertexTangents&&s.enable(16),t.anisotropy&&s.enable(17),t.alphaHash&&s.enable(18),t.batching&&s.enable(19),t.dispersion&&s.enable(20),t.batchingColor&&s.enable(21),e.push(s.mask),s.disableAll(),t.fog&&s.enable(0),t.useFog&&s.enable(1),t.flatShading&&s.enable(2),t.logarithmicDepthBuffer&&s.enable(3),t.skinning&&s.enable(4),t.morphTargets&&s.enable(5),t.morphNormals&&s.enable(6),t.morphColors&&s.enable(7),t.premultipliedAlpha&&s.enable(8),t.shadowMapEnabled&&s.enable(9),t.doubleSided&&s.enable(10),t.flipSided&&s.enable(11),t.useDepthPacking&&s.enable(12),t.dithering&&s.enable(13),t.transmission&&s.enable(14),t.sheen&&s.enable(15),t.opaque&&s.enable(16),t.pointsUvs&&s.enable(17),t.decodeVideoTexture&&s.enable(18),t.alphaToCoverage&&s.enable(19),e.push(s.mask)}return{getParameters:function(a,s,u,g,y){let v,b,_,w;let S=g.fog,T=y.geometry,x=a.isMeshStandardMaterial?g.environment:null,E=(a.isMeshStandardMaterial?r:t).get(a.envMap||x),C=E&&E.mapping===rw?E.image.height:null,A=f[a.type];null!==a.precision&&(p=i.getMaxPrecision(a.precision))!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",p,"instead.");let M=T.morphAttributes.position||T.morphAttributes.normal||T.morphAttributes.color,I=void 0!==M?M.length:0,R=0;if(void 0!==T.morphAttributes.position&&(R=1),void 0!==T.morphAttributes.normal&&(R=2),void 0!==T.morphAttributes.color&&(R=3),A){let e=sj[A];v=e.vertexShader,b=e.fragmentShader}else v=a.vertexShader,b=a.fragmentShader,l.update(a),_=l.getVertexShaderID(a),w=l.getFragmentShaderID(a);let k=e.getRenderTarget(),P=!0===y.isInstancedMesh,O=!0===y.isBatchedMesh,N=!!a.map,L=!!a.matcap,D=!!E,U=!!a.aoMap,F=!!a.lightMap,B=!!a.bumpMap,z=!!a.normalMap,H=!!a.displacementMap,j=!!a.emissiveMap,G=!!a.metalnessMap,V=!!a.roughnessMap,q=a.anisotropy>0,W=a.clearcoat>0,Z=a.dispersion>0,X=a.iridescence>0,$=a.sheen>0,K=a.transmission>0,Y=q&&!!a.anisotropyMap,Q=W&&!!a.clearcoatMap,J=W&&!!a.clearcoatNormalMap,ee=W&&!!a.clearcoatRoughnessMap,et=X&&!!a.iridescenceMap,er=X&&!!a.iridescenceThicknessMap,en=$&&!!a.sheenColorMap,ei=$&&!!a.sheenRoughnessMap,ea=!!a.specularMap,eo=!!a.specularColorMap,es=!!a.specularIntensityMap,el=K&&!!a.transmissionMap,ec=K&&!!a.thicknessMap,eu=!!a.gradientMap,ed=!!a.alphaMap,eh=a.alphaTest>0,ep=!!a.alphaHash,ef=!!a.extensions,em=ro;a.toneMapped&&(null===k||!0===k.isXRRenderTarget)&&(em=e.toneMapping);let eg={shaderID:A,shaderType:a.type,shaderName:a.name,vertexShader:v,fragmentShader:b,defines:a.defines,customVertexShaderID:_,customFragmentShaderID:w,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:p,batching:O,batchingColor:O&&null!==y._colorsTexture,instancing:P,instancingColor:P&&null!==y.instanceColor,instancingMorph:P&&null!==y.morphTexture,supportsVertexTextures:h,outputColorSpace:null===k?e.outputColorSpace:!0===k.isXRRenderTarget?k.texture.colorSpace:nK,alphaToCoverage:!!a.alphaToCoverage,map:N,matcap:L,envMap:D,envMapMode:D&&E.mapping,envMapCubeUVHeight:C,aoMap:U,lightMap:F,bumpMap:B,normalMap:z,displacementMap:h&&H,emissiveMap:j,normalMapObjectSpace:z&&a.normalMapType===nZ,normalMapTangentSpace:z&&a.normalMapType===nW,metalnessMap:G,roughnessMap:V,anisotropy:q,anisotropyMap:Y,clearcoat:W,clearcoatMap:Q,clearcoatNormalMap:J,clearcoatRoughnessMap:ee,dispersion:Z,iridescence:X,iridescenceMap:et,iridescenceThicknessMap:er,sheen:$,sheenColorMap:en,sheenRoughnessMap:ei,specularMap:ea,specularColorMap:eo,specularIntensityMap:es,transmission:K,transmissionMap:el,thicknessMap:ec,gradientMap:eu,opaque:!1===a.transparent&&a.blending===tN&&!1===a.alphaToCoverage,alphaMap:ed,alphaTest:eh,alphaHash:ep,combine:a.combine,mapUv:N&&m(a.map.channel),aoMapUv:U&&m(a.aoMap.channel),lightMapUv:F&&m(a.lightMap.channel),bumpMapUv:B&&m(a.bumpMap.channel),normalMapUv:z&&m(a.normalMap.channel),displacementMapUv:H&&m(a.displacementMap.channel),emissiveMapUv:j&&m(a.emissiveMap.channel),metalnessMapUv:G&&m(a.metalnessMap.channel),roughnessMapUv:V&&m(a.roughnessMap.channel),anisotropyMapUv:Y&&m(a.anisotropyMap.channel),clearcoatMapUv:Q&&m(a.clearcoatMap.channel),clearcoatNormalMapUv:J&&m(a.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ee&&m(a.clearcoatRoughnessMap.channel),iridescenceMapUv:et&&m(a.iridescenceMap.channel),iridescenceThicknessMapUv:er&&m(a.iridescenceThicknessMap.channel),sheenColorMapUv:en&&m(a.sheenColorMap.channel),sheenRoughnessMapUv:ei&&m(a.sheenRoughnessMap.channel),specularMapUv:ea&&m(a.specularMap.channel),specularColorMapUv:eo&&m(a.specularColorMap.channel),specularIntensityMapUv:es&&m(a.specularIntensityMap.channel),transmissionMapUv:el&&m(a.transmissionMap.channel),thicknessMapUv:ec&&m(a.thicknessMap.channel),alphaMapUv:ed&&m(a.alphaMap.channel),vertexTangents:!!T.attributes.tangent&&(z||q),vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!T.attributes.color&&4===T.attributes.color.itemSize,pointsUvs:!0===y.isPoints&&!!T.attributes.uv&&(N||ed),fog:!!S,useFog:!0===a.fog,fogExp2:!!S&&S.isFogExp2,flatShading:!0===a.flatShading,sizeAttenuation:!0===a.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===y.isSkinnedMesh,morphTargets:void 0!==T.morphAttributes.position,morphNormals:void 0!==T.morphAttributes.normal,morphColors:void 0!==T.morphAttributes.color,morphTargetsCount:I,morphTextureStride:R,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numSpotLightMaps:s.spotLightMap.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numSpotLightShadowsWithMaps:s.numSpotLightShadowsWithMaps,numLightProbes:s.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:em,decodeVideoTexture:N&&!0===a.map.isVideoTexture&&i9.getTransfer(a.map.colorSpace)===n0,premultipliedAlpha:a.premultipliedAlpha,doubleSided:a.side===tP,flipSided:a.side===tk,useDepthPacking:a.depthPacking>=0,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionClipCullDistance:ef&&!0===a.extensions.clipCullDistance&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ef&&!0===a.extensions.multiDraw||O)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:a.customProgramCacheKey()};return eg.vertexUv1s=c.has(1),eg.vertexUv2s=c.has(2),eg.vertexUv3s=c.has(3),c.clear(),eg},getProgramCacheKey:function(t){let r=[];if(t.shaderID?r.push(t.shaderID):(r.push(t.customVertexShaderID),r.push(t.customFragmentShaderID)),void 0!==t.defines)for(let e in t.defines)r.push(e),r.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(g(r,t),y(r,t),r.push(e.outputColorSpace)),r.push(t.customProgramCacheKey),r.join()},getUniforms:function(e){let t;let r=f[e.type];if(r){let e=sj[r];t=sg.clone(e.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,r){let n;for(let e=0,t=u.length;e<t;e++){let t=u[e];if(t.cacheKey===r){n=t,++n.usedTimes;break}}return void 0===n&&(n=new cG(e,r,t,a),u.push(n)),n},releaseProgram:function(e){if(0==--e.usedTimes){let t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:u,dispose:function(){l.dispose()}}}function cX(){let e=new WeakMap;return{get:function(t){let r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,n){e.get(t)[r]=n},dispose:function(){e=new WeakMap}}}function c$(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function cK(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function cY(){let e=[],t=0,r=[],n=[],i=[];function a(){t=0,r.length=0,n.length=0,i.length=0}function o(r,n,i,a,o,s){let l=e[t];return void 0===l?(l={id:r.id,object:r,geometry:n,material:i,groupOrder:a,renderOrder:r.renderOrder,z:o,group:s},e[t]=l):(l.id=r.id,l.object=r,l.geometry=n,l.material=i,l.groupOrder=a,l.renderOrder=r.renderOrder,l.z=o,l.group=s),t++,l}function s(e,t,a,s,l,c){let u=o(e,t,a,s,l,c);a.transmission>0?n.push(u):!0===a.transparent?i.push(u):r.push(u)}function l(e,t,a,s,l,c){let u=o(e,t,a,s,l,c);a.transmission>0?n.unshift(u):!0===a.transparent?i.unshift(u):r.unshift(u)}function c(e,t){r.length>1&&r.sort(e||c$),n.length>1&&n.sort(t||cK),i.length>1&&i.sort(t||cK)}return{opaque:r,transmissive:n,transparent:i,init:a,push:s,unshift:l,finish:function(){for(let r=t,n=e.length;r<n;r++){let t=e[r];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:c}}function cQ(){let e=new WeakMap;return{get:function(t,r){let n;let i=e.get(t);return void 0===i?(n=new cY,e.set(t,[n])):r>=i.length?(n=new cY,i.push(n)):n=i[r],n},dispose:function(){e=new WeakMap}}}function cJ(){let e={};return{get:function(t){let r;if(void 0!==e[t.id])return e[t.id];switch(t.type){case"DirectionalLight":r={direction:new ag,color:new oE};break;case"SpotLight":r={position:new ag,direction:new ag,color:new oE,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new ag,color:new oE,distance:0,decay:0};break;case"HemisphereLight":r={direction:new ag,skyColor:new oE,groundColor:new oE};break;case"RectAreaLight":r={color:new oE,position:new ag,halfWidth:new ag,halfHeight:new ag}}return e[t.id]=r,r}}}function c0(){let e={};return{get:function(t){let r;if(void 0!==e[t.id])return e[t.id];switch(t.type){case"DirectionalLight":case"SpotLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new iX};break;case"PointLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new iX,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=r,r}}}let c1=0;function c2(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function c3(e){let t=new cJ,r=c0(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let e=0;e<9;e++)n.probe.push(new ag);let i=new ag,a=new aW,o=new aW;return{setup:function(i){let a=0,o=0,s=0;for(let e=0;e<9;e++)n.probe[e].set(0,0,0);let l=0,c=0,u=0,d=0,h=0,p=0,f=0,m=0,g=0,y=0,v=0;i.sort(c2);for(let e=0,b=i.length;e<b;e++){let b=i[e],_=b.color,w=b.intensity,S=b.distance,T=b.shadow&&b.shadow.map?b.shadow.map.texture:null;if(b.isAmbientLight)a+=_.r*w,o+=_.g*w,s+=_.b*w;else if(b.isLightProbe){for(let e=0;e<9;e++)n.probe[e].addScaledVector(b.sh.coefficients[e],w);v++}else if(b.isDirectionalLight){let e=t.get(b);if(e.color.copy(b.color).multiplyScalar(b.intensity),b.castShadow){let e=b.shadow,t=r.get(b);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,n.directionalShadow[l]=t,n.directionalShadowMap[l]=T,n.directionalShadowMatrix[l]=b.shadow.matrix,p++}n.directional[l]=e,l++}else if(b.isSpotLight){let e=t.get(b);e.position.setFromMatrixPosition(b.matrixWorld),e.color.copy(_).multiplyScalar(w),e.distance=S,e.coneCos=Math.cos(b.angle),e.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),e.decay=b.decay,n.spot[u]=e;let i=b.shadow;if(b.map&&(n.spotLightMap[g]=b.map,g++,i.updateMatrices(b),b.castShadow&&y++),n.spotLightMatrix[u]=i.matrix,b.castShadow){let e=r.get(b);e.shadowIntensity=i.intensity,e.shadowBias=i.bias,e.shadowNormalBias=i.normalBias,e.shadowRadius=i.radius,e.shadowMapSize=i.mapSize,n.spotShadow[u]=e,n.spotShadowMap[u]=T,m++}u++}else if(b.isRectAreaLight){let e=t.get(b);e.color.copy(_).multiplyScalar(w),e.halfWidth.set(.5*b.width,0,0),e.halfHeight.set(0,.5*b.height,0),n.rectArea[d]=e,d++}else if(b.isPointLight){let e=t.get(b);if(e.color.copy(b.color).multiplyScalar(b.intensity),e.distance=b.distance,e.decay=b.decay,b.castShadow){let e=b.shadow,t=r.get(b);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,n.pointShadow[c]=t,n.pointShadowMap[c]=T,n.pointShadowMatrix[c]=b.shadow.matrix,f++}n.point[c]=e,c++}else if(b.isHemisphereLight){let e=t.get(b);e.skyColor.copy(b.color).multiplyScalar(w),e.groundColor.copy(b.groundColor).multiplyScalar(w),n.hemi[h]=e,h++}}d>0&&(!0===e.has("OES_texture_float_linear")?(n.rectAreaLTC1=sH.LTC_FLOAT_1,n.rectAreaLTC2=sH.LTC_FLOAT_2):(n.rectAreaLTC1=sH.LTC_HALF_1,n.rectAreaLTC2=sH.LTC_HALF_2)),n.ambient[0]=a,n.ambient[1]=o,n.ambient[2]=s;let b=n.hash;(b.directionalLength!==l||b.pointLength!==c||b.spotLength!==u||b.rectAreaLength!==d||b.hemiLength!==h||b.numDirectionalShadows!==p||b.numPointShadows!==f||b.numSpotShadows!==m||b.numSpotMaps!==g||b.numLightProbes!==v)&&(n.directional.length=l,n.spot.length=u,n.rectArea.length=d,n.point.length=c,n.hemi.length=h,n.directionalShadow.length=p,n.directionalShadowMap.length=p,n.pointShadow.length=f,n.pointShadowMap.length=f,n.spotShadow.length=m,n.spotShadowMap.length=m,n.directionalShadowMatrix.length=p,n.pointShadowMatrix.length=f,n.spotLightMatrix.length=m+g-y,n.spotLightMap.length=g,n.numSpotLightShadowsWithMaps=y,n.numLightProbes=v,b.directionalLength=l,b.pointLength=c,b.spotLength=u,b.rectAreaLength=d,b.hemiLength=h,b.numDirectionalShadows=p,b.numPointShadows=f,b.numSpotShadows=m,b.numSpotMaps=g,b.numLightProbes=v,n.version=c1++)},setupView:function(e,t){let r=0,s=0,l=0,c=0,u=0,d=t.matrixWorldInverse;for(let t=0,h=e.length;t<h;t++){let h=e[t];if(h.isDirectionalLight){let e=n.directional[r];e.direction.setFromMatrixPosition(h.matrixWorld),i.setFromMatrixPosition(h.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(d),r++}else if(h.isSpotLight){let e=n.spot[l];e.position.setFromMatrixPosition(h.matrixWorld),e.position.applyMatrix4(d),e.direction.setFromMatrixPosition(h.matrixWorld),i.setFromMatrixPosition(h.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(d),l++}else if(h.isRectAreaLight){let e=n.rectArea[c];e.position.setFromMatrixPosition(h.matrixWorld),e.position.applyMatrix4(d),o.identity(),a.copy(h.matrixWorld),a.premultiply(d),o.extractRotation(a),e.halfWidth.set(.5*h.width,0,0),e.halfHeight.set(0,.5*h.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),c++}else if(h.isPointLight){let e=n.point[s];e.position.setFromMatrixPosition(h.matrixWorld),e.position.applyMatrix4(d),s++}else if(h.isHemisphereLight){let e=n.hemi[u];e.direction.setFromMatrixPosition(h.matrixWorld),e.direction.transformDirection(d),u++}}},state:n}}function c4(e){let t=new c3(e),r=[],n=[];function i(e){c.camera=e,r.length=0,n.length=0}function a(e){r.push(e)}function o(e){n.push(e)}function s(){t.setup(r)}function l(e){t.setupView(r,e)}let c={lightsArray:r,shadowsArray:n,camera:null,lights:t,transmissionRenderTarget:{}};return{init:i,state:c,setupLights:s,setupLightsView:l,pushLight:a,pushShadow:o}}function c5(e){let t=new WeakMap;return{get:function(r){let n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=t.get(r);return void 0===a?(n=new c4(e),t.set(r,[n])):i>=a.length?(n=new c4(e),a.push(n)):n=a[i],n},dispose:function(){t=new WeakMap}}}class c6 extends oM{copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=nj,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}}class c8 extends oM{copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}}let c7="void main() {\n	gl_Position = vec4( position, 1.0 );\n}",c9="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n	const float samples = float( VSM_SAMPLES );\n	float mean = 0.0;\n	float squared_mean = 0.0;\n	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n	for ( float i = 0.0; i < samples; i ++ ) {\n		float uvOffset = uvStart + i * uvStride;\n		#ifdef HORIZONTAL_PASS\n			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n			mean += distribution.x;\n			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n		#else\n			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n			mean += depth;\n			squared_mean += depth * depth;\n		#endif\n	}\n	mean = mean / samples;\n	squared_mean = squared_mean / samples;\n	float std_dev = sqrt( squared_mean - mean * mean );\n	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}";function ue(e,t,r){let n=new sD,i=new iX,a=new iX,o=new al,s=new c6({depthPacking:nG}),l=new c8,c={},u=r.maxTextureSize,d={[tR]:tk,[tk]:tR,[tP]:tP},h=new sb({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new iX},radius:{value:4}},vertexShader:c7,fragmentShader:c9}),p=h.clone();p.defines.HORIZONTAL_PASS=1;let f=new o0;f.setAttribute("position",new oU(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new sl(f,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=tA;let y=this.type;function v(r,n){let a=t.update(m);h.defines.VSM_SAMPLES!==r.blurSamples&&(h.defines.VSM_SAMPLES=r.blurSamples,p.defines.VSM_SAMPLES=r.blurSamples,h.needsUpdate=!0,p.needsUpdate=!0),null===r.mapPass&&(r.mapPass=new au(i.x,i.y)),h.uniforms.shadow_pass.value=r.map.texture,h.uniforms.resolution.value=r.mapSize,h.uniforms.radius.value=r.radius,e.setRenderTarget(r.mapPass),e.clear(),e.renderBufferDirect(n,null,a,h,m,null),p.uniforms.shadow_pass.value=r.mapPass.texture,p.uniforms.resolution.value=r.mapSize,p.uniforms.radius.value=r.radius,e.setRenderTarget(r.map),e.clear(),e.renderBufferDirect(n,null,a,p,m,null)}function b(t,r,n,i){let a=null,o=!0===n.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==o)a=o;else if(a=!0===n.isPointLight?l:s,e.localClippingEnabled&&!0===r.clipShadows&&Array.isArray(r.clippingPlanes)&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0||r.map&&r.alphaTest>0){let e=a.uuid,t=r.uuid,n=c[e];void 0===n&&(n={},c[e]=n);let i=n[t];void 0===i&&(i=a.clone(),n[t]=i,r.addEventListener("dispose",w)),a=i}return a.visible=r.visible,a.wireframe=r.wireframe,i===tI?a.side=null!==r.shadowSide?r.shadowSide:r.side:a.side=null!==r.shadowSide?r.shadowSide:d[r.side],a.alphaMap=r.alphaMap,a.alphaTest=r.alphaTest,a.map=r.map,a.clipShadows=r.clipShadows,a.clippingPlanes=r.clippingPlanes,a.clipIntersection=r.clipIntersection,a.displacementMap=r.displacementMap,a.displacementScale=r.displacementScale,a.displacementBias=r.displacementBias,a.wireframeLinewidth=r.wireframeLinewidth,a.linewidth=r.linewidth,!0===n.isPointLight&&!0===a.isMeshDistanceMaterial&&(e.properties.get(a).light=n),a}function _(r,i,a,o,s){if(!1===r.visible)return;if(r.layers.test(i.layers)&&(r.isMesh||r.isLine||r.isPoints)&&(r.castShadow||r.receiveShadow&&s===tI)&&(!r.frustumCulled||n.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,r.matrixWorld);let n=t.update(r),l=r.material;if(Array.isArray(l)){let t=n.groups;for(let c=0,u=t.length;c<u;c++){let u=t[c],d=l[u.materialIndex];if(d&&d.visible){let t=b(r,d,o,s);r.onBeforeShadow(e,r,i,a,n,t,u),e.renderBufferDirect(a,null,n,t,r,u),r.onAfterShadow(e,r,i,a,n,t,u)}}}else if(l.visible){let t=b(r,l,o,s);r.onBeforeShadow(e,r,i,a,n,t,null),e.renderBufferDirect(a,null,n,t,r,null),r.onAfterShadow(e,r,i,a,n,t,null)}}let l=r.children;for(let e=0,t=l.length;e<t;e++)_(l[e],i,a,o,s)}function w(e){for(let t in e.target.removeEventListener("dispose",w),c){let r=c[t],n=e.target.uuid;n in r&&(r[n].dispose(),delete r[n])}}this.render=function(t,r,s){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===t.length)return;let l=e.getRenderTarget(),c=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),h=e.state;h.setBlending(tO),h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);let p=y!==tI&&this.type===tI,f=y===tI&&this.type!==tI;for(let l=0,c=t.length;l<c;l++){let c=t[l],d=c.shadow;if(void 0===d){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}if(!1===d.autoUpdate&&!1===d.needsUpdate)continue;i.copy(d.mapSize);let m=d.getFrameExtents();if(i.multiply(m),a.copy(d.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(a.x=Math.floor(u/m.x),i.x=a.x*m.x,d.mapSize.x=a.x),i.y>u&&(a.y=Math.floor(u/m.y),i.y=a.y*m.y,d.mapSize.y=a.y)),null===d.map||!0===p||!0===f){let e=this.type!==tI?{minFilter:rE,magFilter:rE}:{};null!==d.map&&d.map.dispose(),d.map=new au(i.x,i.y,e),d.map.texture.name=c.name+".shadowMap",d.camera.updateProjectionMatrix()}e.setRenderTarget(d.map),e.clear();let g=d.getViewportCount();for(let e=0;e<g;e++){let t=d.getViewport(e);o.set(a.x*t.x,a.y*t.y,a.x*t.z,a.y*t.w),h.viewport(o),d.updateMatrices(c,e),n=d.getFrustum(),_(r,s,d.camera,c,this.type)}!0!==d.isPointLightShadow&&this.type===tI&&v(d,s),d.needsUpdate=!1}y=this.type,g.needsUpdate=!1,e.setRenderTarget(l,c,d)}}function ut(e){function t(){let t=!1,r=null,n=null,i=null;return{setTest:function(t){t?H(e.DEPTH_TEST):j(e.DEPTH_TEST)},setMask:function(n){r===n||t||(e.depthMask(n),r=n)},setFunc:function(t){if(n!==t){switch(t){case t5:e.depthFunc(e.NEVER);break;case t6:e.depthFunc(e.ALWAYS);break;case t8:e.depthFunc(e.LESS);break;case t7:e.depthFunc(e.LEQUAL);break;case t9:e.depthFunc(e.EQUAL);break;case re:e.depthFunc(e.GEQUAL);break;case rt:e.depthFunc(e.GREATER);break;case rr:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}n=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,r=null,n=null,i=null}}}function r(){let t=!1,r=null,n=null,i=null,a=null,o=null,s=null,l=null,c=null;return{setTest:function(r){t||(r?H(e.STENCIL_TEST):j(e.STENCIL_TEST))},setMask:function(n){r===n||t||(e.stencilMask(n),r=n)},setFunc:function(t,r,o){(n!==t||i!==r||a!==o)&&(e.stencilFunc(t,r,o),n=t,i=r,a=o)},setOp:function(t,r,n){(o!==t||s!==r||l!==n)&&(e.stencilOp(t,r,n),o=t,s=r,l=n)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,r=null,n=null,i=null,a=null,o=null,s=null,l=null,c=null}}}let n=new function(){let t=!1,r=new al,n=null,i=new al(0,0,0,0);return{setMask:function(r){n===r||t||(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,n,a,o,s){!0===s&&(t*=o,n*=o,a*=o),r.set(t,n,a,o),!1===i.equals(r)&&(e.clearColor(t,n,a,o),i.copy(r))},reset:function(){t=!1,n=null,i.set(-1,0,0,0)}}},i=new t,a=new r,o=new WeakMap,s=new WeakMap,l={},c={},u=new WeakMap,d=[],h=null,p=!1,f=null,m=null,g=null,y=null,v=null,b=null,_=null,w=new oE(0,0,0),S=0,T=!1,x=null,E=null,C=null,A=null,M=null,I=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),R=!1,k=0,P=e.getParameter(e.VERSION);-1!==P.indexOf("WebGL")?R=(k=parseFloat(/^WebGL (\d)/.exec(P)[1]))>=1:-1!==P.indexOf("OpenGL ES")&&(R=(k=parseFloat(/^OpenGL ES (\d)/.exec(P)[1]))>=2);let O=null,N={},L=e.getParameter(e.SCISSOR_BOX),D=e.getParameter(e.VIEWPORT),U=new al().fromArray(L),F=new al().fromArray(D);function B(t,r,n,i){let a=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let o=0;o<n;o++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(r,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,a):e.texImage2D(r+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a);return o}let z={};function H(t){!0!==l[t]&&(e.enable(t),l[t]=!0)}function j(t){!1!==l[t]&&(e.disable(t),l[t]=!1)}function G(t,r){return c[t]!==r&&(e.bindFramebuffer(t,r),c[t]=r,t===e.DRAW_FRAMEBUFFER&&(c[e.FRAMEBUFFER]=r),t===e.FRAMEBUFFER&&(c[e.DRAW_FRAMEBUFFER]=r),!0)}function V(t,r){let n=d,i=!1;if(t){void 0===(n=u.get(r))&&(n=[],u.set(r,n));let a=t.textures;if(n.length!==a.length||n[0]!==e.COLOR_ATTACHMENT0){for(let t=0,r=a.length;t<r;t++)n[t]=e.COLOR_ATTACHMENT0+t;n.length=a.length,i=!0}}else n[0]!==e.BACK&&(n[0]=e.BACK,i=!0);i&&e.drawBuffers(n)}function q(t){return h!==t&&(e.useProgram(t),h=t,!0)}z[e.TEXTURE_2D]=B(e.TEXTURE_2D,e.TEXTURE_2D,1),z[e.TEXTURE_CUBE_MAP]=B(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),z[e.TEXTURE_2D_ARRAY]=B(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),z[e.TEXTURE_3D]=B(e.TEXTURE_3D,e.TEXTURE_3D,1,1),n.setClear(0,0,0,1),i.setClear(1),a.setClear(0),H(e.DEPTH_TEST),i.setFunc(t7),K(!1),Y(tT),H(e.CULL_FACE),X(tO);let W={[tB]:e.FUNC_ADD,[tz]:e.FUNC_SUBTRACT,[tH]:e.FUNC_REVERSE_SUBTRACT};W[tj]=e.MIN,W[tG]=e.MAX;let Z={[tV]:e.ZERO,[tq]:e.ONE,[tW]:e.SRC_COLOR,[tX]:e.SRC_ALPHA,[t0]:e.SRC_ALPHA_SATURATE,[tQ]:e.DST_COLOR,[tK]:e.DST_ALPHA,[tZ]:e.ONE_MINUS_SRC_COLOR,[t$]:e.ONE_MINUS_SRC_ALPHA,[tJ]:e.ONE_MINUS_DST_COLOR,[tY]:e.ONE_MINUS_DST_ALPHA,[t1]:e.CONSTANT_COLOR,[t2]:e.ONE_MINUS_CONSTANT_COLOR,[t3]:e.CONSTANT_ALPHA,[t4]:e.ONE_MINUS_CONSTANT_ALPHA};function X(t,r,n,i,a,o,s,l,c,u){if(t===tO){!0===p&&(j(e.BLEND),p=!1);return}if(!1===p&&(H(e.BLEND),p=!0),t!==tF){if(t!==f||u!==T){if((m!==tB||v!==tB)&&(e.blendEquation(e.FUNC_ADD),m=tB,v=tB),u)switch(t){case tN:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case tL:e.blendFunc(e.ONE,e.ONE);break;case tD:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case tU:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case tN:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case tL:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case tD:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case tU:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}g=null,y=null,b=null,_=null,w.set(0,0,0),S=0,f=t,T=u}return}a=a||r,o=o||n,s=s||i,(r!==m||a!==v)&&(e.blendEquationSeparate(W[r],W[a]),m=r,v=a),(n!==g||i!==y||o!==b||s!==_)&&(e.blendFuncSeparate(Z[n],Z[i],Z[o],Z[s]),g=n,y=i,b=o,_=s),(!1===l.equals(w)||c!==S)&&(e.blendColor(l.r,l.g,l.b,c),w.copy(l),S=c),f=t,T=!1}function $(t,r){t.side===tP?j(e.CULL_FACE):H(e.CULL_FACE);let o=t.side===tk;r&&(o=!o),K(o),t.blending===tN&&!1===t.transparent?X(tO):X(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),i.setFunc(t.depthFunc),i.setTest(t.depthTest),i.setMask(t.depthWrite),n.setMask(t.colorWrite);let s=t.stencilWrite;a.setTest(s),s&&(a.setMask(t.stencilWriteMask),a.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),a.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Q(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?H(e.SAMPLE_ALPHA_TO_COVERAGE):j(e.SAMPLE_ALPHA_TO_COVERAGE)}function K(t){x!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),x=t)}function Y(t){t!==tS?(H(e.CULL_FACE),t!==E&&(t===tT?e.cullFace(e.BACK):t===tx?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):j(e.CULL_FACE),E=t}function Q(t,r,n){t?(H(e.POLYGON_OFFSET_FILL),(A!==r||M!==n)&&(e.polygonOffset(r,n),A=r,M=n)):j(e.POLYGON_OFFSET_FILL)}function J(t){t?H(e.SCISSOR_TEST):j(e.SCISSOR_TEST)}function ee(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),l={},O=null,N={},c={},u=new WeakMap,d=[],h=null,p=!1,f=null,m=null,g=null,y=null,v=null,b=null,_=null,w=new oE(0,0,0),S=0,T=!1,x=null,E=null,C=null,A=null,M=null,U.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),n.reset(),i.reset(),a.reset()}return{buffers:{color:n,depth:i,stencil:a},enable:H,disable:j,bindFramebuffer:G,drawBuffers:V,useProgram:q,setBlending:X,setMaterial:$,setFlipSided:K,setCullFace:Y,setLineWidth:function(t){t!==C&&(R&&e.lineWidth(t),C=t)},setPolygonOffset:Q,setScissorTest:J,activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+I-1),O!==t&&(e.activeTexture(t),O=t)},bindTexture:function(t,r,n){void 0===n&&(n=null===O?e.TEXTURE0+I-1:O);let i=N[n];void 0===i&&(i={type:void 0,texture:void 0},N[n]=i),(i.type!==t||i.texture!==r)&&(O!==n&&(e.activeTexture(n),O=n),e.bindTexture(t,r||z[t]),i.type=t,i.texture=r)},unbindTexture:function(){let t=N[O];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},updateUBOMapping:function(t,r){let n=s.get(r);void 0===n&&(n=new WeakMap,s.set(r,n));let i=n.get(t);void 0===i&&(i=e.getUniformBlockIndex(r,t.name),n.set(t,i))},uniformBlockBinding:function(t,r){let n=s.get(r).get(t);o.get(r)!==n&&(e.uniformBlockBinding(r,n,t.__bindingPointIndex),o.set(r,n))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===U.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),U.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:ee}}function ur(e,t,r,n){let i=un(n);switch(r){case rZ:case rK:return e*t;case rY:return e*t*2;case r0:case r1:return e*t/i.components*i.byteLength;case r2:case r3:return e*t*2/i.components*i.byteLength;case rX:return e*t*3/i.components*i.byteLength;case r$:case r5:return e*t*4/i.components*i.byteLength;case r6:case r8:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case r7:case r9:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case nt:case nn:return Math.max(e,16)*Math.max(t,8)/4;case ne:case nr:return Math.max(e,8)*Math.max(t,8)/2;case ni:case na:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case no:case ns:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case nl:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case nc:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case nu:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case nd:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case nh:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case np:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case nf:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case nm:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case ng:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case ny:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case nv:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case nb:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case n_:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case nw:case nS:case nT:return Math.ceil(e/4)*Math.ceil(t/4)*16;case nx:case nE:return Math.ceil(e/4)*Math.ceil(t/4)*8;case nC:case nA:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw Error("Unable to determine texture byte length for ".concat(r," format."))}function un(e){switch(e){case rL:case rD:return{byteLength:1,components:1};case rF:case rU:case rj:return{byteLength:2,components:1};case rG:case rV:return{byteLength:2,components:4};case rz:case rB:case rH:return{byteLength:4,components:1};case rW:return{byteLength:4,components:3}}throw Error("Unknown texture type ".concat(e,"."))}let ui={contain:function(e,t){let r=e.image&&e.image.width?e.image.width/e.image.height:1;return r>t?(e.repeat.x=1,e.repeat.y=r/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2):(e.repeat.x=t/r,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0),e},cover:function(e,t){let r=e.image&&e.image.width?e.image.width/e.image.height:1;return r>t?(e.repeat.x=t/r,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0):(e.repeat.x=1,e.repeat.y=r/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2),e},fill:function(e){return e.repeat.x=1,e.repeat.y=1,e.offset.x=0,e.offset.y=0,e},getByteLength:ur};function ua(e,t,r,n,i,a,o){let s;let l=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,c="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),u=new iX,d=new WeakMap,h=new WeakMap,p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function f(e,t){return p?new OffscreenCanvas(e,t):i0("canvas")}function m(e,t,r){let n=1,i=et(e);if((i.width>r||i.height>r)&&(n=r/Math.max(i.width,i.height)),n<1){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof VideoFrame&&e instanceof VideoFrame){let r=Math.floor(n*i.width),a=Math.floor(n*i.height);void 0===s&&(s=f(r,a));let o=t?f(r,a):s;return o.width=r,o.height=a,o.getContext("2d").drawImage(e,0,0,r,a),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+i.width+"x"+i.height+") to ("+r+"x"+a+")."),o}"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+i.width+"x"+i.height+").")}return e}function g(e){return e.generateMipmaps&&e.minFilter!==rE&&e.minFilter!==rR}function y(t){e.generateMipmap(t)}function v(r,n,i,a){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(null!==r){if(void 0!==e[r])return e[r];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+r+"'")}let s=n;if(n===e.RED&&(i===e.FLOAT&&(s=e.R32F),i===e.HALF_FLOAT&&(s=e.R16F),i===e.UNSIGNED_BYTE&&(s=e.R8)),n===e.RED_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.R8UI),i===e.UNSIGNED_SHORT&&(s=e.R16UI),i===e.UNSIGNED_INT&&(s=e.R32UI),i===e.BYTE&&(s=e.R8I),i===e.SHORT&&(s=e.R16I),i===e.INT&&(s=e.R32I)),n===e.RG&&(i===e.FLOAT&&(s=e.RG32F),i===e.HALF_FLOAT&&(s=e.RG16F),i===e.UNSIGNED_BYTE&&(s=e.RG8)),n===e.RG_INTEGER&&(i===e.UNSIGNED_BYTE&&(s=e.RG8UI),i===e.UNSIGNED_SHORT&&(s=e.RG16UI),i===e.UNSIGNED_INT&&(s=e.RG32UI),i===e.BYTE&&(s=e.RG8I),i===e.SHORT&&(s=e.RG16I),i===e.INT&&(s=e.RG32I)),n===e.RGB&&i===e.UNSIGNED_INT_5_9_9_9_REV&&(s=e.RGB9_E5),n===e.RGBA){let t=o?nJ:i9.getTransfer(a);i===e.FLOAT&&(s=e.RGBA32F),i===e.HALF_FLOAT&&(s=e.RGBA16F),i===e.UNSIGNED_BYTE&&(s=t===n0?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(s=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(s=e.RGB5_A1)}return(s===e.R16F||s===e.R32F||s===e.RG16F||s===e.RG32F||s===e.RGBA16F||s===e.RGBA32F)&&t.get("EXT_color_buffer_float"),s}function b(t,r){let n;return t?null===r||r===rz||r===rq?n=e.DEPTH24_STENCIL8:r===rH?n=e.DEPTH32F_STENCIL8:r===rF&&(n=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===r||r===rz||r===rq?n=e.DEPTH_COMPONENT24:r===rH?n=e.DEPTH_COMPONENT32F:r===rF&&(n=e.DEPTH_COMPONENT16),n}function _(e,t){return!0===g(e)||e.isFramebufferTexture&&e.minFilter!==rE&&e.minFilter!==rR?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function w(e){let t=e.target;t.removeEventListener("dispose",w),T(t),t.isVideoTexture&&d.delete(t)}function S(e){let t=e.target;t.removeEventListener("dispose",S),E(t)}function T(e){let t=n.get(e);if(void 0===t.__webglInit)return;let r=e.source,i=h.get(r);if(i){let n=i[t.__cacheKey];n.usedTimes--,0===n.usedTimes&&x(e),0===Object.keys(i).length&&h.delete(r)}n.remove(e)}function x(t){let r=n.get(t);e.deleteTexture(r.__webglTexture);let i=t.source,a=h.get(i);delete a[r.__cacheKey],o.memory.textures--}function E(t){let r=n.get(t);if(t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++){if(Array.isArray(r.__webglFramebuffer[t]))for(let n=0;n<r.__webglFramebuffer[t].length;n++)e.deleteFramebuffer(r.__webglFramebuffer[t][n]);else e.deleteFramebuffer(r.__webglFramebuffer[t]);r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[t])}else{if(Array.isArray(r.__webglFramebuffer))for(let t=0;t<r.__webglFramebuffer.length;t++)e.deleteFramebuffer(r.__webglFramebuffer[t]);else e.deleteFramebuffer(r.__webglFramebuffer);if(r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&e.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer)for(let t=0;t<r.__webglColorRenderbuffer.length;t++)r.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(r.__webglColorRenderbuffer[t]);r.__webglDepthRenderbuffer&&e.deleteRenderbuffer(r.__webglDepthRenderbuffer)}let i=t.textures;for(let t=0,r=i.length;t<r;t++){let r=n.get(i[t]);r.__webglTexture&&(e.deleteTexture(r.__webglTexture),o.memory.textures--),n.remove(i[t])}n.remove(t)}let C=0;function A(){C=0}function M(){let e=C;return e>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+i.maxTextures),C+=1,e}function I(e){let t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}function R(t,i){let a=n.get(t);if(t.isVideoTexture&&J(t),!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version){let e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(!1===e.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{B(a,t,i);return}}r.bindTexture(e.TEXTURE_2D,a.__webglTexture,e.TEXTURE0+i)}function k(t,i){let a=n.get(t);if(t.version>0&&a.__version!==t.version){B(a,t,i);return}r.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture,e.TEXTURE0+i)}function P(t,i){let a=n.get(t);if(t.version>0&&a.__version!==t.version){B(a,t,i);return}r.bindTexture(e.TEXTURE_3D,a.__webglTexture,e.TEXTURE0+i)}function O(t,i){let a=n.get(t);if(t.version>0&&a.__version!==t.version){z(a,t,i);return}r.bindTexture(e.TEXTURE_CUBE_MAP,a.__webglTexture,e.TEXTURE0+i)}let N={[rS]:e.REPEAT,[rT]:e.CLAMP_TO_EDGE,[rx]:e.MIRRORED_REPEAT},L={[rE]:e.NEAREST,[rC]:e.NEAREST_MIPMAP_NEAREST,[rM]:e.NEAREST_MIPMAP_LINEAR,[rR]:e.LINEAR,[rk]:e.LINEAR_MIPMAP_NEAREST,[rO]:e.LINEAR_MIPMAP_LINEAR},D={[iu]:e.NEVER,[iv]:e.ALWAYS,[id]:e.LESS,[ip]:e.LEQUAL,[ih]:e.EQUAL,[iy]:e.GEQUAL,[im]:e.GREATER,[ig]:e.NOTEQUAL};function U(r,a){if(a.type===rH&&!1===t.has("OES_texture_float_linear")&&(a.magFilter===rR||a.magFilter===rk||a.magFilter===rM||a.magFilter===rO||a.minFilter===rR||a.minFilter===rk||a.minFilter===rM||a.minFilter===rO)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(r,e.TEXTURE_WRAP_S,N[a.wrapS]),e.texParameteri(r,e.TEXTURE_WRAP_T,N[a.wrapT]),(r===e.TEXTURE_3D||r===e.TEXTURE_2D_ARRAY)&&e.texParameteri(r,e.TEXTURE_WRAP_R,N[a.wrapR]),e.texParameteri(r,e.TEXTURE_MAG_FILTER,L[a.magFilter]),e.texParameteri(r,e.TEXTURE_MIN_FILTER,L[a.minFilter]),a.compareFunction&&(e.texParameteri(r,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(r,e.TEXTURE_COMPARE_FUNC,D[a.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")&&a.magFilter!==rE&&(a.minFilter===rM||a.minFilter===rO)&&(a.type!==rH||!1!==t.has("OES_texture_float_linear"))&&(a.anisotropy>1||n.get(a).__currentAnisotropy)){let o=t.get("EXT_texture_filter_anisotropic");e.texParameterf(r,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),n.get(a).__currentAnisotropy=a.anisotropy}}function F(t,r){let n=!1;void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",w));let i=r.source,a=h.get(i);void 0===a&&(a={},h.set(i,a));let s=I(r);if(s!==t.__cacheKey){void 0===a[s]&&(a[s]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,n=!0),a[s].usedTimes++;let i=a[t.__cacheKey];void 0!==i&&(a[t.__cacheKey].usedTimes--,0===i.usedTimes&&x(r)),t.__cacheKey=s,t.__webglTexture=a[s].texture}return n}function B(t,o,s){let l=e.TEXTURE_2D;(o.isDataArrayTexture||o.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),o.isData3DTexture&&(l=e.TEXTURE_3D);let c=F(t,o),u=o.source;r.bindTexture(l,t.__webglTexture,e.TEXTURE0+s);let d=n.get(u);if(u.version!==d.__version||!0===c){let t;r.activeTexture(e.TEXTURE0+s);let n=i9.getPrimaries(i9.workingColorSpace),h=o.colorSpace===nX?null:i9.getPrimaries(o.colorSpace),p=o.colorSpace===nX||n===h?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,p);let f=m(o.image,!1,i.maxTextureSize);f=ee(o,f);let w=a.convert(o.format,o.colorSpace),S=a.convert(o.type),T=v(o.internalFormat,w,S,o.colorSpace,o.isVideoTexture);U(l,o);let x=o.mipmaps,E=!0!==o.isVideoTexture,C=void 0===d.__version||!0===c,A=u.dataReady,M=_(o,f);if(o.isDepthTexture)T=b(o.format===rJ,o.type),C&&(E?r.texStorage2D(e.TEXTURE_2D,1,T,f.width,f.height):r.texImage2D(e.TEXTURE_2D,0,T,f.width,f.height,0,w,S,null));else if(o.isDataTexture){if(x.length>0){E&&C&&r.texStorage2D(e.TEXTURE_2D,M,T,x[0].width,x[0].height);for(let n=0,i=x.length;n<i;n++)t=x[n],E?A&&r.texSubImage2D(e.TEXTURE_2D,n,0,0,t.width,t.height,w,S,t.data):r.texImage2D(e.TEXTURE_2D,n,T,t.width,t.height,0,w,S,t.data);o.generateMipmaps=!1}else E?(C&&r.texStorage2D(e.TEXTURE_2D,M,T,f.width,f.height),A&&r.texSubImage2D(e.TEXTURE_2D,0,0,0,f.width,f.height,w,S,f.data)):r.texImage2D(e.TEXTURE_2D,0,T,f.width,f.height,0,w,S,f.data)}else if(o.isCompressedTexture){if(o.isCompressedArrayTexture){E&&C&&r.texStorage3D(e.TEXTURE_2D_ARRAY,M,T,x[0].width,x[0].height,f.depth);for(let n=0,i=x.length;n<i;n++)if(t=x[n],o.format!==r$){if(null!==w){if(E){if(A){if(o.layerUpdates.size>0){let i=ur(t.width,t.height,o.format,o.type);for(let a of o.layerUpdates){let o=t.data.subarray(a*i/t.data.BYTES_PER_ELEMENT,(a+1)*i/t.data.BYTES_PER_ELEMENT);r.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,n,0,0,a,t.width,t.height,1,w,o,0,0)}o.clearLayerUpdates()}else r.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,n,0,0,0,t.width,t.height,f.depth,w,t.data,0,0)}}else r.compressedTexImage3D(e.TEXTURE_2D_ARRAY,n,T,t.width,t.height,f.depth,0,t.data,0,0)}else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()")}else E?A&&r.texSubImage3D(e.TEXTURE_2D_ARRAY,n,0,0,0,t.width,t.height,f.depth,w,S,t.data):r.texImage3D(e.TEXTURE_2D_ARRAY,n,T,t.width,t.height,f.depth,0,w,S,t.data)}else{E&&C&&r.texStorage2D(e.TEXTURE_2D,M,T,x[0].width,x[0].height);for(let n=0,i=x.length;n<i;n++)t=x[n],o.format!==r$?null!==w?E?A&&r.compressedTexSubImage2D(e.TEXTURE_2D,n,0,0,t.width,t.height,w,t.data):r.compressedTexImage2D(e.TEXTURE_2D,n,T,t.width,t.height,0,t.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?A&&r.texSubImage2D(e.TEXTURE_2D,n,0,0,t.width,t.height,w,S,t.data):r.texImage2D(e.TEXTURE_2D,n,T,t.width,t.height,0,w,S,t.data)}}else if(o.isDataArrayTexture){if(E){if(C&&r.texStorage3D(e.TEXTURE_2D_ARRAY,M,T,f.width,f.height,f.depth),A){if(o.layerUpdates.size>0){let t=ur(f.width,f.height,o.format,o.type);for(let n of o.layerUpdates){let i=f.data.subarray(n*t/f.data.BYTES_PER_ELEMENT,(n+1)*t/f.data.BYTES_PER_ELEMENT);r.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,n,f.width,f.height,1,w,S,i)}o.clearLayerUpdates()}else r.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,f.width,f.height,f.depth,w,S,f.data)}}else r.texImage3D(e.TEXTURE_2D_ARRAY,0,T,f.width,f.height,f.depth,0,w,S,f.data)}else if(o.isData3DTexture)E?(C&&r.texStorage3D(e.TEXTURE_3D,M,T,f.width,f.height,f.depth),A&&r.texSubImage3D(e.TEXTURE_3D,0,0,0,0,f.width,f.height,f.depth,w,S,f.data)):r.texImage3D(e.TEXTURE_3D,0,T,f.width,f.height,f.depth,0,w,S,f.data);else if(o.isFramebufferTexture){if(C){if(E)r.texStorage2D(e.TEXTURE_2D,M,T,f.width,f.height);else{let t=f.width,n=f.height;for(let i=0;i<M;i++)r.texImage2D(e.TEXTURE_2D,i,T,t,n,0,w,S,null),t>>=1,n>>=1}}}else if(x.length>0){if(E&&C){let t=et(x[0]);r.texStorage2D(e.TEXTURE_2D,M,T,t.width,t.height)}for(let n=0,i=x.length;n<i;n++)t=x[n],E?A&&r.texSubImage2D(e.TEXTURE_2D,n,0,0,w,S,t):r.texImage2D(e.TEXTURE_2D,n,T,w,S,t);o.generateMipmaps=!1}else if(E){if(C){let t=et(f);r.texStorage2D(e.TEXTURE_2D,M,T,t.width,t.height)}A&&r.texSubImage2D(e.TEXTURE_2D,0,0,0,w,S,f)}else r.texImage2D(e.TEXTURE_2D,0,T,w,S,f);g(o)&&y(l),d.__version=u.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}function z(t,o,s){if(6!==o.image.length)return;let l=F(t,o),c=o.source;r.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+s);let u=n.get(c);if(c.version!==u.__version||!0===l){let t;r.activeTexture(e.TEXTURE0+s);let n=i9.getPrimaries(i9.workingColorSpace),d=o.colorSpace===nX?null:i9.getPrimaries(o.colorSpace),h=o.colorSpace===nX||n===d?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,o.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);let p=o.isCompressedTexture||o.image[0].isCompressedTexture,f=o.image[0]&&o.image[0].isDataTexture,b=[];for(let e=0;e<6;e++)p||f?b[e]=f?o.image[e].image:o.image[e]:b[e]=m(o.image[e],!0,i.maxCubemapSize),b[e]=ee(o,b[e]);let w=b[0],S=a.convert(o.format,o.colorSpace),T=a.convert(o.type),x=v(o.internalFormat,S,T,o.colorSpace),E=!0!==o.isVideoTexture,C=void 0===u.__version||!0===l,A=c.dataReady,M=_(o,w);if(U(e.TEXTURE_CUBE_MAP,o),p){E&&C&&r.texStorage2D(e.TEXTURE_CUBE_MAP,M,x,w.width,w.height);for(let n=0;n<6;n++){t=b[n].mipmaps;for(let i=0;i<t.length;i++){let a=t[i];o.format!==r$?null!==S?E?A&&r.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i,0,0,a.width,a.height,S,a.data):r.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i,x,a.width,a.height,0,a.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):E?A&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i,0,0,a.width,a.height,S,T,a.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i,x,a.width,a.height,0,S,T,a.data)}}}else{if(t=o.mipmaps,E&&C){t.length>0&&M++;let n=et(b[0]);r.texStorage2D(e.TEXTURE_CUBE_MAP,M,x,n.width,n.height)}for(let n=0;n<6;n++)if(f){E?A&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,0,0,b[n].width,b[n].height,S,T,b[n].data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,x,b[n].width,b[n].height,0,S,T,b[n].data);for(let i=0;i<t.length;i++){let a=t[i].image[n].image;E?A&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i+1,0,0,a.width,a.height,S,T,a.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i+1,x,a.width,a.height,0,S,T,a.data)}}else{E?A&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,0,0,S,T,b[n]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,x,S,T,b[n]);for(let i=0;i<t.length;i++){let a=t[i];E?A&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i+1,0,0,S,T,a.image[n]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,i+1,x,S,T,a.image[n])}}}g(o)&&y(e.TEXTURE_CUBE_MAP),u.__version=c.version,o.onUpdate&&o.onUpdate(o)}t.__version=o.version}function H(t,i,o,s,c,u){let d=a.convert(o.format,o.colorSpace),h=a.convert(o.type),p=v(o.internalFormat,d,h,o.colorSpace);if(!n.get(i).__hasExternalTextures){let t=Math.max(1,i.width>>u),n=Math.max(1,i.height>>u);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?r.texImage3D(c,u,p,t,n,i.depth,0,d,h,null):r.texImage2D(c,u,p,t,n,0,d,h,null)}r.bindFramebuffer(e.FRAMEBUFFER,t),Q(i)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,s,c,n.get(o).__webglTexture,0,Y(i)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,s,c,n.get(o).__webglTexture,u),r.bindFramebuffer(e.FRAMEBUFFER,null)}function j(t,r,n){if(e.bindRenderbuffer(e.RENDERBUFFER,t),r.depthBuffer){let i=r.depthTexture,a=i&&i.isDepthTexture?i.type:null,o=b(r.stencilBuffer,a),s=r.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=Y(r);Q(r)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,o,r.width,r.height):n?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,o,r.width,r.height):e.renderbufferStorage(e.RENDERBUFFER,o,r.width,r.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,s,e.RENDERBUFFER,t)}else{let t=r.textures;for(let i=0;i<t.length;i++){let o=t[i],s=a.convert(o.format,o.colorSpace),c=a.convert(o.type),u=v(o.internalFormat,s,c,o.colorSpace),d=Y(r);n&&!1===Q(r)?e.renderbufferStorageMultisample(e.RENDERBUFFER,d,u,r.width,r.height):Q(r)?l.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,d,u,r.width,r.height):e.renderbufferStorage(e.RENDERBUFFER,u,r.width,r.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function G(t,i){if(i&&i.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(e.FRAMEBUFFER,t),!(i.depthTexture&&i.depthTexture.isDepthTexture))throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),R(i.depthTexture,0);let a=n.get(i.depthTexture).__webglTexture,o=Y(i);if(i.depthTexture.format===rQ)Q(i)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0);else if(i.depthTexture.format===rJ)Q(i)?l.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,a,0);else throw Error("Unknown depthTexture format")}function V(t){let i=n.get(t),a=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!i.__autoAllocateDepthBuffer){if(a)throw Error("target.depthTexture not supported in Cube render targets");G(i.__webglFramebuffer,t)}else if(a){i.__webglDepthbuffer=[];for(let n=0;n<6;n++)r.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[n]),i.__webglDepthbuffer[n]=e.createRenderbuffer(),j(i.__webglDepthbuffer[n],t,!1)}else r.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),j(i.__webglDepthbuffer,t,!1);r.bindFramebuffer(e.FRAMEBUFFER,null)}function q(t,r,i){let a=n.get(t);void 0!==r&&H(a.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==i&&V(t)}function W(t){let i=t.texture,s=n.get(t),l=n.get(i);t.addEventListener("dispose",S);let c=t.textures,u=!0===t.isWebGLCubeRenderTarget,d=c.length>1;if(!d&&(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=i.version,o.memory.textures++),u){s.__webglFramebuffer=[];for(let t=0;t<6;t++)if(i.mipmaps&&i.mipmaps.length>0){s.__webglFramebuffer[t]=[];for(let r=0;r<i.mipmaps.length;r++)s.__webglFramebuffer[t][r]=e.createFramebuffer()}else s.__webglFramebuffer[t]=e.createFramebuffer()}else{if(i.mipmaps&&i.mipmaps.length>0){s.__webglFramebuffer=[];for(let t=0;t<i.mipmaps.length;t++)s.__webglFramebuffer[t]=e.createFramebuffer()}else s.__webglFramebuffer=e.createFramebuffer();if(d)for(let t=0,r=c.length;t<r;t++){let r=n.get(c[t]);void 0===r.__webglTexture&&(r.__webglTexture=e.createTexture(),o.memory.textures++)}if(t.samples>0&&!1===Q(t)){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=[],r.bindFramebuffer(e.FRAMEBUFFER,s.__webglMultisampledFramebuffer);for(let r=0;r<c.length;r++){let n=c[r];s.__webglColorRenderbuffer[r]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,s.__webglColorRenderbuffer[r]);let i=a.convert(n.format,n.colorSpace),o=a.convert(n.type),l=v(n.internalFormat,i,o,n.colorSpace,!0===t.isXRRenderTarget),u=Y(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,u,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+r,e.RENDERBUFFER,s.__webglColorRenderbuffer[r])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),j(s.__webglDepthRenderbuffer,t,!0)),r.bindFramebuffer(e.FRAMEBUFFER,null)}}if(u){r.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),U(e.TEXTURE_CUBE_MAP,i);for(let r=0;r<6;r++)if(i.mipmaps&&i.mipmaps.length>0)for(let n=0;n<i.mipmaps.length;n++)H(s.__webglFramebuffer[r][n],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+r,n);else H(s.__webglFramebuffer[r],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0);g(i)&&y(e.TEXTURE_CUBE_MAP),r.unbindTexture()}else if(d){for(let i=0,a=c.length;i<a;i++){let a=c[i],o=n.get(a);r.bindTexture(e.TEXTURE_2D,o.__webglTexture),U(e.TEXTURE_2D,a),H(s.__webglFramebuffer,t,a,e.COLOR_ATTACHMENT0+i,e.TEXTURE_2D,0),g(a)&&y(e.TEXTURE_2D)}r.unbindTexture()}else{let n=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(n=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),r.bindTexture(n,l.__webglTexture),U(n,i),i.mipmaps&&i.mipmaps.length>0)for(let r=0;r<i.mipmaps.length;r++)H(s.__webglFramebuffer[r],t,i,e.COLOR_ATTACHMENT0,n,r);else H(s.__webglFramebuffer,t,i,e.COLOR_ATTACHMENT0,n,0);g(i)&&y(n),r.unbindTexture()}t.depthBuffer&&V(t)}function Z(t){let i=t.textures;for(let a=0,o=i.length;a<o;a++){let o=i[a];if(g(o)){let i=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,a=n.get(o).__webglTexture;r.bindTexture(i,a),y(i),r.unbindTexture()}}}let X=[],$=[];function K(t){if(t.samples>0){if(!1===Q(t)){let i=t.textures,a=t.width,o=t.height,s=e.COLOR_BUFFER_BIT,l=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=n.get(t),d=i.length>1;if(d)for(let t=0;t<i.length;t++)r.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),r.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);r.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer),r.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let r=0;r<i.length;r++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(s|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(s|=e.STENCIL_BUFFER_BIT)),d){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[r]);let t=n.get(i[r]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,a,o,0,0,a,o,s,e.NEAREST),!0===c&&(X.length=0,$.length=0,X.push(e.COLOR_ATTACHMENT0+r),t.depthBuffer&&!1===t.resolveDepthBuffer&&(X.push(l),$.push(l),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,$)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,X))}if(r.bindFramebuffer(e.READ_FRAMEBUFFER,null),r.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),d)for(let t=0;t<i.length;t++){r.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);let a=n.get(i[t]).__webglTexture;r.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,a,0)}r.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&c){let r=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[r])}}}function Y(e){return Math.min(i.maxSamples,e.samples)}function Q(e){let r=n.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==r.__useRenderToTexture}function J(e){let t=o.render.frame;d.get(e)!==t&&(d.set(e,t),e.update())}function ee(e,t){let r=e.colorSpace,n=e.format,i=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||r!==nK&&r!==nX&&(i9.getTransfer(r)===n0?(n!==r$||i!==rL)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",r)),t}function et(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?(u.width=e.naturalWidth||e.width,u.height=e.naturalHeight||e.height):"undefined"!=typeof VideoFrame&&e instanceof VideoFrame?(u.width=e.displayWidth,u.height=e.displayHeight):(u.width=e.width,u.height=e.height),u}this.allocateTextureUnit=M,this.resetTextureUnits=A,this.setTexture2D=R,this.setTexture2DArray=k,this.setTexture3D=P,this.setTextureCube=O,this.rebindTextures=q,this.setupRenderTarget=W,this.updateRenderTargetMipmap=Z,this.updateMultisampleRenderTarget=K,this.setupDepthRenderbuffer=V,this.setupFrameBufferTexture=H,this.useMultisampledRTT=Q}function uo(e,t){return{convert:function(r){let n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nX,a=i9.getTransfer(i);if(r===rL)return e.UNSIGNED_BYTE;if(r===rG)return e.UNSIGNED_SHORT_4_4_4_4;if(r===rV)return e.UNSIGNED_SHORT_5_5_5_1;if(r===rW)return e.UNSIGNED_INT_5_9_9_9_REV;if(r===rD)return e.BYTE;if(r===rU)return e.SHORT;if(r===rF)return e.UNSIGNED_SHORT;if(r===rB)return e.INT;if(r===rz)return e.UNSIGNED_INT;if(r===rH)return e.FLOAT;if(r===rj)return e.HALF_FLOAT;if(r===rZ)return e.ALPHA;if(r===rX)return e.RGB;if(r===r$)return e.RGBA;if(r===rK)return e.LUMINANCE;if(r===rY)return e.LUMINANCE_ALPHA;if(r===rQ)return e.DEPTH_COMPONENT;if(r===rJ)return e.DEPTH_STENCIL;if(r===r0)return e.RED;if(r===r1)return e.RED_INTEGER;if(r===r2)return e.RG;if(r===r3)return e.RG_INTEGER;if(r===r5)return e.RGBA_INTEGER;if(r===r6||r===r8||r===r7||r===r9){if(a===n0){if(null===(n=t.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(r===r6)return n.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===r8)return n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===r7)return n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===r9)return n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(r===r6)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===r8)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===r7)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===r9)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}}if(r===ne||r===nt||r===nr||r===nn){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(r===ne)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===nt)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===nr)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===nn)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===ni||r===na||r===no){if(null===(n=t.get("WEBGL_compressed_texture_etc")))return null;if(r===ni||r===na)return a===n0?n.COMPRESSED_SRGB8_ETC2:n.COMPRESSED_RGB8_ETC2;if(r===no)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:n.COMPRESSED_RGBA8_ETC2_EAC}if(r===ns||r===nl||r===nc||r===nu||r===nd||r===nh||r===np||r===nf||r===nm||r===ng||r===ny||r===nv||r===nb||r===n_){if(null===(n=t.get("WEBGL_compressed_texture_astc")))return null;if(r===ns)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:n.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===nl)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:n.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===nc)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:n.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===nu)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:n.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===nd)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:n.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===nh)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:n.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===np)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:n.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===nf)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:n.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===nm)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:n.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===ng)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:n.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===ny)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:n.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===nv)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:n.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===nb)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:n.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===n_)return a===n0?n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:n.COMPRESSED_RGBA_ASTC_12x12_KHR}if(r===nw||r===nS||r===nT){if(null===(n=t.get("EXT_texture_compression_bptc")))return null;if(r===nw)return a===n0?n.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:n.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===nS)return n.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===nT)return n.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(r===nx||r===nE||r===nC||r===nA){if(null===(n=t.get("EXT_texture_compression_rgtc")))return null;if(r===nw)return n.COMPRESSED_RED_RGTC1_EXT;if(r===nE)return n.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===nC)return n.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===nA)return n.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return r===rq?e.UNSIGNED_INT_24_8:void 0!==e[r]?e[r]:null}}}class us extends sx{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class ul extends oc{constructor(){super(),this.isGroup=!0,this.type="Group"}}let uc={type:"move"};class uu{getHandSpace(){return null===this._hand&&(this._hand=new ul,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ul,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ag,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ag),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ul,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ag,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ag),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,r){let n=null,i=null,a=null,o=this._targetRay,s=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){for(let n of(a=!0,e.hand.values())){let e=t.getJointPose(n,r),i=this._getHandJoint(l,n);null!==e&&(i.matrix.fromArray(e.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=e.radius),i.visible=null!==e}let n=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],o=n.position.distanceTo(i.position),s=.02,c=.005;l.inputState.pinching&&o>s+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=s-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==s&&e.gripSpace&&null!==(i=t.getPose(e.gripSpace,r))&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1);null!==o&&(null===(n=t.getPose(e.targetRaySpace,r))&&null!==i&&(n=i),null!==n&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(uc)))}return null!==o&&(o.visible=null!==n),null!==s&&(s.visible=null!==i),null!==l&&(l.visible=null!==a),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){let r=new ul;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}constructor(){this._targetRay=null,this._grip=null,this._hand=null}}let ud="\nvoid main() {\n\n	gl_Position = vec4( position, 1.0 );\n\n}",uh="\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n	if ( coord.x >= 1.0 ) {\n\n		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n	} else {\n\n		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n	}\n\n}";class up{init(e,t,r){if(null===this.texture){let n=new as;e.properties.get(n).__webglTexture=t.texture,(t.depthNear!=r.depthNear||t.depthFar!=r.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=n}}getMesh(e){if(null!==this.texture&&null===this.mesh){let t=e.cameras[0].viewport,r=new sb({vertexShader:ud,fragmentShader:uh,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new sl(new sB(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}}class uf extends iP{constructor(e,t){super();let r=this,n=null,i=1,a=null,o="local-floor",s=1,l=null,c=null,u=null,d=null,h=null,p=null,f=new up,m=t.getContextAttributes(),g=null,y=null,v=[],b=[],_=new iX,w=null,S=new sx;S.layers.enable(1),S.viewport=new al;let T=new sx;T.layers.enable(2),T.viewport=new al;let x=[S,T],E=new us;E.layers.enable(1),E.layers.enable(2);let C=null,A=null;function M(e){let t=b.indexOf(e.inputSource);if(-1===t)return;let r=v[t];void 0!==r&&(r.update(e.inputSource,e.frame,l||a),r.dispatchEvent({type:e.type,data:e.inputSource}))}function I(){n.removeEventListener("select",M),n.removeEventListener("selectstart",M),n.removeEventListener("selectend",M),n.removeEventListener("squeeze",M),n.removeEventListener("squeezestart",M),n.removeEventListener("squeezeend",M),n.removeEventListener("end",I),n.removeEventListener("inputsourceschange",R);for(let e=0;e<v.length;e++){let t=b[e];null!==t&&(b[e]=null,v[e].disconnect(t))}C=null,A=null,f.reset(),e.setRenderTarget(g),h=null,d=null,u=null,n=null,y=null,F.stop(),r.isPresenting=!1,e.setPixelRatio(w),e.setSize(_.width,_.height,!1),r.dispatchEvent({type:"sessionend"})}function R(e){for(let t=0;t<e.removed.length;t++){let r=e.removed[t],n=b.indexOf(r);n>=0&&(b[n]=null,v[n].disconnect(r))}for(let t=0;t<e.added.length;t++){let r=e.added[t],n=b.indexOf(r);if(-1===n){for(let e=0;e<v.length;e++){if(e>=b.length){b.push(r),n=e;break}if(null===b[e]){b[e]=r,n=e;break}}if(-1===n)break}let i=v[n];i&&i.connect(r)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=v[e];return void 0===t&&(t=new uu,v[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=v[e];return void 0===t&&(t=new uu,v[e]=t),t.getGripSpace()},this.getHand=function(e){let t=v[e];return void 0===t&&(t=new uu,v[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==d?d:h},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return n},this.setSession=async function(c){if(null!==(n=c)){if(g=e.getRenderTarget(),n.addEventListener("select",M),n.addEventListener("selectstart",M),n.addEventListener("selectend",M),n.addEventListener("squeeze",M),n.addEventListener("squeezestart",M),n.addEventListener("squeezeend",M),n.addEventListener("end",I),n.addEventListener("inputsourceschange",R),!0!==m.xrCompatible&&await t.makeXRCompatible(),w=e.getPixelRatio(),e.getSize(_),void 0===n.renderState.layers){let r={antialias:m.antialias,alpha:!0,depth:m.depth,stencil:m.stencil,framebufferScaleFactor:i};h=new XRWebGLLayer(n,t,r),n.updateRenderState({baseLayer:h}),e.setPixelRatio(1),e.setSize(h.framebufferWidth,h.framebufferHeight,!1),y=new au(h.framebufferWidth,h.framebufferHeight,{format:r$,type:rL,colorSpace:e.outputColorSpace,stencilBuffer:m.stencil})}else{let r=null,a=null,o=null;m.depth&&(o=m.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,r=m.stencil?rJ:rQ,a=m.stencil?rq:rz);let s={colorFormat:t.RGBA8,depthFormat:o,scaleFactor:i};d=(u=new XRWebGLBinding(n,t)).createProjectionLayer(s),n.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),y=new au(d.textureWidth,d.textureHeight,{format:r$,type:rL,depthTexture:new lg(d.textureWidth,d.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,r),stencilBuffer:m.stencil,colorSpace:e.outputColorSpace,samples:m.antialias?4:0,resolveDepthBuffer:!1===d.ignoreDepthValues})}y.isXRRenderTarget=!0,this.setFoveation(s),l=null,a=await n.requestReferenceSpace(o),F.setContext(n),F.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==n)return n.environmentBlendMode},this.getDepthTexture=function(){return f.getDepthTexture()};let k=new ag,P=new ag;function O(e,t,r){k.setFromMatrixPosition(t.matrixWorld),P.setFromMatrixPosition(r.matrixWorld);let n=k.distanceTo(P),i=t.projectionMatrix.elements,a=r.projectionMatrix.elements,o=i[14]/(i[10]-1),s=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],d=(a[8]+1)/a[0],h=o*u,p=o*d,f=n/(-u+d),m=-(f*u);t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();let g=o+f,y=s+f,v=h-m,b=p+(n-m),_=l*s/y*g,w=c*s/y*g;e.projectionMatrix.makePerspective(v,b,_,w,g,y),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}function N(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}function L(e,t,r){null===r?e.matrix.copy(t.matrixWorld):(e.matrix.copy(r.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld)),e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*iD*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}this.updateCamera=function(e){if(null===n)return;null!==f.texture&&(e.near=f.depthNear,e.far=f.depthFar),E.near=T.near=S.near=e.near,E.far=T.far=S.far=e.far,(C!==E.near||A!==E.far)&&(n.updateRenderState({depthNear:E.near,depthFar:E.far}),C=E.near,A=E.far,S.near=C,S.far=A,T.near=C,T.far=A,S.updateProjectionMatrix(),T.updateProjectionMatrix(),e.updateProjectionMatrix());let t=e.parent,r=E.cameras;N(E,t);for(let e=0;e<r.length;e++)N(r[e],t);2===r.length?O(E,S,T):E.projectionMatrix.copy(S.projectionMatrix),L(e,E,t)},this.getCamera=function(){return E},this.getFoveation=function(){if(null!==d||null!==h)return s},this.setFoveation=function(e){s=e,null!==d&&(d.fixedFoveation=e),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==f.texture},this.getDepthSensingMesh=function(){return f.getMesh(E)};let D=null;function U(t,i){if(c=i.getViewerPose(l||a),p=i,null!==c){let t=c.views;null!==h&&(e.setRenderTargetFramebuffer(y,h.framebuffer),e.setRenderTarget(y));let r=!1;t.length!==E.cameras.length&&(E.cameras.length=0,r=!0);for(let n=0;n<t.length;n++){let i=t[n],a=null;if(null!==h)a=h.getViewport(i);else{let t=u.getViewSubImage(d,i);a=t.viewport,0===n&&(e.setRenderTargetTextures(y,t.colorTexture,d.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(y))}let o=x[n];void 0===o&&((o=new sx).layers.enable(n),o.viewport=new al,x[n]=o),o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.quaternion,o.scale),o.projectionMatrix.fromArray(i.projectionMatrix),o.projectionMatrixInverse.copy(o.projectionMatrix).invert(),o.viewport.set(a.x,a.y,a.width,a.height),0===n&&(E.matrix.copy(o.matrix),E.matrix.decompose(E.position,E.quaternion,E.scale)),!0===r&&E.cameras.push(o)}let i=n.enabledFeatures;if(i&&i.includes("depth-sensing")){let r=u.getDepthInformation(t[0]);r&&r.isValid&&r.texture&&f.init(e,r,n.renderState)}}for(let e=0;e<v.length;e++){let t=b[e],r=v[e];null!==t&&void 0!==r&&r.update(t,i,l||a)}D&&D(t,i),i.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:i}),p=null}let F=new sU;F.setAnimationLoop(U),this.setAnimationLoop=function(e){D=e},this.dispose=function(){}}}let um=new a2,ug=new aW;function uy(e,t){function r(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function n(e,n){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map,r(n.map,e.mapTransform)),n.alphaMap&&(e.alphaMap.value=n.alphaMap,r(n.alphaMap,e.alphaMapTransform)),n.bumpMap&&(e.bumpMap.value=n.bumpMap,r(n.bumpMap,e.bumpMapTransform),e.bumpScale.value=n.bumpScale,n.side===tk&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,r(n.normalMap,e.normalMapTransform),e.normalScale.value.copy(n.normalScale),n.side===tk&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,r(n.displacementMap,e.displacementMapTransform),e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap,r(n.emissiveMap,e.emissiveMapTransform)),n.specularMap&&(e.specularMap.value=n.specularMap,r(n.specularMap,e.specularMapTransform)),n.alphaTest>0&&(e.alphaTest.value=n.alphaTest);let i=t.get(n),a=i.envMap,o=i.envMapRotation;a&&(e.envMap.value=a,um.copy(o),um.x*=-1,um.y*=-1,um.z*=-1,a.isCubeTexture&&!1===a.isRenderTargetTexture&&(um.y*=-1,um.z*=-1),e.envMapRotation.value.setFromMatrix4(ug.makeRotationFromEuler(um)),e.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,e.reflectivity.value=n.reflectivity,e.ior.value=n.ior,e.refractionRatio.value=n.refractionRatio),n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity,r(n.lightMap,e.lightMapTransform)),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity,r(n.aoMap,e.aoMapTransform))}function i(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,r(t.map,e.mapTransform))}function a(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}function o(e,t,n,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*i,t.map&&(e.map.value=t.map,r(t.map,e.uvTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,r(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}function s(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,r(t.map,e.mapTransform)),t.alphaMap&&(e.alphaMap.value=t.alphaMap,r(t.alphaMap,e.alphaMapTransform)),t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}function l(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}function c(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}function u(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,r(t.metalnessMap,e.metalnessMapTransform)),e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,r(t.roughnessMap,e.roughnessMapTransform)),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}function d(e,t,n){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,r(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,r(t.sheenRoughnessMap,e.sheenRoughnessMapTransform))),t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,r(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,r(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,r(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===tk&&e.clearcoatNormalScale.value.negate())),t.dispersion>0&&(e.dispersion.value=t.dispersion),t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,r(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,r(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform))),t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=n.texture,e.transmissionSamplerSize.value.set(n.width,n.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,r(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,r(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor)),t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,r(t.anisotropyMap,e.anisotropyMapTransform))),e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,r(t.specularColorMap,e.specularColorMapTransform)),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,r(t.specularIntensityMap,e.specularIntensityMapTransform))}function h(e,t){t.matcap&&(e.matcap.value=t.matcap)}function p(e,r){let n=t.get(r).light;e.referencePosition.value.setFromMatrixPosition(n.matrixWorld),e.nearDistance.value=n.shadow.camera.near,e.farDistance.value=n.shadow.camera.far}return{refreshFogUniforms:function(t,r){r.color.getRGB(t.fogColor.value,sm(e)),r.isFog?(t.fogNear.value=r.near,t.fogFar.value=r.far):r.isFogExp2&&(t.fogDensity.value=r.density)},refreshMaterialUniforms:function(e,t,r,f,m){t.isMeshBasicMaterial?n(e,t):t.isMeshLambertMaterial?n(e,t):t.isMeshToonMaterial?(n(e,t),c(e,t)):t.isMeshPhongMaterial?(n(e,t),l(e,t)):t.isMeshStandardMaterial?(n(e,t),u(e,t),t.isMeshPhysicalMaterial&&d(e,t,m)):t.isMeshMatcapMaterial?(n(e,t),h(e,t)):t.isMeshDepthMaterial?n(e,t):t.isMeshDistanceMaterial?(n(e,t),p(e,t)):t.isMeshNormalMaterial?n(e,t):t.isLineBasicMaterial?(i(e,t),t.isLineDashedMaterial&&a(e,t)):t.isPointsMaterial?o(e,t,r,f):t.isSpriteMaterial?s(e,t):t.isShadowMaterial?(e.color.value.copy(t.color),e.opacity.value=t.opacity):t.isShaderMaterial&&(t.uniformsNeedUpdate=!1)}}}function uv(e,t,r,n){let i={},a={},o=[],s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(t){let r=c();t.__bindingPointIndex=r;let n=e.createBuffer(),i=t.__size,a=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,n),e.bufferData(e.UNIFORM_BUFFER,i,a),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,r,n),n}function c(){for(let e=0;e<s;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function u(t){let r=i[t.id],n=t.uniforms,a=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,r);for(let t=0,r=n.length;t<r;t++){let r=Array.isArray(n[t])?n[t]:[n[t]];for(let n=0,i=r.length;n<i;n++){let i=r[n];if(!0===d(i,t,n,a)){let t=i.__offset,r=Array.isArray(i.value)?i.value:[i.value],n=0;for(let a=0;a<r.length;a++){let o=r[a],s=p(o);"number"==typeof o||"boolean"==typeof o?(i.__data[0]=o,e.bufferSubData(e.UNIFORM_BUFFER,t+n,i.__data)):o.isMatrix3?(i.__data[0]=o.elements[0],i.__data[1]=o.elements[1],i.__data[2]=o.elements[2],i.__data[3]=0,i.__data[4]=o.elements[3],i.__data[5]=o.elements[4],i.__data[6]=o.elements[5],i.__data[7]=0,i.__data[8]=o.elements[6],i.__data[9]=o.elements[7],i.__data[10]=o.elements[8],i.__data[11]=0):(o.toArray(i.__data,n),n+=s.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,i.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}function d(e,t,r,n){let i=e.value,a=t+"_"+r;if(void 0===n[a])return"number"==typeof i||"boolean"==typeof i?n[a]=i:n[a]=i.clone(),!0;{let e=n[a];if("number"==typeof i||"boolean"==typeof i){if(e!==i)return n[a]=i,!0}else if(!1===e.equals(i))return e.copy(i),!0}return!1}function h(e){let t=e.uniforms,r=0,n=16;for(let e=0,i=t.length;e<i;e++){let i=Array.isArray(t[e])?t[e]:[t[e]];for(let e=0,t=i.length;e<t;e++){let t=i[e],a=Array.isArray(t.value)?t.value:[t.value];for(let e=0,i=a.length;e<i;e++){let i=p(a[e]),o=r%n,s=o%i.boundary,l=o+s;r+=s,0!==l&&n-l<i.storage&&(r+=n-l),t.__data=new Float32Array(i.storage/Float32Array.BYTES_PER_ELEMENT),t.__offset=r,r+=i.storage}}}let i=r%n;return i>0&&(r+=n-i),e.__size=r,e.__cache={},this}function p(e){let t={boundary:0,storage:0};return"number"==typeof e||"boolean"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function f(t){let r=t.target;r.removeEventListener("dispose",f);let n=o.indexOf(r.__bindingPointIndex);o.splice(n,1),e.deleteBuffer(i[r.id]),delete i[r.id],delete a[r.id]}return{bind:function(e,t){let r=t.program;n.uniformBlockBinding(e,r)},update:function(e,r){let o=i[e.id];void 0===o&&(h(e),o=l(e),i[e.id]=o,e.addEventListener("dispose",f));let s=r.program;n.updateUBOMapping(e,s);let c=t.render.frame;a[e.id]!==c&&(u(e),a[e.id]=c)},dispose:function(){for(let t in i)e.deleteBuffer(i[t]);o=[],i={},a={}}}}class ub{get coordinateSystem(){return iR}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorSpace=e===nY?"display-p3":"srgb",t.unpackColorSpace=i9.workingColorSpace===nQ?"display-p3":"srgb"}constructor(e={}){let t,r,n,i,a,o,s,l,c,u,d,h,p,f,m,g,y,v,b,_,w,S,T,x,E;let{canvas:C=i1(),context:A=null,depth:M=!0,stencil:I=!1,alpha:R=!1,antialias:k=!1,premultipliedAlpha:P=!0,preserveDrawingBuffer:O=!1,powerPreference:N="default",failIfMajorPerformanceCaveat:L=!1}=e;if(this.isWebGLRenderer=!0,null!==A){if("undefined"!=typeof WebGLRenderingContext&&A instanceof WebGLRenderingContext)throw Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");t=A.getContextAttributes().alpha}else t=R;let D=new Uint32Array(4),U=new Int32Array(4),F=null,B=null,z=[],H=[];this.domElement=C,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=n$,this.toneMapping=ro,this.toneMappingExposure=1;let j=this,G=!1,V=0,q=0,W=null,Z=-1,X=null,$=new al,K=new al,Y=null,Q=new oE(0),J=0,ee=C.width,et=C.height,er=1,en=null,ei=null,ea=new al(0,0,ee,et),eo=new al(0,0,ee,et),es=!1,el=new sD,ec=!1,eu=!1,ed=new aW,eh=new ag,ep=new al,ef={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},em=!1;function eg(){return null===W?er:1}let ey=A;function ev(e,t){return C.getContext(e,t)}try{let e={alpha:!0,depth:M,stencil:I,antialias:k,premultipliedAlpha:P,preserveDrawingBuffer:O,powerPreference:N,failIfMajorPerformanceCaveat:L};if("setAttribute"in C&&C.setAttribute("data-engine","three.js r".concat(tb)),C.addEventListener("webglcontextlost",ew,!1),C.addEventListener("webglcontextrestored",eS,!1),C.addEventListener("webglcontextcreationerror",eT,!1),null===ey){let t="webgl2";if(ey=ev(t,e),null===ey){if(ev(t))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.")}}}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function eb(){(r=new lu(ey)).init(),T=new uo(ey,r),n=new s$(ey,r,e,T),i=new ut(ey),a=new lp(ey),o=new cX,s=new ua(ey,r,i,o,n,T,a),l=new sY(j),c=new lc(j),u=new sF(ey),x=new sZ(ey,u),d=new ld(ey,u,a,x),h=new lm(ey,d,u,a),_=new lf(ey,n,s),y=new sK(o),p=new cZ(j,l,c,r,n,x,y),f=new uy(j,o),m=new cQ,g=new c5(r),b=new sW(j,l,c,i,h,t,P),v=new ue(j,h,n),E=new uv(ey,a,n,i),w=new sX(ey,r,a),S=new lh(ey,r,a),a.programs=p.programs,j.capabilities=n,j.extensions=r,j.properties=o,j.renderLists=m,j.shadowMap=v,j.state=i,j.info=a}eb();let e_=new uf(j,ey);function ew(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),G=!0}function eS(){console.log("THREE.WebGLRenderer: Context Restored."),G=!1;let e=a.autoReset,t=v.enabled,r=v.autoUpdate,n=v.needsUpdate,i=v.type;eb(),a.autoReset=e,v.enabled=t,v.autoUpdate=r,v.needsUpdate=n,v.type=i}function eT(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function ex(e){let t=e.target;t.removeEventListener("dispose",ex),eE(t)}function eE(e){eC(e),o.remove(e)}function eC(e){let t=o.get(e).programs;void 0!==t&&(t.forEach(function(e){p.releaseProgram(e)}),e.isShaderMaterial&&p.releaseShaderCache(e))}function eA(e,t,r){!0===e.transparent&&e.side===tP&&!1===e.forceSinglePass?(e.side=tk,e.needsUpdate=!0,eF(e,t,r),e.side=tR,e.needsUpdate=!0,eF(e,t,r),e.side=tP):eF(e,t,r)}this.xr=e_,this.getContext=function(){return ey},this.getContextAttributes=function(){return ey.getContextAttributes()},this.forceContextLoss=function(){let e=r.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){let e=r.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return er},this.setPixelRatio=function(e){void 0!==e&&(er=e,this.setSize(ee,et,!1))},this.getSize=function(e){return e.set(ee,et)},this.setSize=function(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(e_.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ee=e,et=t,C.width=Math.floor(e*er),C.height=Math.floor(t*er),!0===r&&(C.style.width=e+"px",C.style.height=t+"px"),this.setViewport(0,0,e,t)},this.getDrawingBufferSize=function(e){return e.set(ee*er,et*er).floor()},this.setDrawingBufferSize=function(e,t,r){ee=e,et=t,er=r,C.width=Math.floor(e*r),C.height=Math.floor(t*r),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy($)},this.getViewport=function(e){return e.copy(ea)},this.setViewport=function(e,t,r,n){e.isVector4?ea.set(e.x,e.y,e.z,e.w):ea.set(e,t,r,n),i.viewport($.copy(ea).multiplyScalar(er).round())},this.getScissor=function(e){return e.copy(eo)},this.setScissor=function(e,t,r,n){e.isVector4?eo.set(e.x,e.y,e.z,e.w):eo.set(e,t,r,n),i.scissor(K.copy(eo).multiplyScalar(er).round())},this.getScissorTest=function(){return es},this.setScissorTest=function(e){i.setScissorTest(es=e)},this.setOpaqueSort=function(e){en=e},this.setTransparentSort=function(e){ei=e},this.getClearColor=function(e){return e.copy(b.getClearColor())},this.setClearColor=function(){b.setClearColor.apply(b,arguments)},this.getClearAlpha=function(){return b.getClearAlpha()},this.setClearAlpha=function(){b.setClearAlpha.apply(b,arguments)},this.clear=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=0;if(e){let e=!1;if(null!==W){let t=W.texture.format;e=t===r5||t===r3||t===r1}if(e){let e=W.texture.type,t=e===rL||e===rz||e===rF||e===rq||e===rG||e===rV,r=b.getClearColor(),n=b.getClearAlpha(),i=r.r,a=r.g,o=r.b;t?(D[0]=i,D[1]=a,D[2]=o,D[3]=n,ey.clearBufferuiv(ey.COLOR,0,D)):(U[0]=i,U[1]=a,U[2]=o,U[3]=n,ey.clearBufferiv(ey.COLOR,0,U))}else n|=ey.COLOR_BUFFER_BIT}t&&(n|=ey.DEPTH_BUFFER_BIT),r&&(n|=ey.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ey.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){C.removeEventListener("webglcontextlost",ew,!1),C.removeEventListener("webglcontextrestored",eS,!1),C.removeEventListener("webglcontextcreationerror",eT,!1),m.dispose(),g.dispose(),o.dispose(),l.dispose(),c.dispose(),h.dispose(),x.dispose(),E.dispose(),p.dispose(),e_.dispose(),e_.removeEventListener("sessionstart",eR),e_.removeEventListener("sessionend",ek),eP.stop()},this.renderBufferDirect=function(e,t,n,a,s,l){let c;null===t&&(t=ef);let h=s.isMesh&&0>s.matrixWorld.determinant(),p=eH(e,t,n,a,s);i.setMaterial(a,h);let f=n.index,m=1;if(!0===a.wireframe){if(void 0===(f=d.getWireframeAttribute(n)))return;m=2}let g=n.drawRange,y=n.attributes.position,v=g.start*m,b=(g.start+g.count)*m;null!==l&&(v=Math.max(v,l.start*m),b=Math.min(b,(l.start+l.count)*m)),null!==f?(v=Math.max(v,0),b=Math.min(b,f.count)):null!=y&&(v=Math.max(v,0),b=Math.min(b,y.count));let _=b-v;if(_<0||_===1/0)return;x.setup(s,a,p,n,f);let T=w;if(null!==f&&(c=u.get(f),(T=S).setIndex(c)),s.isMesh)!0===a.wireframe?(i.setLineWidth(a.wireframeLinewidth*eg()),T.setMode(ey.LINES)):T.setMode(ey.TRIANGLES);else if(s.isLine){let e=a.linewidth;void 0===e&&(e=1),i.setLineWidth(e*eg()),s.isLineSegments?T.setMode(ey.LINES):s.isLineLoop?T.setMode(ey.LINE_LOOP):T.setMode(ey.LINE_STRIP)}else s.isPoints?T.setMode(ey.POINTS):s.isSprite&&T.setMode(ey.TRIANGLES);if(s.isBatchedMesh){if(null!==s._multiDrawInstances)T.renderMultiDrawInstances(s._multiDrawStarts,s._multiDrawCounts,s._multiDrawCount,s._multiDrawInstances);else if(r.get("WEBGL_multi_draw"))T.renderMultiDraw(s._multiDrawStarts,s._multiDrawCounts,s._multiDrawCount);else{let e=s._multiDrawStarts,t=s._multiDrawCounts,r=s._multiDrawCount,n=f?u.get(f).bytesPerElement:1,i=o.get(a).currentProgram.getUniforms();for(let a=0;a<r;a++)i.setValue(ey,"_gl_DrawID",a),T.render(e[a]/n,t[a])}}else if(s.isInstancedMesh)T.renderInstances(v,_,s.count);else if(n.isInstancedBufferGeometry){let e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);T.renderInstances(v,_,t)}else T.render(v,_)},this.compile=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===r&&(r=e),(B=g.get(r)).init(t),H.push(B),r.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(B.pushLight(e),e.castShadow&&B.pushShadow(e))}),e!==r&&e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(B.pushLight(e),e.castShadow&&B.pushShadow(e))}),B.setupLights();let n=new Set;return e.traverse(function(e){let t=e.material;if(t){if(Array.isArray(t))for(let i=0;i<t.length;i++){let a=t[i];eA(a,r,e),n.add(a)}else eA(t,r,e),n.add(t)}}),H.pop(),B=null,n},this.compileAsync=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.compile(e,t,n);return new Promise(t=>{function n(){if(i.forEach(function(e){o.get(e).currentProgram.isReady()&&i.delete(e)}),0===i.size){t(e);return}setTimeout(n,10)}null!==r.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)})};let eM=null;function eI(e){eM&&eM(e)}function eR(){eP.stop()}function ek(){eP.start()}let eP=new sU;function eO(e,t,r,n){if(!1===e.visible)return;if(e.layers.test(t.layers)){if(e.isGroup)r=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)B.pushLight(e),e.castShadow&&B.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||el.intersectsSprite(e)){n&&ep.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ed);let t=h.update(e),i=e.material;i.visible&&F.push(e,t,i,r,ep.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||el.intersectsObject(e))){let t=h.update(e),i=e.material;if(n&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),ep.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),ep.copy(t.boundingSphere.center)),ep.applyMatrix4(e.matrixWorld).applyMatrix4(ed)),Array.isArray(i)){let n=t.groups;for(let a=0,o=n.length;a<o;a++){let o=n[a],s=i[o.materialIndex];s&&s.visible&&F.push(e,t,s,r,ep.z,o)}}else i.visible&&F.push(e,t,i,r,ep.z,null)}}let i=e.children;for(let e=0,a=i.length;e<a;e++)eO(i[e],t,r,n)}function eN(e,t,r,n){let a=e.opaque,o=e.transmissive,s=e.transparent;B.setupLightsView(r),!0===ec&&y.setGlobalState(j.clippingPlanes,r),n&&i.viewport($.copy(n)),a.length>0&&eD(a,t,r),o.length>0&&eD(o,t,r),s.length>0&&eD(s,t,r),i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),i.setPolygonOffset(!1)}function eL(e,t,n,i){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;void 0===B.state.transmissionRenderTarget[i.id]&&(B.state.transmissionRenderTarget[i.id]=new au(1,1,{generateMipmaps:!0,type:r.has("EXT_color_buffer_half_float")||r.has("EXT_color_buffer_float")?rj:rL,minFilter:rO,samples:4,stencilBuffer:I,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:i9.workingColorSpace}));let a=B.state.transmissionRenderTarget[i.id],o=i.viewport||$;a.setSize(o.z,o.w);let l=j.getRenderTarget();j.setRenderTarget(a),j.getClearColor(Q),(J=j.getClearAlpha())<1&&j.setClearColor(16777215,.5),j.clear(),em&&b.render(n);let c=j.toneMapping;j.toneMapping=ro;let u=i.viewport;if(void 0!==i.viewport&&(i.viewport=void 0),B.setupLightsView(i),!0===ec&&y.setGlobalState(j.clippingPlanes,i),eD(e,n,i),s.updateMultisampleRenderTarget(a),s.updateRenderTargetMipmap(a),!1===r.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let r=0,a=t.length;r<a;r++){let a=t[r],o=a.object,s=a.geometry,l=a.material,c=a.group;if(l.side===tP&&o.layers.test(i.layers)){let t=l.side;l.side=tk,l.needsUpdate=!0,eU(o,n,i,s,l,c),l.side=t,l.needsUpdate=!0,e=!0}}!0===e&&(s.updateMultisampleRenderTarget(a),s.updateRenderTargetMipmap(a))}j.setRenderTarget(l),j.setClearColor(Q,J),void 0!==u&&(i.viewport=u),j.toneMapping=c}function eD(e,t,r){let n=!0===t.isScene?t.overrideMaterial:null;for(let i=0,a=e.length;i<a;i++){let a=e[i],o=a.object,s=a.geometry,l=null===n?a.material:n,c=a.group;o.layers.test(r.layers)&&eU(o,t,r,s,l,c)}}function eU(e,t,r,n,i,a){e.onBeforeRender(j,t,r,n,i,a),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),!0===i.transparent&&i.side===tP&&!1===i.forceSinglePass?(i.side=tk,i.needsUpdate=!0,j.renderBufferDirect(r,t,n,i,e,a),i.side=tR,i.needsUpdate=!0,j.renderBufferDirect(r,t,n,i,e,a),i.side=tP):j.renderBufferDirect(r,t,n,i,e,a),e.onAfterRender(j,t,r,n,i,a)}function eF(e,t,r){!0!==t.isScene&&(t=ef);let n=o.get(e),i=B.state.lights,a=B.state.shadowsArray,s=i.state.version,u=p.getParameters(e,i.state,a,t,r),d=p.getProgramCacheKey(u),h=n.programs;n.environment=e.isMeshStandardMaterial?t.environment:null,n.fog=t.fog,n.envMap=(e.isMeshStandardMaterial?c:l).get(e.envMap||n.environment),n.envMapRotation=null!==n.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===h&&(e.addEventListener("dispose",ex),h=new Map,n.programs=h);let f=h.get(d);if(void 0!==f){if(n.currentProgram===f&&n.lightsStateVersion===s)return ez(e,u),f}else u.uniforms=p.getUniforms(e),e.onBeforeCompile(u,j),f=p.acquireProgram(u,d),h.set(d,f),n.uniforms=u.uniforms;let m=n.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(m.clippingPlanes=y.uniform),ez(e,u),n.needsLights=eG(e),n.lightsStateVersion=s,n.needsLights&&(m.ambientLightColor.value=i.state.ambient,m.lightProbe.value=i.state.probe,m.directionalLights.value=i.state.directional,m.directionalLightShadows.value=i.state.directionalShadow,m.spotLights.value=i.state.spot,m.spotLightShadows.value=i.state.spotShadow,m.rectAreaLights.value=i.state.rectArea,m.ltc_1.value=i.state.rectAreaLTC1,m.ltc_2.value=i.state.rectAreaLTC2,m.pointLights.value=i.state.point,m.pointLightShadows.value=i.state.pointShadow,m.hemisphereLights.value=i.state.hemi,m.directionalShadowMap.value=i.state.directionalShadowMap,m.directionalShadowMatrix.value=i.state.directionalShadowMatrix,m.spotShadowMap.value=i.state.spotShadowMap,m.spotLightMatrix.value=i.state.spotLightMatrix,m.spotLightMap.value=i.state.spotLightMap,m.pointShadowMap.value=i.state.pointShadowMap,m.pointShadowMatrix.value=i.state.pointShadowMatrix),n.currentProgram=f,n.uniformsList=null,f}function eB(e){if(null===e.uniformsList){let t=e.currentProgram.getUniforms();e.uniformsList=cp.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function ez(e,t){let r=o.get(e);r.outputColorSpace=t.outputColorSpace,r.batching=t.batching,r.batchingColor=t.batchingColor,r.instancing=t.instancing,r.instancingColor=t.instancingColor,r.instancingMorph=t.instancingMorph,r.skinning=t.skinning,r.morphTargets=t.morphTargets,r.morphNormals=t.morphNormals,r.morphColors=t.morphColors,r.morphTargetsCount=t.morphTargetsCount,r.numClippingPlanes=t.numClippingPlanes,r.numIntersection=t.numClipIntersection,r.vertexAlphas=t.vertexAlphas,r.vertexTangents=t.vertexTangents,r.toneMapping=t.toneMapping}function eH(e,t,r,a,u){!0!==t.isScene&&(t=ef),s.resetTextureUnits();let d=t.fog,h=a.isMeshStandardMaterial?t.environment:null,p=null===W?j.outputColorSpace:!0===W.isXRRenderTarget?W.texture.colorSpace:nK,m=(a.isMeshStandardMaterial?c:l).get(a.envMap||h),g=!0===a.vertexColors&&!!r.attributes.color&&4===r.attributes.color.itemSize,v=!!r.attributes.tangent&&(!!a.normalMap||a.anisotropy>0),b=!!r.morphAttributes.position,w=!!r.morphAttributes.normal,S=!!r.morphAttributes.color,T=ro;a.toneMapped&&(null===W||!0===W.isXRRenderTarget)&&(T=j.toneMapping);let x=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,C=void 0!==x?x.length:0,A=o.get(a),M=B.state.lights;if(!0===ec&&(!0===eu||e!==X)){let t=e===X&&a.id===Z;y.setState(a,e,t)}let I=!1;a.version===A.__version?A.needsLights&&A.lightsStateVersion!==M.state.version?I=!0:A.outputColorSpace!==p?I=!0:u.isBatchedMesh&&!1===A.batching?I=!0:u.isBatchedMesh||!0!==A.batching?u.isBatchedMesh&&!0===A.batchingColor&&null===u.colorTexture?I=!0:u.isBatchedMesh&&!1===A.batchingColor&&null!==u.colorTexture?I=!0:u.isInstancedMesh&&!1===A.instancing?I=!0:u.isInstancedMesh||!0!==A.instancing?u.isSkinnedMesh&&!1===A.skinning?I=!0:u.isSkinnedMesh||!0!==A.skinning?u.isInstancedMesh&&!0===A.instancingColor&&null===u.instanceColor?I=!0:u.isInstancedMesh&&!1===A.instancingColor&&null!==u.instanceColor?I=!0:u.isInstancedMesh&&!0===A.instancingMorph&&null===u.morphTexture?I=!0:u.isInstancedMesh&&!1===A.instancingMorph&&null!==u.morphTexture?I=!0:A.envMap!==m?I=!0:!0===a.fog&&A.fog!==d?I=!0:void 0!==A.numClippingPlanes&&(A.numClippingPlanes!==y.numPlanes||A.numIntersection!==y.numIntersection)?I=!0:A.vertexAlphas!==g?I=!0:A.vertexTangents!==v?I=!0:A.morphTargets!==b?I=!0:A.morphNormals!==w?I=!0:A.morphColors!==S?I=!0:A.toneMapping!==T?I=!0:A.morphTargetsCount!==C&&(I=!0):I=!0:I=!0:I=!0:(I=!0,A.__version=a.version);let R=A.currentProgram;!0===I&&(R=eF(a,t,u));let k=!1,P=!1,O=!1,N=R.getUniforms(),L=A.uniforms;if(i.useProgram(R.program)&&(k=!0,P=!0,O=!0),a.id!==Z&&(Z=a.id,P=!0),k||X!==e){N.setValue(ey,"projectionMatrix",e.projectionMatrix),N.setValue(ey,"viewMatrix",e.matrixWorldInverse);let t=N.map.cameraPosition;void 0!==t&&t.setValue(ey,eh.setFromMatrixPosition(e.matrixWorld)),n.logarithmicDepthBuffer&&N.setValue(ey,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(a.isMeshPhongMaterial||a.isMeshToonMaterial||a.isMeshLambertMaterial||a.isMeshBasicMaterial||a.isMeshStandardMaterial||a.isShaderMaterial)&&N.setValue(ey,"isOrthographic",!0===e.isOrthographicCamera),X!==e&&(X=e,P=!0,O=!0)}if(u.isSkinnedMesh){N.setOptional(ey,u,"bindMatrix"),N.setOptional(ey,u,"bindMatrixInverse");let e=u.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),N.setValue(ey,"boneTexture",e.boneTexture,s))}u.isBatchedMesh&&(N.setOptional(ey,u,"batchingTexture"),N.setValue(ey,"batchingTexture",u._matricesTexture,s),N.setOptional(ey,u,"batchingIdTexture"),N.setValue(ey,"batchingIdTexture",u._indirectTexture,s),N.setOptional(ey,u,"batchingColorTexture"),null!==u._colorsTexture&&N.setValue(ey,"batchingColorTexture",u._colorsTexture,s));let D=r.morphAttributes;if((void 0!==D.position||void 0!==D.normal||void 0!==D.color)&&_.update(u,r,R),(P||A.receiveShadow!==u.receiveShadow)&&(A.receiveShadow=u.receiveShadow,N.setValue(ey,"receiveShadow",u.receiveShadow)),a.isMeshGouraudMaterial&&null!==a.envMap&&(L.envMap.value=m,L.flipEnvMap.value=m.isCubeTexture&&!1===m.isRenderTargetTexture?-1:1),a.isMeshStandardMaterial&&null===a.envMap&&null!==t.environment&&(L.envMapIntensity.value=t.environmentIntensity),P&&(N.setValue(ey,"toneMappingExposure",j.toneMappingExposure),A.needsLights&&ej(L,O),d&&!0===a.fog&&f.refreshFogUniforms(L,d),f.refreshMaterialUniforms(L,a,er,et,B.state.transmissionRenderTarget[e.id]),cp.upload(ey,eB(A),L,s)),a.isShaderMaterial&&!0===a.uniformsNeedUpdate&&(cp.upload(ey,eB(A),L,s),a.uniformsNeedUpdate=!1),a.isSpriteMaterial&&N.setValue(ey,"center",u.center),N.setValue(ey,"modelViewMatrix",u.modelViewMatrix),N.setValue(ey,"normalMatrix",u.normalMatrix),N.setValue(ey,"modelMatrix",u.matrixWorld),a.isShaderMaterial||a.isRawShaderMaterial){let e=a.uniformsGroups;for(let t=0,r=e.length;t<r;t++){let r=e[t];E.update(r,R),E.bind(r,R)}}return R}function ej(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}function eG(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}eP.setAnimationLoop(eI),"undefined"!=typeof self&&eP.setContext(self),this.setAnimationLoop=function(e){eM=e,e_.setAnimationLoop(e),null===e?eP.stop():eP.start()},e_.addEventListener("sessionstart",eR),e_.addEventListener("sessionend",ek),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(!0===G)return;if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===e_.enabled&&!0===e_.isPresenting&&(!0===e_.cameraAutoUpdate&&e_.updateCamera(t),t=e_.getCamera()),!0===e.isScene&&e.onBeforeRender(j,e,t,W),(B=g.get(e,H.length)).init(t),H.push(B),ed.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),el.setFromProjectionMatrix(ed),eu=this.localClippingEnabled,ec=y.init(this.clippingPlanes,eu),(F=m.get(e,z.length)).init(),z.push(F),!0===e_.enabled&&!0===e_.isPresenting){let e=j.xr.getDepthSensingMesh();null!==e&&eO(e,t,-1/0,j.sortObjects)}eO(e,t,0,j.sortObjects),F.finish(),!0===j.sortObjects&&F.sort(en,ei),(em=!1===e_.enabled||!1===e_.isPresenting||!1===e_.hasDepthSensing())&&b.addToRenderList(F,e),this.info.render.frame++,!0===ec&&y.beginShadows();let r=B.state.shadowsArray;v.render(r,e,t),!0===ec&&y.endShadows(),!0===this.info.autoReset&&this.info.reset();let n=F.opaque,i=F.transmissive;if(B.setupLights(),t.isArrayCamera){let r=t.cameras;if(i.length>0)for(let t=0,a=r.length;t<a;t++)eL(n,i,e,r[t]);em&&b.render(e);for(let t=0,n=r.length;t<n;t++){let n=r[t];eN(F,e,n,n.viewport)}}else i.length>0&&eL(n,i,e,t),em&&b.render(e),eN(F,e,t);null!==W&&(s.updateMultisampleRenderTarget(W),s.updateRenderTargetMipmap(W)),!0===e.isScene&&e.onAfterRender(j,e,t),x.resetDefaultState(),Z=-1,X=null,H.pop(),H.length>0?(B=H[H.length-1],!0===ec&&y.setGlobalState(j.clippingPlanes,B.state.camera)):B=null,z.pop(),F=z.length>0?z[z.length-1]:null},this.getActiveCubeFace=function(){return V},this.getActiveMipmapLevel=function(){return q},this.getRenderTarget=function(){return W},this.setRenderTargetTextures=function(e,t,n){o.get(e.texture).__webglTexture=t,o.get(e.depthTexture).__webglTexture=n;let i=o.get(e);i.__hasExternalTextures=!0,i.__autoAllocateDepthBuffer=void 0===n,i.__autoAllocateDepthBuffer||!0!==r.has("WEBGL_multisampled_render_to_texture")||(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),i.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(e,t){let r=o.get(e);r.__webglFramebuffer=t,r.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;W=e,V=t,q=r;let n=!0,a=null,l=!1,c=!1;if(e){let u=o.get(e);void 0!==u.__useDefaultFramebuffer?(i.bindFramebuffer(ey.FRAMEBUFFER,null),n=!1):void 0===u.__webglFramebuffer?s.setupRenderTarget(e):u.__hasExternalTextures&&s.rebindTextures(e,o.get(e.texture).__webglTexture,o.get(e.depthTexture).__webglTexture);let d=e.texture;(d.isData3DTexture||d.isDataArrayTexture||d.isCompressedArrayTexture)&&(c=!0);let h=o.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(a=Array.isArray(h[t])?h[t][r]:h[t],l=!0):a=e.samples>0&&!1===s.useMultisampledRTT(e)?o.get(e).__webglMultisampledFramebuffer:Array.isArray(h)?h[r]:h,$.copy(e.viewport),K.copy(e.scissor),Y=e.scissorTest}else $.copy(ea).multiplyScalar(er).floor(),K.copy(eo).multiplyScalar(er).floor(),Y=es;if(i.bindFramebuffer(ey.FRAMEBUFFER,a)&&n&&i.drawBuffers(e,a),i.viewport($),i.scissor(K),i.setScissorTest(Y),l){let n=o.get(e.texture);ey.framebufferTexture2D(ey.FRAMEBUFFER,ey.COLOR_ATTACHMENT0,ey.TEXTURE_CUBE_MAP_POSITIVE_X+t,n.__webglTexture,r)}else if(c){let n=o.get(e.texture),i=t||0;ey.framebufferTextureLayer(ey.FRAMEBUFFER,ey.COLOR_ATTACHMENT0,n.__webglTexture,r||0,i)}Z=-1},this.readRenderTargetPixels=function(e,t,r,a,s,l,c){if(!(e&&e.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let u=o.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==c&&(u=u[c]),u){i.bindFramebuffer(ey.FRAMEBUFFER,u);try{let i=e.texture,o=i.format,c=i.type;if(!n.textureFormatReadable(o)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!n.textureTypeReadable(c)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}t>=0&&t<=e.width-a&&r>=0&&r<=e.height-s&&ey.readPixels(t,r,a,s,T.convert(o),T.convert(c),l)}finally{let e=null!==W?o.get(W).__webglFramebuffer:null;i.bindFramebuffer(ey.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,r,a,s,l,c){if(!(e&&e.isWebGLRenderTarget))throw Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let u=o.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==c&&(u=u[c]),u){i.bindFramebuffer(ey.FRAMEBUFFER,u);try{let i=e.texture,o=i.format,c=i.type;if(!n.textureFormatReadable(o))throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!n.textureTypeReadable(c))throw Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(t>=0&&t<=e.width-a&&r>=0&&r<=e.height-s){let e=ey.createBuffer();ey.bindBuffer(ey.PIXEL_PACK_BUFFER,e),ey.bufferData(ey.PIXEL_PACK_BUFFER,l.byteLength,ey.STREAM_READ),ey.readPixels(t,r,a,s,T.convert(o),T.convert(c),0),ey.flush();let n=ey.fenceSync(ey.SYNC_GPU_COMMANDS_COMPLETE,0);await i4(ey,n,4);try{ey.bindBuffer(ey.PIXEL_PACK_BUFFER,e),ey.getBufferSubData(ey.PIXEL_PACK_BUFFER,0,l)}finally{ey.deleteBuffer(e),ey.deleteSync(n)}return l}}finally{let e=null!==W?o.get(W).__webglFramebuffer:null;i.bindFramebuffer(ey.FRAMEBUFFER,e)}}},this.copyFramebufferToTexture=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!0!==e.isTexture&&(i3("WebGLRenderer: copyFramebufferToTexture function signature has changed."),t=arguments[0]||null,e=arguments[1]);let n=Math.pow(2,-r),a=Math.floor(e.image.width*n),o=Math.floor(e.image.height*n),l=null!==t?t.x:0,c=null!==t?t.y:0;s.setTexture2D(e,0),ey.copyTexSubImage2D(ey.TEXTURE_2D,r,0,0,l,c,a,o),i.unbindTexture()},this.copyTextureToTexture=function(e,t){let r,n,a,o,l,c,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;!0!==e.isTexture&&(i3("WebGLRenderer: copyTextureToTexture function signature has changed."),d=arguments[0]||null,e=arguments[1],t=arguments[2],h=arguments[3]||0,u=null),null!==u?(r=u.max.x-u.min.x,n=u.max.y-u.min.y,a=u.min.x,o=u.min.y):(r=e.image.width,n=e.image.height,a=0,o=0),null!==d?(l=d.x,c=d.y):(l=0,c=0);let p=T.convert(t.format),f=T.convert(t.type);s.setTexture2D(t,0),ey.pixelStorei(ey.UNPACK_FLIP_Y_WEBGL,t.flipY),ey.pixelStorei(ey.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),ey.pixelStorei(ey.UNPACK_ALIGNMENT,t.unpackAlignment);let m=ey.getParameter(ey.UNPACK_ROW_LENGTH),g=ey.getParameter(ey.UNPACK_IMAGE_HEIGHT),y=ey.getParameter(ey.UNPACK_SKIP_PIXELS),v=ey.getParameter(ey.UNPACK_SKIP_ROWS),b=ey.getParameter(ey.UNPACK_SKIP_IMAGES),_=e.isCompressedTexture?e.mipmaps[h]:e.image;ey.pixelStorei(ey.UNPACK_ROW_LENGTH,_.width),ey.pixelStorei(ey.UNPACK_IMAGE_HEIGHT,_.height),ey.pixelStorei(ey.UNPACK_SKIP_PIXELS,a),ey.pixelStorei(ey.UNPACK_SKIP_ROWS,o),e.isDataTexture?ey.texSubImage2D(ey.TEXTURE_2D,h,l,c,r,n,p,f,_.data):e.isCompressedTexture?ey.compressedTexSubImage2D(ey.TEXTURE_2D,h,l,c,_.width,_.height,p,_.data):ey.texSubImage2D(ey.TEXTURE_2D,h,l,c,r,n,p,f,_),ey.pixelStorei(ey.UNPACK_ROW_LENGTH,m),ey.pixelStorei(ey.UNPACK_IMAGE_HEIGHT,g),ey.pixelStorei(ey.UNPACK_SKIP_PIXELS,y),ey.pixelStorei(ey.UNPACK_SKIP_ROWS,v),ey.pixelStorei(ey.UNPACK_SKIP_IMAGES,b),0===h&&t.generateMipmaps&&ey.generateMipmap(ey.TEXTURE_2D),i.unbindTexture()},this.copyTextureToTexture3D=function(e,t){let r,n,a,o,l,c,u,d,h,p,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;!0!==e.isTexture&&(i3("WebGLRenderer: copyTextureToTexture3D function signature has changed."),f=arguments[0]||null,m=arguments[1]||null,e=arguments[2],t=arguments[3],g=arguments[4]||0);let y=e.isCompressedTexture?e.mipmaps[g]:e.image;null!==f?(r=f.max.x-f.min.x,n=f.max.y-f.min.y,a=f.max.z-f.min.z,o=f.min.x,l=f.min.y,c=f.min.z):(r=y.width,n=y.height,a=y.depth,o=0,l=0,c=0),null!==m?(u=m.x,d=m.y,h=m.z):(u=0,d=0,h=0);let v=T.convert(t.format),b=T.convert(t.type);if(t.isData3DTexture)s.setTexture3D(t,0),p=ey.TEXTURE_3D;else if(t.isDataArrayTexture||t.isCompressedArrayTexture)s.setTexture2DArray(t,0),p=ey.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ey.pixelStorei(ey.UNPACK_FLIP_Y_WEBGL,t.flipY),ey.pixelStorei(ey.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),ey.pixelStorei(ey.UNPACK_ALIGNMENT,t.unpackAlignment);let _=ey.getParameter(ey.UNPACK_ROW_LENGTH),w=ey.getParameter(ey.UNPACK_IMAGE_HEIGHT),S=ey.getParameter(ey.UNPACK_SKIP_PIXELS),x=ey.getParameter(ey.UNPACK_SKIP_ROWS),E=ey.getParameter(ey.UNPACK_SKIP_IMAGES);ey.pixelStorei(ey.UNPACK_ROW_LENGTH,y.width),ey.pixelStorei(ey.UNPACK_IMAGE_HEIGHT,y.height),ey.pixelStorei(ey.UNPACK_SKIP_PIXELS,o),ey.pixelStorei(ey.UNPACK_SKIP_ROWS,l),ey.pixelStorei(ey.UNPACK_SKIP_IMAGES,c),e.isDataTexture||e.isData3DTexture?ey.texSubImage3D(p,g,u,d,h,r,n,a,v,b,y.data):t.isCompressedArrayTexture?ey.compressedTexSubImage3D(p,g,u,d,h,r,n,a,v,y.data):ey.texSubImage3D(p,g,u,d,h,r,n,a,v,b,y),ey.pixelStorei(ey.UNPACK_ROW_LENGTH,_),ey.pixelStorei(ey.UNPACK_IMAGE_HEIGHT,w),ey.pixelStorei(ey.UNPACK_SKIP_PIXELS,S),ey.pixelStorei(ey.UNPACK_SKIP_ROWS,x),ey.pixelStorei(ey.UNPACK_SKIP_IMAGES,E),0===g&&t.generateMipmaps&&ey.generateMipmap(p),i.unbindTexture()},this.initRenderTarget=function(e){void 0===o.get(e).__webglFramebuffer&&s.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?s.setTextureCube(e,0):e.isData3DTexture?s.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?s.setTexture2DArray(e,0):s.setTexture2D(e,0),i.unbindTexture()},this.resetState=function(){V=0,q=0,W=null,i.reset(),x.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}class u_{clone(){return new u_(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new oE(e),this.density=t}}class uw{clone(){return new uw(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new oE(e),this.near=t,this.far=r}}class uS extends oc{copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new a2,this.environmentIntensity=1,this.environmentRotation=new a2,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}class uT{onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return i3("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=iU()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=iU()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=ib,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=iU()}}let ux=new ag;class uE{get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)ux.fromBufferAttribute(this,t),ux.applyMatrix4(e),this.setXYZ(t,ux.x,ux.y,ux.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)ux.fromBufferAttribute(this,t),ux.applyNormalMatrix(e),this.setXYZ(t,ux.x,ux.y,ux.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)ux.fromBufferAttribute(this,t),ux.transformDirection(e),this.setXYZ(t,ux.x,ux.y,ux.z);return this}getComponent(e,t){let r=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(r=iq(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=iW(r,this.array)),this.data.array[e*this.data.stride+this.offset+t]=r,this}setX(e,t){return this.normalized&&(t=iW(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=iW(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=iW(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=iW(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=iq(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=iq(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=iq(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=iq(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=iW(t,this.array),r=iW(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=iW(t,this.array),r=iW(r,this.array),n=iW(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=iW(t,this.array),r=iW(r,this.array),n=iW(n,this.array),i=iW(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this}clone(e){if(void 0!==e)return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new uE(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized);{console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return new oU(new this.array.constructor(e),this.itemSize,this.normalized)}}toJSON(e){if(void 0!==e)return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized};{console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}}constructor(e,t,r,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=n}}class uC extends oM{copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new oE(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}}let uA=new ag,uM=new ag,uI=new ag,uR=new iX,uk=new iX,uP=new aW,uO=new ag,uN=new ag,uL=new ag,uD=new iX,uU=new iX,uF=new iX;class uB extends oc{raycast(e,t){let r,n;null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),uM.setFromMatrixScale(this.matrixWorld),uP.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),uI.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&uM.multiplyScalar(-uI.z);let i=this.material.rotation;0!==i&&(n=Math.cos(i),r=Math.sin(i));let a=this.center;uz(uO.set(-.5,-.5,0),uI,a,uM,r,n),uz(uN.set(.5,-.5,0),uI,a,uM,r,n),uz(uL.set(.5,.5,0),uI,a,uM,r,n),uD.set(0,0),uU.set(1,0),uF.set(1,1);let o=e.ray.intersectTriangle(uO,uN,uL,!1,uA);if(null===o&&(uz(uN.set(-.5,.5,0),uI,a,uM,r,n),uU.set(0,1),null===(o=e.ray.intersectTriangle(uO,uL,uN,!1,uA))))return;let s=e.ray.origin.distanceTo(uA);s<e.near||s>e.far||t.push({distance:s,point:uA.clone(),uv:o_.getInterpolation(uA,uO,uN,uL,uD,uU,uF,new iX),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}constructor(e=new uC){if(super(),this.isSprite=!0,this.type="Sprite",void 0===a){a=new o0;let e=new uT(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);a.setIndex([0,1,2,0,2,3]),a.setAttribute("position",new uE(e,3,0,!1)),a.setAttribute("uv",new uE(e,2,3,!1))}this.geometry=a,this.material=e,this.center=new iX(.5,.5)}}function uz(e,t,r,n,i,a){uR.subVectors(e,r).addScalar(.5).multiply(n),void 0!==i?(uk.x=a*uR.x-i*uR.y,uk.y=i*uR.x+a*uR.y):uk.copy(uR),e.copy(t),e.x+=uk.x,e.y+=uk.y,e.applyMatrix4(uP)}let uH=new ag,uj=new ag;class uG extends oc{copy(e){super.copy(e,!1);let t=e.levels;for(let e=0,r=t.length;e<r;e++){let r=t[e];this.addLevel(r.object.clone(),r.distance,r.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;r=Math.abs(r);let i=this.levels;for(t=0;t<i.length&&!(r<i[t].distance);t++);return i.splice(t,0,{distance:r,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){let t=this.levels;if(t.length>0){let r,n;for(r=1,n=t.length;r<n;r++){let n=t[r].distance;if(t[r].object.visible&&(n-=n*t[r].hysteresis),e<n)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){uH.setFromMatrixPosition(this.matrixWorld);let r=e.ray.origin.distanceTo(uH);this.getObjectForDistance(r).raycast(e,t)}}update(e){let t=this.levels;if(t.length>1){let r,n;uH.setFromMatrixPosition(e.matrixWorld),uj.setFromMatrixPosition(this.matrixWorld);let i=uH.distanceTo(uj)/e.zoom;for(r=1,t[0].object.visible=!0,n=t.length;r<n;r++){let e=t[r].distance;if(t[r].object.visible&&(e-=e*t[r].hysteresis),i>=e)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<n;r++)t[r].object.visible=!1}}toJSON(e){let t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];let r=this.levels;for(let e=0,n=r.length;e<n;e++){let n=r[e];t.object.levels.push({object:n.object.uuid,distance:n.distance,hysteresis:n.hysteresis})}return t}constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}}let uV=new ag,uq=new al,uW=new al,uZ=new ag,uX=new aW,u$=new ag,uK=new aU,uY=new aW,uQ=new aq;class uJ extends sl{computeBoundingBox(){let e=this.geometry;null===this.boundingBox&&(this.boundingBox=new ab),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let e=0;e<t.count;e++)this.getVertexPosition(e,u$),this.boundingBox.expandByPoint(u$)}computeBoundingSphere(){let e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new aU),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let e=0;e<t.count;e++)this.getVertexPosition(e,u$),this.boundingSphere.expandByPoint(u$)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let r=this.material,n=this.matrixWorld;if(void 0!==r&&(null===this.boundingSphere&&this.computeBoundingSphere(),uK.copy(this.boundingSphere),uK.applyMatrix4(n),!1!==e.ray.intersectsSphere(uK))){if(uY.copy(n).invert(),uQ.copy(e.ray).applyMatrix4(uY),null!==this.boundingBox&&!1===uQ.intersectsBox(this.boundingBox))return;this._computeIntersections(e,t,uQ)}}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new al,t=this.geometry.attributes.skinWeight;for(let r=0,n=t.count;r<n;r++){e.fromBufferAttribute(t,r);let n=1/e.manhattanLength();n!==1/0?e.multiplyScalar(n):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===rf?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===rm?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let r=this.skeleton,n=this.geometry;uq.fromBufferAttribute(n.attributes.skinIndex,e),uW.fromBufferAttribute(n.attributes.skinWeight,e),uV.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){let n=uW.getComponent(e);if(0!==n){let i=uq.getComponent(e);uX.multiplyMatrices(r.bones[i].matrixWorld,r.boneInverses[i]),t.addScaledVector(uZ.copy(uV).applyMatrix4(uX),n)}}return t.applyMatrix4(this.bindMatrixInverse)}constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=rf,this.bindMatrix=new aW,this.bindMatrixInverse=new aW,this.boundingBox=null,this.boundingSphere=null}}class u0 extends oc{constructor(){super(),this.isBone=!0,this.type="Bone"}}class u1 extends as{constructor(e=null,t=1,r=1,n,i,a,o,s,l=rE,c=rE,u,d){super(null,a,o,s,l,c,n,i,u,d),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let u2=new aW,u3=new aW;class u4{init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new aW)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let t=new aW;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let n=0,i=e.length;n<i;n++){let i=e[n]?e[n].matrixWorld:u3;u2.multiplyMatrices(i,t[n]),u2.toArray(r,16*n)}null!==n&&(n.needsUpdate=!0)}clone(){return new u4(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length),t=new Float32Array((e=Math.max(e=4*Math.ceil(e/4),4))*e*4);t.set(this.boneMatrices);let r=new u1(t,e,e,r$,rH);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,n=e.bones.length;r<n;r++){let n=e.bones[r],i=t[n];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),i=new u0),this.bones.push(i),this.boneInverses.push(new aW().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let n=0,i=t.length;n<i;n++){let i=t[n];e.bones.push(i.uuid);let a=r[n];e.boneInverses.push(a.toArray())}return e}constructor(e=[],t=[]){this.uuid=iU(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}}class u5 extends oU{copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}constructor(e,t,r,n=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}}let u6=new aW,u8=new aW,u7=[],u9=new ab,de=new aW,dt=new sl,dr=new aU;class dn extends sl{computeBoundingBox(){let e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new ab),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,u6),u9.copy(e.boundingBox).applyMatrix4(u6),this.boundingBox.union(u9)}computeBoundingSphere(){let e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new aU),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,u6),dr.copy(e.boundingSphere).applyMatrix4(u6),this.boundingSphere.union(dr)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){let r=t.morphTargetInfluences,n=this.morphTexture.source.data.data,i=e*(r.length+1)+1;for(let e=0;e<r.length;e++)r[e]=n[i+e]}raycast(e,t){let r=this.matrixWorld,n=this.count;if(dt.geometry=this.geometry,dt.material=this.material,void 0!==dt.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),dr.copy(this.boundingSphere),dr.applyMatrix4(r),!1!==e.ray.intersectsSphere(dr)))for(let i=0;i<n;i++){this.getMatrixAt(i,u6),u8.multiplyMatrices(r,u6),dt.matrixWorld=u8,dt.raycast(e,u7);for(let e=0,r=u7.length;e<r;e++){let r=u7[e];r.instanceId=i,r.object=this,t.push(r)}u7.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new u5(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){let r=t.morphTargetInfluences,n=r.length+1;null===this.morphTexture&&(this.morphTexture=new u1(new Float32Array(n*this.count),n,this.count,r0,rH));let i=this.morphTexture.source.data.data,a=0;for(let e=0;e<r.length;e++)a+=r[e];let o=this.geometry.morphTargetsRelative?1:1-a,s=n*e;i[s]=o,i.set(r,s+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null),this}constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new u5(new Float32Array(16*r),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let e=0;e<r;e++)this.setMatrixAt(e,de)}}function di(e,t){return e.z-t.z}function da(e,t){return t.z-e.z}class ds{push(e,t,r){let n=this.pool,i=this.list;this.index>=n.length&&n.push({start:-1,count:-1,z:-1,index:-1});let a=n[this.index];i.push(a),this.index++,a.start=e.start,a.count=e.count,a.z=t,a.index=r}reset(){this.list.length=0,this.index=0}constructor(){this.index=0,this.pool=[],this.list=[]}}let dl=new aW,dc=new aW,du=new aW,dd=new oE(1,1,1),dh=new aW,dp=new sD,df=new ab,dm=new aU,dg=new ag,dy=new ag,dv=new ag,db=new ds,d_=new sl,dw=[];function dS(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=t.itemSize;if(e.isInterleavedBufferAttribute||e.array.constructor!==t.array.constructor){let i=e.count;for(let a=0;a<i;a++)for(let i=0;i<n;i++)t.setComponent(a+r,i,e.getComponent(a,i))}else t.array.set(e.array,r*n);t.needsUpdate=!0}class dT extends sl{get maxInstanceCount(){return this._maxInstanceCount}_initMatricesTexture(){let e=Math.sqrt(4*this._maxInstanceCount),t=new u1(new Float32Array((e=Math.max(e=4*Math.ceil(e/4),4))*e*4),e,e,r$,rH);this._matricesTexture=t}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount),t=new u1(new Uint32Array((e=Math.ceil(e))*e),e,e,r1,rz);this._indirectTexture=t}_initColorsTexture(){let e=Math.sqrt(this._maxIndexCount),t=new u1(new Float32Array((e=Math.ceil(e))*e*4).fill(1),e,e,r$,rH);t.colorSpace=i9.workingColorSpace,this._colorsTexture=t}_initializeGeometry(e){let t=this.geometry,r=this._maxVertexCount,n=this._maxIndexCount;if(!1===this._geometryInitialized){for(let n in e.attributes){let{array:i,itemSize:a,normalized:o}=e.getAttribute(n),s=new oU(new i.constructor(r*a),a,o);t.setAttribute(n,s)}if(null!==e.getIndex()){let e=r>65535?new Uint32Array(n):new Uint16Array(n);t.setIndex(new oU(e,1))}this._geometryInitialized=!0}}_validateGeometry(e){let t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw Error('BatchedMesh: All geometries must consistently have "index".');for(let r in t.attributes){if(!e.hasAttribute(r))throw Error('BatchedMesh: Added geometry missing "'.concat(r,'". All geometries must have consistent attributes.'));let n=e.getAttribute(r),i=t.getAttribute(r);if(n.itemSize!==i.itemSize||n.normalized!==i.normalized)throw Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new ab);let e=this._geometryCount,t=this.boundingBox,r=this._drawInfo;t.makeEmpty();for(let n=0;n<e;n++){if(!1===r[n].active)continue;let e=r[n].geometryIndex;this.getMatrixAt(n,dl),this.getBoundingBoxAt(e,df).applyMatrix4(dl),t.union(df)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new aU);let e=this.boundingSphere,t=this._drawInfo;e.makeEmpty();for(let r=0,n=t.length;r<n;r++){if(!1===t[r].active)continue;let n=t[r].geometryIndex;this.getMatrixAt(r,dl),this.getBoundingSphereAt(n,dm).applyMatrix4(dl),e.union(dm)}}addInstance(e){if(this._drawInfo.length>=this._maxInstanceCount)throw Error("BatchedMesh: Maximum item count reached.");this._drawInfo.push({visible:!0,active:!0,geometryIndex:e});let t=this._drawInfo.length-1,r=this._matricesTexture,n=r.image.data;du.toArray(n,16*t),r.needsUpdate=!0;let i=this._colorsTexture;return i&&(dd.toArray(i.image.data,4*t),i.needsUpdate=!0),t}addGeometry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this._initializeGeometry(e),this._validateGeometry(e),this._drawInfo.length>=this._maxInstanceCount)throw Error("BatchedMesh: Maximum item count reached.");let n={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1},i=null,a=this._reservedRanges,o=this._drawRanges,s=this._bounds;0!==this._geometryCount&&(i=a[a.length-1]),-1===t?n.vertexCount=e.getAttribute("position").count:n.vertexCount=t,null===i?n.vertexStart=0:n.vertexStart=i.vertexStart+i.vertexCount;let l=e.getIndex(),c=null!==l;if(c&&(-1===r?n.indexCount=l.count:n.indexCount=r,null===i?n.indexStart=0:n.indexStart=i.indexStart+i.indexCount),-1!==n.indexStart&&n.indexStart+n.indexCount>this._maxIndexCount||n.vertexStart+n.vertexCount>this._maxVertexCount)throw Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");let u=this._geometryCount;return this._geometryCount++,a.push(n),o.push({start:c?n.indexStart:n.vertexStart,count:-1}),s.push({boxInitialized:!1,box:new ab,sphereInitialized:!1,sphere:new aU}),this.setGeometryAt(u,e),u}setGeometryAt(e,t){if(e>=this._geometryCount)throw Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);let r=this.geometry,n=null!==r.getIndex(),i=r.getIndex(),a=t.getIndex(),o=this._reservedRanges[e];if(n&&a.count>o.indexCount||t.attributes.position.count>o.vertexCount)throw Error("BatchedMesh: Reserved space not large enough for provided geometry.");let s=o.vertexStart,l=o.vertexCount;for(let e in r.attributes){let n=t.getAttribute(e),i=r.getAttribute(e);dS(n,i,s);let a=n.itemSize;for(let e=n.count,t=l;e<t;e++){let t=s+e;for(let e=0;e<a;e++)i.setComponent(t,e,0)}i.needsUpdate=!0,i.addUpdateRange(s*a,l*a)}if(n){let e=o.indexStart;for(let t=0;t<a.count;t++)i.setX(e+t,s+a.getX(t));for(let t=a.count,r=o.indexCount;t<r;t++)i.setX(e+t,s);i.needsUpdate=!0,i.addUpdateRange(e,o.indexCount)}let c=this._bounds[e];null!==t.boundingBox?(c.box.copy(t.boundingBox),c.boxInitialized=!0):c.boxInitialized=!1,null!==t.boundingSphere?(c.sphere.copy(t.boundingSphere),c.sphereInitialized=!0):c.sphereInitialized=!1;let u=this._drawRanges[e],d=t.getAttribute("position");return u.count=n?a.count:d.count,this._visibilityChanged=!0,e}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;let r=this._bounds[e],n=r.box,i=this.geometry;if(!1===r.boxInitialized){n.makeEmpty();let t=i.index,a=i.attributes.position,o=this._drawRanges[e];for(let e=o.start,r=o.start+o.count;e<r;e++){let r=e;t&&(r=t.getX(r)),n.expandByPoint(dg.fromBufferAttribute(a,r))}r.boxInitialized=!0}return t.copy(n),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;let r=this._bounds[e],n=r.sphere,i=this.geometry;if(!1===r.sphereInitialized){n.makeEmpty(),this.getBoundingBoxAt(e,df),df.getCenter(n.center);let t=i.index,a=i.attributes.position,o=this._drawRanges[e],s=0;for(let e=o.start,r=o.start+o.count;e<r;e++){let r=e;t&&(r=t.getX(r)),dg.fromBufferAttribute(a,r),s=Math.max(s,n.center.distanceToSquared(dg))}n.radius=Math.sqrt(s),r.sphereInitialized=!0}return t.copy(n),t}setMatrixAt(e,t){let r=this._drawInfo,n=this._matricesTexture,i=this._matricesTexture.image.data;return e>=r.length||!1===r[e].active||(t.toArray(i,16*e),n.needsUpdate=!0),this}getMatrixAt(e,t){let r=this._drawInfo,n=this._matricesTexture.image.data;return e>=r.length||!1===r[e].active?null:t.fromArray(n,16*e)}setColorAt(e,t){null===this._colorsTexture&&this._initColorsTexture();let r=this._colorsTexture,n=this._colorsTexture.image.data,i=this._drawInfo;return e>=i.length||!1===i[e].active||(t.toArray(n,4*e),r.needsUpdate=!0),this}getColorAt(e,t){let r=this._colorsTexture.image.data,n=this._drawInfo;return e>=n.length||!1===n[e].active?null:t.fromArray(r,4*e)}setVisibleAt(e,t){let r=this._drawInfo;return e>=r.length||!1===r[e].active||r[e].visible===t||(r[e].visible=t,this._visibilityChanged=!0),this}getVisibleAt(e){let t=this._drawInfo;return!(e>=t.length)&&!1!==t[e].active&&t[e].visible}raycast(e,t){let r=this._drawInfo,n=this._drawRanges,i=this.matrixWorld,a=this.geometry;d_.material=this.material,d_.geometry.index=a.index,d_.geometry.attributes=a.attributes,null===d_.geometry.boundingBox&&(d_.geometry.boundingBox=new ab),null===d_.geometry.boundingSphere&&(d_.geometry.boundingSphere=new aU);for(let a=0,o=r.length;a<o;a++){if(!r[a].visible||!r[a].active)continue;let o=r[a].geometryIndex,s=n[o];d_.geometry.setDrawRange(s.start,s.count),this.getMatrixAt(a,d_.matrixWorld).premultiply(i),this.getBoundingBoxAt(o,d_.geometry.boundingBox),this.getBoundingSphereAt(o,d_.geometry.boundingSphere),d_.raycast(e,dw);for(let e=0,r=dw.length;e<r;e++){let r=dw[e];r.object=this,r.batchId=a,t.push(r)}dw.length=0}d_.material=null,d_.geometry.index=null,d_.geometry.attributes={},d_.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(e=>({...e})),this._reservedRanges=e._reservedRanges.map(e=>({...e})),this._drawInfo=e._drawInfo.map(e=>({...e})),this._bounds=e._bounds.map(e=>({boxInitialized:e.boxInitialized,box:e.box.clone(),sphereInitialized:e.sphereInitialized,sphere:e.sphere.clone()})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),null!==this._colorsTexture&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,t,r,n,i){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;let a=n.getIndex(),o=null===a?1:a.array.BYTES_PER_ELEMENT,s=this._drawInfo,l=this._multiDrawStarts,c=this._multiDrawCounts,u=this._drawRanges,d=this.perObjectFrustumCulled,h=this._indirectTexture,p=h.image.data;d&&(dh.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),dp.setFromProjectionMatrix(dh,e.coordinateSystem));let f=0;if(this.sortObjects){dc.copy(this.matrixWorld).invert(),dg.setFromMatrixPosition(r.matrixWorld).applyMatrix4(dc),dy.set(0,0,-1).transformDirection(r.matrixWorld).transformDirection(dc);for(let e=0,t=s.length;e<t;e++)if(s[e].visible&&s[e].active){let t=s[e].geometryIndex;this.getMatrixAt(e,dl),this.getBoundingSphereAt(t,dm).applyMatrix4(dl);let r=!1;if(d&&(r=!dp.intersectsSphere(dm)),!r){let r=dv.subVectors(dm.center,dg).dot(dy);db.push(u[t],r,e)}}let e=db.list,t=this.customSort;null===t?e.sort(i.transparent?da:di):t.call(this,e,r);for(let t=0,r=e.length;t<r;t++){let r=e[t];l[f]=r.start*o,c[f]=r.count,p[f]=r.index,f++}db.reset()}else for(let e=0,t=s.length;e<t;e++)if(s[e].visible&&s[e].active){let t=s[e].geometryIndex,r=!1;if(d&&(this.getMatrixAt(e,dl),this.getBoundingSphereAt(t,dm).applyMatrix4(dl),r=!dp.intersectsSphere(dm)),!r){let r=u[t];l[f]=r.start*o,c[f]=r.count,p[f]=e,f++}}h.needsUpdate=!0,this._multiDrawCount=f,this._visibilityChanged=!1}onBeforeShadow(e,t,r,n,i,a){this.onBeforeRender(e,null,n,i,a)}constructor(e,t,r=2*t,n){super(new o0,n),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawInfo=[],this._drawRanges=[],this._reservedRanges=[],this._bounds=[],this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}}class dx extends oM{copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new oE(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}}let dE=new ag,dC=new ag,dA=new aW,dM=new aq,dI=new aU,dR=new ag,dk=new ag;class dP extends oc{copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,r=[0];for(let e=1,n=t.count;e<n;e++)dE.fromBufferAttribute(t,e-1),dC.fromBufferAttribute(t,e),r[e]=r[e-1],r[e]+=dE.distanceTo(dC);e.setAttribute("lineDistance",new oW(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,n=this.matrixWorld,i=e.params.Line.threshold,a=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),dI.copy(r.boundingSphere),dI.applyMatrix4(n),dI.radius+=i,!1===e.ray.intersectsSphere(dI))return;dA.copy(n).invert(),dM.copy(e.ray).applyMatrix4(dA);let o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=this.isLineSegments?2:1,c=r.index,u=r.attributes.position;if(null!==c){let r=Math.max(0,a.start),n=Math.min(c.count,a.start+a.count);for(let i=r,a=n-1;i<a;i+=l){let r=dO(this,e,dM,s,c.getX(i),c.getX(i+1));r&&t.push(r)}if(this.isLineLoop){let i=dO(this,e,dM,s,c.getX(n-1),c.getX(r));i&&t.push(i)}}else{let r=Math.max(0,a.start),n=Math.min(u.count,a.start+a.count);for(let i=r,a=n-1;i<a;i+=l){let r=dO(this,e,dM,s,i,i+1);r&&t.push(r)}if(this.isLineLoop){let i=dO(this,e,dM,s,n-1,r);i&&t.push(i)}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){let t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}constructor(e=new o0,t=new dx){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}}function dO(e,t,r,n,i,a){let o=e.geometry.attributes.position;if(dE.fromBufferAttribute(o,i),dC.fromBufferAttribute(o,a),r.distanceSqToSegment(dE,dC,dR,dk)>n)return;dR.applyMatrix4(e.matrixWorld);let s=t.ray.origin.distanceTo(dR);if(!(s<t.near)&&!(s>t.far))return{distance:s,point:dk.clone().applyMatrix4(e.matrixWorld),index:i,face:null,faceIndex:null,object:e}}let dN=new ag,dL=new ag;class dD extends dP{computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,r=[];for(let e=0,n=t.count;e<n;e+=2)dN.fromBufferAttribute(t,e),dL.fromBufferAttribute(t,e+1),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+dN.distanceTo(dL);e.setAttribute("lineDistance",new oW(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}}class dU extends dP{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class dF extends oM{copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new oE(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}}let dB=new aW,dz=new aq,dH=new aU,dj=new ag;class dG extends oc{copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let r=this.geometry,n=this.matrixWorld,i=e.params.Points.threshold,a=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),dH.copy(r.boundingSphere),dH.applyMatrix4(n),dH.radius+=i,!1===e.ray.intersectsSphere(dH))return;dB.copy(n).invert(),dz.copy(e.ray).applyMatrix4(dB);let o=i/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=r.index,c=r.attributes.position;if(null!==l){let r=Math.max(0,a.start),i=Math.min(l.count,a.start+a.count);for(let a=r,o=i;a<o;a++){let r=l.getX(a);dj.fromBufferAttribute(c,r),dV(dj,r,s,n,e,t,this)}}else{let r=Math.max(0,a.start),i=Math.min(c.count,a.start+a.count);for(let a=r,o=i;a<o;a++)dj.fromBufferAttribute(c,a),dV(dj,a,s,n,e,t,this)}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=r.length;e<t;e++){let t=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}constructor(e=new o0,t=new dF){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}}function dV(e,t,r,n,i,a,o){let s=dz.distanceSqToPoint(e);if(s<r){let r=new ag;dz.closestPointToPoint(e,r),r.applyMatrix4(n);let l=i.ray.origin.distanceTo(r);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(s),point:r,index:t,face:null,object:o})}}class dq extends as{clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!1=="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}constructor(e,t,r,n,i,a,o,s,l){super(e,t,r,n,i,a,o,s,l),this.isVideoTexture=!0,this.minFilter=void 0!==a?a:rR,this.magFilter=void 0!==i?i:rR,this.generateMipmaps=!1;let c=this;function u(){c.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}}class dW extends as{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=rE,this.minFilter=rE,this.generateMipmaps=!1,this.needsUpdate=!0}}class dZ extends as{constructor(e,t,r,n,i,a,o,s,l,c,u,d){super(null,a,o,s,l,c,n,i,u,d),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class dX extends dZ{addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}constructor(e,t,r,n,i,a){super(e,t,r,i,a),this.isCompressedArrayTexture=!0,this.image.depth=n,this.wrapR=rT,this.layerUpdates=new Set}}class d$ extends dZ{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,ry),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class dK extends as{constructor(e,t,r,n,i,a,o,s,l){super(e,t,r,n,i,a,o,s,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class dY{getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,n=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)t.push(i+=(r=this.getPoint(a/e)).distanceTo(n)),n=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r;let n=this.getLengths(),i=0,a=n.length;r=t||e*n[a-1];let o=0,s=a-1,l;for(;o<=s;)if((l=n[i=Math.floor(o+(s-o)/2)]-r)<0)o=i+1;else if(l>0)s=i-1;else{s=i;break}if(n[i=s]===r)return i/(a-1);let c=n[i],u=n[i+1]-c;return(i+(r-c)/u)/(a-1)}getTangent(e,t){let r=e-1e-4,n=e+1e-4;r<0&&(r=0),n>1&&(n=1);let i=this.getPoint(r),a=this.getPoint(n),o=t||(i.isVector2?new iX:new ag);return o.copy(a).sub(i).normalize(),o}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new ag,n=[],i=[],a=[],o=new ag,s=new aW;for(let t=0;t<=e;t++){let r=t/e;n[t]=this.getTangentAt(r,new ag)}i[0]=new ag,a[0]=new ag;let l=Number.MAX_VALUE,c=Math.abs(n[0].x),u=Math.abs(n[0].y),d=Math.abs(n[0].z);c<=l&&(l=c,r.set(1,0,0)),u<=l&&(l=u,r.set(0,1,0)),d<=l&&r.set(0,0,1),o.crossVectors(n[0],r).normalize(),i[0].crossVectors(n[0],o),a[0].crossVectors(n[0],i[0]);for(let t=1;t<=e;t++){if(i[t]=i[t-1].clone(),a[t]=a[t-1].clone(),o.crossVectors(n[t-1],n[t]),o.length()>Number.EPSILON){o.normalize();let e=Math.acos(iF(n[t-1].dot(n[t]),-1,1));i[t].applyMatrix4(s.makeRotationAxis(o,e))}a[t].crossVectors(n[t],i[t])}if(!0===t){let t=Math.acos(iF(i[0].dot(i[e]),-1,1));t/=e,n[0].dot(o.crossVectors(i[0],i[e]))>0&&(t=-t);for(let r=1;r<=e;r++)i[r].applyMatrix4(s.makeRotationAxis(n[r],t*r)),a[r].crossVectors(n[r],i[r])}return{tangents:n,normals:i,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}constructor(){this.type="Curve",this.arcLengthDivisions=200}}class dQ extends dY{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new iX,r=t,n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;for(;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=a?0:n),!0!==this.aClockwise||a||(i===n?i=-n:i-=n);let o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){let e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),r=s-this.aX,n=l-this.aY;s=r*e-n*t+this.aX,l=r*t+n*e+this.aY}return r.set(s,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}constructor(e=0,t=0,r=1,n=1,i=0,a=2*Math.PI,o=!1,s=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=i,this.aEndAngle=a,this.aClockwise=o,this.aRotation=s}}class dJ extends dQ{constructor(e,t,r,n,i,a){super(e,t,r,r,n,i,a),this.isArcCurve=!0,this.type="ArcCurve"}}function d0(){let e=0,t=0,r=0,n=0;function i(i,a,o,s){e=i,t=o,r=-3*i+3*a-2*o-s,n=2*i-2*a+o+s}return{initCatmullRom:function(e,t,r,n,a){i(t,r,a*(r-e),a*(n-t))},initNonuniformCatmullRom:function(e,t,r,n,a,o,s){let l=(t-e)/a-(r-e)/(a+o)+(r-t)/o,c=(r-t)/o-(n-t)/(o+s)+(n-r)/s;i(t,r,l*=o,c*=o)},calc:function(i){let a=i*i,o=a*i;return e+t*i+r*a+n*o}}}let d1=new ag,d2=new d0,d3=new d0,d4=new d0;class d5 extends dY{getPoint(e){let t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ag,i=n,a=this.points,o=a.length,s=(o-(this.closed?0:1))*e,l=Math.floor(s),c=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/o)+1)*o:0===c&&l===o-1&&(l=o-2,c=1),this.closed||l>0?t=a[(l-1)%o]:(d1.subVectors(a[0],a[1]).add(a[0]),t=d1);let u=a[l%o],d=a[(l+1)%o];if(this.closed||l+2<o?r=a[(l+2)%o]:(d1.subVectors(a[o-1],a[o-2]).add(a[o-1]),r=d1),"centripetal"===this.curveType||"chordal"===this.curveType){let e="chordal"===this.curveType?.5:.25,n=Math.pow(t.distanceToSquared(u),e),i=Math.pow(u.distanceToSquared(d),e),a=Math.pow(d.distanceToSquared(r),e);i<1e-4&&(i=1),n<1e-4&&(n=i),a<1e-4&&(a=i),d2.initNonuniformCatmullRom(t.x,u.x,d.x,r.x,n,i,a),d3.initNonuniformCatmullRom(t.y,u.y,d.y,r.y,n,i,a),d4.initNonuniformCatmullRom(t.z,u.z,d.z,r.z,n,i,a)}else"catmullrom"===this.curveType&&(d2.initCatmullRom(t.x,u.x,d.x,r.x,this.tension),d3.initCatmullRom(t.y,u.y,d.y,r.y,this.tension),d4.initCatmullRom(t.z,u.z,d.z,r.z,this.tension));return i.set(d2.calc(c),d3.calc(c),d4.calc(c)),i}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(new ag().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}constructor(e=[],t=!1,r="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=n}}function d6(e,t,r,n,i){let a=(n-t)*.5,o=(i-r)*.5,s=e*e;return e*s*(2*r-2*n+a+o)+(-3*r+3*n-2*a-o)*s+a*e+r}function d8(e,t){let r=1-e;return r*r*t}function d7(e,t){return 2*(1-e)*e*t}function d9(e,t){return e*e*t}function he(e,t,r,n){return d8(e,t)+d7(e,r)+d9(e,n)}function ht(e,t){let r=1-e;return r*r*r*t}function hr(e,t){let r=1-e;return 3*r*r*e*t}function hn(e,t){return 3*(1-e)*e*e*t}function hi(e,t){return e*e*e*t}function ha(e,t,r,n,i){return ht(e,t)+hr(e,r)+hn(e,n)+hi(e,i)}class ho extends dY{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new iX,r=t,n=this.v0,i=this.v1,a=this.v2,o=this.v3;return r.set(ha(e,n.x,i.x,a.x,o.x),ha(e,n.y,i.y,a.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}constructor(e=new iX,t=new iX,r=new iX,n=new iX){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=n}}class hs extends dY{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ag,r=t,n=this.v0,i=this.v1,a=this.v2,o=this.v3;return r.set(ha(e,n.x,i.x,a.x,o.x),ha(e,n.y,i.y,a.y,o.y),ha(e,n.z,i.z,a.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}constructor(e=new ag,t=new ag,r=new ag,n=new ag){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=n}}class hl extends dY{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new iX,r=t;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new iX;return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}constructor(e=new iX,t=new iX){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}}class hc extends dY{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ag,r=t;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ag;return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}constructor(e=new ag,t=new ag){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}}class hu extends dY{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new iX,r=t,n=this.v0,i=this.v1,a=this.v2;return r.set(he(e,n.x,i.x,a.x),he(e,n.y,i.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}constructor(e=new iX,t=new iX,r=new iX){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}}class hd extends dY{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ag,r=t,n=this.v0,i=this.v1,a=this.v2;return r.set(he(e,n.x,i.x,a.x),he(e,n.y,i.y,a.y),he(e,n.z,i.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}constructor(e=new ag,t=new ag,r=new ag){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}}class hh extends dY{getPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new iX,r=t,n=this.points,i=(n.length-1)*e,a=Math.floor(i),o=i-a,s=n[0===a?a:a-1],l=n[a],c=n[a>n.length-2?n.length-1:a+1],u=n[a>n.length-3?n.length-1:a+2];return r.set(d6(o,s.x,l.x,c.x,u.x),d6(o,s.y,l.y,c.y,u.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let r=e.points[t];this.points.push(new iX().fromArray(r))}return this}constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}}var hp=Object.freeze({__proto__:null,ArcCurve:dJ,CatmullRomCurve3:d5,CubicBezierCurve:ho,CubicBezierCurve3:hs,EllipseCurve:dQ,LineCurve:hl,LineCurve3:hc,QuadraticBezierCurve:hu,QuadraticBezierCurve3:hd,SplineCurve:hh});class hf extends dY{add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){let r=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new hp[r](t,e))}return this}getPoint(e,t){let r=e*this.getLength(),n=this.getCurveLengths(),i=0;for(;i<n.length;){if(n[i]>=r){let e=n[i]-r,a=this.curves[i],o=a.getLength(),s=0===o?0:1-e/o;return a.getPointAt(s,t)}i++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,n=this.curves.length;r<n;r++)e.push(t+=this.curves[r].getLength());return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,r=[];for(let n=0,i=this.curves;n<i.length;n++){let a=i[n],o=a.isEllipseCurve?2*t:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o);for(let t=0;t<s.length;t++){let n=s[t];e&&e.equals(n)||(r.push(n),e=n)}}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let r=e.curves[t];this.curves.push(new hp[r.type]().fromJSON(r))}return this}constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}}class hm extends hf{setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new hl(this.currentPoint.clone(),new iX(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,n){let i=new hu(this.currentPoint.clone(),new iX(e,t),new iX(r,n));return this.curves.push(i),this.currentPoint.set(r,n),this}bezierCurveTo(e,t,r,n,i,a){let o=new ho(this.currentPoint.clone(),new iX(e,t),new iX(r,n),new iX(i,a));return this.curves.push(o),this.currentPoint.set(i,a),this}splineThru(e){let t=new hh([this.currentPoint.clone()].concat(e));return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,n,i,a){let o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,r,n,i,a),this}absarc(e,t,r,n,i,a){return this.absellipse(e,t,r,r,n,i,a),this}ellipse(e,t,r,n,i,a,o,s){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,r,n,i,a,o,s),this}absellipse(e,t,r,n,i,a,o,s){let l=new dQ(e,t,r,n,i,a,o,s);if(this.curves.length>0){let e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}constructor(e){super(),this.type="Path",this.currentPoint=new iX,e&&this.setFromPoints(e)}}class hg extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hg(e.points,e.segments,e.phiStart,e.phiLength)}constructor(e=[new iX(0,-.5),new iX(.5,0),new iX(0,.5)],t=12,r=0,n=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=Math.floor(t),n=iF(n,0,2*Math.PI);let i=[],a=[],o=[],s=[],l=[],c=1/t,u=new ag,d=new iX,h=new ag,p=new ag,f=new ag,m=0,g=0;for(let t=0;t<=e.length-1;t++)switch(t){case 0:m=e[t+1].x-e[t].x,g=e[t+1].y-e[t].y,h.x=1*g,h.y=-m,h.z=0*g,f.copy(h),h.normalize(),s.push(h.x,h.y,h.z);break;case e.length-1:s.push(f.x,f.y,f.z);break;default:m=e[t+1].x-e[t].x,g=e[t+1].y-e[t].y,h.x=1*g,h.y=-m,h.z=0*g,p.copy(h),h.x+=f.x,h.y+=f.y,h.z+=f.z,h.normalize(),s.push(h.x,h.y,h.z),f.copy(p)}for(let i=0;i<=t;i++){let h=r+i*c*n,p=Math.sin(h),f=Math.cos(h);for(let r=0;r<=e.length-1;r++){u.x=e[r].x*p,u.y=e[r].y,u.z=e[r].x*f,a.push(u.x,u.y,u.z),d.x=i/t,d.y=r/(e.length-1),o.push(d.x,d.y);let n=s[3*r+0]*p,c=s[3*r+1],h=s[3*r+0]*f;l.push(n,c,h)}}for(let r=0;r<t;r++)for(let t=0;t<e.length-1;t++){let n=t+r*e.length,a=n,o=n+e.length,s=n+e.length+1,l=n+1;i.push(a,o,l),i.push(s,l,o)}this.setIndex(i),this.setAttribute("position",new oW(a,3)),this.setAttribute("uv",new oW(o,2)),this.setAttribute("normal",new oW(l,3))}}class hy extends hg{static fromJSON(e){return new hy(e.radius,e.length,e.capSegments,e.radialSegments)}constructor(e=1,t=1,r=4,n=8){let i=new hm;i.absarc(0,-t/2,e,1.5*Math.PI,0),i.absarc(0,t/2,e,0,.5*Math.PI),super(i.getPoints(r),n),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:r,radialSegments:n}}}class hv extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hv(e.radius,e.segments,e.thetaStart,e.thetaLength)}constructor(e=1,t=32,r=0,n=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},t=Math.max(3,t);let i=[],a=[],o=[],s=[],l=new ag,c=new iX;a.push(0,0,0),o.push(0,0,1),s.push(.5,.5);for(let i=0,u=3;i<=t;i++,u+=3){let d=r+i/t*n;l.x=e*Math.cos(d),l.y=e*Math.sin(d),a.push(l.x,l.y,l.z),o.push(0,0,1),c.x=(a[u]/e+1)/2,c.y=(a[u+1]/e+1)/2,s.push(c.x,c.y)}for(let e=1;e<=t;e++)i.push(e,e+1,0);this.setIndex(i),this.setAttribute("position",new oW(a,3)),this.setAttribute("normal",new oW(o,3)),this.setAttribute("uv",new oW(s,2))}}class hb extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hb(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}constructor(e=1,t=1,r=1,n=32,i=1,a=!1,o=0,s=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s};let l=this;n=Math.floor(n),i=Math.floor(i);let c=[],u=[],d=[],h=[],p=0,f=[],m=r/2,g=0;function y(r){let i=p,a=new iX,f=new ag,y=0,v=!0===r?e:t,b=!0===r?1:-1;for(let e=1;e<=n;e++)u.push(0,m*b,0),d.push(0,b,0),h.push(.5,.5),p++;let _=p;for(let e=0;e<=n;e++){let t=e/n*s+o,r=Math.cos(t),i=Math.sin(t);f.x=v*i,f.y=m*b,f.z=v*r,u.push(f.x,f.y,f.z),d.push(0,b,0),a.x=.5*r+.5,a.y=.5*i*b+.5,h.push(a.x,a.y),p++}for(let e=0;e<n;e++){let t=i+e,n=_+e;!0===r?c.push(n,n+1,t):c.push(n+1,n,t),y+=3}l.addGroup(g,y,!0===r?1:2),g+=y}(function(){let a=new ag,y=new ag,v=0,b=(t-e)/r;for(let l=0;l<=i;l++){let c=[],g=l/i,v=g*(t-e)+e;for(let e=0;e<=n;e++){let t=e/n,i=t*s+o,l=Math.sin(i),f=Math.cos(i);y.x=v*l,y.y=-g*r+m,y.z=v*f,u.push(y.x,y.y,y.z),a.set(l,b,f).normalize(),d.push(a.x,a.y,a.z),h.push(t,1-g),c.push(p++)}f.push(c)}for(let e=0;e<n;e++)for(let t=0;t<i;t++){let r=f[t][e],n=f[t+1][e],i=f[t+1][e+1],a=f[t][e+1];c.push(r,n,a),c.push(n,i,a),v+=6}l.addGroup(g,v,0),g+=v})(),!1===a&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new oW(u,3)),this.setAttribute("normal",new oW(d,3)),this.setAttribute("uv",new oW(h,2))}}class h_ extends hb{static fromJSON(e){return new h_(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}constructor(e=1,t=1,r=32,n=1,i=!1,a=0,o=2*Math.PI){super(0,e,t,r,n,i,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:o}}}class hw extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hw(e.vertices,e.indices,e.radius,e.details)}constructor(e=[],t=[],r=1,n=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n};let i=[],a=[];function o(e,t,r,n){let i=n+1,a=[];for(let n=0;n<=i;n++){a[n]=[];let o=e.clone().lerp(r,n/i),s=t.clone().lerp(r,n/i),l=i-n;for(let e=0;e<=l;e++)0===e&&n===i?a[n][e]=o:a[n][e]=o.clone().lerp(s,e/l)}for(let e=0;e<i;e++)for(let t=0;t<2*(i-e)-1;t++){let r=Math.floor(t/2);t%2==0?(u(a[e][r+1]),u(a[e+1][r]),u(a[e][r])):(u(a[e][r+1]),u(a[e+1][r+1]),u(a[e+1][r]))}}function s(e){let t=new ag;for(let r=0;r<i.length;r+=3)t.x=i[r+0],t.y=i[r+1],t.z=i[r+2],t.normalize().multiplyScalar(e),i[r+0]=t.x,i[r+1]=t.y,i[r+2]=t.z}function l(){let e=new ag;for(let t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];let r=f(e)/2/Math.PI+.5,n=m(e)/Math.PI+.5;a.push(r,1-n)}h(),c()}function c(){for(let e=0;e<a.length;e+=6){let t=a[e+0],r=a[e+2],n=a[e+4],i=Math.max(t,r,n),o=Math.min(t,r,n);i>.9&&o<.1&&(t<.2&&(a[e+0]+=1),r<.2&&(a[e+2]+=1),n<.2&&(a[e+4]+=1))}}function u(e){i.push(e.x,e.y,e.z)}function d(t,r){let n=3*t;r.x=e[n+0],r.y=e[n+1],r.z=e[n+2]}function h(){let e=new ag,t=new ag,r=new ag,n=new ag,o=new iX,s=new iX,l=new iX;for(let c=0,u=0;c<i.length;c+=9,u+=6){e.set(i[c+0],i[c+1],i[c+2]),t.set(i[c+3],i[c+4],i[c+5]),r.set(i[c+6],i[c+7],i[c+8]),o.set(a[u+0],a[u+1]),s.set(a[u+2],a[u+3]),l.set(a[u+4],a[u+5]),n.copy(e).add(t).add(r).divideScalar(3);let d=f(n);p(o,u+0,e,d),p(s,u+2,t,d),p(l,u+4,r,d)}}function p(e,t,r,n){n<0&&1===e.x&&(a[t]=e.x-1),0===r.x&&0===r.z&&(a[t]=n/2/Math.PI+.5)}function f(e){return Math.atan2(e.z,-e.x)}function m(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(function(e){let r=new ag,n=new ag,i=new ag;for(let a=0;a<t.length;a+=3)d(t[a+0],r),d(t[a+1],n),d(t[a+2],i),o(r,n,i,e)})(n),s(r),l(),this.setAttribute("position",new oW(i,3)),this.setAttribute("normal",new oW(i.slice(),3)),this.setAttribute("uv",new oW(a,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}}class hS extends hw{static fromJSON(e){return new hS(e.radius,e.detail)}constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,n=1/r;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}}let hT=new ag,hx=new ag,hE=new ag,hC=new o_;class hA extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){let r=1e4,n=Math.cos(iL*t),i=e.getIndex(),a=e.getAttribute("position"),o=i?i.count:a.count,s=[0,0,0],l=["a","b","c"],c=[,,,],u={},d=[];for(let e=0;e<o;e+=3){i?(s[0]=i.getX(e),s[1]=i.getX(e+1),s[2]=i.getX(e+2)):(s[0]=e,s[1]=e+1,s[2]=e+2);let{a:t,b:o,c:h}=hC;if(t.fromBufferAttribute(a,s[0]),o.fromBufferAttribute(a,s[1]),h.fromBufferAttribute(a,s[2]),hC.getNormal(hE),c[0]="".concat(Math.round(t.x*r),",").concat(Math.round(t.y*r),",").concat(Math.round(t.z*r)),c[1]="".concat(Math.round(o.x*r),",").concat(Math.round(o.y*r),",").concat(Math.round(o.z*r)),c[2]="".concat(Math.round(h.x*r),",").concat(Math.round(h.y*r),",").concat(Math.round(h.z*r)),c[0]!==c[1]&&c[1]!==c[2]&&c[2]!==c[0])for(let e=0;e<3;e++){let t=(e+1)%3,r=c[e],i=c[t],a=hC[l[e]],o=hC[l[t]],h="".concat(r,"_").concat(i),p="".concat(i,"_").concat(r);p in u&&u[p]?(hE.dot(u[p].normal)<=n&&(d.push(a.x,a.y,a.z),d.push(o.x,o.y,o.z)),u[p]=null):h in u||(u[h]={index0:s[e],index1:s[t],normal:hE.clone()})}}for(let e in u)if(u[e]){let{index0:t,index1:r}=u[e];hT.fromBufferAttribute(a,t),hx.fromBufferAttribute(a,r),d.push(hT.x,hT.y,hT.z),d.push(hx.x,hx.y,hx.z)}this.setAttribute("position",new oW(d,3))}}}class hM extends hm{getPointsHoles(e){let t=[];for(let r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let r=e.holes[t];this.holes.push(new hm().fromJSON(r))}return this}constructor(e){super(e),this.uuid=iU(),this.type="Shape",this.holes=[]}}let hI=function(e,t){let r,n,i,a,o,s,l,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,u=t&&t.length,d=u?t[0]*c:e.length,h=hR(e,0,d,c,!0),p=[];if(!h||h.next===h.prev)return p;if(u&&(h=hU(e,t,h,c)),e.length>80*c){r=i=e[0],n=a=e[1];for(let t=c;t<d;t+=c)o=e[t],s=e[t+1],o<r&&(r=o),s<n&&(n=s),o>i&&(i=o),s>a&&(a=s);l=0!==(l=Math.max(i-r,a-n))?32767/l:0}return hP(h,p,c,r,n,l,0),p};function hR(e,t,r,n,i){let a,o;if(i===h6(e,t,r,n)>0)for(a=t;a<r;a+=n)o=h3(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=h3(a,e[a],e[a+1],o);return o&&h$(o,o.next)&&(h4(o),o=o.next),o}function hk(e,t){if(!e)return e;t||(t=e);let r=e,n;do if(n=!1,!r.steiner&&(h$(r,r.next)||0===hX(r.prev,r,r.next))){if(h4(r),(r=t=r.prev)===r.next)break;n=!0}else r=r.next;while(n||r!==t);return t}function hP(e,t,r,n,i,a,o){if(!e)return;!o&&a&&hj(e,n,i,a);let s=e,l,c;for(;e.prev!==e.next;){if(l=e.prev,c=e.next,a?hN(e,n,i,a):hO(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(c.i/r|0),h4(e),e=c.next,s=c.next;continue}if((e=c)===s){o?1===o?hP(e=hL(hk(e),t,r),t,r,n,i,a,2):2===o&&hD(e,t,r,n,i,a):hP(hk(e),t,r,n,i,a,1);break}}}function hO(e){let t=e.prev,r=e,n=e.next;if(hX(t,r,n)>=0)return!1;let i=t.x,a=r.x,o=n.x,s=t.y,l=r.y,c=n.y,u=i<a?i<o?i:o:a<o?a:o,d=s<l?s<c?s:c:l<c?l:c,h=i>a?i>o?i:o:a>o?a:o,p=s>l?s>c?s:c:l>c?l:c,f=n.next;for(;f!==t;){if(f.x>=u&&f.x<=h&&f.y>=d&&f.y<=p&&hW(i,s,a,l,o,c,f.x,f.y)&&hX(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function hN(e,t,r,n){let i=e.prev,a=e,o=e.next;if(hX(i,a,o)>=0)return!1;let s=i.x,l=a.x,c=o.x,u=i.y,d=a.y,h=o.y,p=s<l?s<c?s:c:l<c?l:c,f=u<d?u<h?u:h:d<h?d:h,m=s>l?s>c?s:c:l>c?l:c,g=u>d?u>h?u:h:d>h?d:h,y=hV(p,f,t,r,n),v=hV(m,g,t,r,n),b=e.prevZ,_=e.nextZ;for(;b&&b.z>=y&&_&&_.z<=v;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==i&&b!==o&&hW(s,u,l,d,c,h,b.x,b.y)&&hX(b.prev,b,b.next)>=0||(b=b.prevZ,_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==i&&_!==o&&hW(s,u,l,d,c,h,_.x,_.y)&&hX(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;b&&b.z>=y;){if(b.x>=p&&b.x<=m&&b.y>=f&&b.y<=g&&b!==i&&b!==o&&hW(s,u,l,d,c,h,b.x,b.y)&&hX(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;_&&_.z<=v;){if(_.x>=p&&_.x<=m&&_.y>=f&&_.y<=g&&_!==i&&_!==o&&hW(s,u,l,d,c,h,_.x,_.y)&&hX(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function hL(e,t,r){let n=e;do{let i=n.prev,a=n.next.next;!h$(i,a)&&hK(i,n,n.next,a)&&h0(i,a)&&h0(a,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(a.i/r|0),h4(n),h4(n.next),n=e=a),n=n.next}while(n!==e);return hk(n)}function hD(e,t,r,n,i,a){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&hZ(o,e)){let s=h2(o,e);o=hk(o,o.next),s=hk(s,s.next),hP(o,t,r,n,i,a,0),hP(s,t,r,n,i,a,0);return}e=e.next}o=o.next}while(o!==e)}function hU(e,t,r,n){let i,a,o,s,l;let c=[];for(i=0,a=t.length;i<a;i++)o=t[i]*n,s=i<a-1?t[i+1]*n:e.length,(l=hR(e,o,s,n,!1))===l.next&&(l.steiner=!0),c.push(hq(l));for(c.sort(hF),i=0;i<c.length;i++)r=hB(c[i],r);return r}function hF(e,t){return e.x-t.x}function hB(e,t){let r=hz(e,t);if(!r)return t;let n=h2(r,e);return hk(n,n.next),hk(r,r.next)}function hz(e,t){let r=t,n=-1/0,i,a=e.x,o=e.y;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){let e=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(e<=a&&e>n&&(n=e,i=r.x<r.next.x?r:r.next,e===a))return i}r=r.next}while(r!==t);if(!i)return null;let s=i,l=i.x,c=i.y,u=1/0,d;r=i;do a>=r.x&&r.x>=l&&a!==r.x&&hW(o<c?a:n,o,l,c,o<c?n:a,o,r.x,r.y)&&(d=Math.abs(o-r.y)/(a-r.x),h0(r,e)&&(d<u||d===u&&(r.x>i.x||r.x===i.x&&hH(i,r)))&&(i=r,u=d)),r=r.next;while(r!==s);return i}function hH(e,t){return 0>hX(e.prev,e,t.prev)&&0>hX(t.next,e,e.next)}function hj(e,t,r,n){let i=e;do 0===i.z&&(i.z=hV(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,hG(i)}function hG(e){let t,r,n,i,a,o,s,l,c=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,s=0,t=0;t<c&&(s++,n=n.nextZ);t++);for(l=c;s>0||l>0&&n;)0!==s&&(0===l||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,c*=2}while(o>1);return e}function hV(e,t,r,n,i){return(e=((e=((e=((e=((e=(e-r)*i|0)|e<<8)&16711935)|e<<4)&252645135)|e<<2)&858993459)|e<<1)&1431655765)|(t=((t=((t=((t=((t=(t-n)*i|0)|t<<8)&16711935)|t<<4)&252645135)|t<<2)&858993459)|t<<1)&1431655765)<<1}function hq(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function hW(e,t,r,n,i,a,o,s){return(i-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(n-s)>=(r-o)*(t-s)&&(r-o)*(a-s)>=(i-o)*(n-s)}function hZ(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!hJ(e,t)&&(h0(e,t)&&h0(t,e)&&h1(e,t)&&(hX(e.prev,e,t.prev)||hX(e,t.prev,t))||h$(e,t)&&hX(e.prev,e,e.next)>0&&hX(t.prev,t,t.next)>0)}function hX(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function h$(e,t){return e.x===t.x&&e.y===t.y}function hK(e,t,r,n){let i=hQ(hX(e,t,r)),a=hQ(hX(e,t,n)),o=hQ(hX(r,n,e)),s=hQ(hX(r,n,t));return!!(i!==a&&o!==s||0===i&&hY(e,r,t)||0===a&&hY(e,n,t)||0===o&&hY(r,e,n)||0===s&&hY(r,t,n))}function hY(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function hQ(e){return e>0?1:e<0?-1:0}function hJ(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&hK(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function h0(e,t){return 0>hX(e.prev,e,e.next)?hX(e,t,e.next)>=0&&hX(e,e.prev,t)>=0:0>hX(e,t,e.prev)||0>hX(e,e.next,t)}function h1(e,t){let r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e);return n}function h2(e,t){let r=new h5(e.i,e.x,e.y),n=new h5(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function h3(e,t,r,n){let i=new h5(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function h4(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function h5(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function h6(e,t,r,n){let i=0;for(let a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}class h8{static area(e){let t=e.length,r=0;for(let n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return .5*r}static isClockWise(e){return 0>h8.area(e)}static triangulateShape(e,t){let r=[],n=[],i=[];h7(e),h9(r,e);let a=e.length;t.forEach(h7);for(let e=0;e<t.length;e++)n.push(a),a+=t[e].length,h9(r,t[e]);let o=hI(r,n);for(let e=0;e<o.length;e+=3)i.push(o.slice(e,e+3));return i}}function h7(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function h9(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}class pe extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return pr(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){let r=[];for(let n=0,i=e.shapes.length;n<i;n++){let i=t[e.shapes[n]];r.push(i)}let n=e.options.extrudePath;return void 0!==n&&(e.options.extrudePath=new hp[n.type]().fromJSON(n)),new pe(r,e.options)}constructor(e=new hM([new iX(.5,.5),new iX(-.5,.5),new iX(-.5,-.5),new iX(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let r=this,n=[],i=[];for(let t=0,r=e.length;t<r;t++)a(e[t]);function a(e){let a,o,s,l;let c=[],u=void 0!==t.curveSegments?t.curveSegments:12,d=void 0!==t.steps?t.steps:1,h=void 0!==t.depth?t.depth:1,p=void 0===t.bevelEnabled||t.bevelEnabled,f=void 0!==t.bevelThickness?t.bevelThickness:.2,m=void 0!==t.bevelSize?t.bevelSize:f-.1,g=void 0!==t.bevelOffset?t.bevelOffset:0,y=void 0!==t.bevelSegments?t.bevelSegments:3,v=t.extrudePath,b=void 0!==t.UVGenerator?t.UVGenerator:pt,_,w=!1;v&&(_=v.getSpacedPoints(d),w=!0,p=!1,a=v.computeFrenetFrames(d,!1),o=new ag,s=new ag,l=new ag),p||(y=0,f=0,m=0,g=0);let S=e.extractPoints(u),T=S.shape,x=S.holes;if(!h8.isClockWise(T)){T=T.reverse();for(let e=0,t=x.length;e<t;e++){let t=x[e];h8.isClockWise(t)&&(x[e]=t.reverse())}}let E=h8.triangulateShape(T,x),C=T;for(let e=0,t=x.length;e<t;e++){let t=x[e];T=T.concat(t)}function A(e,t,r){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,r)}let M=T.length,I=E.length;function R(e,t,r){let n,i,a;let o=e.x-t.x,s=e.y-t.y,l=r.x-e.x,c=r.y-e.y,u=o*o+s*s;if(Math.abs(o*c-s*l)>Number.EPSILON){let d=Math.sqrt(u),h=Math.sqrt(l*l+c*c),p=t.x-s/d,f=t.y+o/d,m=((r.x-c/h-p)*c-(r.y+l/h-f)*l)/(o*c-s*l),g=(n=p+o*m-e.x)*n+(i=f+s*m-e.y)*i;if(g<=2)return new iX(n,i);a=Math.sqrt(g/2)}else{let e=!1;o>Number.EPSILON?l>Number.EPSILON&&(e=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(s)===Math.sign(c)&&(e=!0),e?(n=-s,i=o,a=Math.sqrt(u)):(n=o,i=s,a=Math.sqrt(u/2))}return new iX(n/a,i/a)}let k=[];for(let e=0,t=C.length,r=t-1,n=e+1;e<t;e++,r++,n++)r===t&&(r=0),n===t&&(n=0),k[e]=R(C[e],C[r],C[n]);let P=[],O,N=k.concat();for(let e=0,t=x.length;e<t;e++){let t=x[e];O=[];for(let e=0,r=t.length,n=r-1,i=e+1;e<r;e++,n++,i++)n===r&&(n=0),i===r&&(i=0),O[e]=R(t[e],t[n],t[i]);P.push(O),N=N.concat(O)}for(let e=0;e<y;e++){let t=e/y,r=f*Math.cos(t*Math.PI/2),n=m*Math.sin(t*Math.PI/2)+g;for(let e=0,t=C.length;e<t;e++){let t=A(C[e],k[e],n);F(t.x,t.y,-r)}for(let e=0,t=x.length;e<t;e++){let t=x[e];O=P[e];for(let e=0,i=t.length;e<i;e++){let i=A(t[e],O[e],n);F(i.x,i.y,-r)}}}let L=m+g;for(let e=0;e<M;e++){let t=p?A(T[e],N[e],L):T[e];w?(s.copy(a.normals[0]).multiplyScalar(t.x),o.copy(a.binormals[0]).multiplyScalar(t.y),l.copy(_[0]).add(s).add(o),F(l.x,l.y,l.z)):F(t.x,t.y,0)}for(let e=1;e<=d;e++)for(let t=0;t<M;t++){let r=p?A(T[t],N[t],L):T[t];w?(s.copy(a.normals[e]).multiplyScalar(r.x),o.copy(a.binormals[e]).multiplyScalar(r.y),l.copy(_[e]).add(s).add(o),F(l.x,l.y,l.z)):F(r.x,r.y,h/d*e)}for(let e=y-1;e>=0;e--){let t=e/y,r=f*Math.cos(t*Math.PI/2),n=m*Math.sin(t*Math.PI/2)+g;for(let e=0,t=C.length;e<t;e++){let t=A(C[e],k[e],n);F(t.x,t.y,h+r)}for(let e=0,t=x.length;e<t;e++){let t=x[e];O=P[e];for(let e=0,i=t.length;e<i;e++){let i=A(t[e],O[e],n);w?F(i.x,i.y+_[d-1].y,_[d-1].x+r):F(i.x,i.y,h+r)}}}function D(){let e=n.length/3,t=0;U(C,0),t+=C.length;for(let e=0,r=x.length;e<r;e++){let r=x[e];U(r,t),t+=r.length}r.addGroup(e,n.length/3-e,1)}function U(e,t){let r=e.length;for(;--r>=0;){let n=r,i=r-1;i<0&&(i=e.length-1);for(let e=0,r=d+2*y;e<r;e++){let r=M*e,a=M*(e+1);z(t+n+r,t+i+r,t+i+a,t+n+a)}}}function F(e,t,r){c.push(e),c.push(t),c.push(r)}function B(e,t,i){H(e),H(t),H(i);let a=n.length/3,o=b.generateTopUV(r,n,a-3,a-2,a-1);j(o[0]),j(o[1]),j(o[2])}function z(e,t,i,a){H(e),H(t),H(a),H(t),H(i),H(a);let o=n.length/3,s=b.generateSideWallUV(r,n,o-6,o-3,o-2,o-1);j(s[0]),j(s[1]),j(s[3]),j(s[1]),j(s[2]),j(s[3])}function H(e){n.push(c[3*e+0]),n.push(c[3*e+1]),n.push(c[3*e+2])}function j(e){i.push(e.x),i.push(e.y)}(function(){let e=n.length/3;if(p){let e=0,t=0*M;for(let e=0;e<I;e++){let r=E[e];B(r[2]+t,r[1]+t,r[0]+t)}t=M*(e=d+2*y);for(let e=0;e<I;e++){let r=E[e];B(r[0]+t,r[1]+t,r[2]+t)}}else{for(let e=0;e<I;e++){let t=E[e];B(t[2],t[1],t[0])}for(let e=0;e<I;e++){let t=E[e];B(t[0]+M*d,t[1]+M*d,t[2]+M*d)}}r.addGroup(e,n.length/3-e,0)})(),D()}this.setAttribute("position",new oW(n,3)),this.setAttribute("uv",new oW(i,2)),this.computeVertexNormals()}}let pt={generateTopUV:function(e,t,r,n,i){let a=t[3*r],o=t[3*r+1],s=t[3*n],l=t[3*n+1],c=t[3*i],u=t[3*i+1];return[new iX(a,o),new iX(s,l),new iX(c,u)]},generateSideWallUV:function(e,t,r,n,i,a){let o=t[3*r],s=t[3*r+1],l=t[3*r+2],c=t[3*n],u=t[3*n+1],d=t[3*n+2],h=t[3*i],p=t[3*i+1],f=t[3*i+2],m=t[3*a],g=t[3*a+1],y=t[3*a+2];return Math.abs(s-u)<Math.abs(o-c)?[new iX(o,1-l),new iX(c,1-d),new iX(h,1-f),new iX(m,1-y)]:[new iX(s,1-l),new iX(u,1-d),new iX(p,1-f),new iX(g,1-y)]}};function pr(e,t,r){if(r.shapes=[],Array.isArray(e))for(let t=0,n=e.length;t<n;t++){let n=e[t];r.shapes.push(n.uuid)}else r.shapes.push(e.uuid);return r.options=Object.assign({},t),void 0!==t.extrudePath&&(r.options.extrudePath=t.extrudePath.toJSON()),r}class pn extends hw{static fromJSON(e){return new pn(e.radius,e.detail)}constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2;super([-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}}class pi extends hw{static fromJSON(e){return new pi(e.radius,e.detail)}constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}}class pa extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pa(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}constructor(e=.5,t=1,r=32,n=1,i=0,a=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:a},r=Math.max(3,r);let o=[],s=[],l=[],c=[],u=e,d=(t-e)/(n=Math.max(1,n)),h=new ag,p=new iX;for(let e=0;e<=n;e++){for(let e=0;e<=r;e++){let n=i+e/r*a;h.x=u*Math.cos(n),h.y=u*Math.sin(n),s.push(h.x,h.y,h.z),l.push(0,0,1),p.x=(h.x/t+1)/2,p.y=(h.y/t+1)/2,c.push(p.x,p.y)}u+=d}for(let e=0;e<n;e++){let t=e*(r+1);for(let e=0;e<r;e++){let n=e+t,i=n,a=n+r+1,s=n+r+2,l=n+1;o.push(i,a,l),o.push(a,s,l)}}this.setIndex(o),this.setAttribute("position",new oW(s,3)),this.setAttribute("normal",new oW(l,3)),this.setAttribute("uv",new oW(c,2))}}class po extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return ps(this.parameters.shapes,e)}static fromJSON(e,t){let r=[];for(let n=0,i=e.shapes.length;n<i;n++){let i=t[e.shapes[n]];r.push(i)}return new po(r,e.curveSegments)}constructor(e=new hM([new iX(0,.5),new iX(-.5,-.5),new iX(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};let r=[],n=[],i=[],a=[],o=0,s=0;if(!1===Array.isArray(e))l(e);else for(let t=0;t<e.length;t++)l(e[t]),this.addGroup(o,s,t),o+=s,s=0;function l(e){let o=n.length/3,l=e.extractPoints(t),c=l.shape,u=l.holes;!1===h8.isClockWise(c)&&(c=c.reverse());for(let e=0,t=u.length;e<t;e++){let t=u[e];!0===h8.isClockWise(t)&&(u[e]=t.reverse())}let d=h8.triangulateShape(c,u);for(let e=0,t=u.length;e<t;e++){let t=u[e];c=c.concat(t)}for(let e=0,t=c.length;e<t;e++){let t=c[e];n.push(t.x,t.y,0),i.push(0,0,1),a.push(t.x,t.y)}for(let e=0,t=d.length;e<t;e++){let t=d[e],n=t[0]+o,i=t[1]+o,a=t[2]+o;r.push(n,i,a),s+=3}}this.setIndex(r),this.setAttribute("position",new oW(n,3)),this.setAttribute("normal",new oW(i,3)),this.setAttribute("uv",new oW(a,2))}}function ps(e,t){if(t.shapes=[],Array.isArray(e))for(let r=0,n=e.length;r<n;r++){let n=e[r];t.shapes.push(n.uuid)}else t.shapes.push(e.uuid);return t}class pl extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pl(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}constructor(e=1,t=32,r=16,n=0,i=2*Math.PI,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let s=Math.min(a+o,Math.PI),l=0,c=[],u=new ag,d=new ag,h=[],p=[],f=[],m=[];for(let h=0;h<=r;h++){let g=[],y=h/r,v=0;0===h&&0===a?v=.5/t:h===r&&s===Math.PI&&(v=-.5/t);for(let r=0;r<=t;r++){let s=r/t;u.x=-e*Math.cos(n+s*i)*Math.sin(a+y*o),u.y=e*Math.cos(a+y*o),u.z=e*Math.sin(n+s*i)*Math.sin(a+y*o),p.push(u.x,u.y,u.z),d.copy(u).normalize(),f.push(d.x,d.y,d.z),m.push(s+v,1-y),g.push(l++)}c.push(g)}for(let e=0;e<r;e++)for(let n=0;n<t;n++){let t=c[e][n+1],i=c[e][n],o=c[e+1][n],l=c[e+1][n+1];(0!==e||a>0)&&h.push(t,i,l),(e!==r-1||s<Math.PI)&&h.push(i,o,l)}this.setIndex(h),this.setAttribute("position",new oW(p,3)),this.setAttribute("normal",new oW(f,3)),this.setAttribute("uv",new oW(m,2))}}class pc extends hw{static fromJSON(e){return new pc(e.radius,e.detail)}constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}}class pu extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pu(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}constructor(e=1,t=.4,r=12,n=48,i=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},r=Math.floor(r),n=Math.floor(n);let a=[],o=[],s=[],l=[],c=new ag,u=new ag,d=new ag;for(let a=0;a<=r;a++)for(let h=0;h<=n;h++){let p=h/n*i,f=a/r*Math.PI*2;u.x=(e+t*Math.cos(f))*Math.cos(p),u.y=(e+t*Math.cos(f))*Math.sin(p),u.z=t*Math.sin(f),o.push(u.x,u.y,u.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),d.subVectors(u,c).normalize(),s.push(d.x,d.y,d.z),l.push(h/n),l.push(a/r)}for(let e=1;e<=r;e++)for(let t=1;t<=n;t++){let r=(n+1)*e+t-1,i=(n+1)*(e-1)+t-1,o=(n+1)*(e-1)+t,s=(n+1)*e+t;a.push(r,i,s),a.push(i,o,s)}this.setIndex(a),this.setAttribute("position",new oW(o,3)),this.setAttribute("normal",new oW(s,3)),this.setAttribute("uv",new oW(l,2))}}class pd extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pd(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}constructor(e=1,t=.4,r=64,n=8,i=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:a},r=Math.floor(r),n=Math.floor(n);let o=[],s=[],l=[],c=[],u=new ag,d=new ag,h=new ag,p=new ag,f=new ag,m=new ag,g=new ag;for(let o=0;o<=r;++o){let v=o/r*i*Math.PI*2;y(v,i,a,e,h),y(v+.01,i,a,e,p),m.subVectors(p,h),g.addVectors(p,h),f.crossVectors(m,g),g.crossVectors(f,m),f.normalize(),g.normalize();for(let e=0;e<=n;++e){let i=e/n*Math.PI*2,a=-t*Math.cos(i),p=t*Math.sin(i);u.x=h.x+(a*g.x+p*f.x),u.y=h.y+(a*g.y+p*f.y),u.z=h.z+(a*g.z+p*f.z),s.push(u.x,u.y,u.z),d.subVectors(u,h).normalize(),l.push(d.x,d.y,d.z),c.push(o/r),c.push(e/n)}}for(let e=1;e<=r;e++)for(let t=1;t<=n;t++){let r=(n+1)*(e-1)+(t-1),i=(n+1)*e+(t-1),a=(n+1)*e+t,s=(n+1)*(e-1)+t;o.push(r,i,s),o.push(i,a,s)}function y(e,t,r,n,i){let a=Math.cos(e),o=Math.sin(e),s=r/t*e,l=Math.cos(s);i.x=n*(2+l)*.5*a,i.y=n*(2+l)*o*.5,i.z=n*Math.sin(s)*.5}this.setIndex(o),this.setAttribute("position",new oW(s,3)),this.setAttribute("normal",new oW(l,3)),this.setAttribute("uv",new oW(c,2))}}class ph extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new ph(new hp[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}constructor(e=new hd(new ag(-1,-1,0),new ag(-1,1,0),new ag(1,1,0)),t=64,r=1,n=8,i=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i};let a=e.computeFrenetFrames(t,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;let o=new ag,s=new ag,l=new iX,c=new ag,u=[],d=[],h=[],p=[];function f(i){c=e.getPointAt(i/t,c);let l=a.normals[i],h=a.binormals[i];for(let e=0;e<=n;e++){let t=e/n*Math.PI*2,i=Math.sin(t),a=-Math.cos(t);s.x=a*l.x+i*h.x,s.y=a*l.y+i*h.y,s.z=a*l.z+i*h.z,s.normalize(),d.push(s.x,s.y,s.z),o.x=c.x+r*s.x,o.y=c.y+r*s.y,o.z=c.z+r*s.z,u.push(o.x,o.y,o.z)}}function m(){for(let e=1;e<=t;e++)for(let t=1;t<=n;t++){let r=(n+1)*(e-1)+(t-1),i=(n+1)*e+(t-1),a=(n+1)*e+t,o=(n+1)*(e-1)+t;p.push(r,i,o),p.push(i,a,o)}}function g(){for(let e=0;e<=t;e++)for(let r=0;r<=n;r++)l.x=e/t,l.y=r/n,h.push(l.x,l.y)}(function(){for(let e=0;e<t;e++)f(e);f(!1===i?t:0),g(),m()})(),this.setIndex(p),this.setAttribute("position",new oW(u,3)),this.setAttribute("normal",new oW(d,3)),this.setAttribute("uv",new oW(h,2))}}class pp extends o0{copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){let t=[],r=new Set,n=new ag,i=new ag;if(null!==e.index){let a=e.attributes.position,o=e.index,s=e.groups;0===s.length&&(s=[{start:0,count:o.count,materialIndex:0}]);for(let e=0,l=s.length;e<l;++e){let l=s[e],c=l.start,u=l.count;for(let e=c,s=c+u;e<s;e+=3)for(let s=0;s<3;s++){let l=o.getX(e+s),c=o.getX(e+(s+1)%3);n.fromBufferAttribute(a,l),i.fromBufferAttribute(a,c),!0===pf(n,i,r)&&(t.push(n.x,n.y,n.z),t.push(i.x,i.y,i.z))}}}else{let a=e.attributes.position;for(let e=0,o=a.count/3;e<o;e++)for(let o=0;o<3;o++){let s=3*e+o,l=3*e+(o+1)%3;n.fromBufferAttribute(a,s),i.fromBufferAttribute(a,l),!0===pf(n,i,r)&&(t.push(n.x,n.y,n.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new oW(t,3))}}}function pf(e,t,r){let n="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),i="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==r.has(n)&&!0!==r.has(i)&&(r.add(n),r.add(i),!0)}var pm=Object.freeze({__proto__:null,BoxGeometry:sd,CapsuleGeometry:hy,CircleGeometry:hv,ConeGeometry:h_,CylinderGeometry:hb,DodecahedronGeometry:hS,EdgesGeometry:hA,ExtrudeGeometry:pe,IcosahedronGeometry:pn,LatheGeometry:hg,OctahedronGeometry:pi,PlaneGeometry:sB,PolyhedronGeometry:hw,RingGeometry:pa,ShapeGeometry:po,SphereGeometry:pl,TetrahedronGeometry:pc,TorusGeometry:pu,TorusKnotGeometry:pd,TubeGeometry:ph,WireframeGeometry:pp});class pg extends oM{copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new oE(0),this.transparent=!0,this.fog=!0,this.setValues(e)}}class py extends sb{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class pv extends oM{copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new oE(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new oE(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nW,this.normalScale=new iX(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new a2,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}}class pb extends pv{get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new iX(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return iF(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new oE(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new oE(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new oE(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}}class p_ extends oM{copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new oE(16777215),this.specular=new oE(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new oE(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nW,this.normalScale=new iX(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new a2,this.combine=rn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}}class pw extends oM{copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new oE(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new oE(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nW,this.normalScale=new iX(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}}class pS extends oM{copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nW,this.normalScale=new iX(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}}class pT extends oM{copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new oE(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new oE(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nW,this.normalScale=new iX(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new a2,this.combine=rn,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}}class px extends oM{copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new oE(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=nW,this.normalScale=new iX(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}}class pE extends dx{copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}}function pC(e,t,r){return e&&(r||e.constructor!==t)?"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e}function pA(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function pM(e){function t(t,r){return e[t]-e[r]}let r=e.length,n=Array(r);for(let e=0;e!==r;++e)n[e]=e;return n.sort(t),n}function pI(e,t,r){let n=e.length,i=new e.constructor(n);for(let a=0,o=0;o!==n;++a){let n=r[a]*t;for(let r=0;r!==t;++r)i[o++]=e[n+r]}return i}function pR(e,t,r,n){let i=1,a=e[0];for(;void 0!==a&&void 0===a[n];)a=e[i++];if(void 0===a)return;let o=a[n];if(void 0!==o){if(Array.isArray(o))do void 0!==(o=a[n])&&(t.push(a.time),r.push.apply(r,o)),a=e[i++];while(void 0!==a);else if(void 0!==o.toArray)do void 0!==(o=a[n])&&(t.push(a.time),o.toArray(r,r.length)),a=e[i++];while(void 0!==a);else do void 0!==(o=a[n])&&(t.push(a.time),r.push(o)),a=e[i++];while(void 0!==a)}}function pk(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,a=e.clone();a.name=t;let o=[];for(let e=0;e<a.tracks.length;++e){let t=a.tracks[e],s=t.getValueSize(),l=[],c=[];for(let e=0;e<t.times.length;++e){let a=t.times[e]*i;if(!(a<r)&&!(a>=n)){l.push(t.times[e]);for(let r=0;r<s;++r)c.push(t.values[e*s+r])}}0!==l.length&&(t.times=pC(l,t.times.constructor),t.values=pC(c,t.values.constructor),o.push(t))}a.tracks=o;let s=1/0;for(let e=0;e<a.tracks.length;++e)s>a.tracks[e].times[0]&&(s=a.tracks[e].times[0]);for(let e=0;e<a.tracks.length;++e)a.tracks[e].shift(-1*s);return a.resetDuration(),a}let pP={convertArray:pC,isTypedArray:pA,getKeyframeOrder:pM,sortedArray:pI,flattenJSON:pR,subclip:pk,makeClipAdditive:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;n<=0&&(n=30);let i=r.tracks.length,a=t/n;for(let t=0;t<i;++t){let n;let i=r.tracks[t],o=i.ValueTypeName;if("bool"===o||"string"===o)continue;let s=e.tracks.find(function(e){return e.name===i.name&&e.ValueTypeName===o});if(void 0===s)continue;let l=0,c=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(l=c/3);let u=0,d=s.getValueSize();s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let h=i.times.length-1;if(a<=i.times[0]){let e=l,t=c-l;n=i.values.slice(e,t)}else if(a>=i.times[h]){let e=h*c+l,t=e+c-l;n=i.values.slice(e,t)}else{let e=i.createInterpolant(),t=l,r=c-l;e.evaluate(a),n=e.resultBuffer.slice(t,r)}"quaternion"===o&&new am().fromArray(n).normalize().conjugate().toArray(n);let p=s.times.length;for(let e=0;e<p;++e){let t=e*d+u;if("quaternion"===o)am.multiplyQuaternionsFlat(s.values,t,n,0,s.values,t);else{let e=d-2*u;for(let r=0;r<e;++r)s.values[t+r]-=n[r]}}}return e.blendMode=nF,e}};class pO{evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{let a;r:{n:if(!(e<n)){for(let a=r+2;;){if(void 0===n){if(e<i)break n;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(i=n,e<(n=t[++r]))break t}a=t.length;break r}if(!(e>=i)){let o=t[1];e<o&&(r=2,i=o);for(let a=r-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(r===a)break;if(n=i,e>=(i=t[--r-1]))break t}a=r,r=0;break r}break e}for(;r<a;){let n=r+a>>>1;e<t[n]?a=n:r=n+1}if(n=t[r],void 0===(i=t[r-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===n)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n;for(let e=0;e!==n;++e)t[e]=r[i+e];return t}interpolate_(){throw Error("call to abstract method")}intervalChanged_(){}constructor(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}}class pN extends pO{intervalChanged_(e,t,r){let n=this.parameterPositions,i=e-2,a=e+1,o=n[i],s=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case nL:i=e,o=2*t-r;break;case nD:i=n.length-2,o=t+n[i]-n[i+1];break;default:i=e,o=r}if(void 0===s)switch(this.getSettings_().endingEnd){case nL:a=e,s=2*r-t;break;case nD:a=1,s=r+n[1]-n[0];break;default:a=e-1,s=t}let l=(r-t)*.5,c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-r),this._offsetPrev=i*c,this._offsetNext=a*c}interpolate_(e,t,r,n){let i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,h=this._weightNext,p=(r-t)/(n-t),f=p*p,m=f*p,g=-d*m+2*d*f-d*p,y=(1+d)*m+(-1.5-2*d)*f+(-.5+d)*p+1,v=(-1-h)*m+(1.5+h)*f+.5*p,b=h*m-h*f;for(let e=0;e!==o;++e)i[e]=g*a[c+e]+y*a[l+e]+v*a[s+e]+b*a[u+e];return i}constructor(e,t,r,n){super(e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:nN,endingEnd:nN}}}class pL extends pO{interpolate_(e,t,r,n){let i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=(r-t)/(n-t),u=1-c;for(let e=0;e!==o;++e)i[e]=a[l+e]*u+a[s+e]*c;return i}constructor(e,t,r,n){super(e,t,r,n)}}class pD extends pO{interpolate_(e){return this.copySampleValue_(e-1)}constructor(e,t,r,n){super(e,t,r,n)}}class pU{static toJSON(e){let t;let r=e.constructor;if(r.toJSON!==this.toJSON)t=r.toJSON(e);else{t={name:e.name,times:pC(e.times,Array),values:pC(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}InterpolantFactoryMethodDiscrete(e){return new pD(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new pL(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new pN(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case nk:t=this.InterpolantFactoryMethodDiscrete;break;case nP:t=this.InterpolantFactoryMethodLinear;break;case nO:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){let t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(t)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return nk;case this.InterpolantFactoryMethodLinear:return nP;case this.InterpolantFactoryMethodSmooth:return nO}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]+=e}return this}scale(e){if(1!==e){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]*=e}return this}trim(e,t){let r=this.times,n=r.length,i=0,a=n-1;for(;i!==n&&r[i]<e;)++i;for(;-1!==a&&r[a]>t;)--a;if(++a,0!==i||a!==n){i>=a&&(i=(a=Math.max(a,1))-1);let e=this.getValueSize();this.times=r.slice(i,a),this.values=this.values.slice(i*e,a*e)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,n=this.values,i=r.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let t=0;t!==i;t++){let n=r[t];if("number"==typeof n&&isNaN(n)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,n),e=!1;break}if(null!==a&&a>n){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,n,a),e=!1;break}a=n}if(void 0!==n&&pA(n))for(let t=0,r=n.length;t!==r;++t){let r=n[t];if(isNaN(r)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,r),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),n=this.getInterpolation()===nO,i=e.length-1,a=1;for(let o=1;o<i;++o){let i=!1,s=e[o];if(s!==e[o+1]&&(1!==o||s!==e[0])){if(n)i=!0;else{let e=o*r,n=e-r,a=e+r;for(let o=0;o!==r;++o){let r=t[e+o];if(r!==t[n+o]||r!==t[a+o]){i=!0;break}}}}if(i){if(o!==a){e[a]=e[o];let n=o*r,i=a*r;for(let e=0;e!==r;++e)t[i+e]=t[n+e]}++a}}if(i>0){e[a]=e[i];for(let e=i*r,n=a*r,o=0;o!==r;++o)t[n+o]=t[e+o];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*r)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),r=new this.constructor(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}constructor(e,t,r,n){if(void 0===e)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=pC(t,this.TimeBufferType),this.values=pC(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}}pU.prototype.TimeBufferType=Float32Array,pU.prototype.ValueBufferType=Float32Array,pU.prototype.DefaultInterpolation=nP;class pF extends pU{constructor(e,t,r){super(e,t,r)}}pF.prototype.ValueTypeName="bool",pF.prototype.ValueBufferType=Array,pF.prototype.DefaultInterpolation=nk,pF.prototype.InterpolantFactoryMethodLinear=void 0,pF.prototype.InterpolantFactoryMethodSmooth=void 0;class pB extends pU{}pB.prototype.ValueTypeName="color";class pz extends pU{}pz.prototype.ValueTypeName="number";class pH extends pO{interpolate_(e,t,r,n){let i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(r-t)/(n-t),l=e*o;for(let e=l+o;l!==e;l+=4)am.slerpFlat(i,0,a,l-o,a,l,s);return i}constructor(e,t,r,n){super(e,t,r,n)}}class pj extends pU{InterpolantFactoryMethodLinear(e){return new pH(this.times,this.values,this.getValueSize(),e)}}pj.prototype.ValueTypeName="quaternion",pj.prototype.InterpolantFactoryMethodSmooth=void 0;class pG extends pU{constructor(e,t,r){super(e,t,r)}}pG.prototype.ValueTypeName="string",pG.prototype.ValueBufferType=Array,pG.prototype.DefaultInterpolation=nk,pG.prototype.InterpolantFactoryMethodLinear=void 0,pG.prototype.InterpolantFactoryMethodSmooth=void 0;class pV extends pU{}pV.prototype.ValueTypeName="vector";class pq{static parse(e){let t=[],r=e.tracks,n=1/(e.fps||1);for(let e=0,i=r.length;e!==i;++e)t.push(pZ(r[e]).scale(n));let i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i}static toJSON(e){let t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,n=r.length;e!==n;++e)t.push(pU.toJSON(r[e]));return n}static CreateFromMorphTargetSequence(e,t,r,n){let i=t.length,a=[];for(let e=0;e<i;e++){let o=[],s=[];o.push((e+i-1)%i,e,(e+1)%i),s.push(0,1,0);let l=pM(o);o=pI(o,1,l),s=pI(s,1,l),n||0!==o[0]||(o.push(i),s.push(s[0])),a.push(new pz(".morphTargetInfluences["+t[e].name+"]",o,s).scale(1/r))}return new this(e,-1,a)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let t=e;r=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<r.length;e++)if(r[e].name===t)return r[e];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let n={},i=/^([\w-]*?)([\d]+)$/;for(let t=0,r=e.length;t<r;t++){let r=e[t],a=r.name.match(i);if(a&&a.length>1){let e=a[1],t=n[e];t||(n[e]=t=[]),t.push(r)}}let a=[];for(let e in n)a.push(this.CreateFromMorphTargetSequence(e,n[e],t,r));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(e,t,r,n,i){if(0!==r.length){let a=[],o=[];pR(r,a,o,n),0!==a.length&&i.push(new e(t,a,o))}},n=[],i=e.name||"default",a=e.fps||30,o=e.blendMode,s=e.length||-1,l=e.hierarchy||[];for(let e=0;e<l.length;e++){let i=l[e].keys;if(i&&0!==i.length){if(i[0].morphTargets){let e;let t={};for(e=0;e<i.length;e++)if(i[e].morphTargets)for(let r=0;r<i[e].morphTargets.length;r++)t[i[e].morphTargets[r]]=-1;for(let r in t){let t=[],a=[];for(let n=0;n!==i[e].morphTargets.length;++n){let n=i[e];t.push(n.time),a.push(n.morphTarget===r?1:0)}n.push(new pz(".morphTargetInfluence["+r+"]",t,a))}s=t.length*a}else{let a=".bones["+t[e].name+"]";r(pV,a+".position",i,"pos",n),r(pj,a+".quaternion",i,"rot",n),r(pV,a+".scale",i,"scl",n)}}}return 0===n.length?null:new this(i,s,n,o)}resetDuration(){let e=this.tracks,t=0;for(let r=0,n=e.length;r!==n;++r){let e=this.tracks[r];t=Math.max(t,e.times[e.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}constructor(e="",t=-1,r=[],n=nU){this.name=e,this.tracks=r,this.duration=t,this.blendMode=n,this.uuid=iU(),this.duration<0&&this.resetDuration()}}function pW(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return pz;case"vector":case"vector2":case"vector3":case"vector4":return pV;case"color":return pB;case"quaternion":return pj;case"bool":case"boolean":return pF;case"string":return pG}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function pZ(e){if(void 0===e.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=pW(e.type);if(void 0===e.times){let t=[],r=[];pR(e.keys,t,r,"value"),e.times=t,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}let pX={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class p${constructor(e,t,r){let n;let i=this,a=!1,o=0,s=0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){s++,!1===a&&void 0!==i.onStart&&i.onStart(e,o,s),a=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,s),o===s&&(a=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return n?n(e):e},this.setURLModifier=function(e){return n=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){let t=l.indexOf(e);return -1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,r=l.length;t<r;t+=2){let r=l[t],n=l[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return n}return null}}}let pK=new p$;class pY{load(){}loadAsync(e,t){let r=this;return new Promise(function(n,i){r.load(e,n,t,i)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}constructor(e){this.manager=void 0!==e?e:pK,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}}pY.DEFAULT_MATERIAL_NAME="__DEFAULT";let pQ={};class pJ extends Error{constructor(e,t){super(e),this.response=t}}class p0 extends pY{load(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let i=pX.get(e);if(void 0!==i)return this.manager.itemStart(e),setTimeout(()=>{t&&t(i),this.manager.itemEnd(e)},0),i;if(void 0!==pQ[e]){pQ[e].push({onLoad:t,onProgress:r,onError:n});return}pQ[e]=[],pQ[e].push({onLoad:t,onProgress:r,onError:n});let a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,s=this.responseType;fetch(a).then(t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;let r=pQ[e],n=t.body.getReader(),i=t.headers.get("X-File-Size")||t.headers.get("Content-Length"),a=i?parseInt(i):0,o=0!==a,s=0;return new Response(new ReadableStream({start(e){t();function t(){n.read().then(n=>{let{done:i,value:l}=n;if(i)e.close();else{let n=new ProgressEvent("progress",{lengthComputable:o,loaded:s+=l.byteLength,total:a});for(let e=0,t=r.length;e<t;e++){let t=r[e];t.onProgress&&t.onProgress(n)}e.enqueue(l),t()}},t=>{e.error(t)})}}}))}throw new pJ('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)}).then(e=>{switch(s){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(e=>new DOMParser().parseFromString(e,o));case"json":return e.json();default:if(void 0===o)return e.text();{let t=/charset="?([^;"\s]*)"?/i.exec(o),r=new TextDecoder(t&&t[1]?t[1].toLowerCase():void 0);return e.arrayBuffer().then(e=>r.decode(e))}}}).then(t=>{pX.add(e,t);let r=pQ[e];delete pQ[e];for(let e=0,n=r.length;e<n;e++){let n=r[e];n.onLoad&&n.onLoad(t)}}).catch(t=>{let r=pQ[e];if(void 0===r)throw this.manager.itemError(e),t;delete pQ[e];for(let e=0,n=r.length;e<n;e++){let n=r[e];n.onError&&n.onError(t)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}constructor(e){super(e)}}class p1 extends pY{load(e,t,r,n){let i=this,a=new p0(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(r){try{t(i.parse(JSON.parse(r)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},r,n)}parse(e){let t=[];for(let r=0;r<e.length;r++){let n=pq.parse(e[r]);t.push(n)}return t}constructor(e){super(e)}}class p2 extends pY{load(e,t,r,n){let i=this,a=[],o=new dZ,s=new p0(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(i.withCredentials);let l=0;function c(c){s.load(e[c],function(e){let r=i.parse(e,!0);a[c]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(l+=1)&&(1===r.mipmapCount&&(o.minFilter=rR),o.image=a,o.format=r.format,o.needsUpdate=!0,t&&t(o))},r,n)}if(Array.isArray(e))for(let t=0,r=e.length;t<r;++t)c(t);else s.load(e,function(e){let r=i.parse(e,!0);if(r.isCubemap){let e=r.mipmaps.length/r.mipmapCount;for(let t=0;t<e;t++){a[t]={mipmaps:[]};for(let e=0;e<r.mipmapCount;e++)a[t].mipmaps.push(r.mipmaps[t*r.mipmapCount+e]),a[t].format=r.format,a[t].width=r.width,a[t].height=r.height}o.image=a}else o.image.width=r.width,o.image.height=r.height,o.mipmaps=r.mipmaps;1===r.mipmapCount&&(o.minFilter=rR),o.format=r.format,o.needsUpdate=!0,t&&t(o)},r,n);return o}constructor(e){super(e)}}class p3 extends pY{load(e,t,r,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let i=this,a=pX.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;let o=i0("img");function s(){c(),pX.add(e,this),t&&t(this),i.manager.itemEnd(e)}function l(t){c(),n&&n(t),i.manager.itemError(e),i.manager.itemEnd(e)}function c(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o}constructor(e){super(e)}}class p4 extends pY{load(e,t,r,n){let i=new sM;i.colorSpace=n$;let a=new p3(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function s(r){a.load(e[r],function(e){i.images[r]=e,6==++o&&(i.needsUpdate=!0,t&&t(i))},void 0,n)}for(let t=0;t<e.length;++t)s(t);return i}constructor(e){super(e)}}class p5 extends pY{load(e,t,r,n){let i=this,a=new u1,o=new p0(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(i.withCredentials),o.load(e,function(e){let r;try{r=i.parse(e)}catch(e){if(void 0!==n)n(e);else{console.error(e);return}}void 0!==r.image?a.image=r.image:void 0!==r.data&&(a.image.width=r.width,a.image.height=r.height,a.image.data=r.data),a.wrapS=void 0!==r.wrapS?r.wrapS:rT,a.wrapT=void 0!==r.wrapT?r.wrapT:rT,a.magFilter=void 0!==r.magFilter?r.magFilter:rR,a.minFilter=void 0!==r.minFilter?r.minFilter:rR,a.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.colorSpace&&(a.colorSpace=r.colorSpace),void 0!==r.flipY&&(a.flipY=r.flipY),void 0!==r.format&&(a.format=r.format),void 0!==r.type&&(a.type=r.type),void 0!==r.mipmaps&&(a.mipmaps=r.mipmaps,a.minFilter=rO),1===r.mipmapCount&&(a.minFilter=rR),void 0!==r.generateMipmaps&&(a.generateMipmaps=r.generateMipmaps),a.needsUpdate=!0,t&&t(a,r)},r,n),a}constructor(e){super(e)}}class p6 extends pY{load(e,t,r,n){let i=new as,a=new p3(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)},r,n),i}constructor(e){super(e)}}class p8 extends oc{dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(t.object.target=this.target.uuid),t}constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new oE(e),this.intensity=t}}class p7 extends p8{copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(oc.DEFAULT_UP),this.updateMatrix(),this.groundColor=new oE(t)}}let p9=new aW,fe=new ag,ft=new ag;class fr{getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;fe.setFromMatrixPosition(e.matrixWorld),t.position.copy(fe),ft.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(ft),t.updateMatrixWorld(),p9.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(p9),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(p9)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new iX(512,512),this.map=null,this.mapPass=null,this.matrix=new aW,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new sD,this._frameExtents=new iX(1,1),this._viewportCount=1,this._viewports=[new al(0,0,1,1)]}}class fn extends fr{updateMatrices(e){let t=this.camera,r=2*iD*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;(r!==t.fov||n!==t.aspect||i!==t.far)&&(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}constructor(){super(new sx(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}}class fi extends p8{get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}constructor(e,t,r=0,n=Math.PI/3,i=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(oc.DEFAULT_UP),this.updateMatrix(),this.target=new oc,this.distance=r,this.angle=n,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new fn}}let fa=new aW,fo=new ag,fs=new ag;class fl extends fr{updateMatrices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.camera,n=this.matrix,i=e.distance||r.far;i!==r.far&&(r.far=i,r.updateProjectionMatrix()),fo.setFromMatrixPosition(e.matrixWorld),r.position.copy(fo),fs.copy(r.position),fs.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(fs),r.updateMatrixWorld(),n.makeTranslation(-fo.x,-fo.y,-fo.z),fa.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(fa)}constructor(){super(new sx(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new iX(4,2),this._viewportCount=6,this._viewports=[new al(2,1,1,1),new al(0,1,1,1),new al(3,1,1,1),new al(1,1,1,1),new al(3,0,1,1),new al(1,0,1,1)],this._cubeDirections=[new ag(1,0,0),new ag(-1,0,0),new ag(0,0,1),new ag(0,0,-1),new ag(0,1,0),new ag(0,-1,0)],this._cubeUps=[new ag(0,1,0),new ag(0,1,0),new ag(0,1,0),new ag(0,1,0),new ag(0,0,1),new ag(0,0,-1)]}}class fc extends p8{get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}constructor(e,t,r=0,n=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new fl}}class fu extends fr{constructor(){super(new sQ(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class fd extends p8{dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(oc.DEFAULT_UP),this.updateMatrix(),this.target=new oc,this.shadow=new fu}}class fh extends p8{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class fp extends p8{get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){let t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}constructor(e,t,r=10,n=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=n}}class ff{set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){let r=e.x,n=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*n),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*r),t.addScaledVector(a[4],r*n*1.092548),t.addScaledVector(a[5],n*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],r*i*1.092548),t.addScaledVector(a[8],.546274*(r*r-n*n)),t}getIrradianceAt(e,t){let r=e.x,n=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*n),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*r),t.addScaledVector(a[4],.858086*r*n),t.addScaledVector(a[5],.858086*n*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*r*i),t.addScaledVector(a[8],.429043*(r*r-n*n)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.coefficients;for(let n=0;n<9;n++)r[n].fromArray(e,t+3*n);return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.coefficients;for(let n=0;n<9;n++)r[n].toArray(e,t+3*n);return e}static getBasisAt(e,t){let r=e.x,n=e.y,i=e.z;t[0]=.282095,t[1]=.488603*n,t[2]=.488603*i,t[3]=.488603*r,t[4]=1.092548*r*n,t[5]=1.092548*n*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*r*i,t[8]=.546274*(r*r-n*n)}constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ag)}}class fm extends p8{copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){let t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}constructor(e=new ff,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}}class fg extends pY{load(e,t,r,n){let i=this,a=new p0(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(r){try{t(i.parse(JSON.parse(r)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},r,n)}parse(e){let t=this.textures;function r(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}let n=fg.createMaterialFromType(e.type);if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&void 0!==n.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.sheen&&(n.sheen=e.sheen),void 0!==e.sheenColor&&(n.sheenColor=new oE().setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(n.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==n.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==n.specular&&n.specular.setHex(e.specular),void 0!==e.specularIntensity&&(n.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==n.specularColor&&n.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearcoat&&(n.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(n.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.dispersion&&(n.dispersion=e.dispersion),void 0!==e.iridescence&&(n.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(n.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(n.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(n.transmission=e.transmission),void 0!==e.thickness&&(n.thickness=e.thickness),void 0!==e.attenuationDistance&&(n.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==n.attenuationColor&&n.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(n.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(n.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.flatShading&&(n.flatShading=e.flatShading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.combine&&(n.combine=e.combine),void 0!==e.side&&(n.side=e.side),void 0!==e.shadowSide&&(n.shadowSide=e.shadowSide),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(n.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(n.depthFunc=e.depthFunc),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(n.blendSrc=e.blendSrc),void 0!==e.blendDst&&(n.blendDst=e.blendDst),void 0!==e.blendEquation&&(n.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(n.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(n.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(n.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==n.blendColor&&n.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(n.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(n.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(n.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(n.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(n.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(n.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(n.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(n.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(n.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(n.rotation=e.rotation),void 0!==e.linewidth&&(n.linewidth=e.linewidth),void 0!==e.dashSize&&(n.dashSize=e.dashSize),void 0!==e.gapSize&&(n.gapSize=e.gapSize),void 0!==e.scale&&(n.scale=e.scale),void 0!==e.polygonOffset&&(n.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(n.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(n.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(n.dithering=e.dithering),void 0!==e.alphaToCoverage&&(n.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(n.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(n.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.toneMapped&&(n.toneMapped=e.toneMapped),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?n.vertexColors=e.vertexColors>0:n.vertexColors=e.vertexColors),void 0!==e.uniforms)for(let t in e.uniforms){let i=e.uniforms[t];switch(n.uniforms[t]={},i.type){case"t":n.uniforms[t].value=r(i.value);break;case"c":n.uniforms[t].value=new oE().setHex(i.value);break;case"v2":n.uniforms[t].value=new iX().fromArray(i.value);break;case"v3":n.uniforms[t].value=new ag().fromArray(i.value);break;case"v4":n.uniforms[t].value=new al().fromArray(i.value);break;case"m3":n.uniforms[t].value=new i$().fromArray(i.value);break;case"m4":n.uniforms[t].value=new aW().fromArray(i.value);break;default:n.uniforms[t].value=i.value}}if(void 0!==e.defines&&(n.defines=e.defines),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(n.glslVersion=e.glslVersion),void 0!==e.extensions)for(let t in e.extensions)n.extensions[t]=e.extensions[t];if(void 0!==e.lights&&(n.lights=e.lights),void 0!==e.clipping&&(n.clipping=e.clipping),void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=r(e.map)),void 0!==e.matcap&&(n.matcap=r(e.matcap)),void 0!==e.alphaMap&&(n.alphaMap=r(e.alphaMap)),void 0!==e.bumpMap&&(n.bumpMap=r(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=r(e.normalMap)),void 0!==e.normalMapType&&(n.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),n.normalScale=new iX().fromArray(t)}return void 0!==e.displacementMap&&(n.displacementMap=r(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=r(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=r(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=r(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=r(e.specularMap)),void 0!==e.specularIntensityMap&&(n.specularIntensityMap=r(e.specularIntensityMap)),void 0!==e.specularColorMap&&(n.specularColorMap=r(e.specularColorMap)),void 0!==e.envMap&&(n.envMap=r(e.envMap)),void 0!==e.envMapRotation&&n.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(n.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(n.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(n.lightMap=r(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=r(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=r(e.gradientMap)),void 0!==e.clearcoatMap&&(n.clearcoatMap=r(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(n.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(n.clearcoatNormalMap=r(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(n.clearcoatNormalScale=new iX().fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(n.iridescenceMap=r(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(n.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(n.transmissionMap=r(e.transmissionMap)),void 0!==e.thicknessMap&&(n.thicknessMap=r(e.thicknessMap)),void 0!==e.anisotropyMap&&(n.anisotropyMap=r(e.anisotropyMap)),void 0!==e.sheenColorMap&&(n.sheenColorMap=r(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(n.sheenRoughnessMap=r(e.sheenRoughnessMap)),n}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new({ShadowMaterial:pg,SpriteMaterial:uC,RawShaderMaterial:py,ShaderMaterial:sb,PointsMaterial:dF,MeshPhysicalMaterial:pb,MeshStandardMaterial:pv,MeshPhongMaterial:p_,MeshToonMaterial:pw,MeshNormalMaterial:pS,MeshLambertMaterial:pT,MeshDepthMaterial:c6,MeshDistanceMaterial:c8,MeshBasicMaterial:oI,MeshMatcapMaterial:px,LineDashedMaterial:pE,LineBasicMaterial:dx,Material:oM})[e]}constructor(e){super(e),this.textures={}}}class fy{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),"undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);let t="";for(let r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(e){return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return -1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e))?e:t+e}}class fv extends o0{copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}}class fb extends pY{load(e,t,r,n){let i=this,a=new p0(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(r){try{t(i.parse(JSON.parse(r)))}catch(t){n?n(t):console.error(t),i.manager.itemError(e)}},r,n)}parse(e){let t={},r={};function n(e,r){if(void 0!==t[r])return t[r];let n=e.interleavedBuffers[r],a=i(e,n.buffer),o=new uT(iJ(n.type,a),n.stride);return o.uuid=n.uuid,t[r]=o,o}function i(e,t){if(void 0!==r[t])return r[t];let n=new Uint32Array(e.arrayBuffers[t]).buffer;return r[t]=n,n}let a=e.isInstancedBufferGeometry?new fv:new o0,o=e.data.index;if(void 0!==o){let e=iJ(o.type,o.array);a.setIndex(new oU(e,1))}let s=e.data.attributes;for(let t in s){let r;let i=s[t];if(i.isInterleavedBufferAttribute)r=new uE(n(e.data,i.data),i.itemSize,i.offset,i.normalized);else{let e=iJ(i.type,i.array);r=new(i.isInstancedBufferAttribute?u5:oU)(e,i.itemSize,i.normalized)}void 0!==i.name&&(r.name=i.name),void 0!==i.usage&&r.setUsage(i.usage),a.setAttribute(t,r)}let l=e.data.morphAttributes;if(l)for(let t in l){let r=l[t],i=[];for(let t=0,a=r.length;t<a;t++){let a;let o=r[t];a=o.isInterleavedBufferAttribute?new uE(n(e.data,o.data),o.itemSize,o.offset,o.normalized):new oU(iJ(o.type,o.array),o.itemSize,o.normalized),void 0!==o.name&&(a.name=o.name),i.push(a)}a.morphAttributes[t]=i}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);let c=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==c)for(let e=0,t=c.length;e!==t;++e){let t=c[e];a.addGroup(t.start,t.count,t.materialIndex)}let u=e.data.boundingSphere;if(void 0!==u){let e=new ag;void 0!==u.center&&e.fromArray(u.center),a.boundingSphere=new aU(e,u.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}constructor(e){super(e)}}class f_ extends pY{load(e,t,r,n){let i=this,a=""===this.path?fy.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;let o=new p0(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(r){let a=null;try{a=JSON.parse(r)}catch(t){void 0!==n&&n(t),console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message);return}let o=a.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase()){void 0!==n&&n(Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}i.parse(a,t)},r,n)}async loadAsync(e,t){let r=this,n=""===this.path?fy.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;let i=new p0(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);let a=JSON.parse(await i.loadAsync(e,t)),o=a.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase())throw Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(a)}parse(e,t){let r=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),a=this.parseImages(e.images,function(){void 0!==t&&t(l)}),o=this.parseTextures(e.textures,a),s=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,i,s,o,r),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),this.bindLightTargets(l),void 0!==t){let e=!1;for(let t in a)if(a[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){let t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),n=this.parseGeometries(e.geometries,r),i=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,n,o,a,t),l=this.parseSkeletons(e.skeletons,s);return this.bindSkeletons(s,l),this.bindLightTargets(s),s}parseShapes(e){let t={};if(void 0!==e)for(let r=0,n=e.length;r<n;r++){let n=new hM().fromJSON(e[r]);t[n.uuid]=n}return t}parseSkeletons(e,t){let r={},n={};if(t.traverse(function(e){e.isBone&&(n[e.uuid]=e)}),void 0!==e)for(let t=0,i=e.length;t<i;t++){let i=new u4().fromJSON(e[t],n);r[i.uuid]=i}return r}parseGeometries(e,t){let r={};if(void 0!==e){let n=new fb;for(let i=0,a=e.length;i<a;i++){let a;let o=e[i];switch(o.type){case"BufferGeometry":case"InstancedBufferGeometry":a=n.parse(o);break;default:o.type in pm?a=pm[o.type].fromJSON(o,t):console.warn('THREE.ObjectLoader: Unsupported geometry type "'.concat(o.type,'"'))}a.uuid=o.uuid,void 0!==o.name&&(a.name=o.name),void 0!==o.userData&&(a.userData=o.userData),r[o.uuid]=a}}return r}parseMaterials(e,t){let r={},n={};if(void 0!==e){let i=new fg;i.setTextures(t);for(let t=0,a=e.length;t<a;t++){let a=e[t];void 0===r[a.uuid]&&(r[a.uuid]=i.parse(a)),n[a.uuid]=r[a.uuid]}}return n}parseAnimations(e){let t={};if(void 0!==e)for(let r=0;r<e.length;r++){let n=e[r],i=pq.parse(n);t[i.uuid]=i}return t}parseImages(e,t){let r;let n=this,i={};function a(e){return n.manager.itemStart(e),r.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemError(e),n.manager.itemEnd(e)})}function o(e){if("string"==typeof e){let t=e;return a(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:iJ(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){(r=new p3(new p$(t))).setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){let r=e[t],n=r.url;if(Array.isArray(n)){let e=[];for(let t=0,r=n.length;t<r;t++){let r=o(n[t]);null!==r&&(r instanceof HTMLImageElement?e.push(r):e.push(new u1(r.data,r.width,r.height)))}i[r.uuid]=new ai(e)}else{let e=o(r.url);i[r.uuid]=new ai(e)}}}return i}async parseImagesAsync(e){let t;let r=this,n={};async function i(e){if("string"==typeof e){let n=e,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:r.resourcePath+n;return await t.loadAsync(i)}return e.data?{data:iJ(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){(t=new p3(this.manager)).setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){let r=e[t],a=r.url;if(Array.isArray(a)){let e=[];for(let t=0,r=a.length;t<r;t++){let r=a[t],n=await i(r);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new u1(n.data,n.width,n.height)))}n[r.uuid]=new ai(e)}else{let e=await i(r.url);n[r.uuid]=new ai(e)}}}return n}parseTextures(e,t){function r(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}let n={};if(void 0!==e)for(let i=0,a=e.length;i<a;i++){let a;let o=e[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);let s=t[o.image],l=s.data;Array.isArray(l)?(a=new sM,6===l.length&&(a.needsUpdate=!0)):(a=l&&l.data?new u1:new as,l&&(a.needsUpdate=!0)),a.source=s,a.uuid=o.uuid,void 0!==o.name&&(a.name=o.name),void 0!==o.mapping&&(a.mapping=r(o.mapping,fw)),void 0!==o.channel&&(a.channel=o.channel),void 0!==o.offset&&a.offset.fromArray(o.offset),void 0!==o.repeat&&a.repeat.fromArray(o.repeat),void 0!==o.center&&a.center.fromArray(o.center),void 0!==o.rotation&&(a.rotation=o.rotation),void 0!==o.wrap&&(a.wrapS=r(o.wrap[0],fS),a.wrapT=r(o.wrap[1],fS)),void 0!==o.format&&(a.format=o.format),void 0!==o.internalFormat&&(a.internalFormat=o.internalFormat),void 0!==o.type&&(a.type=o.type),void 0!==o.colorSpace&&(a.colorSpace=o.colorSpace),void 0!==o.minFilter&&(a.minFilter=r(o.minFilter,fT)),void 0!==o.magFilter&&(a.magFilter=r(o.magFilter,fT)),void 0!==o.anisotropy&&(a.anisotropy=o.anisotropy),void 0!==o.flipY&&(a.flipY=o.flipY),void 0!==o.generateMipmaps&&(a.generateMipmaps=o.generateMipmaps),void 0!==o.premultiplyAlpha&&(a.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(a.unpackAlignment=o.unpackAlignment),void 0!==o.compareFunction&&(a.compareFunction=o.compareFunction),void 0!==o.userData&&(a.userData=o.userData),n[o.uuid]=a}return n}parseObject(e,t,r,n,i){let a,o,s;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){let t=[];for(let n=0,i=e.length;n<i;n++){let i=e[n];void 0===r[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),t.push(r[i])}return t}return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),r[e]}}function u(e){return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),n[e]}switch(e.type){case"Scene":a=new uS,void 0!==e.background&&(Number.isInteger(e.background)?a.background=new oE(e.background):a.background=u(e.background)),void 0!==e.environment&&(a.environment=u(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new uw(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new u_(e.fog.color,e.fog.density)),""!==e.fog.name&&(a.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(a.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(a.backgroundIntensity=e.backgroundIntensity),void 0!==e.backgroundRotation&&a.backgroundRotation.fromArray(e.backgroundRotation),void 0!==e.environmentIntensity&&(a.environmentIntensity=e.environmentIntensity),void 0!==e.environmentRotation&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new sx(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new sQ(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new fh(e.color,e.intensity);break;case"DirectionalLight":(a=new fd(e.color,e.intensity)).target=e.target||"";break;case"PointLight":a=new fc(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new fp(e.color,e.intensity,e.width,e.height);break;case"SpotLight":(a=new fi(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay)).target=e.target||"";break;case"HemisphereLight":a=new p7(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new fm().fromJSON(e);break;case"SkinnedMesh":a=new uJ(o=l(e.geometry),s=c(e.material)),void 0!==e.bindMode&&(a.bindMode=e.bindMode),void 0!==e.bindMatrix&&a.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(a.skeleton=e.skeleton);break;case"Mesh":a=new sl(o=l(e.geometry),s=c(e.material));break;case"InstancedMesh":o=l(e.geometry),s=c(e.material);let d=e.count,h=e.instanceMatrix,p=e.instanceColor;(a=new dn(o,s,d)).instanceMatrix=new u5(new Float32Array(h.array),16),void 0!==p&&(a.instanceColor=new u5(new Float32Array(p.array),p.itemSize));break;case"BatchedMesh":o=l(e.geometry),s=c(e.material),(a=new dT(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,s)).geometry=o,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._visibility=e.visibility,a._active=e.active,a._bounds=e.bounds.map(e=>{let t=new ab;t.min.fromArray(e.boxMin),t.max.fromArray(e.boxMax);let r=new aU;return r.radius=e.sphereRadius,r.center.fromArray(e.sphereCenter),{boxInitialized:e.boxInitialized,box:t,sphereInitialized:e.sphereInitialized,sphere:r}}),a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._geometryCount=e.geometryCount,a._matricesTexture=u(e.matricesTexture.uuid),void 0!==e.colorsTexture&&(a._colorsTexture=u(e.colorsTexture.uuid));break;case"LOD":a=new uG;break;case"Line":a=new dP(l(e.geometry),c(e.material));break;case"LineLoop":a=new dU(l(e.geometry),c(e.material));break;case"LineSegments":a=new dD(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":a=new dG(l(e.geometry),c(e.material));break;case"Sprite":a=new uB(c(e.material));break;case"Group":a=new ul;break;case"Bone":a=new u0;break;default:a=new oc}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(a.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.up&&a.up.fromArray(e.up),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.intensity&&(a.shadow.intensity=e.shadow.intensity),void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(a.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.frustumCulled&&(a.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(a.renderOrder=e.renderOrder),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.layers&&(a.layers.mask=e.layers),void 0!==e.children){let o=e.children;for(let e=0;e<o.length;e++)a.add(this.parseObject(o[e],t,r,n,i))}if(void 0!==e.animations){let t=e.animations;for(let e=0;e<t.length;e++){let r=t[e];a.animations.push(i[r])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(a.autoUpdate=e.autoUpdate);let t=e.levels;for(let e=0;e<t.length;e++){let r=t[e],n=a.getObjectByProperty("uuid",r.object);void 0!==n&&a.addLevel(n,r.distance,r.hysteresis)}}return a}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){let r=t[e.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(r,e.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){let r=t.target,n=e.getObjectByProperty("uuid",r);void 0!==n?t.target=n:t.target=new oc}})}constructor(e){super(e)}}let fw={UVMapping:rg,CubeReflectionMapping:ry,CubeRefractionMapping:rv,EquirectangularReflectionMapping:rb,EquirectangularRefractionMapping:r_,CubeUVReflectionMapping:rw},fS={RepeatWrapping:rS,ClampToEdgeWrapping:rT,MirroredRepeatWrapping:rx},fT={NearestFilter:rE,NearestMipmapNearestFilter:rC,NearestMipmapLinearFilter:rM,LinearFilter:rR,LinearMipmapNearestFilter:rk,LinearMipmapLinearFilter:rO};class fx extends pY{setOptions(e){return this.options=e,this}load(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let i=this,a=pX.get(e);if(void 0!==a){if(i.manager.itemStart(e),a.then){a.then(r=>{t&&t(r),i.manager.itemEnd(e)}).catch(e=>{n&&n(e)});return}return setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a}let o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader;let s=fetch(e,o).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))}).then(function(r){return pX.add(e,r),t&&t(r),i.manager.itemEnd(e),r}).catch(function(t){n&&n(t),pX.remove(e),i.manager.itemError(e),i.manager.itemEnd(e)});pX.add(e,s),i.manager.itemStart(e)}constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}}class fE{static getContext(){return void 0===o&&(o=new(window.AudioContext||window.webkitAudioContext)),o}static setContext(e){o=e}}class fC extends pY{load(e,t,r,n){let i=this,a=new p0(this.manager);function o(t){n?n(t):console.error(t),i.manager.itemError(e)}a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(e){try{let r=e.slice(0);fE.getContext().decodeAudioData(r,function(e){t(e)}).catch(o)}catch(e){o(e)}},r,n)}constructor(e){super(e)}}let fA=new aW,fM=new aW,fI=new aW;class fR{update(e){let t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){let r,n;t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,fI.copy(e.projectionMatrix);let i=t.eyeSep/2,a=i*t.near/t.focus,o=t.near*Math.tan(iL*t.fov*.5)/t.zoom;fM.elements[12]=-i,fA.elements[12]=i,r=-o*t.aspect+a,n=o*t.aspect+a,fI.elements[0]=2*t.near/(n-r),fI.elements[8]=(n+r)/(n-r),this.cameraL.projectionMatrix.copy(fI),r=-o*t.aspect-a,n=o*t.aspect-a,fI.elements[0]=2*t.near/(n-r),fI.elements[8]=(n+r)/(n-r),this.cameraR.projectionMatrix.copy(fI)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(fM),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(fA)}constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new sx,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new sx,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}}class fk{start(){this.startTime=fP(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=fP();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}}function fP(){return("undefined"==typeof performance?Date:performance).now()}let fO=new ag,fN=new am,fL=new ag,fD=new ag;class fU extends oc{getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);let t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(fO,fN,fL),fD.set(0,0,-1).applyQuaternion(fN),t.positionX){let e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(fO.x,e),t.positionY.linearRampToValueAtTime(fO.y,e),t.positionZ.linearRampToValueAtTime(fO.z,e),t.forwardX.linearRampToValueAtTime(fD.x,e),t.forwardY.linearRampToValueAtTime(fD.y,e),t.forwardZ.linearRampToValueAtTime(fD.z,e),t.upX.linearRampToValueAtTime(r.x,e),t.upY.linearRampToValueAtTime(r.y,e),t.upZ.linearRampToValueAtTime(r.z,e)}else t.setPosition(fO.x,fO.y,fO.z),t.setOrientation(fD.x,fD.y,fD.z,r.x,r.y,r.z)}constructor(){super(),this.type="AudioListener",this.context=fE.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new fk}}class fF extends oc{getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0===this.isPlaying){console.warn("THREE.Audio: Audio is already playing.");return}if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;let t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,null!==this.source&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}}let fB=new ag,fz=new am,fH=new ag,fj=new ag;class fG extends fF{connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(fB,fz,fH),fj.set(0,0,1).applyQuaternion(fz);let t=this.panner;if(t.positionX){let e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(fB.x,e),t.positionY.linearRampToValueAtTime(fB.y,e),t.positionZ.linearRampToValueAtTime(fB.z,e),t.orientationX.linearRampToValueAtTime(fj.x,e),t.orientationY.linearRampToValueAtTime(fj.y,e),t.orientationZ.linearRampToValueAtTime(fj.z,e)}else t.setPosition(fB.x,fB.y,fB.z),t.setOrientation(fj.x,fj.y,fj.z)}constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}}class fV{getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0,t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}}class fq{accumulate(e,t){let r=this.buffer,n=this.valueSize,i=e*n+n,a=this.cumulativeWeight;if(0===a){for(let e=0;e!==n;++e)r[i+e]=r[e];a=t}else{a+=t;let e=t/a;this._mixBufferRegion(r,i,0,e,n)}this.cumulativeWeight=a}accumulateAdditive(e){let t=this.buffer,r=this.valueSize,n=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,n,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){let e=t*this._origIndex;this._mixBufferRegion(r,n,e,1-i,t)}a>0&&this._mixBufferRegionAdditive(r,n,this._addIndex*t,1,t);for(let e=t,i=t+t;e!==i;++e)if(r[e]!==r[e+t]){o.setValue(r,n);break}}saveOriginalState(){let e=this.binding,t=this.buffer,r=this.valueSize,n=r*this._origIndex;e.getValue(t,n);for(let e=r,i=n;e!==i;++e)t[e]=t[n+e%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,n,i){if(n>=.5)for(let n=0;n!==i;++n)e[t+n]=e[r+n]}_slerp(e,t,r,n){am.slerpFlat(e,t,e,t,e,r,n)}_slerpAdditive(e,t,r,n,i){let a=this._workIndex*i;am.multiplyQuaternionsFlat(e,a,e,t,e,r),am.slerpFlat(e,t,e,t,e,a,n)}_lerp(e,t,r,n,i){let a=1-n;for(let o=0;o!==i;++o){let i=t+o;e[i]=e[i]*a+e[r+o]*n}}_lerpAdditive(e,t,r,n,i){for(let a=0;a!==i;++a){let i=t+a;e[i]=e[i]+e[r+a]*n}}constructor(e,t,r){let n,i,a;switch(this.binding=e,this.valueSize=r,t){case"quaternion":n=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":n=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=Array(5*r);break;default:n=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}}let fW="\\[\\]\\.:\\/",fZ=RegExp("["+fW+"]","g"),fX="[^"+fW+"]",f$="[^"+fW.replace("\\.","")+"]",fK=/((?:WC+[\/:])*)/.source.replace("WC",fX),fY=RegExp("^"+fK+/(WCOD+)?/.source.replace("WCOD",f$)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",fX)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",fX)+"$"),fQ=["material","materials","bones","map"];class fJ{getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}constructor(e,t,r){let n=r||f0.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}}class f0{static create(e,t,r){return e&&e.isAnimationObjectGroup?new f0.Composite(e,t,r):new f0(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(fZ,"")}static parseTrackName(e){let t=fY.exec(e);if(null===t)throw Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){let e=r.nodeName.substring(n+1);-1!==fQ.indexOf(e)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=e)}if(null===r.propertyName||0===r.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){let r=function(e){for(let n=0;n<e.length;n++){let i=e[n];if(i.name===t||i.uuid===t)return i;let a=r(i.children);if(a)return a}return null},n=r(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)e[t++]=r[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,i=t.propertyIndex;if(e||(e=f0.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let n=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===n){n=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(void 0===e[r]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(void 0!==n){if(void 0===e[n]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[n]}}let a=e[n];if(void 0===a){console.error("THREE.PropertyBinding: Trying to update property for track: "+t.nodeName+"."+n+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let s=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}s=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(s=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(s=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=n;this.getValue=this.GetterByBindingType[s],this.setValue=this.SetterByBindingTypeAndVersioning[s][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}constructor(e,t,r){this.path=t,this.parsedPath=r||f0.parseTrackName(t),this.node=f0.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}f0.Composite=fJ,f0.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},f0.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},f0.prototype.GetterByBindingType=[f0.prototype._getValue_direct,f0.prototype._getValue_array,f0.prototype._getValue_arrayElement,f0.prototype._getValue_toArray],f0.prototype.SetterByBindingTypeAndVersioning=[[f0.prototype._setValue_direct,f0.prototype._setValue_direct_setNeedsUpdate,f0.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[f0.prototype._setValue_array,f0.prototype._setValue_array_setNeedsUpdate,f0.prototype._setValue_array_setMatrixWorldNeedsUpdate],[f0.prototype._setValue_arrayElement,f0.prototype._setValue_arrayElement_setNeedsUpdate,f0.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[f0.prototype._setValue_fromArray,f0.prototype._setValue_fromArray_setNeedsUpdate,f0.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class f1{add(){let e=this._objects,t=this._indicesByUUID,r=this._paths,n=this._parsedPaths,i=this._bindings,a=i.length,o,s=e.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){let u=arguments[c],d=u.uuid,h=t[d];if(void 0===h){h=s++,t[d]=h,e.push(u);for(let e=0,t=a;e!==t;++e)i[e].push(new f0(u,r[e],n[e]))}else if(h<l){o=e[h];let s=--l,c=e[s];t[c.uuid]=h,e[h]=c,t[d]=s,e[s]=u;for(let e=0,t=a;e!==t;++e){let t=i[e],a=t[s],o=t[h];t[h]=a,void 0===o&&(o=new f0(u,r[e],n[e])),t[s]=o}}else e[h]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){let e=this._objects,t=this._indicesByUUID,r=this._bindings,n=r.length,i=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){let o=arguments[a],s=o.uuid,l=t[s];if(void 0!==l&&l>=i){let a=i++,c=e[a];t[c.uuid]=l,e[l]=c,t[s]=a,e[a]=o;for(let e=0,t=n;e!==t;++e){let t=r[e],n=t[a],i=t[l];t[l]=n,t[a]=i}}}this.nCachedObjects_=i}uncache(){let e=this._objects,t=this._indicesByUUID,r=this._bindings,n=r.length,i=this.nCachedObjects_,a=e.length;for(let o=0,s=arguments.length;o!==s;++o){let s=arguments[o],l=s.uuid,c=t[l];if(void 0!==c){if(delete t[l],c<i){let o=--i,s=e[o],l=--a,u=e[l];t[s.uuid]=c,e[c]=s,t[u.uuid]=o,e[o]=u,e.pop();for(let e=0,t=n;e!==t;++e){let t=r[e],n=t[o],i=t[l];t[c]=n,t[o]=i,t.pop()}}else{let i=--a,o=e[i];i>0&&(t[o.uuid]=c),e[c]=o,e.pop();for(let e=0,t=n;e!==t;++e){let t=r[e];t[c]=t[i],t.pop()}}}}this.nCachedObjects_=i}subscribe_(e,t){let r=this._bindingsIndicesByPath,n=r[e],i=this._bindings;if(void 0!==n)return i[n];let a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,u=Array(l);n=i.length,r[e]=n,a.push(e),o.push(t),i.push(u);for(let r=c,n=s.length;r!==n;++r){let n=s[r];u[r]=new f0(n,e,t)}return u}unsubscribe_(e){let t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){let n=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=r,a[r]=s,a.pop(),i[r]=i[o],i.pop(),n[r]=n[o],n.pop()}}constructor(){this.isAnimationObjectGroup=!0,this.uuid=iU(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;let e={};this._indicesByUUID=e;for(let t=0,r=arguments.length;t!==r;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};let t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}}class f2{play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){let r=this._clip.duration,n=e._clip.duration,i=n/r,a=r/n;e.warp(1,i,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){let e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){let n=this._mixer,i=n.time,a=this.timeScale,o=this._timeScaleInterpolant;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);let s=o.parameterPositions,l=o.sampleValues;return s[0]=i,s[1]=i+r,l[0]=e/a,l[1]=t/a,this}stopWarping(){let e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,n){if(!this.enabled){this._updateWeight(e);return}let i=this._startTime;if(null!==i){let n=(e-i)*r;n<0||0===r?t=0:(this._startTime=null,t=r*n)}t*=this._updateTimeScale(e);let a=this._updateTime(t),o=this._updateWeight(e);if(o>0){let e=this._interpolants,t=this._propertyBindings;if(this.blendMode===nF)for(let r=0,n=e.length;r!==n;++r)e[r].evaluate(a),t[r].accumulateAdditive(o);else for(let r=0,i=e.length;r!==i;++r)e[r].evaluate(a),t[r].accumulate(n,o)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let r=this._weightInterpolant;if(null!==r){let n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let r=this._timeScaleInterpolant;null!==r&&(t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,r=this.loop,n=this.time+e,i=this._loopCount,a=r===nR;if(0===e)return -1===i?n:a&&(1&i)==1?t-n:n;if(r===nM){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));i:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break i}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),n>=t||n<0){let r=Math.floor(n/t);n-=t*r,i+=Math.abs(r);let o=this.repetitions-i;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?t:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){let t=e<0;this._setEndings(t,!t,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:r})}}else this.time=n;if(a&&(1&i)==1)return t-n}return n}_setEndings(e,t,r){let n=this._interpolantSettings;r?(n.endingStart=nL,n.endingEnd=nL):(e?n.endingStart=this.zeroSlopeAtStart?nL:nN:n.endingStart=nD,t?n.endingEnd=this.zeroSlopeAtEnd?nL:nN:n.endingEnd=nD)}_scheduleFading(e,t,r){let n=this._mixer,i=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);let o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=r,this}constructor(e,t,r=null,n=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=n;let i=t.tracks,a=i.length,o=Array(a),s={endingStart:nN,endingEnd:nN};for(let e=0;e!==a;++e){let t=i[e].createInterpolant(null);o[e]=t,t.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=nI,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}}let f3=new Float32Array(1);class f4 extends iP{_bindAction(e,t){let r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,a=e._propertyBindings,o=e._interpolants,s=r.uuid,l=this._bindingsByRootAndName,c=l[s];void 0===c&&(c={},l[s]=c);for(let e=0;e!==i;++e){let i=n[e],l=i.name,u=c[l];if(void 0!==u)++u.referenceCount,a[e]=u;else{if(void 0!==(u=a[e])){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,s,l));continue}let n=t&&t._propertyBindings[e].binding.parsedPath;u=new fq(f0.create(r,l,n),i.ValueTypeName,i.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,s,l),a[e]=u}o[e].resultBuffer=u.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){let t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,t)}let t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){let r=t[e];0==r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){let r=t[e];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,r){let n=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{let t=a.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=n.length,n.push(e),a.actionByRoot[r]=e}_removeInactiveAction(e){let t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;let i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,l=s[s.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),e._byClipCacheIndex=null;let u=o.actionByRoot,d=(e._localRoot||this._root).uuid;delete u[d],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){let r=t[e];0==--r.referenceCount&&this._removeInactiveBinding(r)}}_lendAction(e){let t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackAction(e){let t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_addInactiveBinding(e,t,r){let n=this._bindingsByRootAndName,i=this._bindings,a=n[t];void 0===a&&(a={},n[t]=a),a[r]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){let t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,a=this._bindingsByRootAndName,o=a[n],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[i],0===Object.keys(o).length&&delete a[n]}_lendBinding(e){let t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_takeBackBinding(e){let t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return void 0===r&&((r=new pL(new Float32Array(2),new Float32Array(2),1,f3)).__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){let t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n,t[n]=e,i.__cacheIndex=r,t[r]=i}clipAction(e,t,r){let n=t||this._root,i=n.uuid,a="string"==typeof e?pq.findByName(n,e):e,o=null!==a?a.uuid:e,s=this._actionsByClip[o],l=null;if(void 0===r&&(r=null!==a?a.blendMode:nU),void 0!==s){let e=s.actionByRoot[i];if(void 0!==e&&e.blendMode===r)return e;l=s.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;let c=new f2(this,a,t,r);return this._bindAction(c,l),this._addInactiveAction(c,o,i),c}existingAction(e,t){let r=t||this._root,n=r.uuid,i="string"==typeof e?pq.findByName(r,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[n]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;let t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(let o=0;o!==r;++o)t[o]._update(n,e,i,a);let o=this._bindings,s=this._nActiveBindings;for(let e=0;e!==s;++e)o[e].apply(a);return this}setTime(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){let e=i.knownActions;for(let r=0,n=e.length;r!==n;++r){let n=e[r];this._deactivateAction(n);let i=n._cacheIndex,a=t[t.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,a._cacheIndex=i,t[i]=a,t.pop(),this._removeInactiveBindingsForAction(n)}delete n[r]}}uncacheRoot(e){let t=e.uuid,r=this._actionsByClip;for(let e in r){let n=r[e].actionByRoot[t];void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}let n=this._bindingsByRootAndName[t];if(void 0!==n)for(let e in n){let t=n[e];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(e,t){let r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}}class f5{clone(){return new f5(void 0===this.value.clone?this.value:this.value.clone())}constructor(e){this.value=e}}let f6=0;class f8 extends iP{add(e){return this.uniforms.push(e),this}remove(e){let t=this.uniforms.indexOf(e);return -1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;let t=e.uniforms;this.uniforms.length=0;for(let e=0,r=t.length;e<r;e++){let r=Array.isArray(t[e])?t[e]:[t[e]];for(let e=0;e<r.length;e++)this.uniforms.push(r[e].clone())}return this}clone(){return new this.constructor().copy(this)}constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:f6++}),this.name="",this.usage=ib,this.uniforms=[]}}class f7 extends uT{copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){let t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){let t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}}class f9{set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}constructor(e,t,r,n,i){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=n,this.count=i,this.version=0}}let me=new aW;class mt{set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return me.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(me),this}intersectObject(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return mn(e,this,r,t),r.sort(mr),r}intersectObjects(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let n=0,i=e.length;n<i;n++)mn(e[n],this,r,t);return r.sort(mr),r}constructor(e,t,r=0,n=1/0){this.ray=new aq(e,t),this.near=r,this.far=n,this.camera=null,this.layers=new a3,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}}function mr(e,t){return e.distance-t.distance}function mn(e,t,r,n){let i=!0;if(e.layers.test(t.layers)&&!1===e.raycast(t,r)&&(i=!1),!0===i&&!0===n){let n=e.children;for(let e=0,i=n.length;e<i;e++)mn(n[e],t,r,!0)}}class mi{set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){let e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(iF(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}}class ma{set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}constructor(e=1,t=0,r=0){return this.radius=e,this.theta=t,this.y=r,this}}class mo{identity(){return this.set(1,0,0,1),this}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let r=0;r<4;r++)this.elements[r]=e[r+t];return this}set(e,t,r,n){let i=this.elements;return i[0]=e,i[2]=t,i[1]=r,i[3]=n,this}constructor(e,t,r,n){mo.prototype.isMatrix2=!0,this.elements=[1,0,0,1],void 0!==e&&this.set(e,t,r,n)}}let ms=new iX;class ml{set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=ms.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=Infinity,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ms).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}constructor(e=new iX(Infinity,Infinity),t=new iX(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}}let mc=new ag,mu=new ag;class md{set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){mc.subVectors(e,this.start),mu.subVectors(this.end,this.start);let r=mu.dot(mu),n=mu.dot(mc)/r;return t&&(n=iF(n,0,1)),n}closestPointToPoint(e,t,r){let n=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(n).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}constructor(e=new ag,t=new ag){this.start=e,this.end=t}}let mh=new ag;class mp extends oc{dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),mh.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(mh),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let r=new o0,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let e=0,t=1,r=32;e<r;e++,t++){let i=e/r*Math.PI*2,a=t/r*Math.PI*2;n.push(Math.cos(i),Math.sin(i),1,Math.cos(a),Math.sin(a),1)}r.setAttribute("position",new oW(n,3));let i=new dx({fog:!1,toneMapped:!1});this.cone=new dD(r,i),this.add(this.cone),this.update()}}let mf=new ag,mm=new aW,mg=new aW;class my extends dD{updateMatrixWorld(e){let t=this.bones,r=this.geometry,n=r.getAttribute("position");mg.copy(this.root.matrixWorld).invert();for(let e=0,r=0;e<t.length;e++){let i=t[e];i.parent&&i.parent.isBone&&(mm.multiplyMatrices(mg,i.matrixWorld),mf.setFromMatrixPosition(mm),n.setXYZ(r,mf.x,mf.y,mf.z),mm.multiplyMatrices(mg,i.parent.matrixWorld),mf.setFromMatrixPosition(mm),n.setXYZ(r+1,mf.x,mf.y,mf.z),r+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e){let t=mv(e),r=new o0,n=[],i=[],a=new oE(0,0,1),o=new oE(0,1,0);for(let e=0;e<t.length;e++){let r=t[e];r.parent&&r.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}r.setAttribute("position",new oW(n,3)),r.setAttribute("color",new oW(i,3)),super(r,new dx({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}}function mv(e){let t=[];!0===e.isBone&&t.push(e);for(let r=0;r<e.children.length;r++)t.push.apply(t,mv(e.children[r]));return t}class mb extends sl{dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}constructor(e,t,r){super(new pl(t,4,2),new oI({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}}let m_=new ag,mw=new oE,mS=new oE;class mT extends oc{dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){let e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{let t=e.geometry.getAttribute("color");mw.copy(this.light.color),mS.copy(this.light.groundColor);for(let e=0,r=t.count;e<r;e++){let n=e<r/2?mw:mS;t.setXYZ(e,n.r,n.g,n.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(m_.setFromMatrixPosition(this.light.matrixWorld).negate())}constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";let n=new pi(t);n.rotateY(.5*Math.PI),this.material=new oI({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);let i=new Float32Array(3*n.getAttribute("position").count);n.setAttribute("color",new oU(i,3)),this.add(new sl(n,this.material)),this.update()}}class mx extends dD{dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e=10,t=10,r=4473924,n=8947848){r=new oE(r),n=new oE(n);let i=t/2,a=e/t,o=e/2,s=[],l=[];for(let e=0,c=0,u=-o;e<=t;e++,u+=a){s.push(-o,0,u,o,0,u),s.push(u,0,-o,u,0,o);let t=e===i?r:n;t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3}let c=new o0;c.setAttribute("position",new oW(s,3)),c.setAttribute("color",new oW(l,3)),super(c,new dx({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class mE extends dD{dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e=10,t=16,r=8,n=64,i=4473924,a=8947848){i=new oE(i),a=new oE(a);let o=[],s=[];if(t>1)for(let r=0;r<t;r++){let n=r/t*(2*Math.PI),l=Math.sin(n)*e,c=Math.cos(n)*e;o.push(0,0,0),o.push(l,0,c);let u=1&r?i:a;s.push(u.r,u.g,u.b),s.push(u.r,u.g,u.b)}for(let t=0;t<r;t++){let l=1&t?i:a,c=e-e/r*t;for(let e=0;e<n;e++){let t=e/n*(2*Math.PI),r=Math.sin(t)*c,i=Math.cos(t)*c;o.push(r,0,i),s.push(l.r,l.g,l.b),r=Math.sin(t=(e+1)/n*(2*Math.PI))*c,i=Math.cos(t)*c,o.push(r,0,i),s.push(l.r,l.g,l.b)}}let l=new o0;l.setAttribute("position",new oW(o,3)),l.setAttribute("color",new oW(s,3)),super(l,new dx({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}let mC=new ag,mA=new ag,mM=new ag;class mI extends oc{dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),mC.setFromMatrixPosition(this.light.matrixWorld),mA.setFromMatrixPosition(this.light.target.matrixWorld),mM.subVectors(mA,mC),this.lightPlane.lookAt(mA),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(mA),this.targetLine.scale.z=mM.length()}constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",void 0===t&&(t=1);let n=new o0;n.setAttribute("position",new oW([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let i=new dx({fog:!1,toneMapped:!1});this.lightPlane=new dP(n,i),this.add(this.lightPlane),(n=new o0).setAttribute("position",new oW([0,0,0,0,0,1],3)),this.targetLine=new dP(n,i),this.add(this.targetLine),this.update()}}let mR=new ag,mk=new s_;class mP extends dD{setColors(e,t,r,n,i){let a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,r.r,r.g,r.b),a.setXYZ(33,r.r,r.g,r.b),a.setXYZ(34,r.r,r.g,r.b),a.setXYZ(35,r.r,r.g,r.b),a.setXYZ(36,r.r,r.g,r.b),a.setXYZ(37,r.r,r.g,r.b),a.setXYZ(38,n.r,n.g,n.b),a.setXYZ(39,n.r,n.g,n.b),a.setXYZ(40,i.r,i.g,i.b),a.setXYZ(41,i.r,i.g,i.b),a.setXYZ(42,i.r,i.g,i.b),a.setXYZ(43,i.r,i.g,i.b),a.setXYZ(44,i.r,i.g,i.b),a.setXYZ(45,i.r,i.g,i.b),a.setXYZ(46,i.r,i.g,i.b),a.setXYZ(47,i.r,i.g,i.b),a.setXYZ(48,i.r,i.g,i.b),a.setXYZ(49,i.r,i.g,i.b),a.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,r=1,n=1;mk.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),mO("c",t,e,mk,0,0,-1),mO("t",t,e,mk,0,0,1),mO("n1",t,e,mk,-r,-n,-1),mO("n2",t,e,mk,r,-n,-1),mO("n3",t,e,mk,-r,n,-1),mO("n4",t,e,mk,r,n,-1),mO("f1",t,e,mk,-r,-n,1),mO("f2",t,e,mk,r,-n,1),mO("f3",t,e,mk,-r,n,1),mO("f4",t,e,mk,r,n,1),mO("u1",t,e,mk,.7*r,1.1*n,-1),mO("u2",t,e,mk,-(.7*r),1.1*n,-1),mO("u3",t,e,mk,0,2*n,-1),mO("cf1",t,e,mk,-r,0,1),mO("cf2",t,e,mk,r,0,1),mO("cf3",t,e,mk,0,-n,1),mO("cf4",t,e,mk,0,n,1),mO("cn1",t,e,mk,-r,0,-1),mO("cn2",t,e,mk,r,0,-1),mO("cn3",t,e,mk,0,-n,-1),mO("cn4",t,e,mk,0,n,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e){let t=new o0,r=new dx({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],i=[],a={};function o(e,t){s(e),s(t)}function s(e){n.push(0,0,0),i.push(0,0,0),void 0===a[e]&&(a[e]=[]),a[e].push(n.length/3-1)}o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4"),t.setAttribute("position",new oW(n,3)),t.setAttribute("color",new oW(i,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();let l=new oE(16755200),c=new oE(16711680),u=new oE(43775),d=new oE(16777215),h=new oE(3355443);this.setColors(l,c,u,d,h)}}function mO(e,t,r,n,i,a,o){mR.set(i,a,o).unproject(n);let s=t[e];if(void 0!==s){let e=r.getAttribute("position");for(let t=0,r=s.length;t<r;t++)e.setXYZ(s[t],mR.x,mR.y,mR.z)}}let mN=new ab;class mL extends dD{update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&mN.setFromObject(this.object),mN.isEmpty())return;let t=mN.min,r=mN.max,n=this.geometry.attributes.position,i=n.array;i[0]=r.x,i[1]=r.y,i[2]=r.z,i[3]=t.x,i[4]=r.y,i[5]=r.z,i[6]=t.x,i[7]=t.y,i[8]=r.z,i[9]=r.x,i[10]=t.y,i[11]=r.z,i[12]=r.x,i[13]=r.y,i[14]=t.z,i[15]=t.x,i[16]=r.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=r.x,i[22]=t.y,i[23]=t.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e,t=16776960){let r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new o0;i.setIndex(new oU(r,1)),i.setAttribute("position",new oU(n,3)),super(i,new dx({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}}class mD extends dD{updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e,t=16776960){let r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],i=new o0;i.setIndex(new oU(r,1)),i.setAttribute("position",new oW(n,3)),super(i,new dx({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}}class mU extends dP{updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}constructor(e,t=1,r=16776960){let n=r,i=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new o0;a.setAttribute("position",new oW(i,3)),a.computeBoundingSphere(),super(a,new dx({color:n,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;let o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],s=new o0;s.setAttribute("position",new oW(o,3)),s.computeBoundingSphere(),this.add(new sl(s,new oI({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}}let mF=new ag;class mB extends oc{setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{mF.set(e.z,0,-e.x).normalize();let t=Math.acos(e.y);this.quaternion.setFromAxisAngle(mF,t)}}setLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}constructor(e=new ag(0,0,1),t=new ag(0,0,0),r=1,n=16776960,i=.2*r,a=.2*i){super(),this.type="ArrowHelper",void 0===s&&((s=new o0).setAttribute("position",new oW([0,0,0,0,1,0],3)),(l=new hb(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new dP(s,new dx({color:n,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new sl(l,new oI({color:n,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,i,a)}}class mz extends dD{setColors(e,t,r){let n=new oE,i=this.geometry.attributes.color.array;return n.set(e),n.toArray(i,0),n.toArray(i,3),n.set(t),n.toArray(i,6),n.toArray(i,9),n.set(r),n.toArray(i,12),n.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new o0;n.setAttribute("position",new oW(t,3)),n.setAttribute("color",new oW(r,3)),super(n,new dx({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}}class mH{moveTo(e,t){return this.currentPath=new hm,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,n){return this.currentPath.quadraticCurveTo(e,t,r,n),this}bezierCurveTo(e,t,r,n,i,a){return this.currentPath.bezierCurveTo(e,t,r,n,i,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){let t,r,n,i,a;function o(e){let t=[];for(let r=0,n=e.length;r<n;r++){let n=e[r],i=new hM;i.curves=n.curves,t.push(i)}return t}function s(e,t){let r=t.length,n=!1;for(let i=r-1,a=0;a<r;i=a++){let r=t[i],o=t[a],s=o.x-r.x,l=o.y-r.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(r=t[a],s=-s,o=t[i],l=-l),e.y<r.y||e.y>o.y)continue;if(e.y===r.y){if(e.x===r.x)return!0}else{let t=l*(e.x-r.x)-s*(e.y-r.y);if(0===t)return!0;if(t<0)continue;n=!n}}else{if(e.y!==r.y)continue;if(o.x<=e.x&&e.x<=r.x||r.x<=e.x&&e.x<=o.x)return!0}}return n}let l=h8.isClockWise,c=this.subPaths;if(0===c.length)return[];let u=[];if(1===c.length)return r=c[0],(n=new hM).curves=r.curves,u.push(n),u;let d=!l(c[0].getPoints());d=e?!d:d;let h=[],p=[],f=[],m=0;p[0]=void 0,f[m]=[];for(let n=0,a=c.length;n<a;n++)t=l(i=(r=c[n]).getPoints()),(t=e?!t:t)?(!d&&p[m]&&m++,p[m]={s:new hM,p:i},p[m].s.curves=r.curves,d&&m++,f[m]=[]):f[m].push({h:r,p:i[0]});if(!p[0])return o(c);if(p.length>1){let e=!1,t=0;for(let e=0,t=p.length;e<t;e++)h[e]=[];for(let r=0,n=p.length;r<n;r++){let n=f[r];for(let i=0;i<n.length;i++){let a=n[i],o=!0;for(let n=0;n<p.length;n++)s(a.p,p[n].p)&&(r!==n&&t++,o?(o=!1,h[n].push(a)):e=!0);o&&h[r].push(a)}}t>0&&!1===e&&(f=h)}for(let e=0,t=p.length;e<t;e++){n=p[e].s,u.push(n),a=f[e];for(let e=0,t=a.length;e<t;e++)n.holes.push(a[e].h)}return u}constructor(){this.type="ShapePath",this.color=new oE,this.subPaths=[],this.currentPath=null}}class mj extends au{get texture(){return this.textures}constructor(e=1,t=1,r=1,n={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,t,{...n,count:r}),this.isWebGLMultipleRenderTargets=!0}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:tb}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=tb);var mG=r(49971);function mV(e){let t;let r=new Set,n=(e,n)=>{let i="function"==typeof e?e(t):e;if(i!==t){let e=t;t=n?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,a=(e,n=i,a=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let o=n(t);function s(){let r=n(t);if(!a(o,r)){let t=o;e(o=r,t)}}return r.add(s),()=>r.delete(s)},o={setState:n,getState:i,subscribe:(e,t,n)=>t||n?a(e,t,n):(r.add(e),()=>r.delete(e)),destroy:()=>r.clear()};return t=e(n,i,o),o}let mq="undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?v.useEffect:v.useLayoutEffect;function mW(e){let t="function"==typeof e?mV(e):e,r=(e=t.getState,r=Object.is)=>{let n;let[,i]=(0,v.useReducer)(e=>e+1,0),a=t.getState(),o=(0,v.useRef)(a),s=(0,v.useRef)(e),l=(0,v.useRef)(r),c=(0,v.useRef)(!1),u=(0,v.useRef)();void 0===u.current&&(u.current=e(a));let d=!1;(o.current!==a||s.current!==e||l.current!==r||c.current)&&(n=e(a),d=!r(u.current,n)),mq(()=>{d&&(u.current=n),o.current=a,s.current=e,l.current=r,c.current=!1});let h=(0,v.useRef)(a);mq(()=>{let e=()=>{try{let e=t.getState(),r=s.current(e);l.current(u.current,r)||(o.current=e,u.current=r,i())}catch(e){c.current=!0,i()}},r=t.subscribe(e);return t.getState()!==h.current&&e(),r},[]);let p=d?n:u.current;return(0,v.useDebugValue)(p),p};return Object.assign(r,t),r[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");let e=[r,t];return{next(){let t=e.length<=0;return{value:e.shift(),done:t}}}},r}let mZ=e=>"object"==typeof e&&"function"==typeof e.then,mX=[];function m$(e,t,r=(e,t)=>e===t){if(e===t)return!0;if(!e||!t)return!1;let n=e.length;if(t.length!==n)return!1;for(let i=0;i<n;i++)if(!r(e[i],t[i]))return!1;return!0}function mK(e,t=null,r=!1,n={}){for(let i of(null===t&&(t=[e]),mX))if(m$(t,i.keys,i.equal)){if(r)return;if(Object.prototype.hasOwnProperty.call(i,"error"))throw i.error;if(Object.prototype.hasOwnProperty.call(i,"response"))return n.lifespan&&n.lifespan>0&&(i.timeout&&clearTimeout(i.timeout),i.timeout=setTimeout(i.remove,n.lifespan)),i.response;if(!r)throw i.promise}let i={keys:t,equal:n.equal,remove:()=>{let e=mX.indexOf(i);-1!==e&&mX.splice(e,1)},promise:(mZ(e)?e:e(...t)).then(e=>{i.response=e,n.lifespan&&n.lifespan>0&&(i.timeout=setTimeout(i.remove,n.lifespan))}).catch(e=>i.error=e)};if(mX.push(i),!r)throw i.promise}let mY=(e,t,r)=>mK(e,t,!1,r),mQ=(e,t,r)=>void mK(e,t,!0,r),mJ=e=>{if(void 0===e||0===e.length)mX.splice(0,mX.length);else{let t=mX.find(t=>m$(e,t.keys,t.equal));t&&t.remove()}};var m0=r(27975),m1=r.n(m0),m2=r(16697),m3=r(25566);let m4={},m5=e=>void Object.assign(m4,e);function m6(e,t){function r(e,{args:t=[],attach:r,...n},i){let a,o=`${e[0].toUpperCase()}${e.slice(1)}`;if("primitive"===e){if(void 0===n.object)throw Error("R3F: Primitives without 'object' are invalid!");a=gf(n.object,{type:e,root:i,attach:r,primitive:!0})}else{let n=m4[o];if(!n)throw Error(`R3F: ${o} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(t))throw Error("R3F: The args prop must be an array!");a=gf(new n(...t),{type:e,root:i,attach:r,memoizedProps:{args:t}})}return void 0===a.__r3f.attach&&(a.isBufferGeometry?a.__r3f.attach="geometry":a.isMaterial&&(a.__r3f.attach="material")),"inject"!==o&&gw(a,n),a}function n(e,t){let r=!1;if(t){var n,i;null!=(n=t.__r3f)&&n.attach?gy(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),r=!0),r||null==(i=e.__r3f)||i.objects.push(t),t.__r3f||gf(t,{}),t.__r3f.parent=e,gT(t),gS(t)}}function i(e,t,r){let n=!1;if(t){var i,a;if(null!=(i=t.__r3f)&&i.attach)gy(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"}),e.dispatchEvent({type:"childadded",child:t});let i=e.children.filter(e=>e!==t),a=i.indexOf(r);e.children=[...i.slice(0,a),t,...i.slice(a)],n=!0}n||null==(a=e.__r3f)||a.objects.push(t),t.__r3f||gf(t,{}),t.__r3f.parent=e,gT(t),gS(t)}}function a(e,t,r=!1){e&&[...e].forEach(e=>o(t,e,r))}function o(e,t,r){if(t){var n,i,o,s,l;t.__r3f&&(t.__r3f.parent=null),null!=(n=e.__r3f)&&n.objects&&(e.__r3f.objects=e.__r3f.objects.filter(e=>e!==t)),null!=(i=t.__r3f)&&i.attach?gv(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.remove(t),null!=(s=t.__r3f)&&s.root&&gM(gu(t),t));let c=null==(o=t.__r3f)?void 0:o.primitive,u=!c&&(void 0===r?null!==t.dispose:r);if(c||(a(null==(l=t.__r3f)?void 0:l.objects,t,u),a(t.children,t,u)),delete t.__r3f,u&&t.dispose&&"Scene"!==t.type){let e=()=>{try{t.dispose()}catch(e){}};"undefined"==typeof IS_REACT_ACT_ENVIRONMENT?(0,m2.unstable_scheduleCallback)(m2.unstable_IdlePriority,e):e()}gS(e)}}function s(e,t,i,a){var s;let l=null==(s=e.__r3f)?void 0:s.parent;if(!l)return;let c=r(t,i,e.__r3f.root);if(e.children){for(let t of e.children)t.__r3f&&n(c,t);e.children=e.children.filter(e=>!e.__r3f)}e.__r3f.objects.forEach(e=>n(c,e)),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||o(l,e),c.parent&&(c.__r3f.autoRemovedBeforeAppend=!0),n(l,c),c.raycast&&c.__r3f.eventCount&&gu(c).getState().internal.interaction.push(c),[a,a.alternate].forEach(e=>{null!==e&&(e.stateNode=c,e.ref&&("function"==typeof e.ref?e.ref(c):e.ref.current=c))})}let l=()=>{};return{reconciler:m1()({createInstance:r,removeChild:o,appendChild:n,appendInitialChild:n,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;let r=e.getState().scene;r.__r3f&&(r.__r3f.root=e,n(r,t))},removeChildFromContainer:(e,t)=>{t&&o(e.getState().scene,t)},insertInContainerBefore:(e,t,r)=>{if(!t||!r)return;let n=e.getState().scene;n.__r3f&&i(n,t,r)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;return!!(null!=(t=null==e?void 0:e.__r3f)?t:{}).handlers},prepareUpdate(e,t,r,n){var i;if((null!=(i=null==e?void 0:e.__r3f)?i:{}).primitive&&n.object&&n.object!==e)return[!0];{let{args:t=[],children:i,...a}=n,{args:o=[],children:s,...l}=r;if(!Array.isArray(t))throw Error("R3F: the args prop must be an array!");if(t.some((e,t)=>e!==o[t]))return[!0];let c=gb(e,a,l,!0);return c.changes.length?[!1,c]:null}},commitUpdate(e,[t,r],n,i,a,o){t?s(e,n,a,o):gw(e,r)},commitMount(e,t,r,n){var i;let a=null!=(i=e.__r3f)?i:{};e.raycast&&a.handlers&&a.eventCount&&gu(e).getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>gf(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;let{attach:r,parent:n}=null!=(t=e.__r3f)?t:{};r&&n&&gv(n,e,r),e.isObject3D&&(e.visible=!1),gS(e)},unhideInstance(e,t){var r;let{attach:n,parent:i}=null!=(r=e.__r3f)?r:{};n&&i&&gy(i,e,n),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),gS(e)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>t?t():mG.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:"undefined"!=typeof performance&&gd.fun(performance.now)?performance.now:gd.fun(Date.now)?Date.now:()=>0,scheduleTimeout:gd.fun(setTimeout)?setTimeout:void 0,cancelTimeout:gd.fun(clearTimeout)?clearTimeout:void 0}),applyProps:gw}}let m8=e=>"colorSpace"in e||"outputColorSpace"in e,m7=()=>{var e;return null!=(e=m4.ColorManagement)?e:null},m9=e=>e&&e.isOrthographicCamera,ge=e=>e&&e.hasOwnProperty("current"),gt="undefined"!=typeof window&&(null!=(h=window.document)&&h.createElement||(null==(p=window.navigator)?void 0:p.product)==="ReactNative")?v.useLayoutEffect:v.useEffect;function gr(e){let t=v.useRef(e);return gt(()=>void(t.current=e),[e]),t}function gn({set:e}){return gt(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class gi extends v.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}gi.getDerivedStateFromError=()=>({error:!0});let ga="__default",go=new Map,gs=e=>e&&!!e.memoized&&!!e.changes;function gl(e){var t;let r="undefined"!=typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],r),e[1]):e}let gc=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()};function gu(e){let t=e.__r3f.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}let gd={obj:e=>e===Object(e)&&!gd.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t,{arrays:r="shallow",objects:n="reference",strict:i=!0}={}){let a;if(typeof e!=typeof t||!!e!=!!t)return!1;if(gd.str(e)||gd.num(e)||gd.boo(e))return e===t;let o=gd.obj(e);if(o&&"reference"===n)return e===t;let s=gd.arr(e);if(s&&"reference"===r)return e===t;if((s||o)&&e===t)return!0;for(a in e)if(!(a in t))return!1;if(o&&"shallow"===r&&"shallow"===n){for(a in i?t:e)if(!gd.equ(e[a],t[a],{strict:i,objects:"reference"}))return!1}else for(a in i?t:e)if(e[a]!==t[a])return!1;if(gd.und(a)){if(s&&0===e.length&&0===t.length||o&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function gh(e){let t={nodes:{},materials:{}};return e&&e.traverse(e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)}),t}function gp(e){for(let t in e.dispose&&"Scene"!==e.type&&e.dispose(),e)null==t.dispose||t.dispose(),delete e[t]}function gf(e,t){return e.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function gm(e,t){let r=e;if(!t.includes("-"))return{target:r,key:t};{let n=t.split("-"),i=n.pop();return{target:r=n.reduce((e,t)=>e[t],e),key:i}}}let gg=/-\d+$/;function gy(e,t,r){if(gd.str(r)){if(gg.test(r)){let{target:t,key:n}=gm(e,r.replace(gg,""));Array.isArray(t[n])||(t[n]=[])}let{target:n,key:i}=gm(e,r);t.__r3f.previousAttach=n[i],n[i]=t}else t.__r3f.previousAttach=r(e,t)}function gv(e,t,r){var n,i;if(gd.str(r)){let{target:n,key:i}=gm(e,r),a=t.__r3f.previousAttach;void 0===a?delete n[i]:n[i]=a}else null==(n=t.__r3f)||null==n.previousAttach||n.previousAttach(e,t);null==(i=t.__r3f)||delete i.previousAttach}function gb(e,{children:t,key:r,ref:n,...i},{children:a,key:o,ref:s,...l}={},c=!1){let u=e.__r3f,d=Object.entries(i),h=[];if(c){let e=Object.keys(l);for(let t=0;t<e.length;t++)i.hasOwnProperty(e[t])||d.unshift([e[t],ga+"remove"])}d.forEach(([t,r])=>{var n;if(null!=(n=e.__r3f)&&n.primitive&&"object"===t||gd.equ(r,l[t]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(t))return h.push([t,r,!0,[]]);let a=[];for(let e in t.includes("-")&&(a=t.split("-")),h.push([t,r,!1,a]),i){let r=i[e];e.startsWith(`${t}-`)&&h.push([e,r,!1,e.split("-")])}});let p={...i};return null!=u&&u.memoizedProps&&null!=u&&u.memoizedProps.args&&(p.args=u.memoizedProps.args),null!=u&&u.memoizedProps&&null!=u&&u.memoizedProps.attach&&(p.attach=u.memoizedProps.attach),{memoized:p,changes:h}}let g_=void 0!==m3&&!1;function gw(e,t){var r,n,i;let a=e.__r3f,o=null==a?void 0:a.root,s=null==o?void 0:null==o.getState?void 0:o.getState(),{memoized:l,changes:c}=gs(t)?t:gb(e,t),u=null==a?void 0:a.eventCount;e.__r3f&&(e.__r3f.memoizedProps=l);for(let t=0;t<c.length;t++){let[r,o,l,u]=c[t];if(m8(e)){let e=3001,t="srgb",n="srgb-linear";"encoding"===r?(r="colorSpace",o=o===e?t:n):"outputEncoding"===r&&(r="outputColorSpace",o=o===e?t:n)}let d=e,h=d[r];if(u.length&&!((h=u.reduce((e,t)=>e[t],e))&&h.set)){let[t,...n]=u.reverse();d=n.reverse().reduce((e,t)=>e[t],e),r=t}if(o===ga+"remove"){if(d.constructor){let e=go.get(d.constructor);e||(e=new d.constructor,go.set(d.constructor,e)),o=e[r]}else o=0}if(l&&a)o?a.handlers[r]=o:delete a.handlers[r],a.eventCount=Object.keys(a.handlers).length;else if(h&&h.set&&(h.copy||h instanceof a3)){if(Array.isArray(o))h.fromArray?h.fromArray(o):h.set(...o);else if(h.copy&&o&&o.constructor&&(g_?h.constructor.name===o.constructor.name:h.constructor===o.constructor))h.copy(o);else if(void 0!==o){let e=null==(n=h)?void 0:n.isColor;!e&&h.setScalar?h.setScalar(o):h instanceof a3&&o instanceof a3?h.mask=o.mask:h.set(o),!m7()&&s&&!s.linear&&e&&h.convertSRGBToLinear()}}else if(d[r]=o,null!=(i=d[r])&&i.isTexture&&d[r].format===r$&&d[r].type===rL&&s){let e=d[r];m8(e)&&m8(s.gl)?e.colorSpace=s.gl.outputColorSpace:e.encoding=s.gl.outputEncoding}gS(e)}if(a&&a.parent&&e.raycast&&u!==a.eventCount){let t=gu(e).getState().internal,r=t.interaction.indexOf(e);r>-1&&t.interaction.splice(r,1),a.eventCount&&t.interaction.push(e)}return!(1===c.length&&"onUpdate"===c[0][0])&&c.length&&null!=(r=e.__r3f)&&r.parent&&gT(e),e}function gS(e){var t,r;let n=null==(t=e.__r3f)?void 0:null==(r=t.root)?void 0:null==r.getState?void 0:r.getState();n&&0===n.internal.frames&&n.invalidate()}function gT(e){null==e.onUpdate||e.onUpdate(e)}function gx(e,t){e.manual||(m9(e)?(e.left=-(t.width/2),e.right=t.width/2,e.top=t.height/2,e.bottom=-(t.height/2)):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function gE(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function gC(){var e;let t="undefined"!=typeof self&&self||"undefined"!=typeof window&&window;if(!t)return mG.DefaultEventPriority;switch(null==(e=t.event)?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return mG.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return mG.ContinuousEventPriority;default:return mG.DefaultEventPriority}}function gA(e,t,r,n){let i=r.get(t);i&&(r.delete(t),0===r.size&&(e.delete(n),i.target.releasePointerCapture(n)))}function gM(e,t){let{internal:r}=e.getState();r.interaction=r.interaction.filter(e=>e!==t),r.initialHits=r.initialHits.filter(e=>e!==t),r.hovered.forEach((e,n)=>{(e.eventObject===t||e.object===t)&&r.hovered.delete(n)}),r.capturedMap.forEach((e,n)=>{gA(r.capturedMap,t,e,n)})}function gI(e){function t(t){let{internal:r}=e.getState(),n=t.offsetX-r.initialClick[0],i=t.offsetY-r.initialClick[1];return Math.round(Math.sqrt(n*n+i*i))}function r(e){return e.filter(e=>["Move","Over","Enter","Out","Leave"].some(t=>{var r;return null==(r=e.__r3f)?void 0:r.handlers["onPointer"+t]}))}function n(t,r){let n=e.getState(),i=new Set,a=[],o=r?r(n.internal.interaction):n.internal.interaction;for(let e=0;e<o.length;e++){let t=gc(o[e]);t&&(t.raycaster.camera=void 0)}function s(e){let r=gc(e);if(!r||!r.events.enabled||null===r.raycaster.camera)return[];if(void 0===r.raycaster.camera){var n;null==r.events.compute||r.events.compute(t,r,null==(n=r.previousRoot)?void 0:n.getState()),void 0===r.raycaster.camera&&(r.raycaster.camera=null)}return r.raycaster.camera?r.raycaster.intersectObject(e,!0):[]}n.previousRoot||null==n.events.compute||n.events.compute(t,n);let l=o.flatMap(s).sort((e,t)=>{let r=gc(e.object),n=gc(t.object);return r&&n&&n.events.priority-r.events.priority||e.distance-t.distance}).filter(e=>{let t=gE(e);return!i.has(t)&&(i.add(t),!0)});for(let e of(n.events.filter&&(l=n.events.filter(l,n)),l)){let t=e.object;for(;t;){var c;null!=(c=t.__r3f)&&c.eventCount&&a.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&n.internal.capturedMap.has(t.pointerId))for(let e of n.internal.capturedMap.get(t.pointerId).values())i.has(gE(e.intersection))||a.push(e.intersection);return a}function i(t,r,n,i){let o=e.getState();if(t.length){let e={stopped:!1};for(let s of t){let{raycaster:l,pointer:c,camera:u,internal:d}=gc(s.object)||o,h=new ag(c.x,c.y,0).unproject(u),p=e=>{var t,r;return null!=(t=null==(r=d.capturedMap.get(e))?void 0:r.has(s.eventObject))&&t},f=e=>{let t={intersection:s,target:r.target};d.capturedMap.has(e)?d.capturedMap.get(e).set(s.eventObject,t):d.capturedMap.set(e,new Map([[s.eventObject,t]])),r.target.setPointerCapture(e)},m=e=>{let t=d.capturedMap.get(e);t&&gA(d.capturedMap,s.eventObject,t,e)},g={};for(let e in r){let t=r[e];"function"!=typeof t&&(g[e]=t)}let y={...s,...g,pointer:c,intersections:t,stopped:e.stopped,delta:n,unprojectedPoint:h,ray:l.ray,camera:u,stopPropagation(){let n="pointerId"in r&&d.capturedMap.get(r.pointerId);(!n||n.has(s.eventObject))&&(y.stopped=e.stopped=!0,d.hovered.size&&Array.from(d.hovered.values()).find(e=>e.eventObject===s.eventObject)&&a([...t.slice(0,t.indexOf(s)),s]))},target:{hasPointerCapture:p,setPointerCapture:f,releasePointerCapture:m},currentTarget:{hasPointerCapture:p,setPointerCapture:f,releasePointerCapture:m},nativeEvent:r};if(i(y),!0===e.stopped)break}}return t}function a(t){let{internal:r}=e.getState();for(let e of r.hovered.values())if(!t.length||!t.find(t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId)){let n=e.eventObject.__r3f,i=null==n?void 0:n.handlers;if(r.hovered.delete(gE(e)),null!=n&&n.eventCount){let r={...e,intersections:t};null==i.onPointerOut||i.onPointerOut(r),null==i.onPointerLeave||i.onPointerLeave(r)}}}function o(e,t){for(let r=0;r<t.length;r++){let n=t[r].__r3f;null==n||null==n.handlers.onPointerMissed||n.handlers.onPointerMissed(e)}}return{handlePointer:function(s){switch(s){case"onPointerLeave":case"onPointerCancel":return()=>a([]);case"onLostPointerCapture":return t=>{let{internal:r}=e.getState();"pointerId"in t&&r.capturedMap.has(t.pointerId)&&requestAnimationFrame(()=>{r.capturedMap.has(t.pointerId)&&(r.capturedMap.delete(t.pointerId),a([]))})}}return function(l){let{onPointerMissed:c,internal:u}=e.getState();u.lastEvent.current=l;let d="onPointerMove"===s,h="onClick"===s||"onContextMenu"===s||"onDoubleClick"===s,p=n(l,d?r:void 0),f=h?t(l):0;function m(e){let t=e.eventObject,r=t.__r3f,n=null==r?void 0:r.handlers;if(null!=r&&r.eventCount){if(d){if(n.onPointerOver||n.onPointerEnter||n.onPointerOut||n.onPointerLeave){let t=gE(e),r=u.hovered.get(t);r?r.stopped&&e.stopPropagation():(u.hovered.set(t,e),null==n.onPointerOver||n.onPointerOver(e),null==n.onPointerEnter||n.onPointerEnter(e))}null==n.onPointerMove||n.onPointerMove(e)}else{let r=n[s];r?(!h||u.initialHits.includes(t))&&(o(l,u.interaction.filter(e=>!u.initialHits.includes(e))),r(e)):h&&u.initialHits.includes(t)&&o(l,u.interaction.filter(e=>!u.initialHits.includes(e)))}}}"onPointerDown"===s&&(u.initialClick=[l.offsetX,l.offsetY],u.initialHits=p.map(e=>e.eventObject)),h&&!p.length&&f<=2&&(o(l,u.interaction),c&&c(l)),d&&a(p),i(p,l,f,m)}}}}let gR=e=>!!(null!=e&&e.render),gk=v.createContext(null),gP=(e,t)=>{let r=mW((r,n)=>{let i;let a=new ag,o=new ag,s=new ag;function l(e=n().camera,t=o,r=n().size){let{width:i,height:l,top:c,left:u}=r,d=i/l;t.isVector3?s.copy(t):s.set(...t);let h=e.getWorldPosition(a).distanceTo(s);if(m9(e))return{width:i/e.zoom,height:l/e.zoom,top:c,left:u,factor:1,distance:h,aspect:d};{let t=2*Math.tan(e.fov*Math.PI/180/2)*h,r=i/l*t;return{width:r,height:t,top:c,left:u,factor:i/r,distance:h,aspect:d}}}let c=e=>r(t=>({performance:{...t.performance,current:e}})),u=new iX;return{set:r,get:n,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(t=1)=>e(n(),t),advance:(e,r)=>t(e,r,n()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new fk,pointer:u,mouse:u,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{let e=n();i&&clearTimeout(i),e.performance.current!==e.performance.min&&c(e.performance.min),i=setTimeout(()=>c(n().performance.max),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:e=>r(t=>({...t,events:{...t.events,...e}})),setSize:(e,t,i,a,s)=>{let c=n().camera,u={width:e,height:t,top:a||0,left:s||0,updateStyle:i};r(e=>({size:u,viewport:{...e.viewport,...l(c,o,u)}}))},setDpr:e=>r(t=>{let r=gl(e);return{viewport:{...t.viewport,dpr:r,initialDpr:t.viewport.initialDpr||r}}}),setFrameloop:(e="always")=>{let t=n().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),r(()=>({frameloop:e}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:v.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,r)=>{let i=n().internal;return i.priority=i.priority+(t>0?1:0),i.subscribers.push({ref:e,priority:t,store:r}),i.subscribers=i.subscribers.sort((e,t)=>e.priority-t.priority),()=>{let r=n().internal;null!=r&&r.subscribers&&(r.priority=r.priority-(t>0?1:0),r.subscribers=r.subscribers.filter(t=>t.ref!==e))}}}}}),n=r.getState(),i=n.size,a=n.viewport.dpr,o=n.camera;return r.subscribe(()=>{let{camera:e,size:t,viewport:n,gl:s,set:l}=r.getState();if(t.width!==i.width||t.height!==i.height||n.dpr!==a){var c;i=t,a=n.dpr,gx(e,t),s.setPixelRatio(n.dpr);let r=null!=(c=t.updateStyle)?c:"undefined"!=typeof HTMLCanvasElement&&s.domElement instanceof HTMLCanvasElement;s.setSize(t.width,t.height,r)}e!==o&&(o=e,l(t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}})))}),r.subscribe(t=>e(t)),r},gO=new Set,gN=new Set,gL=new Set;function gD(e,t){if(e.size)for(let{callback:r}of e.values())r(t)}function gU(e,t){switch(e){case"before":return gD(gO,t);case"after":return gD(gN,t);case"tail":return gD(gL,t)}}function gF(e,t,r){let n=t.clock.getDelta();for("never"===t.frameloop&&"number"==typeof e&&(n=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),u=t.internal.subscribers,c=0;c<u.length;c++)(d=u[c]).ref.current(d.store.getState(),n,r);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function gB(e){let t,r,n,i=!1,a=!1;function o(s){for(let c of(r=requestAnimationFrame(o),i=!0,t=0,gU("before",s),a=!0,e.values())){var l;(n=c.store.getState()).internal.active&&("always"===n.frameloop||n.internal.frames>0)&&!(null!=(l=n.gl.xr)&&l.isPresenting)&&(t+=gF(s,n))}if(a=!1,gU("after",s),0===t)return gU("tail",s),i=!1,cancelAnimationFrame(r)}function s(t,r=1){var n;if(!t)return e.forEach(e=>s(e.store.getState(),r));null!=(n=t.gl.xr)&&n.isPresenting||!t.internal.active||"never"===t.frameloop||(r>1?t.internal.frames=Math.min(60,t.internal.frames+r):a?t.internal.frames=2:t.internal.frames=1,i||(i=!0,requestAnimationFrame(o)))}return{loop:o,invalidate:s,advance:function(t,r=!0,n,i){if(r&&gU("before",t),n)gF(t,n,i);else for(let r of e.values())gF(t,r.store.getState());r&&gU("after",t)}}}function gz(){let e=v.useContext(gk);if(!e)throw Error("R3F: Hooks can only be used within the Canvas component!");return e}function gH(e,t=0){let r=gz(),n=r.getState().internal.subscribe,i=gr(e);return gt(()=>n(i,t,r),[t,n,r]),null}let gj=new WeakMap;function gG(e,t){return function(r,...n){let i=gj.get(r);return i||(i=new r,gj.set(r,i)),e&&e(i),Promise.all(n.map(e=>new Promise((r,n)=>i.load(e,e=>{e.scene&&Object.assign(e,gh(e.scene)),r(e)},t,t=>n(Error(`Could not load ${e}: ${null==t?void 0:t.message}`))))))}}function gV(e,t,r,n){let i=Array.isArray(t)?t:[t],a=mY(gG(r,n),[e,...i],{equal:gd.equ});return Array.isArray(t)?a:a[0]}gV.preload=function(e,t,r){let n=Array.isArray(t)?t:[t];return mQ(gG(r),[e,...n])},gV.clear=function(e,t){return mJ([e,...Array.isArray(t)?t:[t]])};let gq=new Map,{invalidate:gW,advance:gZ}=gB(gq),{reconciler:gX,applyProps:g$}=m6(gq,gC),gK={objects:"shallow",strict:!1},gY=(e,t)=>{let r="function"==typeof e?e(t):e;return gR(r)?r:new ub({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function gQ(e,t){let r="undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement;if(t){let{width:e,height:n,top:i,left:a,updateStyle:o=r}=t;return{width:e,height:n,top:i,left:a,updateStyle:o}}if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){let{width:t,height:n,top:i,left:a}=e.parentElement.getBoundingClientRect();return{width:t,height:n,top:i,left:a,updateStyle:r}}return"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0,updateStyle:r}:{width:0,height:0,top:0,left:0}}function gJ(e){let t,r;let n=gq.get(e),i=null==n?void 0:n.fiber,a=null==n?void 0:n.store;n&&console.warn("R3F.createRoot should only be called once!");let o="function"==typeof reportError?reportError:console.error,s=a||gP(gW,gZ),l=i||gX.createContainer(s,mG.ConcurrentRoot,null,!1,null,"",o,null);n||gq.set(e,{fiber:l,store:s});let c=!1;return{configure(n={}){var i,a;let{gl:o,size:l,scene:u,events:d,onCreated:h,shadows:p=!1,linear:f=!1,flat:m=!1,legacy:g=!1,orthographic:y=!1,frameloop:v="always",dpr:b=[1,2],performance:_,raycaster:w,camera:S,onPointerMissed:T}=n,x=s.getState(),E=x.gl;x.gl||x.set({gl:E=gY(o,e)});let C=x.raycaster;C||x.set({raycaster:C=new mt});let{params:A,...M}=w||{};if(gd.equ(M,C,gK)||g$(C,{...M}),gd.equ(A,C.params,gK)||g$(C,{params:{...C.params,...A}}),!x.camera||x.camera===r&&!gd.equ(r,S,gK)){r=S;let e=S instanceof s_,t=e?S:y?new sQ(0,0,0,0,.1,1e3):new sx(75,0,.1,1e3);e||(t.position.z=5,S&&(g$(t,S),("aspect"in S||"left"in S||"right"in S||"bottom"in S||"top"in S)&&(t.manual=!0,t.updateProjectionMatrix())),x.camera||null!=S&&S.rotation||t.lookAt(0,0,0)),x.set({camera:t}),C.camera=t}if(!x.scene){let e;null!=u&&u.isScene?e=u:(e=new uS,u&&g$(e,u)),x.set({scene:gf(e)})}if(!x.xr){let e=(e,t)=>{let r=s.getState();"never"!==r.frameloop&&gZ(e,!0,r,t)},t=()=>{let t=s.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||gW(t)},r={connect(){let e=s.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){let e=s.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"==typeof(null==(i=E.xr)?void 0:i.addEventListener)&&r.connect(),x.set({xr:r})}if(E.shadowMap){let e=E.shadowMap.enabled,t=E.shadowMap.type;if(E.shadowMap.enabled=!!p,gd.boo(p))E.shadowMap.type=tM;else if(gd.str(p)){let e={basic:tC,percentage:tA,soft:tM,variance:tI};E.shadowMap.type=null!=(a=e[p])?a:tM}else gd.obj(p)&&Object.assign(E.shadowMap,p);(e!==E.shadowMap.enabled||t!==E.shadowMap.type)&&(E.shadowMap.needsUpdate=!0)}let I=m7();if(I&&("enabled"in I?I.enabled=!g:"legacyMode"in I&&(I.legacyMode=g)),!c){let e=3e3,t=3001;g$(E,{outputEncoding:f?e:t,toneMapping:m?ro:ru})}x.legacy!==g&&x.set(()=>({legacy:g})),x.linear!==f&&x.set(()=>({linear:f})),x.flat!==m&&x.set(()=>({flat:m})),!o||gd.fun(o)||gR(o)||gd.equ(o,E,gK)||g$(E,o),d&&!x.events.handlers&&x.set({events:d(s)});let R=gQ(e,l);return gd.equ(R,x.size,gK)||x.setSize(R.width,R.height,R.updateStyle,R.top,R.left),b&&x.viewport.dpr!==gl(b)&&x.setDpr(b),x.frameloop!==v&&x.setFrameloop(v),x.onPointerMissed||x.set({onPointerMissed:T}),_&&!gd.equ(_,x.performance,gK)&&x.set(e=>({performance:{...e.performance,..._}})),t=h,c=!0,this},render(r){return c||this.configure(),gX.updateContainer((0,D.jsx)(g0,{store:s,children:r,onCreated:t,rootElement:e}),l,null,()=>void 0),s},unmount(){g1(e)}}}function g0({store:e,children:t,onCreated:r,rootElement:n}){return gt(()=>{let t=e.getState();t.set(e=>({internal:{...e.internal,active:!0}})),r&&r(t),e.getState().events.connected||null==t.events.connect||t.events.connect(n)},[]),(0,D.jsx)(gk.Provider,{value:e,children:t})}function g1(e,t){let r=gq.get(e),n=null==r?void 0:r.fiber;if(n){let i=null==r?void 0:r.store.getState();i&&(i.internal.active=!1),gX.updateContainer(null,n,null,()=>{i&&setTimeout(()=>{try{var r,n,a,o;null==i.events.disconnect||i.events.disconnect(),null==(r=i.gl)||null==(n=r.renderLists)||null==n.dispose||n.dispose(),null==(a=i.gl)||null==a.forceContextLoss||a.forceContextLoss(),null!=(o=i.gl)&&o.xr&&i.xr.disconnect(),gp(i),gq.delete(e),t&&t(e)}catch(e){}},500)})}}gX.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:v.version}),v.unstable_act;let g2={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function g3(e){let{handlePointer:t}=gI(e);return{priority:1,enabled:!0,compute(e,t,r){t.pointer.set(e.offsetX/t.size.width*2-1,-(e.offsetY/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(g2).reduce((e,r)=>({...e,[r]:t(r)}),{}),update:()=>{var t;let{events:r,internal:n}=e.getState();null!=(t=n.lastEvent)&&t.current&&r.handlers&&r.handlers.onPointerMove(n.lastEvent.current)},connect:t=>{var r;let{set:n,events:i}=e.getState();null==i.disconnect||i.disconnect(),n(e=>({events:{...e.events,connected:t}})),Object.entries(null!=(r=i.handlers)?r:[]).forEach(([e,r])=>{let[n,i]=g2[e];t.addEventListener(n,r,{passive:i})})},disconnect:()=>{let{set:t,events:r}=e.getState();if(r.connected){var n;Object.entries(null!=(n=r.handlers)?n:[]).forEach(([e,t])=>{if(r&&r.connected instanceof HTMLElement){let[n]=g2[e];r.connected.removeEventListener(n,t)}}),t(e=>({events:{...e.events,connected:void 0}}))}}}}function g4(e,t){let r;return(...n)=>{window.clearTimeout(r),r=window.setTimeout(()=>e(...n),t)}}function g5({debounce:e,scroll:t,polyfill:r,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){let i=r||("undefined"==typeof window?class{}:window.ResizeObserver);if(!i)throw Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");let[a,o]=(0,v.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),s=(0,v.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a,orientationHandler:null}),l=e?"number"==typeof e?e:e.scroll:null,c=e?"number"==typeof e?e:e.resize:null,u=(0,v.useRef)(!1);(0,v.useEffect)(()=>(u.current=!0,()=>void(u.current=!1)));let[d,h,p]=(0,v.useMemo)(()=>{let e=()=>{if(!s.current.element)return;let{left:e,top:t,width:r,height:i,bottom:a,right:l,x:c,y:d}=s.current.element.getBoundingClientRect(),h={left:e,top:t,width:r,height:i,bottom:a,right:l,x:c,y:d};s.current.element instanceof HTMLElement&&n&&(h.height=s.current.element.offsetHeight,h.width=s.current.element.offsetWidth),Object.freeze(h),u.current&&!ye(s.current.lastBounds,h)&&o(s.current.lastBounds=h)};return[e,c?g4(e,c):e,l?g4(e,l):e]},[o,n,l,c]);function f(){s.current.scrollContainers&&(s.current.scrollContainers.forEach(e=>e.removeEventListener("scroll",p,!0)),s.current.scrollContainers=null),s.current.resizeObserver&&(s.current.resizeObserver.disconnect(),s.current.resizeObserver=null),s.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",s.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",s.current.orientationHandler))}function m(){s.current.element&&(s.current.resizeObserver=new i(p),s.current.resizeObserver.observe(s.current.element),t&&s.current.scrollContainers&&s.current.scrollContainers.forEach(e=>e.addEventListener("scroll",p,{capture:!0,passive:!0})),s.current.orientationHandler=()=>{p()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",s.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",s.current.orientationHandler))}let g=e=>{e&&e!==s.current.element&&(f(),s.current.element=e,s.current.scrollContainers=g7(e),m())};return g8(p,!!t),g6(h),(0,v.useEffect)(()=>{f(),m()},[t,p,h]),(0,v.useEffect)(()=>f,[]),[g,a,d]}function g6(e){(0,v.useEffect)(()=>{let t=e;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[e])}function g8(e,t){(0,v.useEffect)(()=>{if(t){let t=e;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[e,t])}function g7(e){let t=[];if(!e||e===document.body)return t;let{overflow:r,overflowX:n,overflowY:i}=window.getComputedStyle(e);return[r,n,i].some(e=>"auto"===e||"scroll"===e)&&t.push(e),[...t,...g7(e.parentElement)]}let g9=["x","y","top","bottom","left","right","width","height"],ye=(e,t)=>g9.every(r=>e[r]===t[r]);var yt=Object.defineProperty,yr=Object.defineProperties,yn=Object.getOwnPropertyDescriptors,yi=Object.getOwnPropertySymbols,ya=Object.prototype.hasOwnProperty,yo=Object.prototype.propertyIsEnumerable,ys=(e,t,r)=>t in e?yt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,yl=(e,t)=>{for(var r in t||(t={}))ya.call(t,r)&&ys(e,r,t[r]);if(yi)for(var r of yi(t))yo.call(t,r)&&ys(e,r,t[r]);return e},yc=(e,t)=>yr(e,yn(t));function yu(e,t,r){if(!e)return;if(!0===r(e))return e;let n=t?e.return:e.child;for(;n;){let e=yu(n,t,r);if(e)return e;n=t?null:n.sibling}}function yd(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(t){return e}}"undefined"!=typeof window&&((null==(f=window.document)?void 0:f.createElement)||(null==(m=window.navigator)?void 0:m.product)==="ReactNative")?v.useLayoutEffect:v.useEffect;let yh=console.error;console.error=function(){let e=[...arguments].join("");if((null==e?void 0:e.startsWith("Warning:"))&&e.includes("useContext")){console.error=yh;return}return yh.apply(this,arguments)};let yp=yd(v.createContext(null));class yf extends v.Component{render(){return v.createElement(yp.Provider,{value:this._reactInternals},this.props.children)}}function ym(){let e=v.useContext(yp);if(null===e)throw Error("its-fine: useFiber must be called within a <FiberProvider />!");let t=v.useId();return v.useMemo(()=>{for(let r of[e,null==e?void 0:e.alternate]){if(!r)continue;let e=yu(r,!1,e=>{let r=e.memoizedState;for(;r;){if(r.memoizedState===t)return!0;r=r.next}});if(e)return e}},[e,t])}function yg(){let e=ym(),[t]=v.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&"object"==typeof r.type){let e=void 0===r.type._context&&r.type.Provider===r.type?r.type:r.type._context;e&&e!==yp&&!t.has(e)&&t.set(e,v.useContext(yd(e)))}r=r.return}return t}function yy(){let e=yg();return v.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>v.createElement(t,null,v.createElement(r.Provider,yc(yl({},n),{value:e.get(r)}))),e=>v.createElement(yf,yl({},e))),[e])}let yv=v.forwardRef(function({children:e,fallback:t,resize:r,style:n,gl:i,events:a=g3,eventSource:o,eventPrefix:s,shadows:l,linear:c,flat:u,legacy:d,orthographic:h,frameloop:p,dpr:f,performance:m,raycaster:y,camera:b,scene:_,onPointerMissed:w,onCreated:S,...T},x){v.useMemo(()=>m5(g),[]);let E=yy(),[C,A]=g5({scroll:!0,debounce:{scroll:50,resize:0},...r}),M=v.useRef(null),I=v.useRef(null);v.useImperativeHandle(x,()=>M.current);let R=gr(w),[k,P]=v.useState(!1),[O,N]=v.useState(!1);if(k)throw k;if(O)throw O;let L=v.useRef(null);gt(()=>{let t=M.current;A.width>0&&A.height>0&&t&&(L.current||(L.current=gJ(t)),L.current.configure({gl:i,events:a,shadows:l,linear:c,flat:u,legacy:d,orthographic:h,frameloop:p,dpr:f,performance:m,raycaster:y,camera:b,scene:_,size:A,onPointerMissed:(...e)=>null==R.current?void 0:R.current(...e),onCreated:e=>{null==e.events.connect||e.events.connect(o?ge(o)?o.current:o:I.current),s&&e.setEvents({compute:(e,t)=>{let r=e[s+"X"],n=e[s+"Y"];t.pointer.set(r/t.size.width*2-1,-(n/t.size.height*2)+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==S||S(e)}}),L.current.render((0,D.jsx)(E,{children:(0,D.jsx)(gi,{set:N,children:(0,D.jsx)(v.Suspense,{fallback:(0,D.jsx)(gn,{set:P}),children:null!=e?e:null})})})))}),v.useEffect(()=>{let e=M.current;if(e)return()=>g1(e)},[]);let U=o?"none":"auto";return(0,D.jsx)("div",{ref:I,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:U,...n},...T,children:(0,D.jsx)("div",{ref:C,style:{width:"100%",height:"100%"},children:(0,D.jsx)("canvas",{ref:M,style:{display:"block"},children:t})})})}),yb=v.forwardRef(function(e,t){return(0,D.jsx)(yf,{children:(0,D.jsx)(yv,{...e,ref:t})})});m5({Line_:dP});let y_=e=>Math.round(Math.log(e/440)/Math.log(2)*12)+69,yw=()=>{let[e]=C(),[t]=(0,Q.fl)(),r=(0,v.useRef)(null),n=(0,v.useRef)(null),i=(0,v.useRef)(null),a=(0,v.useRef)(null),o=(0,v.useMemo)(()=>({time:0,particleStart:0,particleTail:0,currentPitch:440}),[]),s=22050,l=4096;(0,v.useEffect)(()=>{let t=e.frame;o.frame=t,o.time=t.timeSeconds;let r=Math.max(t.pitch0,t.pitch1);-1!==r&&(o.currentPitch=r)},[e.frame]);let c=(0,v.useMemo)(()=>new Float32Array(3*s),[]),u=(0,v.useMemo)(()=>new Float32Array(3*l),[]),d=(0,v.useMemo)(()=>new Float32Array(l),[]),h=(0,v.useMemo)(()=>new Float32Array(3*l),[]),p=(0,v.useMemo)(()=>new Float32Array(s),[]),f=(0,v.useMemo)(()=>new Float32Array(3*s),[]),m=(0,v.useMemo)(()=>{let e=e2.YI.primary.getArgb(t.scheme);return e2.OP.fromInt(e)},[t]);return gH((e,t)=>{let c,d,h,p;let f=e.clock.getElapsedTime();if(!r.current||!n.current||!i.current||!o.frame)return;let g=e.size,y=o.frame.sampleRate,v=~~((o.time-o.frame.timeSeconds)*y);o.time+=t;let b=~~(t*y),_=o.frame.samples0,w=o.frame.samples1,S=y_(o.currentPitch),T=e2.OP.from(S%12*30,m.chroma,80),x=e2.Ct.harmonize(T.toInt(),m.toInt()),E=r.current.geometry.attributes.position.array;n.current.geometry.attributes.position.array;let C=r.current.geometry.attributes.startTime.array,A=r.current.geometry.attributes.particleColor.array;for(let e=0;e<b;++e)p=o.particleTail,c=w[v+e],d=_[v+e+6],h=_[v+e+12]-w[v+e+12],E[3*p+0]=c,E[3*p+1]=d,E[3*p+2]=h,C[p]=f-t*(b-e)/b,A[3*p+0]=(x>>16&255)/255,A[3*p+1]=(x>>8&255)/255,A[3*p+2]=(255&x)/255,o.particleTail=(p+1)%s;let M=n.current.geometry.attributes.startTime.array,I=n.current.geometry.attributes.lineColor.array;for(let e=0;e<l;++e){let t=(o.particleTail-e+s)%s;u[3*e+0]=E[3*t+0],u[3*e+1]=E[3*t+1],u[3*e+2]=E[3*t+2],M[e]=C[t],I[3*e+0]=A[3*t+0],I[3*e+1]=A[3*t+1],I[3*e+2]=A[3*t+2]}r.current.geometry.attributes.position.needsUpdate=!0,r.current.geometry.attributes.startTime.needsUpdate=!0,r.current.geometry.attributes.particleColor.needsUpdate=!0,n.current.geometry.attributes.position.needsUpdate=!0,n.current.geometry.attributes.startTime.needsUpdate=!0,n.current.geometry.attributes.lineColor.needsUpdate=!0,i.current.uniforms.time.value=f,i.current.uniforms.aspect.value=g.width/g.height,a.current&&(a.current.uniforms.time.value=f,a.current.uniforms.aspect.value=g.width/g.height,a.current.uniforms.baseColor.value=new oE(16777215))}),(0,v.useMemo)(()=>(0,y.BX)(y.HY,{children:[(0,y.BX)("line_",{ref:n,children:[(0,y.BX)("bufferGeometry",{children:[(0,y.tZ)("bufferAttribute",{attach:"attributes-position",count:l,itemSize:3,array:u}),(0,y.tZ)("bufferAttribute",{attach:"attributes-startTime",count:l,itemSize:1,array:d}),(0,y.tZ)("bufferAttribute",{attach:"attributes-lineColor",count:l,itemSize:3,array:h})]}),(0,y.tZ)("shaderMaterial",{ref:a,attach:"material",args:[{uniforms:{time:{value:0},baseColor:{value:new oE(16777215)},aspect:{value:1}},vertexShader:"\n                  attribute float startTime;\n                  attribute vec3 lineColor;\n                  uniform float time;\n                  uniform float aspect;\n                  varying vec3 vColor;\n                  varying float vAlpha;\n\n                  void main() {\n                    vec3 p = position;\n                    float r = length(p.xy);\n                    \n                    // \n                    float elapsed = clamp((time - startTime) / (4096.0 / 22050.0), 0.0, 1.0);\n                    float alpha = 1.0;\n                    if (elapsed < 0.1) {\n                      alpha = mix(1.0, 0.6, smoothstep(0.0, 0.1, elapsed));\n                    } else if (elapsed <= 0.5) {\n                      alpha = mix(0.6, 0.4, smoothstep(0.1, 0.5, elapsed));\n                    } else {\n                      alpha = mix(0.4, 0.0, smoothstep(0.5, 1.0, elapsed)); \n                    }\n                    vAlpha = alpha * 0.2;\n                    \n                    // \n\n                    // gamma\n                    float scale = pow(r, 1.0 / 2.2) / r;\n\n                    // float noise = fract(sin(dot(p.xy, vec2(12.9898, 78.233))) * 43758.5453);\n                    // float edge = smoothstep(0.8, 1.2, r);\n                    // float noiseEffect = (noise - 0.5) * 0.4;\n                    // float scale = pow(r * (1.0 + edge * (0.3 + noiseEffect)), 1.0 / 2.2) / r;\n\n                    p.xy *= scale;\n                    \n                    // 45\n                    mat3 rotationMatrix = mat3(\n                      cos(0.785398), sin(0.785398), 0.0,\n                      -sin(0.785398), cos(0.785398), 0.0,\n                      0.0, 0.0, 1.0\n                    );\n                    p = rotationMatrix * p;\n                    \n                    // \n                    // p.x /= aspect;\n                    if (aspect < 1.0) {\n                      p.x /= aspect;\n                    }\n                    if (aspect > 1.4) {\n                      p.y *= aspect / 1.4;\n                    }\n                    \n                    // Z\n                    p.y += position.z * 1.0;\n                    p.y *= 0.6;\n                    p.x *= 0.8;\n                    p.z = 0.0;\n                    \n                    gl_Position = vec4(p, 1.0);\n                    vColor = lineColor;\n                  }\n                ",fragmentShader:"\n                  uniform vec3 baseColor;\n                  varying vec3 vColor;\n                  varying float vAlpha;\n                  \n                  void main() {\n                    gl_FragColor = vec4(vColor, vAlpha);\n                    return;\n                    // \n                    // gl_FragCoord\n                    // \n                    vec2 center = vec2(0.5, 0.5);\n                    vec2 normalizedCoord = gl_FragCoord.xy / vec2(1920.0, 1080.0); // \n                    float dist = length(normalizedCoord - center);\n                    \n                    // \n                    float vignette = smoothstep(0.3, 1.0, dist);\n                    \n                    // // \n                    // vec3 color = vColor * (1.0 - vignette * 0.7);\n                \n                    gl_FragColor = vec4(vColor, vAlpha * (pow(vignette, 1.0 / 2.2)));\n                  }\n                ",transparent:!0}]})]}),(0,y.BX)("points",{ref:r,children:[(0,y.BX)("bufferGeometry",{children:[(0,y.tZ)("bufferAttribute",{attach:"attributes-position",count:s,itemSize:3,array:c}),(0,y.tZ)("bufferAttribute",{attach:"attributes-startTime",count:s,itemSize:1,array:p}),(0,y.tZ)("bufferAttribute",{attach:"attributes-particleColor",count:s,itemSize:3,array:f})]}),(0,y.tZ)("shaderMaterial",{ref:i,attach:"material",args:[{uniforms:{time:{value:0},baseColor:{value:new oE(16777215)},aspect:{value:1}},vertexShader:"\n            attribute float startTime;\n            attribute vec3 particleColor;\n            uniform float time;\n            uniform float aspect;\n            varying float vAlpha;\n            varying vec3 vColor;\n\n            void main() {\n              float elapsed = clamp((time - startTime) / (22050.0 / 22050.0), 0.0, 1.0);\n              float effectScale = pow(1.0 - elapsed, 1.0 / 2.2);\n              // vAlpha = 0.5 - clamp(elapsed, 0.0, 0.5);\n              // elapsed = pow(elapsed, 1.0 / 2.2);\n              // vAlpha = effectScale / 2.0;\n              // vAlpha = effectScale;\n              float alpha = 1.0;\n\n              if (elapsed < 0.1) {\n                alpha = mix(1.0, 0.3, smoothstep(0.0, 0.1, elapsed));\n              } else if (elapsed <= 0.75) {\n                alpha = mix(0.3, 0.2, smoothstep(0.1, 0.75, elapsed));\n              } else {\n                alpha = mix(0.2, 0.0, smoothstep(0.75, 1.0, elapsed)); \n              }\n              vAlpha = alpha;\n              // vAlpha = 1.0 - pow(elapsed / 0.5, 3.0);\n              // vAlpha = 1.0 - smoothstep(0.0, 1.0, elapsed / 0.5);\n              // vAlpha *= 0.5;\n              mat3 rotationMatrix = mat3(\n                cos(0.785398), sin(0.785398), 0.0,\n                -sin(0.785398), cos(0.785398), 0.0,\n                0.0, 0.0, 1.0\n              );\n              vec3 p = position;\n              \n              float r = length(p.xy);\n              \n              // gamma\n              float scale = pow(r, 1.0 / 2.2) / r;\n\n              //  ()\n              //float randOffset = fract(sin(dot(p.xy, vec2(12.9898, 78.233))) * 43758.5453);\n              //float scale = pow(r + randOffset * 0.2, 1.0 / 2.2) / r;\n\n              //  float edge = smoothstep(0.9, 1.1, r);\n              //  float scale = pow(r * (1.0 + edge * 0.2), 1.0 / 2.2) / r;\n\n              // // \n              // float noise = fract(sin(dot(p.xy, vec2(12.9898, 78.233))) * 43758.5453);\n              // float edge = smoothstep(0.8, 1.2, r);  // \n              // float noiseEffect = (noise - 0.5) * 0.4;  // \n\n              // // \n              // float scale = pow(r * (1.0 + edge * (0.3 + noiseEffect)), 1.0 / 2.2) / r;\n\n              //float distortion = sin(r * 6.28318) * 0.1;\n              //float scale = pow(r + distortion, 1.0 / 2.2) / r;\n\n              // 1. \n              //float microNoise = sin(r * 40.0) * 0.02;\n              //float scale = pow(r + microNoise, 1.0 / 2.2) / r;\n\n              // 2. \n              // float ripple = smoothstep(0.8, 1.0, r) * sin(r * 20.0) * 0.03;\n              // float scale = pow(r + ripple, 1.0 / 2.2) / r;\n\n              // 3. \n              // float angle = atan(p.y, p.x);\n              //float directionalRipple = sin(angle * 12.0 + r * 30.0) * 0.02;\n              //float scale = pow(r + directionalRipple, 1.0 / 2.2) / r;\n              \n              //  ()\n              //float noise = fract(sin(dot(p.xy, vec2(15.4891, 89.453))) * 43758.5453);\n              //float scale = pow(r + noise * 0.3, 1.0 / 2.2) / r;\n\n              p.xy *= scale;\n\n              p = rotationMatrix * p;\n\n              // p.x /= aspect;\n              if (aspect < 1.0) {\n               p.x /= aspect;\n              }\n              if (aspect > 1.4) {\n               p.y *= aspect / 1.4;\n              }\n\n              float pointSize = 4.0;\n              if (r > 0.25) {\n                pointSize = 4.0 + mix(0.0, 4.0, smoothstep(0.25, 1.0, r));\n              }\n\n              // 1.   \n              //float noise = fract(sin(dot(p.xy, vec2(12.9898, 78.233))) * 43758.5453);\n              //float pointSize = 2.0 + noise * 2.0 + smoothstep(0.5, 1.0, r) * 2.0;\n\n              // 2.     \n              // float wave = sin(r * 10.0) * 0.5 + 0.5;\n              // float pointSize = 2.0 + wave * 3.0;\n\n              // \n              float flareNoise = fract(sin(dot(p.xy, vec2(12.9898, 78.233))) * 43758.5453);\n              if (r > 0.85 && flareNoise > 0.95) {\n                  // \n                  float flareIntensity = smoothstep(0.85, 1.0, r) * smoothstep(0.85, 1.0, flareNoise);\n                  \n                  pointSize = mix(pointSize, 32.0, flareIntensity);\n              }\n\n              float depth = pow((position.z + 1.0) / 2.0, 1.0 / 2.2); // 0 ~ 1\n              // pointSize = pointSize + (0.0 + depth * 10.0);\n              p.y += position.z * 1.0;\n              // p.y += 1.0;\n              p.y *= 0.6;\n              p.x *= 0.8;\n              p.z = 0.0;\n\n              gl_PointSize = pointSize / 2.0;\n              // gl_PointSize = pointSize;\n              gl_Position = vec4(p, 1.0);\n              vColor = particleColor;\n            }\n          ",fragmentShader:"\n            varying float vAlpha;\n            varying vec3 vColor;\n            uniform vec3 baseColor;\n            void main() {\n              vec2 center = vec2(0.5, 0.5);\n              vec2 coord = gl_PointCoord - center;\n              float dist = length(coord) * 2.0;\n              // \n              float alpha = step(dist, 0.95) * vAlpha;\n              // \n              // float alpha = smoothstep(0.95, 1.0, 1.0 - dist) * vAlpha;\n    \n              gl_FragColor = vec4(vColor, alpha);\n              // gl_FragColor = vec4(vColor, vAlpha);\n            }\n          ",transparent:!0,vertexColors:!0}]})]})]}),[s,c,p])},yS=()=>{let[e]=C(),[t]=(0,Q.fl)(),[r,n]=(0,v.useState)("transparent"),[i,a]=(0,v.useState)(!1),o=(0,v.useRef)(-1),{showCursor:s,containerRef:l}=tl(3e3);(0,v.useEffect)(()=>{let r=Math.max(e.frame.pitch0,e.frame.pitch1),i=Math.max(e.frame.rms0,e.frame.rms1);-1!==r&&(o.current=r);let a=o.current,s=i;if(-1===a)return;let l=e2.OP.fromInt(t.sourceColor),c=y_(a),u=Math.min(100*Math.pow(s,1/2.2),100),d=e2.OP.from(c%12*30,l.chroma,u),h=e2.Ct.harmonize(d.toInt(),l.toInt());n((0,e2.PQ)(h))},[e.frame,t.sourceColor]);let c=(()=>{let e=e2.OP.fromInt(t.sourceColor);return e.tone*=.5,e.chroma*=.5,(0,e2.PQ)(e.toInt())})(),u=(()=>{let e=e2.YI.background.getArgb(t.scheme);return(0,e2.PQ)(e)})(),[d,h]=ta();return(0,v.useEffect)(()=>{let e=e=>{a(!0)};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[]),(0,y.BX)("div",{children:[(0,y.tZ)("div",{css:(0,e3.iv)("position:fixed;transition:background-color 800ms;top:0;right:0;bottom:0;left:0;opacity:1;z-index:-3;background:radial-gradient(\n            circle at 76% 26%,transparent,",u,"          );"),style:{backgroundColor:r}}),(0,y.tZ)("div",{css:(0,e3.iv)("position:fixed;top:0;right:0;bottom:0;left:0;background:linear-gradient(transparent,",c,");opacity:1;z-index:-3;")}),(0,y.tZ)("div",{ref:l,css:(0,e3.iv)("position:fixed;top:0;right:0;bottom:0;left:0;z-index:",d.dynamicsEffectAppeal?0:-2,";display:",i?"none":"block",";background-color:",d.dynamicsEffectAppeal?"rgba(0, 0, 0, 0.6)":"transparent",";transition:background-color 0.5s ease-in-out;cursor:",s?"default":"none",";"),onClick:()=>{h.setDynamicsEffectAppeal(!1)},children:(0,y.tZ)(yb,{style:{pointerEvents:"none"},camera:{fov:90,position:[0,0,.5],near:.01},dpr:1,gl:e=>new ub({canvas:e,alpha:!0,powerPreference:"default"}),children:(0,y.tZ)(yw,{})})})]})};var yT=r(94013),yx=r(33109),yE=r(78242),yC=r(29896),yA=r(32820);function yM(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function yI(e,t,r){var n=[],i=(0,yA.fp)(e,n,r);return n.length<2?r:i+t(n)}var yR=function e(t){for(var r="",n=0;n<t.length;n++){var i=t[n];if(null!=i){var a=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))a=e(i);else for(var o in a="",i)i[o]&&o&&(a&&(a+=" "),a+=o);break;default:a=i}a&&(r&&(r+=" "),r+=a)}}return r},yk=function(e){var t=(0,yE.Z)(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var r=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=(0,yC.O)(r,t.registered,void 0);return(0,yA.My)(t,i,!1),t.key+"-"+i.name},n=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return yI(t.registered,r,yR(n))};return{css:r,cx:n,injectGlobal:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=(0,yC.O)(r,t.registered);yM(t,i)},keyframes:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=(0,yC.O)(r,t.registered),a="animation-"+i.name;return yM(t,{name:i.name,styles:"@keyframes "+a+"{"+i.styles+"}"}),a},hydrate:function(e){e.forEach(function(e){t.inserted[e]=!0})},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:yA.fp.bind(null,t.registered),merge:yI.bind(null,t.registered,r)}}({key:"css"}),yP=(yk.flush,yk.hydrate,yk.cx,yk.merge,yk.getRegisteredStyles,yk.injectGlobal,yk.keyframes,yk.css);yk.sheet,yk.cache;let yO=async e=>{if(!("serviceWorker"in navigator)||void 0===window.serwist)return;let t=await window.serwist.register();if(!t)return;let r=t=>{let r=()=>{let{waiting:e}=t;e&&(console.log("Sending SKIP_WAITING message to waiting clients"),e.postMessage({type:"SKIP_WAITING"}))};e.onNeedRefresh(r)};t.waiting&&r(t);let n=!1;t.addEventListener("updatefound",()=>{let{installing:e}=t;e&&e.addEventListener("statechange",()=>{t.waiting&&(navigator.serviceWorker.controller?r(t):n=!0)})});let i=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{if(n){n=!1;return}i||(window.location.reload(),i=!0)})},yN=(0,eP.ZP)(_.pk)(()=>{let[e]=(0,Q.fl)();e.sourceColor;let t=e2.YI.inverseSurface.getArgb(e.scheme),r=e2.YI.inverseOnSurface.getArgb(e.scheme),n=e2.YI.error.getHct(e.scheme),i=e2.OP.from(n.hue,10,20).toInt(),a=e2.OP.from(n.hue,10,80).toInt();return{"&.notistack-MuiContent-error":{backgroundColor:(0,e2.PQ)(i),color:(0,e2.PQ)(a)},"&.notistack-MuiContent-default":{backgroundColor:(0,e2.PQ)(t),color:(0,e2.PQ)(r)}}}),yL=(0,eP.ZP)(yT.Z)(()=>{let[e]=(0,Q.fl)(),t=e2.YI.inversePrimary.getArgb(e.scheme);return{color:(0,e2.PQ)(t)}}),yD=()=>{let[e]=(0,b.nP)(),[,t]=(0,Q.fl)();return(0,v.useEffect)(()=>{var r;if(!e.activeTrack||e.isActiveTrackLoading)return;let n=w.S5(null===(r=e.activeTrack.file.metadata)||void 0===r?void 0:r.common.picture);if(n){let e=new Blob([new Uint8Array(n.data)],{type:n.format});t.applyThemeFromImage(e)}else t.resetSourceColor()},[e.activeTrack,e.isActiveTrackLoading]),null},yU=e=>{let{children:t}=e,[r,n]=(0,v.useState)(!1),i=yP("margin-left:env(safe-area-inset-left,0);margin-bottom:calc(\n      env(safe-area-inset-bottom,0) + ",r?"0":"136","px\n    );"),[a]=ta();return(0,y.BX)(_.wT,{anchorOrigin:{vertical:"bottom",horizontal:"left"},classes:{containerAnchorOriginBottomLeft:i},Components:{success:yN,error:yN,default:yN},children:[(0,y.tZ)(yD,{}),(0,y.tZ)(yS,{}),(0,y.tZ)(N,{}),(0,y.BX)(G.Z,{component:"div",sx:{height:"100%",width:"100%",position:"absolute",zIndex:a.dynamicsEffectAppeal?-1:0,opacity:a.dynamicsEffectAppeal?.5:1,filter:a.dynamicsEffectAppeal?"blur(calc(1vmin + 5px))":"none",scale:a.dynamicsEffectAppeal?"0.9":"1",transition:"opacity 0.5s ease-in-out, scale 0.5s ease-in-out",overflow:"hidden"},children:[(0,y.tZ)(W.Z,{in:!r,unmountOnExit:!0,children:(0,y.tZ)(G.Z,{component:"div",sx:{height:"100%"},children:t})}),(0,y.tZ)(tg,{expand:r,onShrink:()=>{n(!1)},onExpand:()=>{n(!0)}})]})]})};function yF(e){let{children:t}=e;return(0,v.useEffect)(()=>{yO({onNeedRefresh:e=>{let t=t=>(0,y.tZ)(y.HY,{children:(0,y.tZ)(yL,{onClick:()=>{e(),(0,_.sy)(t)},children:"Reload"})});(0,_.yv)("A New Version is Available.",{action:t,persist:!0})}})},[]),(0,y.tZ)(tt.pG,{children:(0,y.tZ)(yx.Fx,{children:(0,y.tZ)(tv.m0,{children:(0,y.tZ)(b.Hc,{children:(0,y.tZ)(ts,{children:(0,y.tZ)(M,{children:(0,y.tZ)(yU,{children:t})})})})})})})}},78242:function(e,t,r){"use strict";r.d(t,{Z:function(){return eg}});var n=!1;function i(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function a(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var o=function(){function e(e){var t=this;this._insertTag=function(e){var r;r=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,r),t.tags.push(e)},this.isSpeedy=void 0===e.speedy?!n:e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(a(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var r=i(t);try{r.insertRule(e,r.cssRules.length)}catch(e){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach(function(e){var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),this.tags=[],this.ctr=0},e}(),s=Math.abs,l=String.fromCharCode,c=Object.assign;function u(e,t){return 45^m(e,0)?(((t<<2^m(e,0))<<2^m(e,1))<<2^m(e,2))<<2^m(e,3):0}function d(e){return e.trim()}function h(e,t){return(e=t.exec(e))?e[0]:e}function p(e,t,r){return e.replace(t,r)}function f(e,t){return e.indexOf(t)}function m(e,t){return 0|e.charCodeAt(t)}function g(e,t,r){return e.slice(t,r)}function y(e){return e.length}function v(e){return e.length}function b(e,t){return t.push(e),e}function _(e,t){return e.map(t).join("")}var w=1,S=1,T=0,x=0,E=0,C="";function A(e,t,r,n,i,a,o){return{value:e,root:t,parent:r,type:n,props:i,children:a,line:w,column:S,length:o,return:""}}function M(e,t){return c(A("",null,null,"",null,null,0),e,{length:-e.length},t)}function I(){return E}function R(){return E=x>0?m(C,--x):0,S--,10===E&&(S=1,w--),E}function k(){return E=x<T?m(C,x++):0,S++,10===E&&(S=1,w++),E}function P(){return m(C,x)}function O(){return x}function N(e,t){return g(C,e,t)}function L(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function D(e){return w=S=1,T=y(C=e),x=0,[]}function U(e){return C="",e}function F(e){return d(N(x-1,H(91===e?e+2:40===e?e+1:e)))}function B(e){for(;E=P();)if(E<33)k();else break;return L(e)>2||L(E)>3?"":" "}function z(e,t){for(;--t&&k()&&!(E<48)&&!(E>102)&&(!(E>57)||!(E<65))&&(!(E>70)||!(E<97)););return N(e,O()+(t<6&&32==P()&&32==k()))}function H(e){for(;k();)switch(E){case e:return x;case 34:case 39:34!==e&&39!==e&&H(E);break;case 40:41===e&&H(e);break;case 92:k()}return x}function j(e,t){for(;k();)if(e+E===57)break;else if(e+E===84&&47===P())break;return"/*"+N(t,x-1)+"*"+l(47===e?e:k())}function G(e){for(;!L(P());)k();return N(e,x)}var V="-ms-",q="-moz-",W="-webkit-",Z="comm",X="rule",$="decl",K="@import",Y="@keyframes",Q="@layer";function J(e,t){for(var r="",n=v(e),i=0;i<n;i++)r+=t(e[i],i,e,t)||"";return r}function ee(e,t,r,n){switch(e.type){case Q:if(e.children.length)break;case K:case $:return e.return=e.return||e.value;case Z:return"";case Y:return e.return=e.value+"{"+J(e.children,n)+"}";case X:e.value=e.props.join(",")}return y(r=J(e.children,n))?e.return=e.value+"{"+r+"}":""}function et(e){var t=v(e);return function(r,n,i,a){for(var o="",s=0;s<t;s++)o+=e[s](r,n,i,a)||"";return o}}function er(e){return function(t){!t.root&&(t=t.return)&&e(t)}}function en(e){return U(ei("",null,null,null,[""],e=D(e),0,[0],e))}function ei(e,t,r,n,i,a,o,s,c){for(var u=0,d=0,h=o,g=0,v=0,_=0,w=1,S=1,T=1,x=0,E="",C=i,A=a,M=n,I=E;S;)switch(_=x,x=k()){case 40:if(108!=_&&58==m(I,h-1)){-1!=f(I+=p(F(x),"&","&\f"),"&\f")&&(T=-1);break}case 34:case 39:case 91:I+=F(x);break;case 9:case 10:case 13:case 32:I+=B(_);break;case 92:I+=z(O()-1,7);continue;case 47:switch(P()){case 42:case 47:b(eo(j(k(),O()),t,r),c);break;default:I+="/"}break;case 123*w:s[u++]=y(I)*T;case 125*w:case 59:case 0:switch(x){case 0:case 125:S=0;case 59+d:-1==T&&(I=p(I,/\f/g,"")),v>0&&y(I)-h&&b(v>32?es(I+";",n,r,h-1):es(p(I," ","")+";",n,r,h-2),c);break;case 59:I+=";";default:if(b(M=ea(I,t,r,u,d,i,s,E,C=[],A=[],h),a),123===x){if(0===d)ei(I,t,M,M,C,a,h,s,A);else switch(99===g&&110===m(I,3)?100:g){case 100:case 108:case 109:case 115:ei(e,M,M,n&&b(ea(e,M,M,0,0,i,s,E,i,C=[],h),A),i,A,h,s,n?C:A);break;default:ei(I,M,M,M,[""],A,0,s,A)}}}u=d=v=0,w=T=1,E=I="",h=o;break;case 58:h=1+y(I),v=_;default:if(w<1){if(123==x)--w;else if(125==x&&0==w++&&125==R())continue}switch(I+=l(x),x*w){case 38:T=d>0?1:(I+="\f",-1);break;case 44:s[u++]=(y(I)-1)*T,T=1;break;case 64:45===P()&&(I+=F(k())),g=P(),d=h=y(E=I+=G(O())),x++;break;case 45:45===_&&2==y(I)&&(w=0)}}return a}function ea(e,t,r,n,i,a,o,l,c,u,h){for(var f=i-1,m=0===i?a:[""],y=v(m),b=0,_=0,w=0;b<n;++b)for(var S=0,T=g(e,f+1,f=s(_=o[b])),x=e;S<y;++S)(x=d(_>0?m[S]+" "+T:p(T,/&\f/g,m[S])))&&(c[w++]=x);return A(e,t,r,0===i?X:l,c,u,h)}function eo(e,t,r){return A(e,t,r,Z,l(I()),g(e,2,-2),0)}function es(e,t,r,n){return A(e,t,r,$,g(e,0,n),g(e,n+1,-1),n)}var el=function(e,t,r){for(var n=0,i=0;n=i,i=P(),38===n&&12===i&&(t[r]=1),!L(i);)k();return N(e,x)},ec=function(e,t){var r=-1,n=44;do switch(L(n)){case 0:38===n&&12===P()&&(t[r]=1),e[r]+=el(x-1,t,r);break;case 2:e[r]+=F(n);break;case 4:if(44===n){e[++r]=58===P()?"&\f":"",t[r]=e[r].length;break}default:e[r]+=l(n)}while(n=k());return e},eu=function(e,t){return U(ec(D(e),t))},ed=new WeakMap,eh=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,r=e.parent,n=e.column===r.column&&e.line===r.line;"rule"!==r.type;)if(!(r=r.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||ed.get(r))&&!n){ed.set(e,!0);for(var i=[],a=eu(t,i),o=r.props,s=0,l=0;s<a.length;s++)for(var c=0;c<o.length;c++,l++)e.props[l]=i[s]?a[s].replace(/&\f/g,o[c]):o[c]+" "+a[s]}}},ep=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}};function ef(e,t){switch(u(e,t)){case 5103:return W+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return W+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return W+e+q+e+V+e+e;case 6828:case 4268:return W+e+V+e+e;case 6165:return W+e+V+"flex-"+e+e;case 5187:return W+e+p(e,/(\w+).+(:[^]+)/,W+"box-$1$2"+V+"flex-$1$2")+e;case 5443:return W+e+V+"flex-item-"+p(e,/flex-|-self/,"")+e;case 4675:return W+e+V+"flex-line-pack"+p(e,/align-content|flex-|-self/,"")+e;case 5548:return W+e+V+p(e,"shrink","negative")+e;case 5292:return W+e+V+p(e,"basis","preferred-size")+e;case 6060:return W+"box-"+p(e,"-grow","")+W+e+V+p(e,"grow","positive")+e;case 4554:return W+p(e,/([^-])(transform)/g,"$1"+W+"$2")+e;case 6187:return p(p(p(e,/(zoom-|grab)/,W+"$1"),/(image-set)/,W+"$1"),e,"")+e;case 5495:case 3959:return p(e,/(image-set\([^]*)/,W+"$1$`$1");case 4968:return p(p(e,/(.+:)(flex-)?(.*)/,W+"box-pack:$3"+V+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+W+e+e;case 4095:case 3583:case 4068:case 2532:return p(e,/(.+)-inline(.+)/,W+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(y(e)-1-t>6)switch(m(e,t+1)){case 109:if(45!==m(e,t+4))break;case 102:return p(e,/(.+:)(.+)-([^]+)/,"$1"+W+"$2-$3$1"+q+(108==m(e,t+3)?"$3":"$2-$3"))+e;case 115:return~f(e,"stretch")?ef(p(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==m(e,t+1))break;case 6444:switch(m(e,y(e)-3-(~f(e,"!important")&&10))){case 107:return p(e,":",":"+W)+e;case 101:return p(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+W+(45===m(e,14)?"inline-":"")+"box$3$1"+W+"$2$3$1"+V+"$2box$3")+e}break;case 5936:switch(m(e,t+11)){case 114:return W+e+V+p(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return W+e+V+p(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return W+e+V+p(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return W+e+V+e+e}return e}var em=[function(e,t,r,n){if(e.length>-1&&!e.return)switch(e.type){case $:e.return=ef(e.value,e.length);break;case Y:return J([M(e,{value:p(e.value,"@","@"+W)})],n);case X:if(e.length)return _(e.props,function(t){switch(h(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return J([M(e,{props:[p(t,/:(read-\w+)/,":"+q+"$1")]})],n);case"::placeholder":return J([M(e,{props:[p(t,/:(plac\w+)/,":"+W+"input-$1")]}),M(e,{props:[p(t,/:(plac\w+)/,":"+q+"$1")]}),M(e,{props:[p(t,/:(plac\w+)/,V+"input-$1")]})],n)}return""})}}],eg=function(e){var t,r,n,i=e.key;if("css"===i){var a=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(a,function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))})}var s=e.stylisPlugins||em,l={},c=[];t=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+i+' "]'),function(e){for(var t=e.getAttribute("data-emotion").split(" "),r=1;r<t.length;r++)l[t[r]]=!0;c.push(e)});var u=et([eh,ep].concat(s,[ee,er(function(e){n.insert(e)})])),d=function(e){return J(en(e),u)};r=function(e,t,r,i){n=r,d(e?e+"{"+t.styles+"}":t.styles),i&&(h.inserted[t.name]=!0)};var h={key:i,sheet:new o({key:i,container:t,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:l,registered:{},insert:r};return h.sheet.hydrate(c),h}},5772:function(e,t,r){"use strict";function n(e){var t=Object.create(null);return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}}r.d(t,{Z:function(){return n}})},25246:function(e,t,r){"use strict";r.d(t,{C:function(){return u},E:function(){return y},T:function(){return h},c:function(){return m},h:function(){return p},w:function(){return d}});var n=r(2265),i=r(78242),a=r(32820),o=r(29896),s=r(24006),l=!1,c=n.createContext("undefined"!=typeof HTMLElement?(0,i.Z)({key:"css"}):null),u=c.Provider,d=function(e){return(0,n.forwardRef)(function(t,r){return e(t,(0,n.useContext)(c),r)})},h=n.createContext({}),p={}.hasOwnProperty,f="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",m=function(e,t){var r={};for(var n in t)p.call(t,n)&&(r[n]=t[n]);return r[f]=e,r},g=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;return(0,a.hC)(t,r,n),(0,s.L)(function(){return(0,a.My)(t,r,n)}),null},y=d(function(e,t,r){var i=e.css;"string"==typeof i&&void 0!==t.registered[i]&&(i=t.registered[i]);var s=e[f],c=[i],u="";"string"==typeof e.className?u=(0,a.fp)(t.registered,c,e.className):null!=e.className&&(u=e.className+" ");var d=(0,o.O)(c,void 0,n.useContext(h));u+=t.key+"-"+d.name;var m={};for(var y in e)p.call(e,y)&&"css"!==y&&y!==f&&!l&&(m[y]=e[y]);return m.className=u,r&&(m.ref=r),n.createElement(n.Fragment,null,n.createElement(g,{cache:t,serialized:d,isStringTag:"string"==typeof s}),n.createElement(s,m))})},3146:function(e,t,r){"use strict";r.d(t,{F4:function(){return d},iv:function(){return u},xB:function(){return c}});var n=r(25246),i=r(2265),a=r(32820),o=r(24006),s=r(29896);r(78242),r(63285);var l=function(e,t){var r=arguments;if(null==t||!n.h.call(t,"css"))return i.createElement.apply(void 0,r);var a=r.length,o=Array(a);o[0]=n.E,o[1]=(0,n.c)(e,t);for(var s=2;s<a;s++)o[s]=r[s];return i.createElement.apply(null,o)};!function(e){var t;t||(t=e.JSX||(e.JSX={}))}(l||(l={}));var c=(0,n.w)(function(e,t){var r=e.styles,l=(0,s.O)([r],void 0,i.useContext(n.T)),c=i.useRef();return(0,o.j)(function(){var e=t.key+"-global",r=new t.sheet.constructor({key:e,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),n=!1,i=document.querySelector('style[data-emotion="'+e+" "+l.name+'"]');return t.sheet.tags.length&&(r.before=t.sheet.tags[0]),null!==i&&(n=!0,i.setAttribute("data-emotion",e),r.hydrate([i])),c.current=[r,n],function(){r.flush()}},[t]),(0,o.j)(function(){var e=c.current,r=e[0];if(e[1]){e[1]=!1;return}if(void 0!==l.next&&(0,a.My)(t,l.next,!0),r.tags.length){var n=r.tags[r.tags.length-1].nextElementSibling;r.before=n,r.flush()}t.insert("",l,r,!1)},[t,l.name]),null});function u(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.O)(t)}function d(){var e=u.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}},81595:function(e,t,r){"use strict";r.d(t,{BX:function(){return s},HY:function(){return a},tZ:function(){return o}});var n=r(57437),i=r(25246);r(2265),r(78242),r(63285),r(29896),r(24006);var a=n.Fragment,o=function(e,t,r){return i.h.call(t,"css")?n.jsx(i.E,(0,i.c)(e,t),r):n.jsx(e,t,r)},s=function(e,t,r){return i.h.call(t,"css")?n.jsxs(i.E,(0,i.c)(e,t),r):n.jsxs(e,t,r)}},29896:function(e,t,r){"use strict";function n(e){for(var t,r=0,n=0,i=e.length;i>=4;++n,i-=4)t=(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))*1540483477+((t>>>16)*59797<<16),t^=t>>>24,r=(65535&t)*1540483477+((t>>>16)*59797<<16)^(65535&r)*1540483477+((r>>>16)*59797<<16);switch(i){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r^=255&e.charCodeAt(n),r=(65535&r)*1540483477+((r>>>16)*59797<<16)}return r^=r>>>13,(((r=(65535&r)*1540483477+((r>>>16)*59797<<16))^r>>>15)>>>0).toString(36)}r.d(t,{O:function(){return v}});var i,a={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},o=r(5772),s=!1,l=/[A-Z]|^ms/g,c=/_EMO_([^_]+?)_([^]*?)_EMO_/g,u=function(e){return 45===e.charCodeAt(1)},d=function(e){return null!=e&&"boolean"!=typeof e},h=(0,o.Z)(function(e){return u(e)?e:e.replace(l,"-$&").toLowerCase()}),p=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(c,function(e,t,r){return i={name:t,styles:r,next:i},t})}return 1===a[e]||u(e)||"number"!=typeof t||0===t?t:t+"px"},f="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function m(e,t,r){if(null==r)return"";var n=r;if(void 0!==n.__emotion_styles)return n;switch(typeof r){case"boolean":return"";case"object":var a=r;if(1===a.anim)return i={name:a.name,styles:a.styles,next:i},a.name;var o=r;if(void 0!==o.styles){var s=o.next;if(void 0!==s)for(;void 0!==s;)i={name:s.name,styles:s.styles,next:i},s=s.next;return o.styles+";"}return g(e,t,r);case"function":if(void 0!==e){var l=i,c=r(e);return i=l,m(e,t,c)}}var u=r;if(null==t)return u;var d=t[u];return void 0!==d?d:u}function g(e,t,r){var n="";if(Array.isArray(r))for(var i=0;i<r.length;i++)n+=m(e,t,r[i])+";";else for(var a in r){var o=r[a];if("object"!=typeof o){var l=o;null!=t&&void 0!==t[l]?n+=a+"{"+t[l]+"}":d(l)&&(n+=h(a)+":"+p(a,l)+";")}else{if("NO_COMPONENT_SELECTOR"===a&&s)throw Error(f);if(Array.isArray(o)&&"string"==typeof o[0]&&(null==t||void 0===t[o[0]]))for(var c=0;c<o.length;c++)d(o[c])&&(n+=h(a)+":"+p(a,o[c])+";");else{var u=m(e,t,o);switch(a){case"animation":case"animationName":n+=h(a)+":"+u+";";break;default:n+=a+"{"+u+"}"}}}}return n}var y=/label:\s*([^\s;{]+)\s*(;|$)/g;function v(e,t,r){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var a,o=!0,s="";i=void 0;var l=e[0];null==l||void 0===l.raw?(o=!1,s+=m(r,t,l)):s+=l[0];for(var c=1;c<e.length;c++)s+=m(r,t,e[c]),o&&(s+=l[c]);y.lastIndex=0;for(var u="";null!==(a=y.exec(s));)u+="-"+a[1];return{name:n(s)+u,styles:s,next:i}}},24006:function(e,t,r){"use strict";r.d(t,{L:function(){return s},j:function(){return l}});var n,i=r(2265),a=function(e){return e()},o=!!(n||(n=r.t(i,2))).useInsertionEffect&&(n||(n=r.t(i,2))).useInsertionEffect,s=o||a,l=o||i.useLayoutEffect},32820:function(e,t,r){"use strict";r.d(t,{My:function(){return o},fp:function(){return i},hC:function(){return a}});var n=!0;function i(e,t,r){var n="";return r.split(" ").forEach(function(r){void 0!==e[r]?t.push(e[r]+";"):r&&(n+=r+" ")}),n}var a=function(e,t,r){var i=e.key+"-"+t.name;(!1===r||!1===n)&&void 0===e.registered[i]&&(e.registered[i]=t.styles)},o=function(e,t,r){a(e,t,r);var n=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var i=t;do e.insert(t===i?"."+n:"",i,e.sheet,!0),i=i.next;while(void 0!==i)}}},78356:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var n=r(1119),i=r(2265),a=r(78242),o=r(25246),s=r(99376),l=r(57437);function c(e){let{options:t,CacheProvider:r=o.C,children:c}=e,[u]=i.useState(()=>{var e;let r=(0,a.Z)((0,n.Z)({},t,{key:null!=(e=null==t?void 0:t.key)?e:"mui"}));r.compat=!0;let i=r.insert,o=[];return r.insert=function(){for(var e=arguments.length,n=Array(e),a=0;a<e;a++)n[a]=arguments[a];null!=t&&t.enableCssLayer&&!n[1].styles.match(/^@layer\s+[^{]*$/)&&(n[1].styles="@layer mui {".concat(n[1].styles,"}"));let[s,l]=n;return void 0===r.inserted[l.name]&&o.push({name:l.name,isGlobal:!s}),i(...n)},{cache:r,flush:()=>{let e=o;return o=[],e}}});return(0,s.useServerInsertedHTML)(()=>{let e=u.flush();if(0===e.length)return null;let r="",n=u.cache.key,a=[];return e.forEach(e=>{let{name:t,isGlobal:i}=e,o=u.cache.inserted[t];"string"==typeof o&&(i?a.push({name:t,style:o}):(r+=o,n+=" ".concat(t)))}),(0,l.jsxs)(i.Fragment,{children:[a.map(e=>{let{name:r,style:n}=e;return(0,l.jsx)("style",{nonce:null==t?void 0:t.nonce,"data-emotion":"".concat(u.cache.key,"-global ").concat(r),dangerouslySetInnerHTML:{__html:n}},r)}),r&&(0,l.jsx)("style",{nonce:null==t?void 0:t.nonce,"data-emotion":n,dangerouslySetInnerHTML:{__html:r}})]})}),(0,l.jsx)(r,{value:u.cache,children:c})}},71495:function(e,t,r){"use strict";r.d(t,{Z:function(){return _}});var n=r(74610),i=r(1119),a=r(2265),o=r(61994),s=r(20801),l=r(16210),c=r(37053),u=r(85657),d=r(96207),h=r(94143),p=r(50738);function f(e){return(0,p.ZP)("MuiAppBar",e)}(0,h.Z)("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);var m=r(57437);let g=["className","color","enableColorOnDark","position"],y=e=>{let{color:t,position:r,classes:n}=e,i={root:["root","color".concat((0,u.Z)(t)),"position".concat((0,u.Z)(r))]};return(0,s.Z)(i,f,n)},v=(e,t)=>e?"".concat(null==e?void 0:e.replace(")",""),", ").concat(t,")"):t,b=(0,l.ZP)(d.Z,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t["position".concat((0,u.Z)(r.position))],t["color".concat((0,u.Z)(r.color))]]}})(e=>{let{theme:t,ownerState:r}=e,n="light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[900];return(0,i.Z)({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},"fixed"===r.position&&{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},"absolute"===r.position&&{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0},"sticky"===r.position&&{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0},"static"===r.position&&{position:"static"},"relative"===r.position&&{position:"relative"},!t.vars&&(0,i.Z)({},"default"===r.color&&{backgroundColor:n,color:t.palette.getContrastText(n)},r.color&&"default"!==r.color&&"inherit"!==r.color&&"transparent"!==r.color&&{backgroundColor:t.palette[r.color].main,color:t.palette[r.color].contrastText},"inherit"===r.color&&{color:"inherit"},"dark"===t.palette.mode&&!r.enableColorOnDark&&{backgroundColor:null,color:null},"transparent"===r.color&&(0,i.Z)({backgroundColor:"transparent",color:"inherit"},"dark"===t.palette.mode&&{backgroundImage:"none"})),t.vars&&(0,i.Z)({},"default"===r.color&&{"--AppBar-background":r.enableColorOnDark?t.vars.palette.AppBar.defaultBg:v(t.vars.palette.AppBar.darkBg,t.vars.palette.AppBar.defaultBg),"--AppBar-color":r.enableColorOnDark?t.vars.palette.text.primary:v(t.vars.palette.AppBar.darkColor,t.vars.palette.text.primary)},r.color&&!r.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":r.enableColorOnDark?t.vars.palette[r.color].main:v(t.vars.palette.AppBar.darkBg,t.vars.palette[r.color].main),"--AppBar-color":r.enableColorOnDark?t.vars.palette[r.color].contrastText:v(t.vars.palette.AppBar.darkColor,t.vars.palette[r.color].contrastText)},!["inherit","transparent"].includes(r.color)&&{backgroundColor:"var(--AppBar-background)"},{color:"inherit"===r.color?"inherit":"var(--AppBar-color)"},"transparent"===r.color&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))});var _=a.forwardRef(function(e,t){let r=(0,c.i)({props:e,name:"MuiAppBar"}),{className:a,color:s="primary",enableColorOnDark:l=!1,position:u="fixed"}=r,d=(0,n.Z)(r,g),h=(0,i.Z)({},r,{color:s,position:u,enableColorOnDark:l}),p=y(h);return(0,m.jsx)(b,(0,i.Z)({square:!0,component:"header",ownerState:h,elevation:4,className:(0,o.Z)(p.root,a,"fixed"===u&&"mui-fixed"),ref:t},d))})},32088:function(e,t,r){"use strict";r.d(t,{Z:function(){return R}});var n=r(74610),i=r(1119),a=r(2265),o=r(61994),s=r(20801),l=r(16210),c=r(37053),u=r(94630),d=r(57437),h=(0,u.Z)((0,d.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person"),p=r(94143),f=r(50738);function m(e){return(0,f.ZP)("MuiAvatar",e)}(0,p.Z)("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);var g=r(23947),y=r(4250),v=r(13366),b=r(73810);let _=["className","elementType","ownerState","externalForwardedProps","getSlotOwnerState","internalForwardedProps"],w=["component","slots","slotProps"],S=["component"];function T(e,t){let{className:r,elementType:a,ownerState:o,externalForwardedProps:s,getSlotOwnerState:l,internalForwardedProps:c}=t,u=(0,n.Z)(t,_),{component:d,slots:h={[e]:void 0},slotProps:p={[e]:void 0}}=s,f=(0,n.Z)(s,w),m=h[e]||a,T=(0,v.Z)(p[e],o),x=(0,b.Z)((0,i.Z)({className:r},u,{externalForwardedProps:"root"===e?f:void 0,externalSlotProps:T})),{props:{component:E},internalRef:C}=x,A=(0,n.Z)(x.props,S),M=(0,g.Z)(C,null==T?void 0:T.ref,t.ref),I=l?l(A):{},R=(0,i.Z)({},o,I),k="root"===e?E||d:E,P=(0,y.Z)(m,(0,i.Z)({},"root"===e&&!d&&!h[e]&&c,"root"!==e&&!h[e]&&c,A,k&&{as:k},{ref:M}),R);return Object.keys(I).forEach(e=>{delete P[e]}),[m,P]}let x=["alt","children","className","component","slots","slotProps","imgProps","sizes","src","srcSet","variant"],E=e=>{let{classes:t,variant:r,colorDefault:n}=e,i={root:["root",r,n&&"colorDefault"],img:["img"],fallback:["fallback"]};return(0,s.Z)(i,m,t)},C=(0,l.ZP)("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t[r.variant],r.colorDefault&&t.colorDefault]}})(e=>{let{theme:t}=e;return{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:(0,i.Z)({color:(t.vars||t).palette.background.default},t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:(0,i.Z)({backgroundColor:t.palette.grey[400]},t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})))}]}}),A=(0,l.ZP)("img",{name:"MuiAvatar",slot:"Img",overridesResolver:(e,t)=>t.img})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),M=(0,l.ZP)(h,{name:"MuiAvatar",slot:"Fallback",overridesResolver:(e,t)=>t.fallback})({width:"75%",height:"75%"});function I(e){let{crossOrigin:t,referrerPolicy:r,src:n,srcSet:i}=e,[o,s]=a.useState(!1);return a.useEffect(()=>{if(!n&&!i)return;s(!1);let e=!0,a=new Image;return a.onload=()=>{e&&s("loaded")},a.onerror=()=>{e&&s("error")},a.crossOrigin=t,a.referrerPolicy=r,a.src=n,i&&(a.srcset=i),()=>{e=!1}},[t,r,n,i]),o}var R=a.forwardRef(function(e,t){let r=(0,c.i)({props:e,name:"MuiAvatar"}),{alt:a,children:s,className:l,component:u="div",slots:h={},slotProps:p={},imgProps:f,sizes:m,src:g,srcSet:y,variant:v="circular"}=r,b=(0,n.Z)(r,x),_=null,w=I((0,i.Z)({},f,{src:g,srcSet:y})),S=g||y,R=S&&"error"!==w,k=(0,i.Z)({},r,{colorDefault:!R,component:u,variant:v}),P=E(k),[O,N]=T("img",{className:P.img,elementType:A,externalForwardedProps:{slots:h,slotProps:{img:(0,i.Z)({},f,p.img)}},additionalProps:{alt:a,src:g,srcSet:y,sizes:m},ownerState:k});return _=R?(0,d.jsx)(O,(0,i.Z)({},N)):s||0===s?s:S&&a?a[0]:(0,d.jsx)(M,{ownerState:k,className:P.fallback}),(0,d.jsx)(C,(0,i.Z)({as:u,ownerState:k,className:(0,o.Z)(P.root,l),ref:t},b,{children:_}))})},1899:function(e,t,r){"use strict";r.d(t,{Z:function(){return b}});var n=r(1119),i=r(74610),a=r(2265),o=r(61994),s=r(90702),l=r(38720),c=r(95086),u=r(12720),d=r(57437);let h=["className","component"];function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{themeId:t,defaultTheme:r,defaultClassName:p="MuiBox-root",generateClassName:f}=e,m=(0,s.default)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(l.Z);return a.forwardRef(function(e,a){let s=(0,u.Z)(r),l=(0,c.Z)(e),{className:g,component:y="div"}=l,v=(0,i.Z)(l,h);return(0,d.jsx)(m,(0,n.Z)({as:y,ref:a,className:(0,o.Z)(g,f?f(p):p),theme:t&&s[t]||s},v))})}var f=r(56063),m=r(66075),g=r(22166),y=(0,r(94143).Z)("MuiBox",["root"]);let v=(0,m.Z)();var b=p({themeId:g.Z,defaultTheme:v,defaultClassName:y.root,generateClassName:f.Z.generate})},94013:function(e,t,r){"use strict";r.d(t,{Z:function(){return M}});var n=r(74610),i=r(1119),a=r(2265),o=r(61994),s=r(53232),l=r(20801),c=r(14031),u=r(16210),d=r(34765),h=r(37053),p=r(19472),f=r(85657),m=r(94143),g=r(50738);function y(e){return(0,g.ZP)("MuiButton",e)}var v=(0,m.Z)("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),b=a.createContext({}),_=a.createContext(void 0),w=r(57437);let S=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],T=e=>{let{color:t,disableElevation:r,fullWidth:n,size:a,variant:o,classes:s}=e,c={root:["root",o,"".concat(o).concat((0,f.Z)(t)),"size".concat((0,f.Z)(a)),"".concat(o,"Size").concat((0,f.Z)(a)),"color".concat((0,f.Z)(t)),r&&"disableElevation",n&&"fullWidth"],label:["label"],startIcon:["icon","startIcon","iconSize".concat((0,f.Z)(a))],endIcon:["icon","endIcon","iconSize".concat((0,f.Z)(a))]},u=(0,l.Z)(c,y,s);return(0,i.Z)({},s,u)},x=e=>(0,i.Z)({},"small"===e.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===e.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===e.size&&{"& > *:nth-of-type(1)":{fontSize:22}}),E=(0,u.ZP)(p.Z,{shouldForwardProp:e=>(0,d.Z)(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t[r.variant],t["".concat(r.variant).concat((0,f.Z)(r.color))],t["size".concat((0,f.Z)(r.size))],t["".concat(r.variant,"Size").concat((0,f.Z)(r.size))],"inherit"===r.color&&t.colorInherit,r.disableElevation&&t.disableElevation,r.fullWidth&&t.fullWidth]}})(e=>{var t,r;let{theme:n,ownerState:a}=e,o="light"===n.palette.mode?n.palette.grey[300]:n.palette.grey[800],s="light"===n.palette.mode?n.palette.grey.A100:n.palette.grey[700];return(0,i.Z)({},n.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(n.vars||n).shape.borderRadius,transition:n.transitions.create(["background-color","box-shadow","border-color","color"],{duration:n.transitions.duration.short}),"&:hover":(0,i.Z)({textDecoration:"none",backgroundColor:n.vars?"rgba(".concat(n.vars.palette.text.primaryChannel," / ").concat(n.vars.palette.action.hoverOpacity,")"):(0,c.Fq)(n.palette.text.primary,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===a.variant&&"inherit"!==a.color&&{backgroundColor:n.vars?"rgba(".concat(n.vars.palette[a.color].mainChannel," / ").concat(n.vars.palette.action.hoverOpacity,")"):(0,c.Fq)(n.palette[a.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===a.variant&&"inherit"!==a.color&&{border:"1px solid ".concat((n.vars||n).palette[a.color].main),backgroundColor:n.vars?"rgba(".concat(n.vars.palette[a.color].mainChannel," / ").concat(n.vars.palette.action.hoverOpacity,")"):(0,c.Fq)(n.palette[a.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===a.variant&&{backgroundColor:n.vars?n.vars.palette.Button.inheritContainedHoverBg:s,boxShadow:(n.vars||n).shadows[4],"@media (hover: none)":{boxShadow:(n.vars||n).shadows[2],backgroundColor:(n.vars||n).palette.grey[300]}},"contained"===a.variant&&"inherit"!==a.color&&{backgroundColor:(n.vars||n).palette[a.color].dark,"@media (hover: none)":{backgroundColor:(n.vars||n).palette[a.color].main}}),"&:active":(0,i.Z)({},"contained"===a.variant&&{boxShadow:(n.vars||n).shadows[8]}),["&.".concat(v.focusVisible)]:(0,i.Z)({},"contained"===a.variant&&{boxShadow:(n.vars||n).shadows[6]}),["&.".concat(v.disabled)]:(0,i.Z)({color:(n.vars||n).palette.action.disabled},"outlined"===a.variant&&{border:"1px solid ".concat((n.vars||n).palette.action.disabledBackground)},"contained"===a.variant&&{color:(n.vars||n).palette.action.disabled,boxShadow:(n.vars||n).shadows[0],backgroundColor:(n.vars||n).palette.action.disabledBackground})},"text"===a.variant&&{padding:"6px 8px"},"text"===a.variant&&"inherit"!==a.color&&{color:(n.vars||n).palette[a.color].main},"outlined"===a.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===a.variant&&"inherit"!==a.color&&{color:(n.vars||n).palette[a.color].main,border:n.vars?"1px solid rgba(".concat(n.vars.palette[a.color].mainChannel," / 0.5)"):"1px solid ".concat((0,c.Fq)(n.palette[a.color].main,.5))},"contained"===a.variant&&{color:n.vars?n.vars.palette.text.primary:null==(t=(r=n.palette).getContrastText)?void 0:t.call(r,n.palette.grey[300]),backgroundColor:n.vars?n.vars.palette.Button.inheritContainedBg:o,boxShadow:(n.vars||n).shadows[2]},"contained"===a.variant&&"inherit"!==a.color&&{color:(n.vars||n).palette[a.color].contrastText,backgroundColor:(n.vars||n).palette[a.color].main},"inherit"===a.color&&{color:"inherit",borderColor:"currentColor"},"small"===a.size&&"text"===a.variant&&{padding:"4px 5px",fontSize:n.typography.pxToRem(13)},"large"===a.size&&"text"===a.variant&&{padding:"8px 11px",fontSize:n.typography.pxToRem(15)},"small"===a.size&&"outlined"===a.variant&&{padding:"3px 9px",fontSize:n.typography.pxToRem(13)},"large"===a.size&&"outlined"===a.variant&&{padding:"7px 21px",fontSize:n.typography.pxToRem(15)},"small"===a.size&&"contained"===a.variant&&{padding:"4px 10px",fontSize:n.typography.pxToRem(13)},"large"===a.size&&"contained"===a.variant&&{padding:"8px 22px",fontSize:n.typography.pxToRem(15)},a.fullWidth&&{width:"100%"})},e=>{let{ownerState:t}=e;return t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},["&.".concat(v.focusVisible)]:{boxShadow:"none"},"&:active":{boxShadow:"none"},["&.".concat(v.disabled)]:{boxShadow:"none"}}}),C=(0,u.ZP)("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.startIcon,t["iconSize".concat((0,f.Z)(r.size))]]}})(e=>{let{ownerState:t}=e;return(0,i.Z)({display:"inherit",marginRight:8,marginLeft:-4},"small"===t.size&&{marginLeft:-2},x(t))}),A=(0,u.ZP)("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.endIcon,t["iconSize".concat((0,f.Z)(r.size))]]}})(e=>{let{ownerState:t}=e;return(0,i.Z)({display:"inherit",marginRight:-4,marginLeft:8},"small"===t.size&&{marginRight:-2},x(t))});var M=a.forwardRef(function(e,t){let r=a.useContext(b),l=a.useContext(_),c=(0,s.Z)(r,e),u=(0,h.i)({props:c,name:"MuiButton"}),{children:d,color:p="primary",component:f="button",className:m,disabled:g=!1,disableElevation:y=!1,disableFocusRipple:v=!1,endIcon:x,focusVisibleClassName:M,fullWidth:I=!1,size:R="medium",startIcon:k,type:P,variant:O="text"}=u,N=(0,n.Z)(u,S),L=(0,i.Z)({},u,{color:p,component:f,disabled:g,disableElevation:y,disableFocusRipple:v,fullWidth:I,size:R,type:P,variant:O}),D=T(L),U=k&&(0,w.jsx)(C,{className:D.startIcon,ownerState:L,children:k}),F=x&&(0,w.jsx)(A,{className:D.endIcon,ownerState:L,children:x}),B=l||"";return(0,w.jsxs)(E,(0,i.Z)({ownerState:L,className:(0,o.Z)(r.className,D.root,m,B),component:f,disabled:g,focusRipple:!v,focusVisibleClassName:(0,o.Z)(D.focusVisible,M),ref:t,type:P},N,{classes:D,children:[U,d,F]}))})},19472:function(e,t,r){"use strict";r.d(t,{Z:function(){return er}});var n=r(1119),i=r(74610),a=r(2265),o=r(61994),s=r(20801),l=r(16210),c=r(37053),u=r(60118),d=r(9665),h=r(2424),p=r(45008);function f(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var m=r(88671),g=r(79610);function y(e,t){var r=function(e){return t&&(0,a.isValidElement)(e)?t(e):e},n=Object.create(null);return e&&a.Children.map(e,function(e){return e}).forEach(function(e){n[e.key]=r(e)}),n}function v(e,t){function r(r){return r in t?t[r]:e[r]}e=e||{},t=t||{};var n,i=Object.create(null),a=[];for(var o in e)o in t?a.length&&(i[o]=a,a=[]):a.push(o);var s={};for(var l in t){if(i[l])for(n=0;n<i[l].length;n++){var c=i[l][n];s[i[l][n]]=r(c)}s[l]=r(l)}for(n=0;n<a.length;n++)s[a[n]]=r(a[n]);return s}function b(e,t,r){return null!=r[t]?r[t]:e.props[t]}function _(e,t){return y(e.children,function(r){return(0,a.cloneElement)(r,{onExited:t.bind(null,r),in:!0,appear:b(r,"appear",e),enter:b(r,"enter",e),exit:b(r,"exit",e)})})}function w(e,t,r){var n=y(e.children),i=v(t,n);return Object.keys(i).forEach(function(o){var s=i[o];if((0,a.isValidElement)(s)){var l=o in t,c=o in n,u=t[o],d=(0,a.isValidElement)(u)&&!u.props.in;c&&(!l||d)?i[o]=(0,a.cloneElement)(s,{onExited:r.bind(null,s),in:!0,exit:b(s,"exit",e),enter:b(s,"enter",e)}):c||!l||d?c&&l&&(0,a.isValidElement)(u)&&(i[o]=(0,a.cloneElement)(s,{onExited:r.bind(null,s),in:u.props.in,exit:b(s,"exit",e),enter:b(s,"enter",e)})):i[o]=(0,a.cloneElement)(s,{in:!1})}}),i}var S=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},T={component:"div",childFactory:function(e){return e}},x=function(e){function t(t,r){var n,i=(n=e.call(this,t,r)||this).handleExited.bind(f(n));return n.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},n}(0,m.Z)(t,e);var r=t.prototype;return r.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},r.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var r=t.children,n=t.handleExited;return{children:t.firstRender?_(e,n):w(e,r,n),firstRender:!1}},r.handleExited=function(e,t){var r=y(this.props.children);e.key in r||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState(function(t){var r=(0,n.Z)({},t.children);return delete r[e.key],{children:r}}))},r.render=function(){var e=this.props,t=e.component,r=e.childFactory,n=(0,i.Z)(e,["component","childFactory"]),o=this.state.contextValue,s=S(this.state.children).map(r);return(delete n.appear,delete n.enter,delete n.exit,null===t)?a.createElement(g.Z.Provider,{value:o},s):a.createElement(g.Z.Provider,{value:o},a.createElement(t,n,s))},t}(a.Component);x.propTypes={},x.defaultProps=T;var E=x,C=r(3146),A=r(96375),M=r(57437),I=function(e){let{className:t,classes:r,pulsate:n=!1,rippleX:i,rippleY:s,rippleSize:l,in:c,onExited:u,timeout:d}=e,[h,p]=a.useState(!1),f=(0,o.Z)(t,r.ripple,r.rippleVisible,n&&r.ripplePulsate),m={width:l,height:l,top:-(l/2)+s,left:-(l/2)+i},g=(0,o.Z)(r.child,h&&r.childLeaving,n&&r.childPulsate);return c||h||p(!0),a.useEffect(()=>{if(!c&&null!=u){let e=setTimeout(u,d);return()=>{clearTimeout(e)}}},[u,c,d]),(0,M.jsx)("span",{className:f,style:m,children:(0,M.jsx)("span",{className:g})})},R=r(94143),k=(0,R.Z)("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]);function P(){let e=(0,p._)(["\n  0% {\n    transform: scale(0);\n    opacity: 0.1;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 0.3;\n  }\n"]);return P=function(){return e},e}function O(){let e=(0,p._)(["\n  0% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0;\n  }\n"]);return O=function(){return e},e}function N(){let e=(0,p._)(["\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(0.92);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n"]);return N=function(){return e},e}function L(){let e=(0,p._)(["\n  opacity: 0;\n  position: absolute;\n\n  &."," {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  &."," {\n    animation-duration: ","ms;\n  }\n\n  & ."," {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & ."," {\n    opacity: 0;\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  & ."," {\n    position: absolute;\n    /* @noflip */\n    left: 0px;\n    top: 0;\n    animation-name: ",";\n    animation-duration: 2500ms;\n    animation-timing-function: ",";\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n"]);return L=function(){return e},e}let D=["center","classes","className"],U=e=>e,F,B,z,H,j=550,G=80,V=(0,C.F4)(F||(F=U(P()))),q=(0,C.F4)(B||(B=U(O()))),W=(0,C.F4)(z||(z=U(N()))),Z=(0,l.ZP)("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),X=(0,l.ZP)(I,{name:"MuiTouchRipple",slot:"Ripple"})(H||(H=U(L(),0,0,0,0,0,0,0,0,0,0,0,0,0,0)),k.rippleVisible,V,j,e=>{let{theme:t}=e;return t.transitions.easing.easeInOut},k.ripplePulsate,e=>{let{theme:t}=e;return t.transitions.duration.shorter},k.child,k.childLeaving,q,j,e=>{let{theme:t}=e;return t.transitions.easing.easeInOut},k.childPulsate,W,e=>{let{theme:t}=e;return t.transitions.easing.easeInOut});var $=a.forwardRef(function(e,t){let r=(0,c.i)({props:e,name:"MuiTouchRipple"}),{center:s=!1,classes:l={},className:u}=r,d=(0,i.Z)(r,D),[h,p]=a.useState([]),f=a.useRef(0),m=a.useRef(null);a.useEffect(()=>{m.current&&(m.current(),m.current=null)},[h]);let g=a.useRef(!1),y=(0,A.Z)(),v=a.useRef(null),b=a.useRef(null),_=a.useCallback(e=>{let{pulsate:t,rippleX:r,rippleY:n,rippleSize:i,cb:a}=e;p(e=>[...e,(0,M.jsx)(X,{classes:{ripple:(0,o.Z)(l.ripple,k.ripple),rippleVisible:(0,o.Z)(l.rippleVisible,k.rippleVisible),ripplePulsate:(0,o.Z)(l.ripplePulsate,k.ripplePulsate),child:(0,o.Z)(l.child,k.child),childLeaving:(0,o.Z)(l.childLeaving,k.childLeaving),childPulsate:(0,o.Z)(l.childPulsate,k.childPulsate)},timeout:j,pulsate:t,rippleX:r,rippleY:n,rippleSize:i},f.current)]),f.current+=1,m.current=a},[l]),w=a.useCallback(function(){let e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{},{pulsate:o=!1,center:l=s||i.pulsate,fakeElement:c=!1}=i;if((null==n?void 0:n.type)==="mousedown"&&g.current){g.current=!1;return}(null==n?void 0:n.type)==="touchstart"&&(g.current=!0);let u=c?null:b.current,d=u?u.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(!l&&void 0!==n&&(0!==n.clientX||0!==n.clientY)&&(n.clientX||n.touches)){let{clientX:r,clientY:i}=n.touches&&n.touches.length>0?n.touches[0]:n;e=Math.round(r-d.left),t=Math.round(i-d.top)}else e=Math.round(d.width/2),t=Math.round(d.height/2);l?(r=Math.sqrt((2*d.width**2+d.height**2)/3))%2==0&&(r+=1):r=Math.sqrt((2*Math.max(Math.abs((u?u.clientWidth:0)-e),e)+2)**2+(2*Math.max(Math.abs((u?u.clientHeight:0)-t),t)+2)**2),null!=n&&n.touches?null===v.current&&(v.current=()=>{_({pulsate:o,rippleX:e,rippleY:t,rippleSize:r,cb:a})},y.start(G,()=>{v.current&&(v.current(),v.current=null)})):_({pulsate:o,rippleX:e,rippleY:t,rippleSize:r,cb:a})},[s,_,y]),S=a.useCallback(()=>{w({},{pulsate:!0})},[w]),T=a.useCallback((e,t)=>{if(y.clear(),(null==e?void 0:e.type)==="touchend"&&v.current){v.current(),v.current=null,y.start(0,()=>{T(e,t)});return}v.current=null,p(e=>e.length>0?e.slice(1):e),m.current=t},[y]);return a.useImperativeHandle(t,()=>({pulsate:S,start:w,stop:T}),[S,w,T]),(0,M.jsx)(Z,(0,n.Z)({className:(0,o.Z)(k.root,l.root,u),ref:b},d,{children:(0,M.jsx)(E,{component:null,exit:!0,children:h})}))}),K=r(50738);function Y(e){return(0,K.ZP)("MuiButtonBase",e)}var Q=(0,R.Z)("MuiButtonBase",["root","disabled","focusVisible"]);let J=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],ee=e=>{let{disabled:t,focusVisible:r,focusVisibleClassName:n,classes:i}=e,a={root:["root",t&&"disabled",r&&"focusVisible"]},o=(0,s.Z)(a,Y,i);return r&&n&&(o.root+=" ".concat(n)),o},et=(0,l.ZP)("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},["&.".concat(Q.disabled)]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}});var er=a.forwardRef(function(e,t){let r=(0,c.i)({props:e,name:"MuiButtonBase"}),{action:s,centerRipple:l=!1,children:p,className:f,component:m="button",disabled:g=!1,disableRipple:y=!1,disableTouchRipple:v=!1,focusRipple:b=!1,LinkComponent:_="a",onBlur:w,onClick:S,onContextMenu:T,onDragLeave:x,onFocus:E,onFocusVisible:C,onKeyDown:A,onKeyUp:I,onMouseDown:R,onMouseLeave:k,onMouseUp:P,onTouchEnd:O,onTouchMove:N,onTouchStart:L,tabIndex:D=0,TouchRippleProps:U,touchRippleRef:F,type:B}=r,z=(0,i.Z)(r,J),H=a.useRef(null),j=a.useRef(null),G=(0,u.Z)(j,F),{isFocusVisibleRef:V,onFocus:q,onBlur:W,ref:Z}=(0,h.Z)(),[X,K]=a.useState(!1);g&&X&&K(!1),a.useImperativeHandle(s,()=>({focusVisible:()=>{K(!0),H.current.focus()}}),[]);let[Y,Q]=a.useState(!1);a.useEffect(()=>{Q(!0)},[]);let er=Y&&!y&&!g;function en(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;return(0,d.Z)(n=>(t&&t(n),!r&&j.current&&j.current[e](n),!0))}a.useEffect(()=>{X&&b&&!y&&Y&&j.current.pulsate()},[y,b,X,Y]);let ei=en("start",R),ea=en("stop",T),eo=en("stop",x),es=en("stop",P),el=en("stop",e=>{X&&e.preventDefault(),k&&k(e)}),ec=en("start",L),eu=en("stop",O),ed=en("stop",N),eh=en("stop",e=>{W(e),!1===V.current&&K(!1),w&&w(e)},!1),ep=(0,d.Z)(e=>{H.current||(H.current=e.currentTarget),q(e),!0===V.current&&(K(!0),C&&C(e)),E&&E(e)}),ef=()=>{let e=H.current;return m&&"button"!==m&&!("A"===e.tagName&&e.href)},em=a.useRef(!1),eg=(0,d.Z)(e=>{b&&!em.current&&X&&j.current&&" "===e.key&&(em.current=!0,j.current.stop(e,()=>{j.current.start(e)})),e.target===e.currentTarget&&ef()&&" "===e.key&&e.preventDefault(),A&&A(e),e.target===e.currentTarget&&ef()&&"Enter"===e.key&&!g&&(e.preventDefault(),S&&S(e))}),ey=(0,d.Z)(e=>{b&&" "===e.key&&j.current&&X&&!e.defaultPrevented&&(em.current=!1,j.current.stop(e,()=>{j.current.pulsate(e)})),I&&I(e),S&&e.target===e.currentTarget&&ef()&&" "===e.key&&!e.defaultPrevented&&S(e)}),ev=m;"button"===ev&&(z.href||z.to)&&(ev=_);let eb={};"button"===ev?(eb.type=void 0===B?"button":B,eb.disabled=g):(z.href||z.to||(eb.role="button"),g&&(eb["aria-disabled"]=g));let e_=(0,u.Z)(t,Z,H),ew=(0,n.Z)({},r,{centerRipple:l,component:m,disabled:g,disableRipple:y,disableTouchRipple:v,focusRipple:b,tabIndex:D,focusVisible:X}),eS=ee(ew);return(0,M.jsxs)(et,(0,n.Z)({as:ev,className:(0,o.Z)(eS.root,f),ownerState:ew,onBlur:eh,onClick:S,onContextMenu:ea,onFocus:ep,onKeyDown:eg,onKeyUp:ey,onMouseDown:ei,onMouseLeave:el,onMouseUp:es,onDragLeave:eo,onTouchEnd:eu,onTouchMove:ed,onTouchStart:ec,ref:e_,tabIndex:g?-1:D,type:B},eb,z,{children:[p,er?(0,M.jsx)($,(0,n.Z)({ref:G,center:l},U)):null]}))})},67208:function(e,t,r){"use strict";r.d(t,{Z:function(){return v}});var n=r(1119),i=r(74610),a=r(2265),o=r(61994),s=r(20801),l=r(16210),c=r(37053),u=r(96207),d=r(94143),h=r(50738);function p(e){return(0,h.ZP)("MuiCard",e)}(0,d.Z)("MuiCard",["root"]);var f=r(57437);let m=["className","raised"],g=e=>{let{classes:t}=e,r={root:["root"]};return(0,s.Z)(r,p,t)},y=(0,l.ZP)(u.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({overflow:"hidden"}));var v=a.forwardRef(function(e,t){let r=(0,c.i)({props:e,name:"MuiCard"}),{className:a,raised:s=!1}=r,l=(0,i.Z)(r,m),u=(0,n.Z)({},r,{raised:s}),d=g(u);return(0,f.jsx)(y,(0,n.Z)({className:(0,o.Z)(d.root,a),elevation:s?8:void 0,ref:t,ownerState:u},l))})},95707:function(e,t,r){"use strict";r.d(t,{default:function(){return d}});var n=r(1119),i=r(2265),a=r(37053),o=r(41723),s=r(57437);let l=(e,t)=>(0,n.Z)({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%"},t&&!e.vars&&{colorScheme:e.palette.mode}),c=e=>(0,n.Z)({color:(e.vars||e).palette.text.primary},e.typography.body1,{backgroundColor:(e.vars||e).palette.background.default,"@media print":{backgroundColor:(e.vars||e).palette.common.white}}),u=function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i={};r&&e.colorSchemes&&Object.entries(e.colorSchemes).forEach(t=>{var r;let[n,a]=t;i[e.getColorSchemeSelector(n).replace(/\s*&/,"")]={colorScheme:null==(r=a.palette)?void 0:r.mode}});let a=(0,n.Z)({html:l(e,r),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:e.typography.fontWeightBold},body:(0,n.Z)({margin:0},c(e),{"&::backdrop":{backgroundColor:(e.vars||e).palette.background.default}})},i),o=null==(t=e.components)||null==(t=t.MuiCssBaseline)?void 0:t.styleOverrides;return o&&(a=[a,o]),a};var d=function(e){let{children:t,enableColorScheme:r=!1}=(0,a.i)({props:e,name:"MuiCssBaseline"});return(0,s.jsxs)(i.Fragment,{children:[(0,s.jsx)(o.Z,{styles:e=>u(e,r)}),t]})}},37053:function(e,t,r){"use strict";r.d(t,{i:function(){return i}}),r(2265);var n=r(17804);function i(e){return(0,n.i)(e)}r(57437)},90486:function(e,t,r){"use strict";var n=r(1119),i=r(74610),a=r(2265),o=r(86739),s=r(30628),l=r(31691),c=r(31090),u=r(60118),d=r(57437);let h=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],p={entering:{opacity:1},entered:{opacity:1}},f=a.forwardRef(function(e,t){let r=(0,l.Z)(),f={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:m,appear:g=!0,children:y,easing:v,in:b,onEnter:_,onEntered:w,onEntering:S,onExit:T,onExited:x,onExiting:E,style:C,timeout:A=f,TransitionComponent:M=o.ZP}=e,I=(0,i.Z)(e,h),R=!0,k=a.useRef(null),P=(0,u.Z)(k,(0,s.Z)(y),t),O=e=>t=>{if(e){let r=k.current;void 0===t?e(r):e(r,t)}},N=O(S),L=O((e,t)=>{(0,c.n)(e);let n=(0,c.C)({style:C,timeout:A,easing:v},{mode:"enter"});e.style.webkitTransition=r.transitions.create("opacity",n),e.style.transition=r.transitions.create("opacity",n),_&&_(e,t)}),D=O(w),U=O(E),F=O(e=>{let t=(0,c.C)({style:C,timeout:A,easing:v},{mode:"exit"});e.style.webkitTransition=r.transitions.create("opacity",t),e.style.transition=r.transitions.create("opacity",t),T&&T(e)}),B=O(x),z=e=>{m&&m(k.current,e)};return(0,d.jsx)(M,(0,n.Z)({appear:g,in:b,nodeRef:R?k:void 0,onEnter:L,onEntered:D,onEntering:N,onExit:F,onExited:B,onExiting:U,addEndListener:z,timeout:A},I,{children:(e,t)=>a.cloneElement(y,(0,n.Z)({style:(0,n.Z)({opacity:0,visibility:"exited"!==e||b?void 0:"hidden"},p[e],C,y.props.style),ref:P},t))}))});t.Z=f},41723:function(e,t,r){"use strict";var n=r(1119);r(2265);var i=r(21075),a=r(55201),o=r(22166),s=r(57437);function l(e){return(0,s.jsx)(i.Z,(0,n.Z)({},e,{defaultTheme:a.Z,themeId:o.Z}))}t.Z=l},78826:function(e,t,r){"use strict";var n=r(1119),i=r(74610),a=r(2265),o=r(96375),s=r(30628),l=r(86739),c=r(31691),u=r(31090),d=r(60118),h=r(57437);let p=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function f(e){return"scale(".concat(e,", ").concat(e**2,")")}let m={entering:{opacity:1,transform:f(1)},entered:{opacity:1,transform:"none"}},g="undefined"!=typeof navigator&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),y=a.forwardRef(function(e,t){let{addEndListener:r,appear:y=!0,children:v,easing:b,in:_,onEnter:w,onEntered:S,onEntering:T,onExit:x,onExited:E,onExiting:C,style:A,timeout:M="auto",TransitionComponent:I=l.ZP}=e,R=(0,i.Z)(e,p),k=(0,o.Z)(),P=a.useRef(),O=(0,c.Z)(),N=a.useRef(null),L=(0,d.Z)(N,(0,s.Z)(v),t),D=e=>t=>{if(e){let r=N.current;void 0===t?e(r):e(r,t)}},U=D(T),F=D((e,t)=>{let r;(0,u.n)(e);let{duration:n,delay:i,easing:a}=(0,u.C)({style:A,timeout:M,easing:b},{mode:"enter"});"auto"===M?(r=O.transitions.getAutoHeightDuration(e.clientHeight),P.current=r):r=n,e.style.transition=[O.transitions.create("opacity",{duration:r,delay:i}),O.transitions.create("transform",{duration:g?r:.666*r,delay:i,easing:a})].join(","),w&&w(e,t)}),B=D(S),z=D(C),H=D(e=>{let t;let{duration:r,delay:n,easing:i}=(0,u.C)({style:A,timeout:M,easing:b},{mode:"exit"});"auto"===M?(t=O.transitions.getAutoHeightDuration(e.clientHeight),P.current=t):t=r,e.style.transition=[O.transitions.create("opacity",{duration:t,delay:n}),O.transitions.create("transform",{duration:g?t:.666*t,delay:g?n:n||.333*t,easing:i})].join(","),e.style.opacity=0,e.style.transform=f(.75),x&&x(e)}),j=D(E),G=e=>{"auto"===M&&k.start(P.current||0,e),r&&r(N.current,e)};return(0,h.jsx)(I,(0,n.Z)({appear:y,in:_,nodeRef:N,onEnter:F,onEntered:B,onEntering:U,onExit:H,onExited:j,onExiting:z,addEndListener:G,timeout:"auto"===M?null:M},R,{children:(e,t)=>a.cloneElement(v,(0,n.Z)({style:(0,n.Z)({opacity:0,transform:f(.75),visibility:"exited"!==e||_?void 0:"hidden"},m[e],A,v.props.style),ref:L},t))}))});y.muiSupportAuto=!0,t.Z=y},59832:function(e,t,r){"use strict";r.d(t,{Z:function(){return w}});var n=r(74610),i=r(1119),a=r(2265),o=r(61994),s=r(20801),l=r(14031),c=r(16210),u=r(37053),d=r(19472),h=r(85657),p=r(94143),f=r(50738);function m(e){return(0,f.ZP)("MuiIconButton",e)}var g=(0,p.Z)("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),y=r(57437);let v=["edge","children","className","color","disabled","disableFocusRipple","size"],b=e=>{let{classes:t,disabled:r,color:n,edge:i,size:a}=e,o={root:["root",r&&"disabled","default"!==n&&"color".concat((0,h.Z)(n)),i&&"edge".concat((0,h.Z)(i)),"size".concat((0,h.Z)(a))]};return(0,s.Z)(o,m,t)},_=(0,c.ZP)(d.Z,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,"default"!==r.color&&t["color".concat((0,h.Z)(r.color))],r.edge&&t["edge".concat((0,h.Z)(r.edge))],t["size".concat((0,h.Z)(r.size))]]}})(e=>{let{theme:t,ownerState:r}=e;return(0,i.Z)({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!r.disableRipple&&{"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.activeChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,l.Fq)(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"start"===r.edge&&{marginLeft:"small"===r.size?-3:-12},"end"===r.edge&&{marginRight:"small"===r.size?-3:-12})},e=>{var t;let{theme:r,ownerState:n}=e,a=null==(t=(r.vars||r).palette)?void 0:t[n.color];return(0,i.Z)({},"inherit"===n.color&&{color:"inherit"},"inherit"!==n.color&&"default"!==n.color&&(0,i.Z)({color:null==a?void 0:a.main},!n.disableRipple&&{"&:hover":(0,i.Z)({},a&&{backgroundColor:r.vars?"rgba(".concat(a.mainChannel," / ").concat(r.vars.palette.action.hoverOpacity,")"):(0,l.Fq)(a.main,r.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),"small"===n.size&&{padding:5,fontSize:r.typography.pxToRem(18)},"large"===n.size&&{padding:12,fontSize:r.typography.pxToRem(28)},{["&.".concat(g.disabled)]:{backgroundColor:"transparent",color:(r.vars||r).palette.action.disabled}})});var w=a.forwardRef(function(e,t){let r=(0,u.i)({props:e,name:"MuiIconButton"}),{edge:a=!1,children:s,className:l,color:c="default",disabled:d=!1,disableFocusRipple:h=!1,size:p="medium"}=r,f=(0,n.Z)(r,v),m=(0,i.Z)({},r,{edge:a,color:c,disabled:d,disableFocusRipple:h,size:p}),g=b(m);return(0,y.jsx)(_,(0,i.Z)({className:(0,o.Z)(g.root,l),centerRipple:!0,focusRipple:!h,disabled:d,ref:t},f,{ownerState:m,children:s}))})},59253:function(e,t,r){"use strict";r.d(t,{Z:function(){return G}});var n=r(45008),i=r(74610),a=r(1119),o=r(2265),s=r(61994),l=r(20801),c=r(3146),u=r(14031),d=r(77126),h=r(85657),p=r(16210),f=r(37053),m=r(94143),g=r(50738);function y(e){return(0,g.ZP)("MuiLinearProgress",e)}(0,m.Z)("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);var v=r(57437);function b(){let e=(0,n._)(["\n  0% {\n    left: -35%;\n    right: 100%;\n  }\n\n  60% {\n    left: 100%;\n    right: -90%;\n  }\n\n  100% {\n    left: 100%;\n    right: -90%;\n  }\n"]);return b=function(){return e},e}function _(){let e=(0,n._)(["\n  0% {\n    left: -200%;\n    right: 100%;\n  }\n\n  60% {\n    left: 107%;\n    right: -8%;\n  }\n\n  100% {\n    left: 107%;\n    right: -8%;\n  }\n"]);return _=function(){return e},e}function w(){let e=(0,n._)(["\n  0% {\n    opacity: 1;\n    background-position: 0 -23px;\n  }\n\n  60% {\n    opacity: 0;\n    background-position: 0 -23px;\n  }\n\n  100% {\n    opacity: 1;\n    background-position: -200px -23px;\n  }\n"]);return w=function(){return e},e}function S(){let e=(0,n._)(["\n    animation: "," 3s infinite linear;\n  "]);return S=function(){return e},e}function T(){let e=(0,n._)(["\n      width: auto;\n      animation: "," 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;\n    "]);return T=function(){return e},e}function x(){let e=(0,n._)(["\n      width: auto;\n      animation: "," 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;\n    "]);return x=function(){return e},e}let E=["className","color","value","valueBuffer","variant"],C=e=>e,A,M,I,R,k,P,O=4,N=(0,c.F4)(A||(A=C(b()))),L=(0,c.F4)(M||(M=C(_()))),D=(0,c.F4)(I||(I=C(w()))),U=e=>{let{classes:t,variant:r,color:n}=e,i={root:["root","color".concat((0,h.Z)(n)),r],dashed:["dashed","dashedColor".concat((0,h.Z)(n))],bar1:["bar","barColor".concat((0,h.Z)(n)),("indeterminate"===r||"query"===r)&&"bar1Indeterminate","determinate"===r&&"bar1Determinate","buffer"===r&&"bar1Buffer"],bar2:["bar","buffer"!==r&&"barColor".concat((0,h.Z)(n)),"buffer"===r&&"color".concat((0,h.Z)(n)),("indeterminate"===r||"query"===r)&&"bar2Indeterminate","buffer"===r&&"bar2Buffer"]};return(0,l.Z)(i,y,t)},F=(e,t)=>"inherit"===t?"currentColor":e.vars?e.vars.palette.LinearProgress["".concat(t,"Bg")]:"light"===e.palette.mode?(0,u.$n)(e.palette[t].main,.62):(0,u._j)(e.palette[t].main,.5),B=(0,p.ZP)("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t["color".concat((0,h.Z)(r.color))],t[r.variant]]}})(e=>{let{ownerState:t,theme:r}=e;return(0,a.Z)({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},backgroundColor:F(r,t.color)},"inherit"===t.color&&"buffer"!==t.variant&&{backgroundColor:"none","&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}},"buffer"===t.variant&&{backgroundColor:"transparent"},"query"===t.variant&&{transform:"rotate(180deg)"})}),z=(0,p.ZP)("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.dashed,t["dashedColor".concat((0,h.Z)(r.color))]]}})(e=>{let{ownerState:t,theme:r}=e,n=F(r,t.color);return(0,a.Z)({position:"absolute",marginTop:0,height:"100%",width:"100%"},"inherit"===t.color&&{opacity:.3},{backgroundImage:"radial-gradient(".concat(n," 0%, ").concat(n," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"})},(0,c.iv)(R||(R=C(S(),0)),D)),H=(0,p.ZP)("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.bar,t["barColor".concat((0,h.Z)(r.color))],("indeterminate"===r.variant||"query"===r.variant)&&t.bar1Indeterminate,"determinate"===r.variant&&t.bar1Determinate,"buffer"===r.variant&&t.bar1Buffer]}})(e=>{let{ownerState:t,theme:r}=e;return(0,a.Z)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",backgroundColor:"inherit"===t.color?"currentColor":(r.vars||r).palette[t.color].main},"determinate"===t.variant&&{transition:"transform .".concat(O,"s linear")},"buffer"===t.variant&&{zIndex:1,transition:"transform .".concat(O,"s linear")})},e=>{let{ownerState:t}=e;return("indeterminate"===t.variant||"query"===t.variant)&&(0,c.iv)(k||(k=C(T(),0)),N)}),j=(0,p.ZP)("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.bar,t["barColor".concat((0,h.Z)(r.color))],("indeterminate"===r.variant||"query"===r.variant)&&t.bar2Indeterminate,"buffer"===r.variant&&t.bar2Buffer]}})(e=>{let{ownerState:t,theme:r}=e;return(0,a.Z)({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},"buffer"!==t.variant&&{backgroundColor:"inherit"===t.color?"currentColor":(r.vars||r).palette[t.color].main},"inherit"===t.color&&{opacity:.3},"buffer"===t.variant&&{backgroundColor:F(r,t.color),transition:"transform .".concat(O,"s linear")})},e=>{let{ownerState:t}=e;return("indeterminate"===t.variant||"query"===t.variant)&&(0,c.iv)(P||(P=C(x(),0)),L)});var G=o.forwardRef(function(e,t){let r=(0,f.i)({props:e,name:"MuiLinearProgress"}),{className:n,color:o="primary",value:l,valueBuffer:c,variant:u="indeterminate"}=r,h=(0,i.Z)(r,E),p=(0,a.Z)({},r,{color:o,variant:u}),m=U(p),g=(0,d.V)(),y={},b={bar1:{},bar2:{}};if(("determinate"===u||"buffer"===u)&&void 0!==l){y["aria-valuenow"]=Math.round(l),y["aria-valuemin"]=0,y["aria-valuemax"]=100;let e=l-100;g&&(e=-e),b.bar1.transform="translateX(".concat(e,"%)")}if("buffer"===u&&void 0!==c){let e=(c||0)-100;g&&(e=-e),b.bar2.transform="translateX(".concat(e,"%)")}return(0,v.jsxs)(B,(0,a.Z)({className:(0,s.Z)(m.root,n),ownerState:p,role:"progressbar"},y,{ref:t},h,{children:["buffer"===u?(0,v.jsx)(z,{className:m.dashed,ownerState:p}):null,(0,v.jsx)(H,{className:m.bar1,ownerState:p,style:b.bar1}),"determinate"===u?null:(0,v.jsx)(j,{className:m.bar2,ownerState:p,style:b.bar2})]}))})},96207:function(e,t,r){"use strict";r.d(t,{Z:function(){return b}});var n=r(74610),i=r(1119),a=r(2265),o=r(61994),s=r(20801),l=r(14031),c=r(16210),u=e=>{let t;return((t=e<1?5.11916*e**2:4.5*Math.log(e+1)+2)/100).toFixed(2)},d=r(37053),h=r(94143),p=r(50738);function f(e){return(0,p.ZP)("MuiPaper",e)}(0,h.Z)("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);var m=r(57437);let g=["className","component","elevation","square","variant"],y=e=>{let{square:t,elevation:r,variant:n,classes:i}=e,a={root:["root",n,!t&&"rounded","elevation"===n&&"elevation".concat(r)]};return(0,s.Z)(a,f,i)},v=(0,c.ZP)("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,t[r.variant],!r.square&&t.rounded,"elevation"===r.variant&&t["elevation".concat(r.elevation)]]}})(e=>{var t;let{theme:r,ownerState:n}=e;return(0,i.Z)({backgroundColor:(r.vars||r).palette.background.paper,color:(r.vars||r).palette.text.primary,transition:r.transitions.create("box-shadow")},!n.square&&{borderRadius:r.shape.borderRadius},"outlined"===n.variant&&{border:"1px solid ".concat((r.vars||r).palette.divider)},"elevation"===n.variant&&(0,i.Z)({boxShadow:(r.vars||r).shadows[n.elevation]},!r.vars&&"dark"===r.palette.mode&&{backgroundImage:"linear-gradient(".concat((0,l.Fq)("#fff",u(n.elevation)),", ").concat((0,l.Fq)("#fff",u(n.elevation)),")")},r.vars&&{backgroundImage:null==(t=r.vars.overlays)?void 0:t[n.elevation]}))});var b=a.forwardRef(function(e,t){let r=(0,d.i)({props:e,name:"MuiPaper"}),{className:a,component:s="div",elevation:l=1,square:c=!1,variant:u="elevation"}=r,h=(0,n.Z)(r,g),p=(0,i.Z)({},r,{component:s,elevation:l,square:c,variant:u}),f=y(p);return(0,m.jsx)(v,(0,i.Z)({as:s,ownerState:p,className:(0,o.Z)(f.root,a),ref:t},h))})},71004:function(e,t,r){"use strict";r.d(t,{Z:function(){return y}});var n=r(74610),i=r(1119),a=r(2265),o=r(61994),s=r(20801),l=r(37053),c=r(16210),u=r(94143),d=r(50738);function h(e){return(0,d.ZP)("MuiToolbar",e)}(0,u.Z)("MuiToolbar",["root","gutters","regular","dense"]);var p=r(57437);let f=["className","component","disableGutters","variant"],m=e=>{let{classes:t,disableGutters:r,variant:n}=e,i={root:["root",!r&&"gutters",n]};return(0,s.Z)(i,h,t)},g=(0,c.ZP)("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,!r.disableGutters&&t.gutters,t[r.variant]]}})(e=>{let{theme:t,ownerState:r}=e;return(0,i.Z)({position:"relative",display:"flex",alignItems:"center"},!r.disableGutters&&{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}},"dense"===r.variant&&{minHeight:48})},e=>{let{theme:t,ownerState:r}=e;return"regular"===r.variant&&t.mixins.toolbar});var y=a.forwardRef(function(e,t){let r=(0,l.i)({props:e,name:"MuiToolbar"}),{className:a,component:s="div",disableGutters:c=!1,variant:u="regular"}=r,d=(0,n.Z)(r,f),h=(0,i.Z)({},r,{component:s,disableGutters:c,variant:u}),y=m(h);return(0,p.jsx)(g,(0,i.Z)({as:s,className:(0,o.Z)(y.root,a),ref:t,ownerState:h},d))})},5002:function(e,t,r){"use strict";r.d(t,{Z:function(){return S}});var n=r(74610),i=r(1119),a=r(2265),o=r(61994),s=r(95086),l=r(20801),c=r(16210),u=r(37053),d=r(85657),h=r(94143),p=r(50738);function f(e){return(0,p.ZP)("MuiTypography",e)}(0,h.Z)("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);var m=r(57437);let g=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],y=e=>{let{align:t,gutterBottom:r,noWrap:n,paragraph:i,variant:a,classes:o}=e,s={root:["root",a,"inherit"!==e.align&&"align".concat((0,d.Z)(t)),r&&"gutterBottom",n&&"noWrap",i&&"paragraph"]};return(0,l.Z)(s,f,o)},v=(0,c.ZP)("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,r.variant&&t[r.variant],"inherit"!==r.align&&t["align".concat((0,d.Z)(r.align))],r.noWrap&&t.noWrap,r.gutterBottom&&t.gutterBottom,r.paragraph&&t.paragraph]}})(e=>{let{theme:t,ownerState:r}=e;return(0,i.Z)({margin:0},"inherit"===r.variant&&{font:"inherit"},"inherit"!==r.variant&&t.typography[r.variant],"inherit"!==r.align&&{textAlign:r.align},r.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},r.gutterBottom&&{marginBottom:"0.35em"},r.paragraph&&{marginBottom:16})}),b={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},_={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},w=e=>_[e]||e;var S=a.forwardRef(function(e,t){let r=(0,u.i)({props:e,name:"MuiTypography"}),a=w(r.color),l=(0,s.Z)((0,i.Z)({},r,{color:a})),{align:c="inherit",className:d,component:h,gutterBottom:p=!1,noWrap:f=!1,paragraph:_=!1,variant:S="body1",variantMapping:T=b}=l,x=(0,n.Z)(l,g),E=(0,i.Z)({},l,{align:c,color:a,className:d,component:h,gutterBottom:p,noWrap:f,paragraph:_,variant:S,variantMapping:T}),C=h||(_?"p":T[S]||b[S])||"span",A=y(E);return(0,m.jsx)(v,(0,i.Z)({as:C,ref:t,ownerState:E,className:(0,o.Z)(A.root,d)},x))})},66075:function(e,t,r){"use strict";r.d(t,{Z:function(){return $}});var n=r(1119),i=r(74610),a=r(80399),o=r(87354),s=r(96445),l=r(38720),c=r(35680);function u(e,t){return(0,n.Z)({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},t)}var d=r(14031),h={black:"#000",white:"#fff"},p={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},f={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},m={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},g={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},y={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},v={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},b={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"};let _=["mode","contrastThreshold","tonalOffset"],w={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:h.white,default:h.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},S={text:{primary:h.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:h.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function T(e,t,r,n){let i=n.light||n,a=n.dark||1.5*n;e[t]||(e.hasOwnProperty(r)?e[t]=e[r]:"light"===t?e.light=(0,d.$n)(e.main,i):"dark"===t&&(e.dark=(0,d._j)(e.main,a)))}function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";return"dark"===e?{main:y[200],light:y[50],dark:y[400]}:{main:y[700],light:y[400],dark:y[800]}}function E(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";return"dark"===e?{main:f[200],light:f[50],dark:f[400]}:{main:f[500],light:f[300],dark:f[700]}}function C(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";return"dark"===e?{main:m[500],light:m[300],dark:m[700]}:{main:m[700],light:m[400],dark:m[800]}}function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";return"dark"===e?{main:v[400],light:v[300],dark:v[700]}:{main:v[700],light:v[500],dark:v[900]}}function M(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";return"dark"===e?{main:b[400],light:b[300],dark:b[700]}:{main:b[800],light:b[500],dark:b[900]}}function I(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light";return"dark"===e?{main:g[400],light:g[300],dark:g[700]}:{main:"#ed6c02",light:g[500],dark:g[900]}}function R(e){let{mode:t="light",contrastThreshold:r=3,tonalOffset:s=.2}=e,l=(0,i.Z)(e,_),c=e.primary||x(t),u=e.secondary||E(t),f=e.error||C(t),m=e.info||A(t),g=e.success||M(t),y=e.warning||I(t);function v(e){return(0,d.mi)(e,S.text.primary)>=r?S.text.primary:w.text.primary}let b=e=>{let{color:t,name:r,mainShade:i=500,lightShade:o=300,darkShade:l=700}=e;if(!(t=(0,n.Z)({},t)).main&&t[i]&&(t.main=t[i]),!t.hasOwnProperty("main"))throw Error((0,a.Z)(11,r?" (".concat(r,")"):"",i));if("string"!=typeof t.main)throw Error((0,a.Z)(12,r?" (".concat(r,")"):"",JSON.stringify(t.main)));return T(t,"light",o,s),T(t,"dark",l,s),t.contrastText||(t.contrastText=v(t.main)),t},R={dark:S,light:w};return(0,o.Z)((0,n.Z)({common:(0,n.Z)({},h),mode:t,primary:b({color:c,name:"primary"}),secondary:b({color:u,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:b({color:f,name:"error"}),warning:b({color:y,name:"warning"}),info:b({color:m,name:"info"}),success:b({color:g,name:"success"}),grey:p,contrastThreshold:r,getContrastText:v,augmentColor:b,tonalOffset:s},R[t]),l)}let k=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function P(e){return Math.round(1e5*e)/1e5}let O={textTransform:"uppercase"},N='"Roboto", "Helvetica", "Arial", sans-serif';function L(e,t){let r="function"==typeof t?t(e):t,{fontFamily:a=N,fontSize:s=14,fontWeightLight:l=300,fontWeightRegular:c=400,fontWeightMedium:u=500,fontWeightBold:d=700,htmlFontSize:h=16,allVariants:p,pxToRem:f}=r,m=(0,i.Z)(r,k),g=s/14,y=f||(e=>"".concat(e/h*g,"rem")),v=(e,t,r,i,o)=>(0,n.Z)({fontFamily:a,fontWeight:e,fontSize:y(t),lineHeight:r},a===N?{letterSpacing:"".concat(P(i/t),"em")}:{},o,p),b={h1:v(l,96,1.167,-1.5),h2:v(l,60,1.2,-.5),h3:v(c,48,1.167,0),h4:v(c,34,1.235,.25),h5:v(c,24,1.334,0),h6:v(u,20,1.6,.15),subtitle1:v(c,16,1.75,.15),subtitle2:v(u,14,1.57,.1),body1:v(c,16,1.5,.15),body2:v(c,14,1.43,.15),button:v(u,14,1.75,.4,O),caption:v(c,12,1.66,.4),overline:v(c,12,2.66,1,O),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return(0,o.Z)((0,n.Z)({htmlFontSize:h,pxToRem:y,fontFamily:a,fontSize:s,fontWeightLight:l,fontWeightRegular:c,fontWeightMedium:u,fontWeightBold:d},b),m,{clone:!1})}let D=.2,U=.14,F=.12;function B(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return["".concat(t[0],"px ").concat(t[1],"px ").concat(t[2],"px ").concat(t[3],"px rgba(0,0,0,").concat(D,")"),"".concat(t[4],"px ").concat(t[5],"px ").concat(t[6],"px ").concat(t[7],"px rgba(0,0,0,").concat(U,")"),"".concat(t[8],"px ").concat(t[9],"px ").concat(t[10],"px ").concat(t[11],"px rgba(0,0,0,").concat(F,")")].join(",")}var z=["none",B(0,2,1,-1,0,1,1,0,0,1,3,0),B(0,3,1,-2,0,2,2,0,0,1,5,0),B(0,3,3,-2,0,3,4,0,0,1,8,0),B(0,2,4,-1,0,4,5,0,0,1,10,0),B(0,3,5,-1,0,5,8,0,0,1,14,0),B(0,3,5,-1,0,6,10,0,0,1,18,0),B(0,4,5,-2,0,7,10,1,0,2,16,1),B(0,5,5,-3,0,8,10,1,0,3,14,2),B(0,5,6,-3,0,9,12,1,0,3,16,2),B(0,6,6,-3,0,10,14,1,0,4,18,3),B(0,6,7,-4,0,11,15,1,0,4,20,3),B(0,7,8,-4,0,12,17,2,0,5,22,4),B(0,7,8,-4,0,13,19,2,0,5,24,4),B(0,7,9,-4,0,14,21,2,0,5,26,4),B(0,8,9,-5,0,15,22,2,0,6,28,5),B(0,8,10,-5,0,16,24,2,0,6,30,5),B(0,8,11,-5,0,17,26,2,0,6,32,5),B(0,9,11,-5,0,18,28,2,0,7,34,6),B(0,9,12,-6,0,19,29,2,0,7,36,6),B(0,10,13,-6,0,20,31,3,0,8,38,7),B(0,10,13,-6,0,21,33,3,0,8,40,7),B(0,10,14,-6,0,22,35,3,0,8,42,7),B(0,11,14,-7,0,23,36,3,0,9,44,8),B(0,11,15,-7,0,24,38,3,0,9,46,8)];let H=["duration","easing","delay"],j={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},G={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function V(e){return"".concat(Math.round(e),"ms")}function q(e){if(!e)return 0;let t=e/36;return Math.round((4+15*t**.25+t/5)*10)}function W(e){let t=(0,n.Z)({},j,e.easing),r=(0,n.Z)({},G,e.duration),a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{duration:a=r.standard,easing:o=t.easeInOut,delay:s=0}=n;return(0,i.Z)(n,H),(Array.isArray(e)?e:[e]).map(e=>"".concat(e," ").concat("string"==typeof a?a:V(a)," ").concat(o," ").concat("string"==typeof s?s:V(s))).join(",")};return(0,n.Z)({getAutoHeightDuration:q,create:a},e,{easing:t,duration:r})}var Z={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};let X=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];var $=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var t=arguments.length,r=Array(t>1?t-1:0),d=1;d<t;d++)r[d-1]=arguments[d];let{mixins:h={},palette:p={},transitions:f={},typography:m={}}=e,g=(0,i.Z)(e,X);if(e.vars&&void 0===e.generateCssVars)throw Error((0,a.Z)(18));let y=R(p),v=(0,c.Z)(e),b=(0,o.Z)(v,{mixins:u(v.breakpoints,h),palette:y,shadows:z.slice(),typography:L(y,m),transitions:W(f),zIndex:(0,n.Z)({},Z)});return b=(0,o.Z)(b,g),(b=r.reduce((e,t)=>(0,o.Z)(e,t),b)).unstable_sxConfig=(0,n.Z)({},s.Z,null==g?void 0:g.unstable_sxConfig),b.unstable_sx=function(e){return(0,l.Z)({sx:e,theme:this})},b}},55201:function(e,t,r){"use strict";let n=(0,r(66075).Z)();t.Z=n},22166:function(e,t){"use strict";t.Z="$$material"},34765:function(e,t,r){"use strict";var n=r(99202);let i=e=>(0,n.Z)(e)&&"classes"!==e;t.Z=i},99202:function(e,t){"use strict";function r(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}t.Z=r},16210:function(e,t,r){"use strict";var n=r(93652),i=r(55201),a=r(22166),o=r(34765);let s=(0,n.ZP)({themeId:a.Z,defaultTheme:i.Z,rootShouldForwardProp:o.Z});t.ZP=s},31691:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}}),r(2265);var n=r(12720),i=r(55201),a=r(22166);function o(){let e=(0,n.Z)(i.Z);return e[a.Z]||e}},31090:function(e,t,r){"use strict";r.d(t,{C:function(){return i},n:function(){return n}});let n=e=>e.scrollTop;function i(e,t){var r,n;let{timeout:i,easing:a,style:o={}}=e;return{duration:null!=(r=o.transitionDuration)?r:"number"==typeof i?i:i[t.mode]||0,easing:null!=(n=o.transitionTimingFunction)?n:"object"==typeof a?a[t.mode]:a,delay:o.transitionDelay}}},85657:function(e,t,r){"use strict";var n=r(53004);t.Z=n.Z},94630:function(e,t,r){"use strict";r.d(t,{Z:function(){return _}});var n=r(1119),i=r(2265),a=r(74610),o=r(61994),s=r(20801),l=r(85657),c=r(37053),u=r(16210),d=r(94143),h=r(50738);function p(e){return(0,h.ZP)("MuiSvgIcon",e)}(0,d.Z)("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var f=r(57437);let m=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],g=e=>{let{color:t,fontSize:r,classes:n}=e,i={root:["root","inherit"!==t&&"color".concat((0,l.Z)(t)),"fontSize".concat((0,l.Z)(r))]};return(0,s.Z)(i,p,n)},y=(0,u.ZP)("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{let{ownerState:r}=e;return[t.root,"inherit"!==r.color&&t["color".concat((0,l.Z)(r.color))],t["fontSize".concat((0,l.Z)(r.fontSize))]]}})(e=>{var t,r,n,i,a,o,s,l,c,u,d,h,p;let{theme:f,ownerState:m}=e;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:m.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:null==(t=f.transitions)||null==(r=t.create)?void 0:r.call(t,"fill",{duration:null==(n=f.transitions)||null==(n=n.duration)?void 0:n.shorter}),fontSize:({inherit:"inherit",small:(null==(i=f.typography)||null==(a=i.pxToRem)?void 0:a.call(i,20))||"1.25rem",medium:(null==(o=f.typography)||null==(s=o.pxToRem)?void 0:s.call(o,24))||"1.5rem",large:(null==(l=f.typography)||null==(c=l.pxToRem)?void 0:c.call(l,35))||"2.1875rem"})[m.fontSize],color:null!=(u=null==(d=(f.vars||f).palette)||null==(d=d[m.color])?void 0:d.main)?u:({action:null==(h=(f.vars||f).palette)||null==(h=h.action)?void 0:h.active,disabled:null==(p=(f.vars||f).palette)||null==(p=p.action)?void 0:p.disabled,inherit:void 0})[m.color]}}),v=i.forwardRef(function(e,t){let r=(0,c.i)({props:e,name:"MuiSvgIcon"}),{children:s,className:l,color:u="inherit",component:d="svg",fontSize:h="medium",htmlColor:p,inheritViewBox:v=!1,titleAccess:b,viewBox:_="0 0 24 24"}=r,w=(0,a.Z)(r,m),S=i.isValidElement(s)&&"svg"===s.type,T=(0,n.Z)({},r,{color:u,component:d,fontSize:h,instanceFontSize:e.fontSize,inheritViewBox:v,viewBox:_,hasSvgAsChild:S}),x={};v||(x.viewBox=_);let E=g(T);return(0,f.jsxs)(y,(0,n.Z)({as:d,className:(0,o.Z)(E.root,l),focusable:"false",color:p,"aria-hidden":!b||void 0,role:b?"img":void 0,ref:t},x,w,S&&s.props,{ownerState:T,children:[S?s.props.children:s,b?(0,f.jsx)("title",{children:b}):null]}))});v.muiName="SvgIcon";var b=v;function _(e,t){function r(r,i){return(0,f.jsx)(b,(0,n.Z)({"data-testid":"".concat(t,"Icon"),ref:i},r,{children:e}))}return r.muiName=b.muiName,i.memo(i.forwardRef(r))}},9665:function(e,t,r){"use strict";var n=r(8659);t.Z=n.Z},60118:function(e,t,r){"use strict";var n=r(23947);t.Z=n.Z},2424:function(e,t,r){"use strict";var n=r(2005);t.Z=n.Z},18598:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}}),r(2265);var n=r(3146),i=r(57437);function a(e){return null==e||0===Object.keys(e).length}function o(e){let{styles:t,defaultTheme:r={}}=e,o="function"==typeof t?e=>t(a(e)?r:e):t;return(0,i.jsx)(n.xB,{styles:o})}},90702:function(e,t,r){"use strict";r.r(t),r.d(t,{GlobalStyles:function(){return C.Z},StyledEngineProvider:function(){return E},ThemeContext:function(){return i.T},css:function(){return _.iv},default:function(){return A},internal_processStyles:function(){return M},internal_serializeStyles:function(){return R},keyframes:function(){return _.F4}});var n=r(1119),i=r(25246),a=r(29896),o=r(24006),s=r(32820),l=r(2265),c=r(5772),u=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,d=(0,c.Z)(function(e){return u.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&91>e.charCodeAt(2)}),h=!1,p=d,f=function(e){return"theme"!==e},m=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?p:f},g=function(e,t,r){var n;if(t){var i=t.shouldForwardProp;n=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!=typeof n&&r&&(n=e.__emotion_forwardProp),n},y=function(e){var t=e.cache,r=e.serialized,n=e.isStringTag;return(0,s.hC)(t,r,n),(0,o.L)(function(){return(0,s.My)(t,r,n)}),null},v=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],b=(function e(t,r){var o,c,u=t.__emotion_real===t,d=u&&t.__emotion_base||t;void 0!==r&&(o=r.label,c=r.target);var p=g(t,r,u),f=p||m(d),v=!f("as");return function(){var b=arguments,_=u&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==o&&_.push("label:"+o+";"),null==b[0]||void 0===b[0].raw)_.push.apply(_,b);else{var w=b[0];_.push(w[0]);for(var S=b.length,T=1;T<S;T++)_.push(b[T],w[T])}var x=(0,i.w)(function(e,t,r){var n=v&&e.as||d,o="",u=[],h=e;if(null==e.theme){for(var g in h={},e)h[g]=e[g];h.theme=l.useContext(i.T)}"string"==typeof e.className?o=(0,s.fp)(t.registered,u,e.className):null!=e.className&&(o=e.className+" ");var b=(0,a.O)(_.concat(u),t.registered,h);o+=t.key+"-"+b.name,void 0!==c&&(o+=" "+c);var w=v&&void 0===p?m(n):f,S={};for(var T in e)(!v||"as"!==T)&&w(T)&&(S[T]=e[T]);return S.className=o,r&&(S.ref=r),l.createElement(l.Fragment,null,l.createElement(y,{cache:t,serialized:b,isStringTag:"string"==typeof n}),l.createElement(n,S))});return x.displayName=void 0!==o?o:"Styled("+("string"==typeof d?d:d.displayName||d.name||"Component")+")",x.defaultProps=t.defaultProps,x.__emotion_real=x,x.__emotion_base=d,x.__emotion_styles=_,x.__emotion_forwardProp=p,Object.defineProperty(x,"toString",{value:function(){return void 0===c&&h?"NO_COMPONENT_SELECTOR":"."+c}}),x.withComponent=function(t,i){return e(t,(0,n.Z)({},r,i,{shouldForwardProp:g(x,i,!0)})).apply(void 0,_)},x}}).bind(null);v.forEach(function(e){b[e]=b(e)});var _=r(3146),w=r(78242),S=r(57437);function T(e,t){let r=(0,w.Z)({key:"css",prepend:e});if(t){let e=r.insert;r.insert=function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return r[1].styles.match(/^@layer\s+[^{]*$/)||(r[1].styles="@layer mui {".concat(r[1].styles,"}")),e(...r)}}return r}let x=new Map;function E(e){let{injectFirst:t,enableCssLayer:r,children:n}=e,a=l.useMemo(()=>{let e="".concat(t,"-").concat(r);if("object"==typeof document&&x.has(e))return x.get(e);let n=T(t,r);return x.set(e,n),n},[t,r]);return t||r?(0,S.jsx)(i.C,{value:a,children:n}):n}var C=r(18598);function A(e,t){return b(e,t)}let M=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))},I=[];function R(e){return I[0]=e,(0,a.O)(I)}},14031:function(e,t,r){"use strict";var n,i=r(9973);n={value:!0},t.Fq=g,n=x,n=void 0,t._j=v,n=u,n=S,t.mi=m,n=f,n=l,n=p,t.$n=_,n=y,n=void 0,n=b,n=T,n=w,n=d,n=h;var a=i(r(47975)),o=i(r(88777));function s(e,t=0,r=1){return(0,o.default)(e,t,r)}function l(e){e=e.slice(1);let t=RegExp(`.{1,${e.length>=6?2:1}}`,"g"),r=e.match(t);return r&&1===r[0].length&&(r=r.map(e=>e+e)),r?`rgb${4===r.length?"a":""}(${r.map((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3).join(", ")})`:""}function c(e){let t=e.toString(16);return 1===t.length?`0${t}`:t}function u(e){let t;if(e.type)return e;if("#"===e.charAt(0))return u(l(e));let r=e.indexOf("("),n=e.substring(0,r);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw Error((0,a.default)(9,e));let i=e.substring(r+1,e.length-1);if("color"===n){if(t=(i=i.split(" ")).shift(),4===i.length&&"/"===i[3].charAt(0)&&(i[3]=i[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(t))throw Error((0,a.default)(10,t))}else i=i.split(",");return{type:n,values:i=i.map(e=>parseFloat(e)),colorSpace:t}}function d(e){let{type:t,colorSpace:r}=e,{values:n}=e;return -1!==t.indexOf("rgb")?n=n.map((e,t)=>t<3?parseInt(e,10):e):-1!==t.indexOf("hsl")&&(n[1]=`${n[1]}%`,n[2]=`${n[2]}%`),n=-1!==t.indexOf("color")?`${r} ${n.join(" ")}`:`${n.join(", ")}`,`${t}(${n})`}function h(e){if(0===e.indexOf("#"))return e;let{values:t}=u(e);return`#${t.map((e,t)=>c(3===t?Math.round(255*e):e)).join("")}`}function p(e){let{values:t}=e=u(e),r=t[0],n=t[1]/100,i=t[2]/100,a=n*Math.min(i,1-i),o=(e,t=(e+r/30)%12)=>i-a*Math.max(Math.min(t-3,9-t,1),-1),s="rgb",l=[Math.round(255*o(0)),Math.round(255*o(8)),Math.round(255*o(4))];return"hsla"===e.type&&(s+="a",l.push(t[3])),d({type:s,values:l})}function f(e){let t="hsl"===(e=u(e)).type||"hsla"===e.type?u(p(e)).values:e.values;return Number((.2126*(t=t.map(t=>("color"!==e.type&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4)))[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function m(e,t){let r=f(e),n=f(t);return(Math.max(r,n)+.05)/(Math.min(r,n)+.05)}function g(e,t){return e=u(e),t=s(t),("rgb"===e.type||"hsl"===e.type)&&(e.type+="a"),"color"===e.type?e.values[3]=`/${t}`:e.values[3]=t,d(e)}function y(e,t,r){try{return g(e,t)}catch(t){return e}}function v(e,t){if(e=u(e),t=s(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(let r=0;r<3;r+=1)e.values[r]*=1-t;return d(e)}function b(e,t,r){try{return v(e,t)}catch(t){return e}}function _(e,t){if(e=u(e),t=s(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(let r=0;r<3;r+=1)e.values[r]+=(255-e.values[r])*t;else if(-1!==e.type.indexOf("color"))for(let r=0;r<3;r+=1)e.values[r]+=(1-e.values[r])*t;return d(e)}function w(e,t,r){try{return _(e,t)}catch(t){return e}}function S(e,t=.15){return f(e)>.5?v(e,t):_(e,t)}function T(e,t,r){try{return S(e,t)}catch(t){return e}}function x(e,t,r,n=1){let i=(e,t)=>Math.round((e**(1/n)*(1-r)+t**(1/n)*r)**n),a=u(e),o=u(t);return d({type:"rgb",values:[i(a.values[0],o.values[0]),i(a.values[1],o.values[1]),i(a.values[2],o.values[2])]})}},93652:function(e,t,r){"use strict";var n,i=r(9973);n={value:!0},t.ZP=E,n=v,n=void 0;var a=i(r(12722)),o=i(r(63916)),s=m(r(90702)),l=r(17393);i(r(38573)),i(r(66627));var c=i(r(12792)),u=i(r(8492));let d=["ownerState"],h=["variants"],p=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(f=function(e){return e?r:t})(e)}function m(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=f(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function g(e){return 0===Object.keys(e).length}function y(e){return"string"==typeof e&&e.charCodeAt(0)>96}function v(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}function b(e,t){return t&&e&&"object"==typeof e&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${t}{${String(e.styles)}}`),e}let _=n=(0,c.default)(),w=e=>e?e.charAt(0).toLowerCase()+e.slice(1):e;function S({defaultTheme:e,theme:t,themeId:r}){return g(t)?e:t[r]||t}function T(e){return e?(t,r)=>r[e]:null}function x(e,t,r){let{ownerState:n}=t,i=(0,o.default)(t,d),l="function"==typeof e?e((0,a.default)({ownerState:n},i)):e;if(Array.isArray(l))return l.flatMap(e=>x(e,(0,a.default)({ownerState:n},i),r));if(l&&"object"==typeof l&&Array.isArray(l.variants)){let{variants:e=[]}=l,t=(0,o.default)(l,h);return e.forEach(e=>{let o=!0;if("function"==typeof e.props?o=e.props((0,a.default)({ownerState:n},i,n)):Object.keys(e.props).forEach(t=>{(null==n?void 0:n[t])!==e.props[t]&&i[t]!==e.props[t]&&(o=!1)}),o){Array.isArray(t)||(t=[t]);let o="function"==typeof e.style?e.style((0,a.default)({ownerState:n},i,n)):e.style;t.push(r?b((0,s.internal_serializeStyles)(o),r):o)}}),t}return r?b((0,s.internal_serializeStyles)(l),r):l}function E(e={}){let{themeId:t,defaultTheme:r=_,rootShouldForwardProp:n=v,slotShouldForwardProp:i=v}=e,c=e=>(0,u.default)((0,a.default)({},e,{theme:S((0,a.default)({},e,{defaultTheme:r,themeId:t}))}));return c.__mui_systemSx=!0,(e,u={})=>{let d;(0,s.internal_processStyles)(e,e=>e.filter(e=>!(null!=e&&e.__mui_systemSx)));let{name:h,slot:f,skipVariantsResolver:m,skipSx:g,overridesResolver:b=T(w(f))}=u,_=(0,o.default)(u,p),E=h&&h.startsWith("Mui")||f?"components":"custom",C=void 0!==m?m:f&&"Root"!==f&&"root"!==f||!1,A=g||!1,M=v;"Root"===f||"root"===f?M=n:f?M=i:y(e)&&(M=void 0);let I=(0,s.default)(e,(0,a.default)({shouldForwardProp:M,label:d},_)),R=e=>"function"==typeof e&&e.__emotion_real!==e||(0,l.isPlainObject)(e)?n=>{let i=S({theme:n.theme,defaultTheme:r,themeId:t});return x(e,(0,a.default)({},n,{theme:i}),i.modularCssLayers?E:void 0)}:e,k=(n,...i)=>{let o=R(n),s=i?i.map(R):[];h&&b&&s.push(e=>{let n=S((0,a.default)({},e,{defaultTheme:r,themeId:t}));if(!n.components||!n.components[h]||!n.components[h].styleOverrides)return null;let i=n.components[h].styleOverrides,o={};return Object.entries(i).forEach(([t,r])=>{o[t]=x(r,(0,a.default)({},e,{theme:n}),n.modularCssLayers?"theme":void 0)}),b(e,o)}),h&&!C&&s.push(e=>{var n;let i=S((0,a.default)({},e,{defaultTheme:r,themeId:t}));return x({variants:null==i||null==(n=i.components)||null==(n=n[h])?void 0:n.variants},(0,a.default)({},e,{theme:i}),i.modularCssLayers?"theme":void 0)}),A||s.push(c);let l=s.length-i.length;if(Array.isArray(n)&&l>0){let e=Array(l).fill("");(o=[...n,...e]).raw=[...n.raw,...e]}let u=I(o,...s);return e.muiName&&(u.muiName=e.muiName),u};return I.withConfig&&(k.withConfig=I.withConfig),k}}},17804:function(e,t,r){"use strict";r.d(t,{i:function(){return c}});var n=r(2265),i=r(53232),a=r(57437);let o=n.createContext(void 0);function s(e){let{value:t,children:r}=e;return(0,a.jsx)(o.Provider,{value:t,children:r})}function l(e){let{theme:t,name:r,props:n}=e;if(!t||!t.components||!t.components[r])return n;let a=t.components[r];return a.defaultProps?(0,i.Z)(a.defaultProps,n):a.styleOverrides||a.variants?n:(0,i.Z)(a,n)}function c(e){let{props:t,name:r}=e;return l({props:t,name:r,theme:{components:n.useContext(o)}})}t.Z=s},21075:function(e,t,r){"use strict";r(2265);var n=r(90702),i=r(18598),a=r(12720),o=r(57437);function s(e){let t=(0,n.internal_serializeStyles)(e);return e!==t&&t.styles?(t.styles.match(/^@layer\s+[^{]*$/)||(t.styles="@layer global{".concat(t.styles,"}")),t):e}function l(e){let{styles:t,themeId:r,defaultTheme:n={}}=e,l=(0,a.Z)(n),c=r&&l[r]||l,u="function"==typeof t?t(c):t;return c.modularCssLayers&&(u=Array.isArray(u)?u.map(e=>"function"==typeof e?s(e(c)):s(e)):s(u)),(0,o.jsx)(i.Z,{styles:u})}t.Z=l},77126:function(e,t,r){"use strict";r.d(t,{V:function(){return u}});var n=r(1119),i=r(74610),a=r(2265),o=r(57437);let s=["value"],l=a.createContext();function c(e){let{value:t}=e,r=(0,i.Z)(e,s);return(0,o.jsx)(l.Provider,(0,n.Z)({value:null==t||t},r))}let u=()=>{let e=a.useContext(l);return null!=e&&e};t.Z=c},80990:function(e,t,r){"use strict";r.d(t,{L7:function(){return s},VO:function(){return n},W8:function(){return o},k9:function(){return a}});let n={xs:0,sm:600,md:900,lg:1200,xl:1536},i={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${n[e]}px)`};function a(e,t,r){let a=e.theme||{};if(Array.isArray(t)){let e=a.breakpoints||i;return t.reduce((n,i,a)=>(n[e.up(e.keys[a])]=r(t[a]),n),{})}if("object"==typeof t){let e=a.breakpoints||i;return Object.keys(t).reduce((i,a)=>{if(-1!==Object.keys(e.values||n).indexOf(a))i[e.up(a)]=r(t[a],a);else{let e=a;i[e]=t[e]}return i},{})}return r(t)}function o(e={}){var t;return(null==(t=e.keys)?void 0:t.reduce((t,r)=>(t[e.up(r)]={},t),{}))||{}}function s(e,t){return e.reduce((e,t)=>{let r=e[t];return r&&0!==Object.keys(r).length||delete e[t],e},t)}},88064:function(e,t,r){"use strict";r.d(t,{Fq:function(){return c}});var n=r(80399),i=r(11189);function a(e,t=0,r=1){return(0,i.Z)(e,t,r)}function o(e){e=e.slice(1);let t=RegExp(`.{1,${e.length>=6?2:1}}`,"g"),r=e.match(t);return r&&1===r[0].length&&(r=r.map(e=>e+e)),r?`rgb${4===r.length?"a":""}(${r.map((e,t)=>t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3).join(", ")})`:""}function s(e){let t;if(e.type)return e;if("#"===e.charAt(0))return s(o(e));let r=e.indexOf("("),i=e.substring(0,r);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(i))throw Error((0,n.Z)(9,e));let a=e.substring(r+1,e.length-1);if("color"===i){if(t=(a=a.split(" ")).shift(),4===a.length&&"/"===a[3].charAt(0)&&(a[3]=a[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(t))throw Error((0,n.Z)(10,t))}else a=a.split(",");return{type:i,values:a=a.map(e=>parseFloat(e)),colorSpace:t}}function l(e){let{type:t,colorSpace:r}=e,{values:n}=e;return -1!==t.indexOf("rgb")?n=n.map((e,t)=>t<3?parseInt(e,10):e):-1!==t.indexOf("hsl")&&(n[1]=`${n[1]}%`,n[2]=`${n[2]}%`),n=-1!==t.indexOf("color")?`${r} ${n.join(" ")}`:`${n.join(", ")}`,`${t}(${n})`}function c(e,t){return e=s(e),t=a(t),("rgb"===e.type||"hsl"===e.type)&&(e.type+="a"),"color"===e.type?e.values[3]=`/${t}`:e.values[3]=t,l(e)}},79281:function(e,t,r){"use strict";function n(e,t){let r=this;return r.vars&&"function"==typeof r.getColorSchemeSelector?{[r.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)")]:t}:r.palette.mode===e?t:{}}r.d(t,{Z:function(){return n}})},51324:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(74610),i=r(1119);let a=["values","unit","step"],o=e=>{let t=Object.keys(e).map(t=>({key:t,val:e[t]}))||[];return t.sort((e,t)=>e.val-t.val),t.reduce((e,t)=>(0,i.Z)({},e,{[t.key]:t.val}),{})};function s(e){let{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:r="px",step:s=5}=e,l=(0,n.Z)(e,a),c=o(t),u=Object.keys(c);function d(e){let n="number"==typeof t[e]?t[e]:e;return`@media (min-width:${n}${r})`}function h(e){let n="number"==typeof t[e]?t[e]:e;return`@media (max-width:${n-s/100}${r})`}function p(e,n){let i=u.indexOf(n);return`@media (min-width:${"number"==typeof t[e]?t[e]:e}${r}) and (max-width:${(-1!==i&&"number"==typeof t[u[i]]?t[u[i]]:n)-s/100}${r})`}function f(e){return u.indexOf(e)+1<u.length?p(e,u[u.indexOf(e)+1]):d(e)}function m(e){let t=u.indexOf(e);return 0===t?d(u[1]):t===u.length-1?h(u[t]):p(e,u[u.indexOf(e)+1]).replace("@media","@media not all and")}return(0,i.Z)({keys:u,values:c,up:d,down:h,between:p,only:f,not:m,unit:r},l)}},35680:function(e,t,r){"use strict";r.d(t,{Z:function(){return f}});var n=r(1119),i=r(74610),a=r(87354),o=r(51324),s={borderRadius:4},l=r(66167);function c(e=8){if(e.mui)return e;let t=(0,l.hB)({spacing:e}),r=(...e)=>(0===e.length?[1]:e).map(e=>{let r=t(e);return"number"==typeof r?`${r}px`:r}).join(" ");return r.mui=!0,r}var u=r(38720),d=r(96445),h=r(79281);let p=["breakpoints","palette","spacing","shape"];var f=function(e={},...t){let{breakpoints:r={},palette:l={},spacing:f,shape:m={}}=e,g=(0,i.Z)(e,p),y=(0,o.Z)(r),v=c(f),b=(0,a.Z)({breakpoints:y,direction:"ltr",components:{},palette:(0,n.Z)({mode:"light"},l),spacing:v,shape:(0,n.Z)({},s,m)},g);return b.applyStyles=h.Z,(b=t.reduce((e,t)=>(0,a.Z)(e,t),b)).unstable_sxConfig=(0,n.Z)({},d.Z,null==g?void 0:g.unstable_sxConfig),b.unstable_sx=function(e){return(0,u.Z)({sx:e,theme:this})},b}},12792:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return n.Z},private_createBreakpoints:function(){return i.Z},unstable_applyStyles:function(){return a.Z}});var n=r(35680),i=r(51324),a=r(79281)},14394:function(e,t,r){"use strict";var n=r(87354);function i(e,t){return t?(0,n.Z)(e,t,{clone:!1}):e}t.Z=i},66167:function(e,t,r){"use strict";r.d(t,{hB:function(){return f},eI:function(){return p},NA:function(){return m},e6:function(){return b},o3:function(){return _}});var n=r(80990),i=r(36084),a=r(14394);let o={m:"margin",p:"padding"},s={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},l={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},c=function(e){let t={};return r=>(void 0===t[r]&&(t[r]=e(r)),t[r])}(e=>{if(e.length>2){if(!l[e])return[e];e=l[e]}let[t,r]=e.split(""),n=o[t],i=s[r]||"";return Array.isArray(i)?i.map(e=>n+e):[n+i]}),u=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],d=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],h=[...u,...d];function p(e,t,r,n){var a;let o=null!=(a=(0,i.DW)(e,t,!1))?a:r;return"number"==typeof o?e=>"string"==typeof e?e:o*e:Array.isArray(o)?e=>"string"==typeof e?e:o[e]:"function"==typeof o?o:()=>void 0}function f(e){return p(e,"spacing",8,"spacing")}function m(e,t){if("string"==typeof t||null==t)return t;let r=e(Math.abs(t));return t>=0?r:"number"==typeof r?-r:`-${r}`}function g(e,t){return r=>e.reduce((e,n)=>(e[n]=m(t,r),e),{})}function y(e,t,r,i){if(-1===t.indexOf(r))return null;let a=g(c(r),i),o=e[r];return(0,n.k9)(e,o,a)}function v(e,t){let r=f(e.theme);return Object.keys(e).map(n=>y(e,t,n,r)).reduce(a.Z,{})}function b(e){return v(e,u)}function _(e){return v(e,d)}function w(e){return v(e,h)}b.propTypes={},b.filterProps=u,_.propTypes={},_.filterProps=d,w.propTypes={},w.filterProps=h},36084:function(e,t,r){"use strict";r.d(t,{DW:function(){return a},Jq:function(){return o}});var n=r(53004),i=r(80990);function a(e,t,r=!0){if(!t||"string"!=typeof t)return null;if(e&&e.vars&&r){let r=`vars.${t}`.split(".").reduce((e,t)=>e&&e[t]?e[t]:null,e);if(null!=r)return r}return t.split(".").reduce((e,t)=>e&&null!=e[t]?e[t]:null,e)}function o(e,t,r,n=r){let i;return i="function"==typeof e?e(r):Array.isArray(e)?e[r]||n:a(e,r)||n,t&&(i=t(i,n,e)),i}function s(e){let{prop:t,cssProperty:r=e.prop,themeKey:s,transform:l}=e,c=e=>{if(null==e[t])return null;let c=e[t],u=a(e.theme,s)||{},d=e=>{let i=o(u,l,e);return(e===i&&"string"==typeof e&&(i=o(u,l,`${t}${"default"===e?"":(0,n.Z)(e)}`,e)),!1===r)?i:{[r]:i}};return(0,i.k9)(e,c,d)};return c.propTypes={},c.filterProps=[t],c}t.ZP=s},96445:function(e,t,r){"use strict";r.d(t,{Z:function(){return z}});var n=r(66167),i=r(36084),a=r(14394),o=function(...e){let t=e.reduce((e,t)=>(t.filterProps.forEach(r=>{e[r]=t}),e),{}),r=e=>Object.keys(e).reduce((r,n)=>t[n]?(0,a.Z)(r,t[n](e)):r,{});return r.propTypes={},r.filterProps=e.reduce((e,t)=>e.concat(t.filterProps),[]),r},s=r(80990);function l(e){return"number"!=typeof e?e:`${e}px solid`}function c(e,t){return(0,i.ZP)({prop:e,themeKey:"borders",transform:t})}let u=c("border",l),d=c("borderTop",l),h=c("borderRight",l),p=c("borderBottom",l),f=c("borderLeft",l),m=c("borderColor"),g=c("borderTopColor"),y=c("borderRightColor"),v=c("borderBottomColor"),b=c("borderLeftColor"),_=c("outline",l),w=c("outlineColor"),S=e=>{if(void 0!==e.borderRadius&&null!==e.borderRadius){let t=(0,n.eI)(e.theme,"shape.borderRadius",4,"borderRadius"),r=e=>({borderRadius:(0,n.NA)(t,e)});return(0,s.k9)(e,e.borderRadius,r)}return null};S.propTypes={},S.filterProps=["borderRadius"],o(u,d,h,p,f,m,g,y,v,b,S,_,w);let T=e=>{if(void 0!==e.gap&&null!==e.gap){let t=(0,n.eI)(e.theme,"spacing",8,"gap"),r=e=>({gap:(0,n.NA)(t,e)});return(0,s.k9)(e,e.gap,r)}return null};T.propTypes={},T.filterProps=["gap"];let x=e=>{if(void 0!==e.columnGap&&null!==e.columnGap){let t=(0,n.eI)(e.theme,"spacing",8,"columnGap"),r=e=>({columnGap:(0,n.NA)(t,e)});return(0,s.k9)(e,e.columnGap,r)}return null};x.propTypes={},x.filterProps=["columnGap"];let E=e=>{if(void 0!==e.rowGap&&null!==e.rowGap){let t=(0,n.eI)(e.theme,"spacing",8,"rowGap"),r=e=>({rowGap:(0,n.NA)(t,e)});return(0,s.k9)(e,e.rowGap,r)}return null};E.propTypes={},E.filterProps=["rowGap"];let C=(0,i.ZP)({prop:"gridColumn"}),A=(0,i.ZP)({prop:"gridRow"}),M=(0,i.ZP)({prop:"gridAutoFlow"}),I=(0,i.ZP)({prop:"gridAutoColumns"}),R=(0,i.ZP)({prop:"gridAutoRows"}),k=(0,i.ZP)({prop:"gridTemplateColumns"});function P(e,t){return"grey"===t?t:e}function O(e){return e<=1&&0!==e?`${100*e}%`:e}o(T,x,E,C,A,M,I,R,k,(0,i.ZP)({prop:"gridTemplateRows"}),(0,i.ZP)({prop:"gridTemplateAreas"}),(0,i.ZP)({prop:"gridArea"})),o((0,i.ZP)({prop:"color",themeKey:"palette",transform:P}),(0,i.ZP)({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:P}),(0,i.ZP)({prop:"backgroundColor",themeKey:"palette",transform:P}));let N=(0,i.ZP)({prop:"width",transform:O}),L=e=>{if(void 0!==e.maxWidth&&null!==e.maxWidth){let t=t=>{var r,n;let i=(null==(r=e.theme)||null==(r=r.breakpoints)||null==(r=r.values)?void 0:r[t])||s.VO[t];return i?(null==(n=e.theme)||null==(n=n.breakpoints)?void 0:n.unit)!=="px"?{maxWidth:`${i}${e.theme.breakpoints.unit}`}:{maxWidth:i}:{maxWidth:O(t)}};return(0,s.k9)(e,e.maxWidth,t)}return null};L.filterProps=["maxWidth"];let D=(0,i.ZP)({prop:"minWidth",transform:O}),U=(0,i.ZP)({prop:"height",transform:O}),F=(0,i.ZP)({prop:"maxHeight",transform:O}),B=(0,i.ZP)({prop:"minHeight",transform:O});(0,i.ZP)({prop:"size",cssProperty:"width",transform:O}),(0,i.ZP)({prop:"size",cssProperty:"height",transform:O}),o(N,L,D,U,F,B,(0,i.ZP)({prop:"boxSizing"}));var z={border:{themeKey:"borders",transform:l},borderTop:{themeKey:"borders",transform:l},borderRight:{themeKey:"borders",transform:l},borderBottom:{themeKey:"borders",transform:l},borderLeft:{themeKey:"borders",transform:l},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:l},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:S},color:{themeKey:"palette",transform:P},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:P},backgroundColor:{themeKey:"palette",transform:P},p:{style:n.o3},pt:{style:n.o3},pr:{style:n.o3},pb:{style:n.o3},pl:{style:n.o3},px:{style:n.o3},py:{style:n.o3},padding:{style:n.o3},paddingTop:{style:n.o3},paddingRight:{style:n.o3},paddingBottom:{style:n.o3},paddingLeft:{style:n.o3},paddingX:{style:n.o3},paddingY:{style:n.o3},paddingInline:{style:n.o3},paddingInlineStart:{style:n.o3},paddingInlineEnd:{style:n.o3},paddingBlock:{style:n.o3},paddingBlockStart:{style:n.o3},paddingBlockEnd:{style:n.o3},m:{style:n.e6},mt:{style:n.e6},mr:{style:n.e6},mb:{style:n.e6},ml:{style:n.e6},mx:{style:n.e6},my:{style:n.e6},margin:{style:n.e6},marginTop:{style:n.e6},marginRight:{style:n.e6},marginBottom:{style:n.e6},marginLeft:{style:n.e6},marginX:{style:n.e6},marginY:{style:n.e6},marginInline:{style:n.e6},marginInlineStart:{style:n.e6},marginInlineEnd:{style:n.e6},marginBlock:{style:n.e6},marginBlockStart:{style:n.e6},marginBlockEnd:{style:n.e6},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:T},rowGap:{style:E},columnGap:{style:x},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:O},maxWidth:{style:L},minWidth:{transform:O},height:{transform:O},maxHeight:{transform:O},minHeight:{transform:O},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}}},95086:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(1119),i=r(74610),a=r(87354),o=r(96445);let s=["sx"],l=e=>{var t,r;let n={systemProps:{},otherProps:{}},i=null!=(t=null==e||null==(r=e.theme)?void 0:r.unstable_sxConfig)?t:o.Z;return Object.keys(e).forEach(t=>{i[t]?n.systemProps[t]=e[t]:n.otherProps[t]=e[t]}),n};function c(e){let t;let{sx:r}=e,{systemProps:o,otherProps:c}=l((0,i.Z)(e,s));return t=Array.isArray(r)?[o,...r]:"function"==typeof r?(...e)=>{let t=r(...e);return(0,a.P)(t)?(0,n.Z)({},o,t):o}:(0,n.Z)({},o,r),(0,n.Z)({},c,{sx:t})}},8492:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return n.Z},extendSxProp:function(){return i.Z},unstable_createStyleFunctionSx:function(){return n.n},unstable_defaultSxConfig:function(){return a.Z}});var n=r(38720),i=r(95086),a=r(96445)},38720:function(e,t,r){"use strict";r.d(t,{n:function(){return u}});var n=r(53004),i=r(14394),a=r(36084),o=r(80990),s=r(96445);function l(...e){let t=new Set(e.reduce((e,t)=>e.concat(Object.keys(t)),[]));return e.every(e=>t.size===Object.keys(e).length)}function c(e,t){return"function"==typeof e?e(t):e}function u(){function e(e,t,r,i){let s={[e]:t,theme:r},l=i[e];if(!l)return{[e]:t};let{cssProperty:c=e,themeKey:u,transform:d,style:h}=l;if(null==t)return null;if("typography"===u&&"inherit"===t)return{[e]:t};let p=(0,a.DW)(r,u)||{};if(h)return h(s);let f=t=>{let r=(0,a.Jq)(p,d,t);return(t===r&&"string"==typeof t&&(r=(0,a.Jq)(p,d,`${e}${"default"===t?"":(0,n.Z)(t)}`,t)),!1===c)?r:{[c]:r}};return(0,o.k9)(s,t,f)}function t(r){var n;let{sx:a,theme:u={},nested:d}=r||{};if(!a)return null;let h=null!=(n=u.unstable_sxConfig)?n:s.Z;function p(r){let n=r;if("function"==typeof r)n=r(u);else if("object"!=typeof r)return r;if(!n)return null;let a=(0,o.W8)(u.breakpoints),s=Object.keys(a),p=a;return(Object.keys(n).forEach(r=>{let a=c(n[r],u);if(null!=a){if("object"==typeof a){if(h[r])p=(0,i.Z)(p,e(r,a,u,h));else{let e=(0,o.k9)({theme:u},a,e=>({[r]:e}));l(e,a)?p[r]=t({sx:a,theme:u,nested:!0}):p=(0,i.Z)(p,e)}}else p=(0,i.Z)(p,e(r,a,u,h))}}),!d&&u.modularCssLayers)?{"@layer sx":(0,o.L7)(s,p)}:(0,o.L7)(s,p)}return Array.isArray(a)?a.map(p):p(a)}return t}let d=u();d.filterProps=["sx"],t.Z=d},12720:function(e,t,r){"use strict";var n=r(35680),i=r(62570);let a=(0,n.Z)();function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return(0,i.Z)(e)}t.Z=o},62570:function(e,t,r){"use strict";var n=r(2265),i=r(25246);function a(e){return 0===Object.keys(e).length}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=n.useContext(i.T);return!t||a(t)?e:t}t.Z=o},56063:function(e,t){"use strict";let r=e=>e,n=(()=>{let e=r;return{configure(t){e=t},generate:t=>e(t),reset(){e=r}}})();t.Z=n},4250:function(e,t,r){"use strict";var n=r(1119),i=r(27835);function a(e,t,r){return void 0===e||(0,i.Z)(e)?t:(0,n.Z)({},t,{ownerState:(0,n.Z)({},t.ownerState,r)})}t.Z=a},53004:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(80399);function i(e){if("string"!=typeof e)throw Error((0,n.Z)(7));return e.charAt(0).toUpperCase()+e.slice(1)}},38573:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return n.Z}});var n=r(53004)},11189:function(e,t){"use strict";function r(e,t=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,r))}t.Z=r},88777:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return n.Z}});var n=r(11189)},20801:function(e,t,r){"use strict";function n(e,t,r){let n={};return Object.keys(e).forEach(i=>{n[i]=e[i].reduce((e,n)=>{if(n){let i=t(n);""!==i&&e.push(i),r&&r[n]&&e.push(r[n])}return e},[]).join(" ")}),n}r.d(t,{Z:function(){return n}})},87354:function(e,t,r){"use strict";r.d(t,{P:function(){return a},Z:function(){return s}});var n=r(1119),i=r(2265);function a(e){if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function o(e){if(i.isValidElement(e)||!a(e))return e;let t={};return Object.keys(e).forEach(r=>{t[r]=o(e[r])}),t}function s(e,t,r={clone:!0}){let l=r.clone?(0,n.Z)({},e):e;return a(e)&&a(t)&&Object.keys(t).forEach(n=>{i.isValidElement(t[n])?l[n]=t[n]:a(t[n])&&Object.prototype.hasOwnProperty.call(e,n)&&a(e[n])?l[n]=s(e[n],t[n],r):r.clone?l[n]=a(t[n])?o(t[n]):t[n]:l[n]=t[n]}),l}},17393:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return n.Z},isPlainObject:function(){return n.P}});var n=r(87354)},44393:function(e,t){"use strict";function r(e,t=[]){if(void 0===e)return{};let r={};return Object.keys(e).filter(r=>r.match(/^on[A-Z]/)&&"function"==typeof e[r]&&!t.includes(r)).forEach(t=>{r[t]=e[t]}),r}t.Z=r},80399:function(e,t,r){"use strict";function n(e){let t="https://mui.com/production-error/?code="+e;for(let e=1;e<arguments.length;e+=1)t+="&args[]="+encodeURIComponent(arguments[e]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}r.d(t,{Z:function(){return n}})},47975:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return n.Z}});var n=r(80399)},50738:function(e,t,r){"use strict";r.d(t,{ZP:function(){return a}});var n=r(56063);let i={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function a(e,t,r="Mui"){let a=i[t];return a?`${r}-${a}`:`${n.Z.generate(e)}-${t}`}},94143:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(50738);function i(e,t,r="Mui"){let i={};return t.forEach(t=>{i[t]=(0,n.ZP)(e,t,r)}),i}},66627:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l},getFunctionName:function(){return a}});var n=r(59679);let i=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function a(e){let t=`${e}`.match(i);return t&&t[1]||""}function o(e,t=""){return e.displayName||e.name||a(e)||t}function s(e,t,r){let n=o(t);return e.displayName||(""!==n?`${r}(${n})`:r)}function l(e){if(null!=e){if("string"==typeof e)return e;if("function"==typeof e)return o(e,"Component");if("object"==typeof e)switch(e.$$typeof){case n.A4:return s(e,e.render,"ForwardRef");case n._Y:return s(e,e.type,"memo")}}}},30628:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(2265);function i(e){if(parseInt(n.version,10)>=19){var t;return(null==e||null==(t=e.props)?void 0:t.ref)||null}return(null==e?void 0:e.ref)||null}},27835:function(e,t){"use strict";function r(e){return"string"==typeof e}t.Z=r},73810:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(1119),i=r(61994),a=r(44393),o=function(e){if(void 0===e)return{};let t={};return Object.keys(e).filter(t=>!(t.match(/^on[A-Z]/)&&"function"==typeof e[t])).forEach(r=>{t[r]=e[r]}),t},s=function(e){let{getSlotProps:t,additionalProps:r,externalSlotProps:s,externalForwardedProps:l,className:c}=e;if(!t){let e=(0,i.Z)(null==r?void 0:r.className,c,null==l?void 0:l.className,null==s?void 0:s.className),t=(0,n.Z)({},null==r?void 0:r.style,null==l?void 0:l.style,null==s?void 0:s.style),a=(0,n.Z)({},r,l,s);return e.length>0&&(a.className=e),Object.keys(t).length>0&&(a.style=t),{props:a,internalRef:void 0}}let u=(0,a.Z)((0,n.Z)({},l,s)),d=o(s),h=o(l),p=t(u),f=(0,i.Z)(null==p?void 0:p.className,null==r?void 0:r.className,c,null==l?void 0:l.className,null==s?void 0:s.className),m=(0,n.Z)({},null==p?void 0:p.style,null==r?void 0:r.style,null==l?void 0:l.style,null==s?void 0:s.style),g=(0,n.Z)({},p,r,h,d);return f.length>0&&(g.className=f),Object.keys(m).length>0&&(g.style=m),{props:g,internalRef:p.ref}}},72786:function(e,t,r){"use strict";function n(e){return e&&e.ownerDocument||document}r.d(t,{Z:function(){return n}})},13366:function(e,t){"use strict";function r(e,t,r){return"function"==typeof e?e(t,r):e}t.Z=r},53232:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(1119);function i(e,t){let r=(0,n.Z)({},t);return Object.keys(e).forEach(a=>{if(a.toString().match(/^(components|slots)$/))r[a]=(0,n.Z)({},e[a],r[a]);else if(a.toString().match(/^(componentsProps|slotProps)$/)){let o=e[a]||{},s=t[a];r[a]={},s&&Object.keys(s)?o&&Object.keys(o)?(r[a]=(0,n.Z)({},s),Object.keys(o).forEach(e=>{r[a][e]=i(o[e],s[e])})):r[a]=s:r[a]=o}else void 0===r[a]&&(r[a]=e[a])}),r}},29419:function(e,t,r){"use strict";function n(e,t){"function"==typeof e?e(t):e&&(e.current=t)}r.d(t,{Z:function(){return n}})},38462:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(2265);function i(e){let{controlled:t,default:r,name:i,state:a="value"}=e,{current:o}=n.useRef(void 0!==t),[s,l]=n.useState(r);return[o?t:s,n.useCallback(e=>{o||l(e)},[])]}},3450:function(e,t,r){"use strict";var n=r(2265);let i="undefined"!=typeof window?n.useLayoutEffect:n.useEffect;t.Z=i},8659:function(e,t,r){"use strict";var n=r(2265),i=r(3450);function a(e){let t=n.useRef(e);return(0,i.Z)(()=>{t.current=e}),n.useRef(function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return(0,t.current)(...r)}).current}t.Z=a},23947:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(2265),i=r(29419);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.useMemo(()=>t.every(e=>null==e)?null:e=>{t.forEach(t=>{(0,i.Z)(t,e)})},t)}},53025:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n,i=r(2265);let a=0;function o(e){let[t,r]=i.useState(e),n=e||t;return i.useEffect(()=>{null==t&&(a+=1,r("mui-".concat(a)))},[t]),n}let s=(n||(n=r.t(i,2)))["useId".toString()];function l(e){if(void 0!==s){let t=s();return null!=e?e:t}return o(e)}},2005:function(e,t,r){"use strict";r.d(t,{Z:function(){return m}});var n=r(2265),i=r(96375);let a=!0,o=!1,s=new i.V,l={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function c(e){let{type:t,tagName:r}=e;return"INPUT"===r&&!!l[t]&&!e.readOnly||"TEXTAREA"===r&&!e.readOnly||!!e.isContentEditable}function u(e){e.metaKey||e.altKey||e.ctrlKey||(a=!0)}function d(){a=!1}function h(){"hidden"===this.visibilityState&&o&&(a=!0)}function p(e){e.addEventListener("keydown",u,!0),e.addEventListener("mousedown",d,!0),e.addEventListener("pointerdown",d,!0),e.addEventListener("touchstart",d,!0),e.addEventListener("visibilitychange",h,!0)}function f(e){let{target:t}=e;try{return t.matches(":focus-visible")}catch(e){}return a||c(t)}function m(){let e=n.useCallback(e=>{null!=e&&p(e.ownerDocument)},[]),t=n.useRef(!1);function r(){return!!t.current&&(o=!0,s.start(100,()=>{o=!1}),t.current=!1,!0)}function i(e){return!!f(e)&&(t.current=!0,!0)}return{isFocusVisibleRef:t,onFocus:i,onBlur:r,ref:e}}},15988:function(e,t,r){"use strict";var n=r(1119),i=r(74610),a=r(23947),o=r(4250),s=r(73810),l=r(13366);let c=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function u(e){var t;let{elementType:r,externalSlotProps:u,ownerState:d,skipResolvingSlotProps:h=!1}=e,p=(0,i.Z)(e,c),f=h?{}:(0,l.Z)(u,d),{props:m,internalRef:g}=(0,s.Z)((0,n.Z)({},p,{externalSlotProps:f})),y=(0,a.Z)(g,null==f?void 0:f.ref,null==(t=e.additionalProps)?void 0:t.ref);return(0,o.Z)(r,(0,n.Z)({},m,{ref:y}),d)}t.Z=u},96375:function(e,t,r){"use strict";r.d(t,{V:function(){return l},Z:function(){return c}});var n=r(2265);let i={};function a(e,t){let r=n.useRef(i);return r.current===i&&(r.current=e(t)),r}let o=[];function s(e){n.useEffect(e,o)}class l{static create(){return new l}start(e,t){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,t()},e)}constructor(){this.currentId=null,this.clear=()=>{null!==this.currentId&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}}function c(){let e=a(l.create).current;return s(e.disposeEffect),e}},47239:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;let n=r(57437),i=r(2265);function a(e){let{html:t,height:r=null,width:a=null,children:o,dataNtpc:s=""}=e;return(0,i.useEffect)(()=>{s&&performance.mark("mark_feature_usage",{detail:{feature:"next-third-parties-".concat(s)}})},[s]),(0,n.jsxs)(n.Fragment,{children:[o,t?(0,n.jsx)("div",{style:{height:null!=r?"".concat(r,"px"):"auto",width:null!=a?"".concat(a,"px"):"auto"},"data-ntpc":s,dangerouslySetInnerHTML:{__html:t}}):null]})}},14888:function(e,t,r){"use strict";let n;var i=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAnalytics=l,t.sendGAEvent=c;let a=r(57437),o=r(2265),s=i(r(48667));function l(e){let{gaId:t,debugMode:r,dataLayerName:i="dataLayer",nonce:l}=e;return void 0===n&&(n=i),(0,o.useEffect)(()=>{performance.mark("mark_feature_usage",{detail:{feature:"next-third-parties-ga"}})},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.default,{id:"_next-ga-init",dangerouslySetInnerHTML:{__html:"\n          window['".concat(i,"'] = window['").concat(i,"'] || [];\n          function gtag(){window['").concat(i,"'].push(arguments);}\n          gtag('js', new Date());\n\n          gtag('config', '").concat(t,"' ").concat(r?",{ 'debug_mode': true }":"",");")},nonce:l}),(0,a.jsx)(s.default,{id:"_next-ga",src:"https://www.googletagmanager.com/gtag/js?id=".concat(t),nonce:l})]})}function c(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(void 0===n){console.warn("@next/third-parties: GA has not been initialized");return}window[n]?window[n].push(arguments):console.warn("@next/third-parties: GA dataLayer ".concat(n," does not exist"))}},98087:function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.sendGTMEvent=void 0,t.GoogleTagManager=l;let i=r(57437),a=r(2265),o=n(r(48667)),s="dataLayer";function l(e){let{gtmId:t,gtmScriptUrl:r="https://www.googletagmanager.com/gtm.js",dataLayerName:n="dataLayer",auth:l,preview:c,dataLayer:u,nonce:d}=e;s=n;let h="dataLayer"!==n?"&l=".concat(n):"",p=l?"&gtm_auth=".concat(l):"",f=c?"&gtm_preview=".concat(c,"&gtm_cookies_win=x"):"";return(0,a.useEffect)(()=>{performance.mark("mark_feature_usage",{detail:{feature:"next-third-parties-gtm"}})},[]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o.default,{id:"_next-gtm-init",dangerouslySetInnerHTML:{__html:"\n      (function(w,l){\n        w[l]=w[l]||[];\n        w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});\n        ".concat(u?"w[l].push(".concat(JSON.stringify(u),")"):"","\n      })(window,'").concat(n,"');")},nonce:d}),(0,i.jsx)(o.default,{id:"_next-gtm","data-ntpc":"GTM",src:"".concat(r,"?id=").concat(t).concat(h).concat(p).concat(f),nonce:d})]})}let c=(e,t)=>{let r=t||s;window[r]=window[r]||[],window[r].push(e)};t.sendGTMEvent=c},78918:function(e){"use strict";let{AbortController:t,AbortSignal}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;e.exports=t,e.exports.AbortSignal=AbortSignal,e.exports.default=t},59196:function(e,t){"use strict";t.byteLength=c,t.toByteArray=d,t.fromByteArray=f;for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,s=a.length;o<s;++o)r[o]=a[o],n[a.charCodeAt(o)]=o;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function c(e){var t=l(e),r=t[0],n=t[1];return(r+n)*3/4-n}function u(e,t,r){return(t+r)*3/4-r}function d(e){var t,r,a=l(e),o=a[0],s=a[1],c=new i(u(e,o,s)),d=0,h=s>0?o-4:o;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;return 2===s&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[d++]=255&t),1===s&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t),c}function h(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function p(e,t,r){for(var n=[],i=t;i<r;i+=3)n.push(h((e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2])));return n.join("")}function f(e){for(var t,n=e.length,i=n%3,a=[],o=16383,s=0,l=n-i;s<l;s+=o)a.push(p(e,s,s+o>l?l:s+o));return 1===i?a.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===i&&a.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},82957:function(e,t,r){"use strict";let n=r(59196),i=r(68848),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.SlowBuffer=_,t.INSPECT_MAX_BYTES=50;let o=2147483647;function s(){try{let e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}function l(e){if(e>o)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return p(e)}return u(e,t,r)}function u(e,t,r){if("string"==typeof e)return f(e,t);if(ArrayBuffer.isView(e))return g(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(eo(e,ArrayBuffer)||e&&eo(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(eo(e,SharedArrayBuffer)||e&&eo(e.buffer,SharedArrayBuffer)))return y(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return c.from(n,t,r);let i=v(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function d(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function h(e,t,r){return(d(e),e<=0)?l(e):void 0!==t?"string"==typeof r?l(e).fill(t,r):l(e).fill(t):l(e)}function p(e){return d(e),l(e<0?0:0|b(e))}function f(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!c.isEncoding(t))throw TypeError("Unknown encoding: "+t);let r=0|w(e,t),n=l(r),i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}function m(e){let t=e.length<0?0:0|b(e.length),r=l(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function g(e){if(eo(e,Uint8Array)){let t=new Uint8Array(e);return y(t.buffer,t.byteOffset,t.byteLength)}return m(e)}function y(e,t,r){let n;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),c.prototype),n}function v(e){if(c.isBuffer(e)){let t=0|b(e.length),r=l(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||es(e.length)?l(0):m(e):"Buffer"===e.type&&Array.isArray(e.data)?m(e.data):void 0}function b(e){if(e>=o)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function _(e){return+e!=e&&(e=0),c.alloc(+e)}function w(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||eo(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return et(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return ei(e).length;default:if(i)return n?-1:et(e).length;t=(""+t).toLowerCase(),i=!0}}function S(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return U(this,t,r);case"utf8":case"utf-8":return P(this,t,r);case"ascii":return L(this,t,r);case"latin1":case"binary":return D(this,t,r);case"base64":return k(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,t,r);default:if(n)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function T(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function x(e,t,r,n,i){if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),es(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return -1;r=e.length-1}else if(r<0){if(!i)return -1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:E(e,t,r,n,i);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):E(e,[t],r,n,i);throw TypeError("val must be string, number or Buffer")}function E(e,t,r,n,i){let a,o=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;o=2,s/=2,l/=2,r/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let n=-1;for(a=r;a<s;a++)if(c(e,a)===c(t,-1===n?0:a-n)){if(-1===n&&(n=a),a-n+1===l)return n*o}else -1!==n&&(a-=a-n),n=-1}else for(r+l>s&&(r=s-l),a=r;a>=0;a--){let r=!0;for(let n=0;n<l;n++)if(c(e,a+n)!==c(t,n)){r=!1;break}if(r)return a}return -1}function C(e,t,r,n){let i;r=Number(r)||0;let a=e.length-r;n?(n=Number(n))>a&&(n=a):n=a;let o=t.length;for(n>o/2&&(n=o/2),i=0;i<n;++i){let n=parseInt(t.substr(2*i,2),16);if(es(n))break;e[r+i]=n}return i}function A(e,t,r,n){return ea(et(t,e.length-r),e,r,n)}function M(e,t,r,n){return ea(er(t),e,r,n)}function I(e,t,r,n){return ea(ei(t),e,r,n)}function R(e,t,r,n){return ea(en(t,e.length-r),e,r,n)}function k(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function P(e,t,r){r=Math.min(e.length,r);let n=[],i=t;for(;i<r;){let t=e[i],a=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=r){let r,n,s,l;switch(o){case 1:t<128&&(a=t);break;case 2:(192&(r=e[i+1]))==128&&(l=(31&t)<<6|63&r)>127&&(a=l);break;case 3:r=e[i+1],n=e[i+2],(192&r)==128&&(192&n)==128&&(l=(15&t)<<12|(63&r)<<6|63&n)>2047&&(l<55296||l>57343)&&(a=l);break;case 4:r=e[i+1],n=e[i+2],s=e[i+3],(192&r)==128&&(192&n)==128&&(192&s)==128&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&s)>65535&&l<1114112&&(a=l)}}null===a?(a=65533,o=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=o}return N(n)}t.kMaxLength=o,c.TYPED_ARRAY_SUPPORT=s(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,r){return u(e,t,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,r){return h(e,t,r)},c.allocUnsafe=function(e){return p(e)},c.allocUnsafeSlow=function(e){return p(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(eo(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),eo(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){let r;if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;let n=c.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){let t=e[r];if(eo(t,Uint8Array))i+t.length>n.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else if(c.isBuffer(t))t.copy(n,i);else throw TypeError('"list" argument must be an Array of Buffers');i+=t.length}return n},c.byteLength=w,c.prototype._isBuffer=!0,c.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)T(this,t,t+1);return this},c.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)T(this,t,t+3),T(this,t+1,t+2);return this},c.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)T(this,t,t+7),T(this,t+1,t+6),T(this,t+2,t+5),T(this,t+3,t+4);return this},c.prototype.toString=function(){let e=this.length;return 0===e?"":0==arguments.length?P(this,0,e):S.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},a&&(c.prototype[a]=c.prototype.inspect),c.prototype.compare=function(e,t,r,n,i){if(eo(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;let a=i-n,o=r-t,s=Math.min(a,o),l=this.slice(n,i),u=e.slice(t,r);for(let e=0;e<s;++e)if(l[e]!==u[e]){a=l[e],o=u[e];break}return a<o?-1:o<a?1:0},c.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return x(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return x(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let a=!1;for(;;)switch(n){case"hex":return C(this,e,t,r);case"utf8":case"utf-8":return A(this,e,t,r);case"ascii":case"latin1":case"binary":return M(this,e,t,r);case"base64":return I(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,t,r);default:if(a)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};let O=4096;function N(e){let t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=O));return r}function L(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function D(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function U(e,t,r){let n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=el[e[n]];return i}function F(e,t,r){let n=e.slice(t,r),i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function B(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function z(e,t,r,n,i,a){if(!c.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw RangeError('"value" argument is out of bounds');if(r+n>e.length)throw RangeError("Index out of range")}function H(e,t,r,n,i){K(t,n,i,e,r,7);let a=Number(t&BigInt(4294967295));e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function j(e,t,r,n,i){K(t,n,i,e,r,7);let a=Number(t&BigInt(4294967295));e[r+7]=a,a>>=8,e[r+6]=a,a>>=8,e[r+5]=a,a>>=8,e[r+4]=a;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function G(e,t,r,n,i,a){if(r+n>e.length||r<0)throw RangeError("Index out of range")}function V(e,t,r,n,a){return t=+t,r>>>=0,a||G(e,t,r,4,34028234663852886e22,-34028234663852886e22),i.write(e,t,r,n,23,4),r+4}function q(e,t,r,n,a){return t=+t,r>>>=0,a||G(e,t,r,8,17976931348623157e292,-17976931348623157e292),i.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){let r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||B(e,t,this.length);let n=this[e],i=1,a=0;for(;++a<t&&(i*=256);)n+=this[e+a]*i;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||B(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||B(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||B(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||B(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||B(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||B(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=ec(function(e){Y(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&Q(e,this.length-8);let n=t+256*this[++e]+65536*this[++e]+16777216*this[++e],i=this[++e]+256*this[++e]+65536*this[++e]+16777216*r;return BigInt(n)+(BigInt(i)<<BigInt(32))}),c.prototype.readBigUInt64BE=ec(function(e){Y(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&Q(e,this.length-8);let n=16777216*t+65536*this[++e]+256*this[++e]+this[++e],i=16777216*this[++e]+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)}),c.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||B(e,t,this.length);let n=this[e],i=1,a=0;for(;++a<t&&(i*=256);)n+=this[e+a]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||B(e,t,this.length);let n=t,i=1,a=this[e+--n];for(;n>0&&(i*=256);)a+=this[e+--n]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},c.prototype.readInt8=function(e,t){return(e>>>=0,t||B(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||B(e,2,this.length);let r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){e>>>=0,t||B(e,2,this.length);let r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||B(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||B(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=ec(function(e){Y(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&Q(e,this.length-8),(BigInt(this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24))<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+16777216*this[++e])}),c.prototype.readBigInt64BE=ec(function(e){Y(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&Q(e,this.length-8),(BigInt((t<<24)+65536*this[++e]+256*this[++e]+this[++e])<<BigInt(32))+BigInt(16777216*this[++e]+65536*this[++e]+256*this[++e]+r)}),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||B(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||B(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||B(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||B(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){let n=Math.pow(2,8*r)-1;z(this,e,t,r,n,0)}let i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){let n=Math.pow(2,8*r)-1;z(this,e,t,r,n,0)}let i=r-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=ec(function(e,t=0){return H(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=ec(function(e,t=0){return j(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){let n=Math.pow(2,8*r-1);z(this,e,t,r,n-1,-n)}let i=0,a=1,o=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/a>>0)-o&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){let n=Math.pow(2,8*r-1);z(this,e,t,r,n-1,-n)}let i=r-1,a=1,o=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/a>>0)-o&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||z(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=ec(function(e,t=0){return H(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=ec(function(e,t=0){return j(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeFloatLE=function(e,t,r){return V(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return V(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return q(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return q(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(!c.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);let i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},c.prototype.fill=function(e,t,r,n){let i;if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===e.length){let t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{let a=c.isBuffer(e)?e:c.from(e,n),o=a.length;if(0===o)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=a[i%o]}return this};let W={};function Z(e,t,r){W[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function X(e){let t="",r=e.length,n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function $(e,t,r){Y(t,"offset"),(void 0===e[t]||void 0===e[t+r])&&Q(t,e.length-(r+1))}function K(e,t,r,n,i,a){if(e>r||e<t){let n;let i="bigint"==typeof t?"n":"";throw n=a>3?0===t||t===BigInt(0)?`>= 0${i} and < 2${i} ** ${(a+1)*8}${i}`:`>= -(2${i} ** ${(a+1)*8-1}${i}) and < 2 ** ${(a+1)*8-1}${i}`:`>= ${t}${i} and <= ${r}${i}`,new W.ERR_OUT_OF_RANGE("value",n,e)}$(n,i,a)}function Y(e,t){if("number"!=typeof e)throw new W.ERR_INVALID_ARG_TYPE(t,"number",e)}function Q(e,t,r){if(Math.floor(e)!==e)throw Y(e,r),new W.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new W.ERR_BUFFER_OUT_OF_BOUNDS;throw new W.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}Z("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Z("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),Z("ERR_OUT_OF_RANGE",function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>4294967296?i=X(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=X(i)),i+="n"),n+=` It must be ${t}. Received ${i}`},RangeError);let J=/[^+/0-9A-Za-z-_]/g;function ee(e){if((e=(e=e.split("=")[0]).trim().replace(J,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function et(e,t){let r;t=t||1/0;let n=e.length,i=null,a=[];for(let o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319||o+1===n){(t-=3)>-1&&a.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return a}function er(e){let t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function en(e,t){let r,n;let i=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i.push(r%256),i.push(n);return i}function ei(e){return n.toByteArray(ee(e))}function ea(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length)&&!(i>=e.length);++i)t[i+r]=e[i];return i}function eo(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function es(e){return e!=e}let el=function(){let e="0123456789abcdef",t=Array(256);for(let r=0;r<16;++r){let n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function ec(e){return"undefined"==typeof BigInt?eu:e}function eu(){throw Error("BigInt not supported")}},63674:function(e,t){"use strict";var r=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,n=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,i=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,a=/\\([\u000b\u0020-\u00ff])/g,o=/([\\"])/g,s=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/;function l(e){if(!e||"object"!=typeof e)throw TypeError("argument obj is required");var t=e.parameters,r=e.type;if(!r||!s.test(r))throw TypeError("invalid type");var n=r;if(t&&"object"==typeof t)for(var a,o=Object.keys(t).sort(),l=0;l<o.length;l++){if(a=o[l],!i.test(a))throw TypeError("invalid parameter name");n+="; "+a+"="+d(t[a])}return n}function c(e){if(!e)throw TypeError("argument string is required");var t,n,i,o="object"==typeof e?u(e):e;if("string"!=typeof o)throw TypeError("argument string is required to be a string");var l=o.indexOf(";"),c=-1!==l?o.slice(0,l).trim():o.trim();if(!s.test(c))throw TypeError("invalid media type");var d=new h(c.toLowerCase());if(-1!==l){for(r.lastIndex=l;n=r.exec(o);){if(n.index!==l)throw TypeError("invalid parameter format");l+=n[0].length,t=n[1].toLowerCase(),34===(i=n[2]).charCodeAt(0)&&-1!==(i=i.slice(1,-1)).indexOf("\\")&&(i=i.replace(a,"$1")),d.parameters[t]=i}if(l!==o.length)throw TypeError("invalid parameter format")}return d}function u(e){var t;if("function"==typeof e.getHeader?t=e.getHeader("content-type"):"object"==typeof e.headers&&(t=e.headers&&e.headers["content-type"]),"string"!=typeof t)throw TypeError("content-type header is missing from object");return t}function d(e){var t=String(e);if(i.test(t))return t;if(t.length>0&&!n.test(t))throw TypeError("invalid parameter value");return'"'+t.replace(o,"\\$1")+'"'}function h(e){this.parameters=Object.create(null),this.type=e}t.format=l,t.parse=c},31464:function(e,t,r){var n=r(25566);function i(){let e;return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function a(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))}),t.splice(i,0,r)}function o(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}}function s(){let e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e}function l(){try{return localStorage}catch(e){}}t.formatArgs=a,t.save=o,t.load=s,t.useColors=i,t.storage=l(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(27244)(t);let{formatters:c}=e.exports;c.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},27244:function(e,t,r){function n(e){function t(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return n.colors[Math.abs(t)%n.colors.length]}function n(e){let t,r,a;let o=null;function s(...e){if(!s.enabled)return;let r=s,i=Number(new Date),a=i-(t||i);r.diff=a,r.prev=t,r.curr=i,t=i,e[0]=n.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(t,i)=>{if("%%"===t)return"%";o++;let a=n.formatters[i];if("function"==typeof a){let n=e[o];t=a.call(r,n),e.splice(o,1),o--}return t}),n.formatArgs.call(r,e),(r.log||n.log).apply(r,e)}return s.namespace=e,s.useColors=n.useColors(),s.color=n.selectColor(e),s.extend=i,s.destroy=n.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(r!==n.namespaces&&(r=n.namespaces,a=n.enabled(e)),a),set:e=>{o=e}}),"function"==typeof n.init&&n.init(s),s}function i(e,t){let r=n(this.namespace+(void 0===t?":":t)+e);return r.log=this.log,r}function a(e){for(let t of(n.save(e),n.namespaces=e,n.names=[],n.skips=[],("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean)))"-"===t[0]?n.skips.push(t.slice(1)):n.names.push(t)}function o(e,t){let r=0,n=0,i=-1,a=0;for(;r<e.length;)if(n<t.length&&(t[n]===e[r]||"*"===t[n]))"*"===t[n]?(i=n,a=r):r++,n++;else{if(-1===i)return!1;n=i+1,r=++a}for(;n<t.length&&"*"===t[n];)n++;return n===t.length}function s(){let e=[...n.names,...n.skips.map(e=>"-"+e)].join(",");return n.enable(""),e}function l(e){for(let t of n.skips)if(o(e,t))return!1;for(let t of n.names)if(o(e,t))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.debug=n,n.default=n,n.coerce=c,n.disable=s,n.enable=a,n.enabled=l,n.humanize=r(35169),n.destroy=u,Object.keys(e).forEach(t=>{n[t]=e[t]}),n.names=[],n.skips=[],n.formatters={},n.selectColor=t,n.enable(n.load()),n}e.exports=n},55445:function(e){"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};function i(e){console&&console.warn&&console.warn(e)}t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=v,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function l(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function u(e,t,r,n){if(l(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(a=c(e))>0&&s.length>a&&!s.warned){s.warned=!0;var a,o,s,u=Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,i(u)}return e}function d(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=d.bind(n);return i.listener=r,n.wrapFn=i,i}function p(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?y(i):m(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function m(e,t){for(var r=Array(t),n=0;n<t;++n)r[n]=e[n];return r}function g(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function y(e){for(var t=Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function v(e,t){return new Promise(function(r,n){function i(r){e.removeListener(t,a),n(r)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}_(e,t,a,{once:!0}),"error"!==t&&b(e,i,{once:!0})})}function b(e,t,r){"function"==typeof e.on&&_(e,"error",t,r)}function _(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else if("function"==typeof e.addEventListener)e.addEventListener(t,function i(a){n.once&&e.removeEventListener(t,i),r(a)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||a(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,a=this._events;if(void 0!==a)i=i&&void 0===a.error;else if(!i)return!1;if(i){if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var o,s=Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=a[e];if(void 0===l)return!1;if("function"==typeof l)n(l,this,t);else for(var c=l.length,u=m(l,c),r=0;r<c;++r)n(u[r],this,t);return!0},o.prototype.addListener=function(e,t){return u(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return u(this,e,t,!0)},o.prototype.once=function(e,t){return l(t),this.on(e,h(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,h(this,e,t)),this},o.prototype.removeListener=function(e,t){var r,n,i,a,o;if(l(t),void 0===(n=this._events)||void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,a=r.length-1;a>=0;a--)if(r[a]===t||r[a].listener===t){o=r[a].listener,i=a;break}if(i<0)return this;0===i?r.shift():g(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0==arguments.length){var i,a=Object.keys(r);for(n=0;n<a.length;++n)"removeListener"!==(i=a[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return p(this,e,!0)},o.prototype.rawListeners=function(e){return p(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},43890:function(e){"use strict";function t(e){if(this.size=0|e,this.size<=1||(this.size&this.size-1)!=0)throw Error("FFT size must be a power of two and bigger than 1");this._csize=e<<1;for(var t=Array(2*this.size),r=0;r<t.length;r+=2){let e=Math.PI*r/this.size;t[r]=Math.cos(e),t[r+1]=-Math.sin(e)}this.table=t;for(var n=0,i=1;this.size>i;i<<=1)n++;this._width=n%2==0?n-1:n,this._bitrev=Array(1<<this._width);for(var a=0;a<this._bitrev.length;a++){this._bitrev[a]=0;for(var o=0;o<this._width;o+=2){var s=this._width-o-2;this._bitrev[a]|=(a>>>o&3)<<s}}this._out=null,this._data=null,this._inv=0}e.exports=t,t.prototype.fromComplexArray=function(e,t){for(var r=t||Array(e.length>>>1),n=0;n<e.length;n+=2)r[n>>>1]=e[n];return r},t.prototype.createComplexArray=function(){let e=Array(this._csize);for(var t=0;t<e.length;t++)e[t]=0;return e},t.prototype.toComplexArray=function(e,t){for(var r=t||this.createComplexArray(),n=0;n<r.length;n+=2)r[n]=e[n>>>1],r[n+1]=0;return r},t.prototype.completeSpectrum=function(e){for(var t=this._csize,r=t>>>1,n=2;n<r;n+=2)e[t-n]=e[n],e[t-n+1]=-e[n+1]},t.prototype.transform=function(e,t){if(e===t)throw Error("Input and output buffers must be different");this._out=e,this._data=t,this._inv=0,this._transform4(),this._out=null,this._data=null},t.prototype.realTransform=function(e,t){if(e===t)throw Error("Input and output buffers must be different");this._out=e,this._data=t,this._inv=0,this._realTransform4(),this._out=null,this._data=null},t.prototype.inverseTransform=function(e,t){if(e===t)throw Error("Input and output buffers must be different");this._out=e,this._data=t,this._inv=1,this._transform4();for(var r=0;r<e.length;r++)e[r]/=this.size;this._out=null,this._data=null},t.prototype._transform4=function(){var e,t,r=this._out,n=this._csize,i=1<<this._width,a=n/i<<1,o=this._bitrev;if(4===a)for(e=0,t=0;e<n;e+=a,t++){let r=o[t];this._singleTransform2(e,r,i)}else for(e=0,t=0;e<n;e+=a,t++){let r=o[t];this._singleTransform4(e,r,i)}var s=this._inv?-1:1,l=this.table;for(i>>=2;i>=2;i>>=2){var c=(a=n/i<<1)>>>2;for(e=0;e<n;e+=a)for(var u=e+c,d=e,h=0;d<u;d+=2,h+=i){let e=d,t=e+c,n=t+c,i=n+c,a=r[e],o=r[e+1],u=r[t],p=r[t+1],f=r[n],m=r[n+1],g=r[i],y=r[i+1],v=a,b=o,_=l[h],w=s*l[h+1],S=u*_-p*w,T=u*w+p*_,x=l[2*h],E=s*l[2*h+1],C=f*x-m*E,A=f*E+m*x,M=l[3*h],I=s*l[3*h+1],R=g*M-y*I,k=g*I+y*M,P=v+C,O=b+A,N=v-C,L=b-A,D=S+R,U=T+k,F=s*(S-R),B=s*(T-k),z=P+D,H=O+U,j=P-D,G=O-U,V=N+B,q=L-F,W=N-B,Z=L+F;r[e]=z,r[e+1]=H,r[t]=V,r[t+1]=q,r[n]=j,r[n+1]=G,r[i]=W,r[i+1]=Z}}},t.prototype._singleTransform2=function(e,t,r){let n=this._out,i=this._data,a=i[t],o=i[t+1],s=i[t+r],l=i[t+r+1],c=a+s,u=o+l,d=a-s,h=o-l;n[e]=c,n[e+1]=u,n[e+2]=d,n[e+3]=h},t.prototype._singleTransform4=function(e,t,r){let n=this._out,i=this._data,a=this._inv?-1:1,o=2*r,s=3*r,l=i[t],c=i[t+1],u=i[t+r],d=i[t+r+1],h=i[t+o],p=i[t+o+1],f=i[t+s],m=i[t+s+1],g=l+h,y=c+p,v=l-h,b=c-p,_=u+f,w=d+m,S=a*(u-f),T=a*(d-m),x=g+_,E=y+w,C=v+T,A=b-S,M=g-_,I=y-w,R=v-T,k=b+S;n[e]=x,n[e+1]=E,n[e+2]=C,n[e+3]=A,n[e+4]=M,n[e+5]=I,n[e+6]=R,n[e+7]=k},t.prototype._realTransform4=function(){var e,t,r=this._out,n=this._csize,i=1<<this._width,a=n/i<<1,o=this._bitrev;if(4===a)for(e=0,t=0;e<n;e+=a,t++){let r=o[t];this._singleRealTransform2(e,r>>>1,i>>>1)}else for(e=0,t=0;e<n;e+=a,t++){let r=o[t];this._singleRealTransform4(e,r>>>1,i>>>1)}var s=this._inv?-1:1,l=this.table;for(i>>=2;i>=2;i>>=2){var c=(a=n/i<<1)>>>1,u=c>>>1,d=u>>>1;for(e=0;e<n;e+=a)for(var h=0,p=0;h<=d;h+=2,p+=i){var f=e+h,m=f+u,g=m+u,y=g+u,v=r[f],b=r[f+1],_=r[m],w=r[m+1],S=r[g],T=r[g+1],x=r[y],E=r[y+1],C=v,A=b,M=l[p],I=s*l[p+1],R=_*M-w*I,k=_*I+w*M,P=l[2*p],O=s*l[2*p+1],N=S*P-T*O,L=S*O+T*P,D=l[3*p],U=s*l[3*p+1],F=x*D-E*U,B=x*U+E*D,z=C+N,H=A+L,j=C-N,G=A-L,V=R+F,q=k+B,W=s*(R-F),Z=s*(k-B),X=z+V,$=H+q,K=j+Z,Y=G-W;if(r[f]=X,r[f+1]=$,r[m]=K,r[m+1]=Y,0===h){var Q=z-V,J=H-q;r[g]=Q,r[g+1]=J;continue}if(h!==d){var ee=j,et=-G,er=z,en=-H,ei=-s*Z,ea=-s*W,eo=-s*q,es=-s*V,el=ee+ei,ec=et+ea,eu=er+es,ed=en-eo,eh=e+u-h,ep=e+c-h;r[eh]=el,r[eh+1]=ec,r[ep]=eu,r[ep+1]=ed}}}},t.prototype._singleRealTransform2=function(e,t,r){let n=this._out,i=this._data,a=i[t],o=i[t+r],s=a+o,l=a-o;n[e]=s,n[e+1]=0,n[e+2]=l,n[e+3]=0},t.prototype._singleRealTransform4=function(e,t,r){let n=this._out,i=this._data,a=this._inv?-1:1,o=2*r,s=3*r,l=i[t],c=i[t+r],u=i[t+o],d=i[t+s],h=l+u,p=l-u,f=c+d,m=a*(c-d),g=h+f,y=p,v=-m,b=h-f,_=p,w=m;n[e]=g,n[e+1]=0,n[e+2]=y,n[e+3]=v,n[e+4]=b,n[e+5]=0,n[e+6]=_,n[e+7]=w}},20922:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(82957).Buffer;let Token=__webpack_require__(32235),strtok3=__webpack_require__(61232),{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=__webpack_require__(83376),supported=__webpack_require__(58992),minimumBytes=4100;async function fromStream(e){let t=await strtok3.fromStream(e);try{return await fromTokenizer(t)}finally{await t.close()}}async function fromBuffer(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||Buffer.isBuffer(e)))throw TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof e}\``);let t=e instanceof Buffer?e:Buffer.from(e);if(t&&t.length>1)return fromTokenizer(strtok3.fromBuffer(t))}function _check(e,t,r){for(let[n,i]of(r={offset:0,...r},t.entries()))if(r.mask){if(i!==(r.mask[n]&e[n+r.offset]))return!1}else if(i!==e[n+r.offset])return!1;return!0}async function fromTokenizer(e){try{return _fromTokenizer(e)}catch(e){if(!(e instanceof strtok3.EndOfStreamError))throw e}}async function _fromTokenizer(e){let t=Buffer.alloc(minimumBytes),r=12,n=(e,r)=>_check(t,e,r),i=(e,t)=>n(stringToBytes(e),t);if(e.fileInfo.size||(e.fileInfo.size=Number.MAX_SAFE_INTEGER),await e.peekBuffer(t,{length:r,mayBeLess:!0}),n([66,77]))return{ext:"bmp",mime:"image/bmp"};if(n([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(n([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(n([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(n([37,33]))return(await e.peekBuffer(t,{length:24,mayBeLess:!0}),i("PS-Adobe-",{offset:2})&&i(" EPSF-",{offset:14}))?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(n([31,160])||n([31,157]))return{ext:"Z",mime:"application/x-compress"};if(n([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(n([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(n([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(n([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(i("ID3")){await e.ignore(6);let t=await e.readToken(uint32SyncSafeToken);return e.position+t>e.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await e.ignore(t),fromTokenizer(e))}if(i("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((67===t[0]||70===t[0])&&n([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(n([71,73,70]))return{ext:"gif",mime:"image/gif"};if(i("FLIF"))return{ext:"flif",mime:"image/flif"};if(i("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(i("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(i("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(i("FORM"))return{ext:"aif",mime:"audio/aiff"};if(i("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(n([80,75,3,4])){try{for(;e.position+30<e.fileInfo.size;){await e.readBuffer(t,{length:30});let r={compressedSize:t.readUInt32LE(18),uncompressedSize:t.readUInt32LE(22),filenameLength:t.readUInt16LE(26),extraFieldLength:t.readUInt16LE(28)};if(r.filename=await e.readToken(new Token.StringType(r.filenameLength,"utf-8")),await e.ignore(r.extraFieldLength),"META-INF/mozilla.rsa"===r.filename)return{ext:"xpi",mime:"application/x-xpinstall"};if(r.filename.endsWith(".rels")||r.filename.endsWith(".xml"))switch(r.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}if(r.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(r.filename.startsWith("3D/")&&r.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if("mimetype"===r.filename&&r.compressedSize===r.uncompressedSize)switch(await e.readToken(new Token.StringType(r.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}if(0===r.compressedSize){let r=-1;for(;r<0&&e.position<e.fileInfo.size;)await e.peekBuffer(t,{mayBeLess:!0}),r=t.indexOf("504B0304",0,"hex"),await e.ignore(r>=0?r:t.length)}else await e.ignore(r.compressedSize)}}catch(e){if(!(e instanceof strtok3.EndOfStreamError))throw e}return{ext:"zip",mime:"application/zip"}}if(i("OggS")){await e.ignore(28);let t=Buffer.alloc(8);return(await e.readBuffer(t),_check(t,[79,112,117,115,72,101,97,100]))?{ext:"opus",mime:"audio/opus"}:_check(t,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(t,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(t,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(t,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(t,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(n([80,75])&&(3===t[2]||5===t[2]||7===t[2])&&(4===t[3]||6===t[3]||8===t[3]))return{ext:"zip",mime:"application/zip"};if(i("ftyp",{offset:4})&&(96&t[8])!=0){let e=t.toString("binary",8,12).replace("\0"," ").trim();switch(e){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:if(e.startsWith("3g")){if(e.startsWith("3g2"))return{ext:"3g2",mime:"video/3gpp2"};return{ext:"3gp",mime:"video/3gpp"}}return{ext:"mp4",mime:"video/mp4"}}}if(i("MThd"))return{ext:"mid",mime:"audio/midi"};if(i("wOFF")&&(n([0,1,0,0],{offset:4})||i("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(i("wOF2")&&(n([0,1,0,0],{offset:4})||i("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(n([212,195,178,161])||n([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(i("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(i("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(i("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(n([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(i("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(i("%PDF")){await e.ignore(1350);let t=10485760,r=Buffer.alloc(Math.min(t,e.fileInfo.size));return(await e.readBuffer(r,{mayBeLess:!0}),r.includes(Buffer.from("AIPrivateData")))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(n([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(n([73,73,42,0]))return i("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:n([28,0,254,0],{offset:8})||n([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:n([8,0,0,0],{offset:4})&&(n([45,0,254,0],{offset:8})||n([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(t=Buffer.alloc(24),await e.peekBuffer(t),(n([16,251,134,1],{offset:4})||n([8,0,0,0],{offset:4}))&&n([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9}))?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"};if(n([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(i("MAC "))return{ext:"ape",mime:"audio/ape"};if(n([26,69,223,163])){async function a(){let t=await e.peekNumber(Token.UINT8),r=128,n=0;for(;(t&r)==0&&0!==r;)++n,r>>=1;let i=Buffer.alloc(n+1);return await e.readBuffer(i),i}async function o(){let e=await a(),t=await a();t[0]^=128>>t.length-1;let r=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-r,r)}}async function s(t,r){for(;r>0;){let t=await o();if(17026===t.id)return e.readToken(new Token.StringType(t.len,"utf-8"));await e.ignore(t.len),--r}}let t=await o();switch(await s(1,t.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(n([82,73,70,70])){if(n([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(n([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(n([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(i("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(n([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(i("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(i("MSCF")||i("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(n([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(n([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(n([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(n([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(i("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(i("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(n([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(i("IMPM"))return{ext:"it",mime:"audio/x-it"};if(i("-lh0-",{offset:2})||i("-lh1-",{offset:2})||i("-lh2-",{offset:2})||i("-lh3-",{offset:2})||i("-lh4-",{offset:2})||i("-lh5-",{offset:2})||i("-lh6-",{offset:2})||i("-lh7-",{offset:2})||i("-lzs-",{offset:2})||i("-lz4-",{offset:2})||i("-lz5-",{offset:2})||i("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(n([0,0,1,186])){if(n([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(n([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(i("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(n([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(i("<?xml "))return{ext:"xml",mime:"application/xml"};if(n([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(n([82,97,114,33,26,7])&&(0===t[6]||1===t[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(i("solid "))return{ext:"stl",mime:"model/stl"};if(i("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(i("!<arch>"))return(await e.ignore(8),"debian-binary"===await e.readToken(new Token.StringType(13,"ascii")))?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(n([137,80,78,71,13,10,26,10])){async function l(){return{length:await e.readToken(Token.INT32_BE),type:await e.readToken(new Token.StringType(4,"binary"))}}await e.ignore(8);do{let t=await l();if(t.length<0)return;switch(t.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await e.ignore(t.length+4)}}while(e.position+8<e.fileInfo.size);return{ext:"png",mime:"image/png"}}if(n([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(n([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(n([102,114,101,101],{offset:4})||n([109,100,97,116],{offset:4})||n([109,111,111,118],{offset:4})||n([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(n([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(i("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(n([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(n([48,38,178,117,142,102,207,17,166,217])){async function c(){let t=Buffer.alloc(16);return await e.readBuffer(t),{id:t,size:Number(await e.readToken(Token.UINT64_LE))}}for(await e.ignore(30);e.position+24<e.fileInfo.size;){let t=await c(),r=t.size-24;if(_check(t.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){let t=Buffer.alloc(16);if(r-=await e.readBuffer(t),_check(t,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(t,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await e.ignore(r)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(n([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((n([126,16,4])||n([126,24,4]))&&n([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(n([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(n([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await e.ignore(20),await e.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(n([255,10])||n([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(n([0,0,1,186])||n([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(n([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(n([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(n([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(n([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await e.peekBuffer(t,{length:Math.min(256,e.fileInfo.size),mayBeLess:!0}),i("BEGIN:")){if(i("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(i("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(i("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(i("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(i("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(n([4,0,0,0])&&t.length>=16){let e=t.readUInt32LE(12);if(e>12&&t.length>=e+16)try{let r=t.slice(16,e+16).toString();if(JSON.parse(r).files)return{ext:"asar",mime:"application/x-asar"}}catch(e){}}if(n([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(i("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(n([71],{offset:4})&&(n([71],{offset:192})||n([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(n([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(n([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(n([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(n([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(n([76,80],{offset:34})&&(n([0,0,1],{offset:8})||n([1,0,2],{offset:8})||n([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(n([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await e.peekBuffer(t,{length:Math.min(512,e.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(t))return{ext:"tar",mime:"application/x-tar"};if(n([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(i("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(t.length>=2&&n([255,224],{offset:0,mask:[255,224]})){if(n([16],{offset:1,mask:[22]}))return n([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(n([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(n([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(n([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}let stream=readableStream=>new Promise((resolve,reject)=>{let stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",async()=>{let e;let t=new stream.PassThrough;e=stream.pipeline?stream.pipeline(readableStream,t,()=>{}):readableStream.pipe(t);let r=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{let e=await fromBuffer(r);t.fileType=e}catch(e){reject(e)}resolve(e)})}),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get:()=>new Set(supported.extensions)}),Object.defineProperty(fileType,"mimeTypes",{get:()=>new Set(supported.mimeTypes)}),module.exports=fileType},58992:function(e){"use strict";e.exports={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]}},83376:function(e,t){"use strict";t.stringToBytes=e=>[...e].map(e=>e.charCodeAt(0)),t.tarHeaderChecksumMatches=(e,t=0)=>{let r=parseInt(e.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(r))return!1;let n=256;for(let r=t;r<t+148;r++)n+=e[r];for(let r=t+156;r<t+512;r++)n+=e[r];return r===n},t.uint32SyncSafeToken={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4}},63285:function(e,t,r){"use strict";var n=r(44300),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},l={};function c(e){return n.isMemo(e)?s:l[e.$$typeof]||i}l[n.ForwardRef]=o,l[n.Memo]=s;var u=Object.defineProperty,d=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,m=Object.prototype;function g(e,t,r){if("string"!=typeof t){if(m){var n=f(t);n&&n!==m&&g(e,n,r)}var i=d(t);h&&(i=i.concat(h(t)));for(var o=c(e),s=c(t),l=0;l<i.length;++l){var y=i[l];if(!a[y]&&!(r&&r[y])&&!(s&&s[y])&&!(o&&o[y])){var v=p(t,y);try{u(e,y,v)}catch(e){}}}}return e}e.exports=g},57618:function(e,t){"use strict";var r="function"==typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,i=r?Symbol.for("react.portal"):60106,a=r?Symbol.for("react.fragment"):60107,o=r?Symbol.for("react.strict_mode"):60108,s=r?Symbol.for("react.profiler"):60114,l=r?Symbol.for("react.provider"):60109,c=r?Symbol.for("react.context"):60110,u=r?Symbol.for("react.async_mode"):60111,d=r?Symbol.for("react.concurrent_mode"):60111,h=r?Symbol.for("react.forward_ref"):60112,p=r?Symbol.for("react.suspense"):60113,f=r?Symbol.for("react.suspense_list"):60120,m=r?Symbol.for("react.memo"):60115,g=r?Symbol.for("react.lazy"):60116,y=r?Symbol.for("react.block"):60121,v=r?Symbol.for("react.fundamental"):60117,b=r?Symbol.for("react.responder"):60118,_=r?Symbol.for("react.scope"):60119;function w(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case u:case d:case a:case s:case o:case p:return e;default:switch(e=e&&e.$$typeof){case c:case h:case g:case m:case l:return e;default:return t}}case i:return t}}}function S(e){return w(e)===d}t.AsyncMode=u,t.ConcurrentMode=d,t.ContextConsumer=c,t.ContextProvider=l,t.Element=n,t.ForwardRef=h,t.Fragment=a,t.Lazy=g,t.Memo=m,t.Portal=i,t.Profiler=s,t.StrictMode=o,t.Suspense=p,t.isAsyncMode=function(e){return S(e)||w(e)===u},t.isConcurrentMode=S,t.isContextConsumer=function(e){return w(e)===c},t.isContextProvider=function(e){return w(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return w(e)===h},t.isFragment=function(e){return w(e)===a},t.isLazy=function(e){return w(e)===g},t.isMemo=function(e){return w(e)===m},t.isPortal=function(e){return w(e)===i},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===o},t.isSuspense=function(e){return w(e)===p},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===d||e===s||e===o||e===p||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===l||e.$$typeof===c||e.$$typeof===h||e.$$typeof===v||e.$$typeof===b||e.$$typeof===_||e.$$typeof===y)},t.typeOf=w},44300:function(e,t,r){"use strict";e.exports=r(57618)},68848:function(e,t){t.read=function(e,t,r,n,i){var a,o,s=8*i-n-1,l=(1<<s)-1,c=l>>1,u=-7,d=r?i-1:0,h=r?-1:1,p=e[t+d];for(d+=h,a=p&(1<<-u)-1,p>>=-u,u+=s;u>0;a=256*a+e[t+d],d+=h,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=n;u>0;o=256*o+e[t+d],d+=h,u-=8);if(0===a)a=1-c;else{if(a===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),a-=c}return(p?-1:1)*o*Math.pow(2,a-n)},t.write=function(e,t,r,n,i,a){var o,s,l,c=8*a-i-1,u=(1<<c)-1,d=u>>1,h=23===i?5960464477539062e-23:0,p=n?0:a-1,f=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(o++,l/=2),o+d>=u?(s=0,o=u):o+d>=1?(s=(t*l-1)*Math.pow(2,i),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;e[r+p]=255&s,p+=f,s/=256,i-=8);for(o=o<<i|s,c+=i;c>0;e[r+p]=255&o,p+=f,o/=256,c-=8);e[r+p-f]|=128*m}},57062:function(e,t){"use strict";var r=/^[A-Za-z0-9][A-Za-z0-9!#$&^_.-]{0,126}$/,n=/^[A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126}$/,i=/^ *([A-Za-z0-9][A-Za-z0-9!#$&^_-]{0,126})\/([A-Za-z0-9][A-Za-z0-9!#$&^_.+-]{0,126}) *$/;function a(e){if(!e||"object"!=typeof e)throw TypeError("argument obj is required");var t=e.subtype,i=e.suffix,a=e.type;if(!a||!n.test(a))throw TypeError("invalid type");if(!t||!r.test(t))throw TypeError("invalid subtype");var o=a+"/"+t;if(i){if(!n.test(i))throw TypeError("invalid suffix");o+="+"+i}return o}function o(e){if(!e)throw TypeError("argument string is required");if("string"!=typeof e)throw TypeError("argument string is required to be a string");return i.test(e.toLowerCase())}function s(e){if(!e)throw TypeError("argument string is required");if("string"!=typeof e)throw TypeError("argument string is required to be a string");var t,r=i.exec(e.toLowerCase());if(!r)throw TypeError("invalid media type");var n=r[1],a=r[2],o=a.lastIndexOf("+");return -1!==o&&(t=a.substr(o+1),a=a.substr(0,o)),new l(n,a,t)}function l(e,t,r){this.type=e,this.subtype=t,this.suffix=r}t.format=a,t.parse=s,t.test=o},35169:function(e){var t=1e3,r=6e4,n=36e5,i=864e5,a=6048e5,o=315576e5;function s(e){if(!((e=String(e)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(s){var l=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return l*o;case"weeks":case"week":case"w":return l*a;case"days":case"day":case"d":return l*i;case"hours":case"hour":case"hrs":case"hr":case"h":return l*n;case"minutes":case"minute":case"mins":case"min":case"m":return l*r;case"seconds":case"second":case"secs":case"sec":case"s":return l*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}}}function l(e){var a=Math.abs(e);return a>=i?Math.round(e/i)+"d":a>=n?Math.round(e/n)+"h":a>=r?Math.round(e/r)+"m":a>=t?Math.round(e/t)+"s":e+"ms"}function c(e){var a=Math.abs(e);return a>=i?u(e,a,i,"day"):a>=n?u(e,a,n,"hour"):a>=r?u(e,a,r,"minute"):a>=t?u(e,a,t,"second"):e+" ms"}function u(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return s(e);if("number"===r&&isFinite(e))return t.long?c(e):l(e);throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},39963:function(e,t,r){"use strict";o={value:!0},o=t.Aj=o=t.De=t.S5=o=o=o=o=void 0;let n=r(31464),i=r(25390),a=r(59758);n("music-metadata-browser:main");var o,s=r(25390);async function l(e,r,n){let i=new a.ReadableWebToNodeStream(e),o=await (0,t.De)(i,"string"==typeof r?{mimeType:r}:r,n);return await i.close(),o}async function c(e,t){let r={mimeType:e.type,size:e.size};return e instanceof File&&(r.path=e.name),l(e.stream?e.stream():u(e),{mimeType:e.type,size:e.size},t)}function u(e){let t=new FileReader;return new ReadableStream({start(r){t.onloadend=e=>{let t=e.target.result;t instanceof ArrayBuffer&&(t=new Uint8Array(t)),r.enqueue(t),r.close()},t.onerror=e=>{r.close()},t.onabort=e=>{r.close()},t.readAsArrayBuffer(e)}})}o={enumerable:!0,get:function(){return s.parseBuffer}},o={enumerable:!0,get:function(){return s.parseFromTokenizer}},o={enumerable:!0,get:function(){return s.orderTags}},o={enumerable:!0,get:function(){return s.ratingToStars}},Object.defineProperty(t,"S5",{enumerable:!0,get:function(){return s.selectCover}}),t.De=i.parseStream,o=l,t.Aj=c},65496:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ParserFactory=t.parseHttpContentType=void 0;let i=r(20922),a=r(63674),o=r(57062),s=r(31464),l=r(61826),c=r(16194),u=r(98770),d=r(74555),h=r(85370),p=r(53379),f=r(4187),m=r(63499),g=r(33978),y=r(33408),v=r(6421),b=r(46003),_=r(29155),w=r(45238),S=(0,s.default)("music-metadata:parser:factory");function T(e){let t=a.parse(e),r=o.parse(t.type);return{type:r.type,subtype:r.subtype,suffix:r.suffix,parameters:t.parameters}}async function x(e,t,r={}){let n=await E.loadParser(t),i=new l.MetadataCollector(r);return await n.init(i,e,r).parse(),i.toCommonMetadata()}t.parseHttpContentType=T;class E{static async parseOnContentType(e,t){let{mimeType:r,path:n,url:i}=await e.fileInfo,a=E.getParserIdForMimeType(r)||E.getParserIdForExtension(n)||E.getParserIdForExtension(i);return a||S("No parser found for MIME-type / extension: "+r),this.parse(e,a,t)}static async parse(e,t,r){if(!t){S("Guess parser on content...");let r=n.alloc(4100);if(await e.peekBuffer(r,{mayBeLess:!0}),e.fileInfo.path&&(t=this.getParserIdForExtension(e.fileInfo.path)),!t){let e=await i.fromBuffer(r);if(!e)throw Error("Failed to determine audio format");if(S(`Guessed file type is mime=${e.mime}, extension=${e.ext}`),!(t=E.getParserIdForMimeType(e.mime)))throw Error("Guessed MIME-type not supported: "+e.mime)}}return x(e,t,r)}static getParserIdForExtension(e){if(e)switch(this.getExtension(e).toLocaleLowerCase()||e){case".mp2":case".mp3":case".m2a":case".aac":return"mpeg";case".ape":return"apev2";case".mp4":case".m4a":case".m4b":case".m4pa":case".m4v":case".m4r":case".3gp":return"mp4";case".wma":case".wmv":case".asf":return"asf";case".flac":return"flac";case".ogg":case".ogv":case".oga":case".ogm":case".ogx":case".opus":case".spx":return"ogg";case".aif":case".aiff":case".aifc":return"aiff";case".wav":case".bwf":return"riff";case".wv":case".wvp":return"wavpack";case".mpc":return"musepack";case".dsf":return"dsf";case".dff":return"dsdiff";case".mka":case".mkv":case".mk3d":case".mks":case".webm":return"matroska"}}static async loadParser(e){switch(e){case"aiff":return new c.AIFFParser;case"adts":case"mpeg":return new f.MpegParser;case"apev2":return new u.APEv2Parser;case"asf":return new d.AsfParser;case"dsf":return new b.DsfParser;case"dsdiff":return new _.DsdiffParser;case"flac":return new h.FlacParser;case"mp4":return new p.MP4Parser;case"musepack":return new m.default;case"ogg":return new g.OggParser;case"riff":return new y.WaveParser;case"wavpack":return new v.WavPackParser;case"matroska":return new w.MatroskaParser;default:throw Error(`Unknown parser type: ${e}`)}}static getExtension(e){let t=e.lastIndexOf(".");return -1===t?"":e.slice(t)}static getParserIdForMimeType(e){let t;try{t=T(e)}catch(t){S(`Invalid HTTP Content-Type header value: ${e}`);return}let r=0===t.subtype.indexOf("x-")?t.subtype.substring(2):t.subtype;switch(t.type){case"audio":switch(r){case"mp3":case"mpeg":return"mpeg";case"aac":case"aacp":return"adts";case"flac":return"flac";case"ape":case"monkeys-audio":return"apev2";case"mp4":case"m4a":return"mp4";case"ogg":case"opus":case"speex":return"ogg";case"ms-wma":case"ms-wmv":case"ms-asf":return"asf";case"aiff":case"aif":case"aifc":return"aiff";case"vnd.wave":case"wav":case"wave":return"riff";case"wavpack":return"wavpack";case"musepack":return"musepack";case"matroska":case"webm":return"matroska";case"dsf":return"dsf"}break;case"video":switch(r){case"ms-asf":case"ms-wmv":return"asf";case"m4v":case"mp4":return"mp4";case"ogg":return"ogg";case"matroska":case"webm":return"matroska"}break;case"application":switch(r){case"vnd.ms-asf":return"asf";case"ogg":return"ogg"}}}}t.ParserFactory=E},16194:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AIFFParser=void 0;let n=r(32235),i=r(31464),a=r(61232),o=r(83437),s=r(4026),l=r(44820),c=r(96829),u=r(57721),d=(0,i.default)("music-metadata:parser:aiff"),h={NONE:"not compressed	PCM	Apple Computer",sowt:"PCM (byte swapped)",fl32:"32-bit floating point IEEE 32-bit float",fl64:"64-bit floating point IEEE 64-bit float	Apple Computer",alaw:"ALaw 2:1	8-bit ITU-T G.711 A-law",ulaw:"\xb5Law 2:1	8-bit ITU-T G.711 \xb5-law	Apple Computer",ULAW:"CCITT G.711 u-law 8-bit ITU-T G.711 \xb5-law",ALAW:"CCITT G.711 A-law 8-bit ITU-T G.711 A-law",FL32:"Float 32	IEEE 32-bit float "};class p extends l.BasicParser{async parse(){if("FORM"!==(await this.tokenizer.readToken(u.Header)).chunkID)throw Error("Invalid Chunk-ID, expected 'FORM'");let e=await this.tokenizer.readToken(s.FourCcToken);switch(e){case"AIFF":this.metadata.setFormat("container",e),this.isCompressed=!1;break;case"AIFC":this.metadata.setFormat("container","AIFF-C"),this.isCompressed=!0;break;default:throw Error("Unsupported AIFF type: "+e)}this.metadata.setFormat("lossless",!this.isCompressed);try{for(;!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=u.Header.len;){d("Reading AIFF chunk at offset="+this.tokenizer.position);let e=await this.tokenizer.readToken(u.Header),t=2*Math.round(e.chunkSize/2),r=await this.readData(e);await this.tokenizer.ignore(t-r)}}catch(e){if(e instanceof a.EndOfStreamError)d("End-of-stream");else throw e}}async readData(e){var t;switch(e.chunkID){case"COMM":let r=await this.tokenizer.readToken(new c.Common(e,this.isCompressed));return this.metadata.setFormat("bitsPerSample",r.sampleSize),this.metadata.setFormat("sampleRate",r.sampleRate),this.metadata.setFormat("numberOfChannels",r.numChannels),this.metadata.setFormat("numberOfSamples",r.numSampleFrames),this.metadata.setFormat("duration",r.numSampleFrames/r.sampleRate),this.metadata.setFormat("codec",null!==(t=r.compressionName)&&void 0!==t?t:h[r.compressionType]),e.chunkSize;case"ID3 ":let i=await this.tokenizer.readToken(new n.Uint8ArrayType(e.chunkSize)),s=a.fromBuffer(i);return await new o.ID3v2Parser().parse(this.metadata,s,this.options),e.chunkSize;case"SSND":return this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*e.chunkSize/this.metadata.format.duration),0;case"NAME":case"AUTH":case"(c) ":case"ANNO":return this.readTextChunk(e);default:return d(`Ignore chunk id=${e.chunkID}, size=${e.chunkSize}`),0}}async readTextChunk(e){return(await this.tokenizer.readToken(new n.StringType(e.chunkSize,"ascii"))).split("\0").map(e=>e.trim()).filter(e=>e&&e.length>0).forEach(t=>{this.metadata.addTag("AIFF",e.chunkID,t.trim())}),e.chunkSize}}t.AIFFParser=p},12422:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AiffTagMapper=void 0;let n=r(17289),i={NAME:"title",AUTH:"artist","(c) ":"copyright",ANNO:"comment"};class a extends n.CommonTagMapper{constructor(){super(["AIFF"],i)}}t.AiffTagMapper=a},96829:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Common=void 0;let n=r(32235),i=r(4026);class a{constructor(e,t){this.isAifc=t;let r=t?22:18;if(e.chunkSize<r)throw Error(`COMMON CHUNK size should always be at least ${r}`);this.len=e.chunkSize}get(e,t){let r=e.readUInt16BE(t+8)-16398,a=e.readUInt16BE(t+8+2),o={numChannels:e.readUInt16BE(t),numSampleFrames:e.readUInt32BE(t+2),sampleSize:e.readUInt16BE(t+6),sampleRate:r<0?a>>Math.abs(r):a<<r};if(this.isAifc){if(o.compressionType=i.FourCcToken.get(e,t+18),this.len>22){let r=e.readInt8(t+22);if(r>0){let i=(r+1)%2;if(23+r+i===this.len)o.compressionName=new n.StringType(r,"binary").get(e,t+23);else throw Error("Illegal pstring length")}else o.compressionName=void 0}}else o.compressionName="PCM";return o}}t.Common=a},98770:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.APEv2Parser=void 0;let i=r(31464),a=r(61232),o=r(32235),s=r(60928),l=r(44820),c=r(80939),u=(0,i.default)("music-metadata:parser:APEv2"),d="APEv2",h="APETAGEX";class p extends l.BasicParser{constructor(){super(...arguments),this.ape={}}static tryParseApeHeader(e,t,r){let n=new p;return n.init(e,t,r),n.tryParseApeHeader()}static calculateDuration(e){let t=e.totalFrames>1?e.blocksPerFrame*(e.totalFrames-1):0;return(t+=e.finalFrameBlocks)/e.sampleRate}static async findApeFooterOffset(e,t){let r=n.alloc(c.TagFooter.len);await e.randomRead(r,0,c.TagFooter.len,t-c.TagFooter.len);let i=c.TagFooter.get(r,0);if("APETAGEX"===i.ID)return u(`APE footer header at offset=${t}`),{footer:i,offset:t-i.size}}static parseTagFooter(e,t,r){let n=c.TagFooter.get(t,t.length-c.TagFooter.len);if(n.ID!==h)throw Error("Unexpected APEv2 Footer ID preamble value.");a.fromBuffer(t);let i=new p;return i.init(e,a.fromBuffer(t),r),i.parseTags(n)}async tryParseApeHeader(){if(this.tokenizer.fileInfo.size&&this.tokenizer.fileInfo.size-this.tokenizer.position<c.TagFooter.len){u("No APEv2 header found, end-of-file reached");return}let e=await this.tokenizer.peekToken(c.TagFooter);if(e.ID===h)return await this.tokenizer.ignore(c.TagFooter.len),this.parseTags(e);if(u(`APEv2 header not found at offset=${this.tokenizer.position}`),this.tokenizer.fileInfo.size){let e=this.tokenizer.fileInfo.size-this.tokenizer.position,t=n.alloc(e);return await this.tokenizer.readBuffer(t),p.parseTagFooter(this.metadata,t,this.options)}}async parse(){let e=await this.tokenizer.readToken(c.DescriptorParser);if("MAC "!==e.ID)throw Error("Unexpected descriptor ID");this.ape.descriptor=e;let t=e.descriptorBytes-c.DescriptorParser.len,r=await (t>0?this.parseDescriptorExpansion(t):this.parseHeader());return await this.tokenizer.ignore(r.forwardBytes),this.tryParseApeHeader()}async parseTags(e){let t=n.alloc(256),r=e.size-c.TagFooter.len;u(`Parse APE tags at offset=${this.tokenizer.position}, size=${r}`);for(let i=0;i<e.fields;i++){if(r<c.TagItemHeader.len){this.metadata.addWarning(`APEv2 Tag-header: ${e.fields-i} items remaining, but no more tag data to read.`);break}let a=await this.tokenizer.readToken(c.TagItemHeader);r-=c.TagItemHeader.len+a.size,await this.tokenizer.peekBuffer(t,{length:Math.min(t.length,r)});let l=s.findZero(t,0,t.length),h=await this.tokenizer.readToken(new o.StringType(l,"ascii"));switch(await this.tokenizer.ignore(1),r-=h.length+1,a.flags.dataType){case c.DataType.text_utf8:for(let e of(await this.tokenizer.readToken(new o.StringType(a.size,"utf8"))).split(/\x00/g))this.metadata.addTag(d,h,e);break;case c.DataType.binary:if(this.options.skipCovers)await this.tokenizer.ignore(a.size);else{let e=n.alloc(a.size);await this.tokenizer.readBuffer(e),l=s.findZero(e,0,e.length);let t=e.toString("utf8",0,l),r=n.from(e.slice(l+1));this.metadata.addTag(d,h,{description:t,data:r})}break;case c.DataType.external_info:u(`Ignore external info ${h}`),await this.tokenizer.ignore(a.size);break;case c.DataType.reserved:u(`Ignore external info ${h}`),this.metadata.addWarning(`APEv2 header declares a reserved datatype for "${h}"`),await this.tokenizer.ignore(a.size)}}}async parseDescriptorExpansion(e){return await this.tokenizer.ignore(e),this.parseHeader()}async parseHeader(){let e=await this.tokenizer.readToken(c.Header);return this.metadata.setFormat("lossless",!0),this.metadata.setFormat("container","Monkey's Audio"),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("numberOfChannels",e.channel),this.metadata.setFormat("duration",p.calculateDuration(e)),{forwardBytes:this.ape.descriptor.seekTableBytes+this.ape.descriptor.headerDataBytes+this.ape.descriptor.apeFrameDataBytes+this.ape.descriptor.terminatingDataBytes}}}t.APEv2Parser=p},21278:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.APEv2TagMapper=void 0;let n=r(54188),i={Title:"title",Artist:"artist",Artists:"artists","Album Artist":"albumartist",Album:"album",Year:"date",Originalyear:"originalyear",Originaldate:"originaldate",Comment:"comment",Track:"track",Disc:"disk",DISCNUMBER:"disk",Genre:"genre","Cover Art (Front)":"picture","Cover Art (Back)":"picture",Composer:"composer",Lyrics:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",Lyricist:"lyricist",Writer:"writer",Conductor:"conductor",MixArtist:"remixer",Arranger:"arranger",Engineer:"engineer",Producer:"producer",DJMixer:"djmixer",Mixer:"mixer",Label:"label",Grouping:"grouping",Subtitle:"subtitle",DiscSubtitle:"discsubtitle",Compilation:"compilation",BPM:"bpm",Mood:"mood",Media:"media",CatalogNumber:"catalognumber",MUSICBRAINZ_ALBUMSTATUS:"releasestatus",MUSICBRAINZ_ALBUMTYPE:"releasetype",RELEASECOUNTRY:"releasecountry",Script:"script",Language:"language",Copyright:"copyright",LICENSE:"license",EncodedBy:"encodedby",EncoderSettings:"encodersettings",Barcode:"barcode",ISRC:"isrc",ASIN:"asin",musicbrainz_trackid:"musicbrainz_recordingid",musicbrainz_releasetrackid:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",Acoustid_Id:"acoustid_id",ACOUSTID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",Weblink:"website",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",MP3GAIN_MINMAX:"replaygain_track_minmax",MP3GAIN_UNDO:"replaygain_undo"};class a extends n.CaseInsensitiveTagMap{constructor(){super(["APEv2"],i)}}t.APEv2TagMapper=a},80939:function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isBitSet=t.parseTagFlags=t.TagField=t.TagItemHeader=t.TagFooter=t.Header=t.DescriptorParser=t.DataType=void 0;let i=r(32235),a=r(4026);!function(e){e[e.text_utf8=0]="text_utf8",e[e.binary=1]="binary",e[e.external_info=2]="external_info",e[e.reserved=3]="reserved"}(n=t.DataType||(t.DataType={})),t.DescriptorParser={len:52,get:(e,t)=>({ID:a.FourCcToken.get(e,t),version:i.UINT32_LE.get(e,t+4)/1e3,descriptorBytes:i.UINT32_LE.get(e,t+8),headerBytes:i.UINT32_LE.get(e,t+12),seekTableBytes:i.UINT32_LE.get(e,t+16),headerDataBytes:i.UINT32_LE.get(e,t+20),apeFrameDataBytes:i.UINT32_LE.get(e,t+24),apeFrameDataBytesHigh:i.UINT32_LE.get(e,t+28),terminatingDataBytes:i.UINT32_LE.get(e,t+32),fileMD5:new i.Uint8ArrayType(16).get(e,t+36)})},t.Header={len:24,get:(e,t)=>({compressionLevel:i.UINT16_LE.get(e,t),formatFlags:i.UINT16_LE.get(e,t+2),blocksPerFrame:i.UINT32_LE.get(e,t+4),finalFrameBlocks:i.UINT32_LE.get(e,t+8),totalFrames:i.UINT32_LE.get(e,t+12),bitsPerSample:i.UINT16_LE.get(e,t+16),channel:i.UINT16_LE.get(e,t+18),sampleRate:i.UINT32_LE.get(e,t+20)})},t.TagFooter={len:32,get:(e,t)=>({ID:new i.StringType(8,"ascii").get(e,t),version:i.UINT32_LE.get(e,t+8),size:i.UINT32_LE.get(e,t+12),fields:i.UINT32_LE.get(e,t+16),flags:s(i.UINT32_LE.get(e,t+20))})},t.TagItemHeader={len:8,get:(e,t)=>({size:i.UINT32_LE.get(e,t),flags:s(i.UINT32_LE.get(e,t+4))})};let o=e=>new i.Uint8ArrayType(e.size-t.TagFooter.len);function s(e){return{containsHeader:l(e,31),containsFooter:l(e,30),isHeader:l(e,31),readOnly:l(e,0),dataType:(6&e)>>1}}function l(e,t){return(e&1<<t)!=0}t.TagField=o,t.parseTagFlags=s,t.isBitSet=l},41483:function(e,t,r){"use strict";var n,i=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.WmPictureToken=t.MetadataLibraryObjectState=t.MetadataObjectState=t.ExtendedStreamPropertiesObjectState=t.ExtendedContentDescriptionObjectState=t.ContentDescriptionObjectState=t.readCodecEntries=t.HeaderExtensionObject=t.StreamPropertiesObject=t.FilePropertiesObject=t.IgnoreObjectState=t.State=t.HeaderObjectToken=t.TopLevelHeaderObjectToken=t.DataType=void 0;let a=r(60928),o=r(32235),s=r(48156),l=r(9867),c=r(93367);!function(e){e[e.UnicodeString=0]="UnicodeString",e[e.ByteArray=1]="ByteArray",e[e.Bool=2]="Bool",e[e.DWord=3]="DWord",e[e.QWord=4]="QWord",e[e.Word=5]="Word"}(n=t.DataType||(t.DataType={})),t.TopLevelHeaderObjectToken={len:30,get:(e,t)=>({objectId:s.default.fromBin(new o.BufferType(16).get(e,t)),objectSize:Number(o.UINT64_LE.get(e,t+16)),numberOfHeaderObjects:o.UINT32_LE.get(e,t+24)})},t.HeaderObjectToken={len:24,get:(e,t)=>({objectId:s.default.fromBin(new o.BufferType(16).get(e,t)),objectSize:Number(o.UINT64_LE.get(e,t+16))})};class u{constructor(e){this.len=Number(e.objectSize)-t.HeaderObjectToken.len}postProcessTag(e,t,r,n){if("WM/Picture"===t)e.push({id:t,value:E.fromBuffer(n)});else{let i=l.AsfUtil.getParserForAttr(r);if(!i)throw Error("unexpected value headerType: "+r);e.push({id:t,value:i(n)})}}}t.State=u;class d extends u{constructor(e){super(e)}get(e,t){return null}}t.IgnoreObjectState=d;class h extends u{constructor(e){super(e)}get(e,t){return{fileId:s.default.fromBin(e,t),fileSize:o.UINT64_LE.get(e,t+16),creationDate:o.UINT64_LE.get(e,t+24),dataPacketsCount:o.UINT64_LE.get(e,t+32),playDuration:o.UINT64_LE.get(e,t+40),sendDuration:o.UINT64_LE.get(e,t+48),preroll:o.UINT64_LE.get(e,t+56),flags:{broadcast:a.getBit(e,t+64,24),seekable:a.getBit(e,t+64,25)},minimumDataPacketSize:o.UINT32_LE.get(e,t+68),maximumDataPacketSize:o.UINT32_LE.get(e,t+72),maximumBitrate:o.UINT32_LE.get(e,t+76)}}}h.guid=s.default.FilePropertiesObject,t.FilePropertiesObject=h;class p extends u{constructor(e){super(e)}get(e,t){return{streamType:s.default.decodeMediaType(s.default.fromBin(e,t)),errorCorrectionType:s.default.fromBin(e,t+8)}}}p.guid=s.default.StreamPropertiesObject,t.StreamPropertiesObject=p;class f{constructor(){this.len=22}get(e,t){return{reserved1:s.default.fromBin(e,t),reserved2:e.readUInt16LE(t+16),extensionDataSize:e.readUInt32LE(t+18)}}}f.guid=s.default.HeaderExtensionObject,t.HeaderExtensionObject=f;let m={len:20,get:(e,t)=>({entryCount:e.readUInt16LE(t+16)})};async function g(e){let t=await e.readNumber(o.UINT16_LE);return(await e.readToken(new o.StringType(2*t,"utf16le"))).replace("\0","")}async function y(e){let t=await e.readToken(m),r=[];for(let n=0;n<t.entryCount;++n)r.push(await b(e));return r}async function v(e){let t=await e.readNumber(o.UINT16_LE),r=i.alloc(t);return await e.readBuffer(r),r}async function b(e){let t=await e.readNumber(o.UINT16_LE);return{type:{videoCodec:(1&t)==1,audioCodec:(2&t)==2},codecName:await g(e),description:await g(e),information:await v(e)}}t.readCodecEntries=y;class _ extends u{constructor(e){super(e)}get(e,t){let r=[],n=t+10;for(let i=0;i<_.contentDescTags.length;++i){let a=e.readUInt16LE(t+2*i);if(a>0){let t=_.contentDescTags[i],o=n+a;r.push({id:t,value:l.AsfUtil.parseUnicodeAttr(e.slice(n,o))}),n=o}}return r}}_.guid=s.default.ContentDescriptionObject,_.contentDescTags=["Title","Author","Copyright","Description","Rating"],t.ContentDescriptionObjectState=_;class w extends u{constructor(e){super(e)}get(e,t){let r=[],n=e.readUInt16LE(t),i=t+2;for(let t=0;t<n;t+=1){let t=e.readUInt16LE(i);i+=2;let n=l.AsfUtil.parseUnicodeAttr(e.slice(i,i+t));i+=t;let a=e.readUInt16LE(i);i+=2;let o=e.readUInt16LE(i);i+=2;let s=e.slice(i,i+o);i+=o,this.postProcessTag(r,n,a,s)}return r}}w.guid=s.default.ExtendedContentDescriptionObject,t.ExtendedContentDescriptionObjectState=w;class S extends u{constructor(e){super(e)}get(e,t){return{startTime:o.UINT64_LE.get(e,t),endTime:o.UINT64_LE.get(e,t+8),dataBitrate:e.readInt32LE(t+12),bufferSize:e.readInt32LE(t+16),initialBufferFullness:e.readInt32LE(t+20),alternateDataBitrate:e.readInt32LE(t+24),alternateBufferSize:e.readInt32LE(t+28),alternateInitialBufferFullness:e.readInt32LE(t+32),maximumObjectSize:e.readInt32LE(t+36),flags:{reliableFlag:a.getBit(e,t+40,0),seekableFlag:a.getBit(e,t+40,1),resendLiveCleanpointsFlag:a.getBit(e,t+40,2)},streamNumber:e.readInt16LE(t+42),streamLanguageId:e.readInt16LE(t+44),averageTimePerFrame:e.readInt32LE(t+52),streamNameCount:e.readInt32LE(t+54),payloadExtensionSystems:e.readInt32LE(t+56),streamNames:[],streamPropertiesObject:null}}}S.guid=s.default.ExtendedStreamPropertiesObject,t.ExtendedStreamPropertiesObjectState=S;class T extends u{constructor(e){super(e)}get(e,t){let r=[],n=i.from(e),a=n.readUInt16LE(t),o=t+2;for(let e=0;e<a;e+=1){o+=4;let e=n.readUInt16LE(o);o+=2;let t=n.readUInt16LE(o);o+=2;let i=n.readUInt32LE(o);o+=4;let a=l.AsfUtil.parseUnicodeAttr(n.slice(o,o+e));o+=e;let s=n.slice(o,o+i);o+=i,this.postProcessTag(r,a,t,s)}return r}}T.guid=s.default.MetadataObject,t.MetadataObjectState=T;class x extends T{constructor(e){super(e)}}x.guid=s.default.MetadataLibraryObject,t.MetadataLibraryObjectState=x;class E{static fromBase64(e){return this.fromBuffer(i.from(e,"base64"))}static fromBuffer(e){return new E(e.length).get(e,0)}constructor(e){this.len=e}get(e,t){let r=e.readUInt8(t++),n=e.readInt32LE(t),i=5;for(;0!==e.readUInt16BE(i);)i+=2;let a=e.slice(5,i).toString("utf16le");for(;0!==e.readUInt16BE(i);)i+=2;let o=e.slice(5,i).toString("utf16le");return{type:c.AttachedPictureType[r],format:a,description:o,size:n,data:e.slice(i+4)}}}t.WmPictureToken=E},74555:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsfParser=void 0;let n=r(31464),i=r(27469),a=r(48156),o=r(41483),s=r(44820),l=(0,n.default)("music-metadata:parser:ASF"),c="asf";class u extends s.BasicParser{async parse(){let e=await this.tokenizer.readToken(o.TopLevelHeaderObjectToken);if(!e.objectId.equals(a.default.HeaderObject))throw Error("expected asf header; but was not found; got: "+e.objectId.str);try{await this.parseObjectHeader(e.numberOfHeaderObjects)}catch(e){l("Error while parsing ASF: %s",e)}}async parseObjectHeader(e){let t;do{let e=await this.tokenizer.readToken(o.HeaderObjectToken);switch(l("header GUID=%s",e.objectId.str),e.objectId.str){case o.FilePropertiesObject.guid.str:let r=await this.tokenizer.readToken(new o.FilePropertiesObject(e));this.metadata.setFormat("duration",Number(r.playDuration/BigInt(1e3))/1e4-Number(r.preroll)/1e3),this.metadata.setFormat("bitrate",r.maximumBitrate);break;case o.StreamPropertiesObject.guid.str:let n=await this.tokenizer.readToken(new o.StreamPropertiesObject(e));this.metadata.setFormat("container","ASF/"+n.streamType);break;case o.HeaderExtensionObject.guid.str:let s=await this.tokenizer.readToken(new o.HeaderExtensionObject);await this.parseExtensionObject(s.extensionDataSize);break;case o.ContentDescriptionObjectState.guid.str:t=await this.tokenizer.readToken(new o.ContentDescriptionObjectState(e)),this.addTags(t);break;case o.ExtendedContentDescriptionObjectState.guid.str:t=await this.tokenizer.readToken(new o.ExtendedContentDescriptionObjectState(e)),this.addTags(t);break;case a.default.CodecListObject.str:let c=await o.readCodecEntries(this.tokenizer);c.forEach(e=>{this.metadata.addStreamInfo({type:e.type.videoCodec?i.TrackType.video:i.TrackType.audio,codecName:e.codecName})});let u=c.filter(e=>e.type.audioCodec).map(e=>e.codecName).join("/");this.metadata.setFormat("codec",u);break;case a.default.StreamBitratePropertiesObject.str:await this.tokenizer.ignore(e.objectSize-o.HeaderObjectToken.len);break;case a.default.PaddingObject.str:l("Padding: %s bytes",e.objectSize-o.HeaderObjectToken.len),await this.tokenizer.ignore(e.objectSize-o.HeaderObjectToken.len);break;default:this.metadata.addWarning("Ignore ASF-Object-GUID: "+e.objectId.str),l("Ignore ASF-Object-GUID: %s",e.objectId.str),await this.tokenizer.readToken(new o.IgnoreObjectState(e))}}while(--e)}addTags(e){e.forEach(e=>{this.metadata.addTag(c,e.id,e.value)})}async parseExtensionObject(e){do{let t=await this.tokenizer.readToken(o.HeaderObjectToken),r=t.objectSize-o.HeaderObjectToken.len;switch(t.objectId.str){case o.ExtendedStreamPropertiesObjectState.guid.str:await this.tokenizer.readToken(new o.ExtendedStreamPropertiesObjectState(t));break;case o.MetadataObjectState.guid.str:let n=await this.tokenizer.readToken(new o.MetadataObjectState(t));this.addTags(n);break;case o.MetadataLibraryObjectState.guid.str:let i=await this.tokenizer.readToken(new o.MetadataLibraryObjectState(t));this.addTags(i);break;case a.default.PaddingObject.str:await this.tokenizer.ignore(r);break;case a.default.CompatibilityObject.str:this.tokenizer.ignore(r);break;case a.default.ASF_Index_Placeholder_Object.str:await this.tokenizer.ignore(r);break;default:this.metadata.addWarning("Ignore ASF-Object-GUID: "+t.objectId.str),await this.tokenizer.readToken(new o.IgnoreObjectState(t))}e-=t.objectSize}while(e>0)}}t.AsfParser=u},6149:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AsfTagMapper=void 0;let n=r(17289),i={Title:"title",Author:"artist","WM/AlbumArtist":"albumartist","WM/AlbumTitle":"album","WM/Year":"date","WM/OriginalReleaseTime":"originaldate","WM/OriginalReleaseYear":"originalyear",Description:"comment","WM/TrackNumber":"track","WM/PartOfSet":"disk","WM/Genre":"genre","WM/Composer":"composer","WM/Lyrics":"lyrics","WM/AlbumSortOrder":"albumsort","WM/TitleSortOrder":"titlesort","WM/ArtistSortOrder":"artistsort","WM/AlbumArtistSortOrder":"albumartistsort","WM/ComposerSortOrder":"composersort","WM/Writer":"lyricist","WM/Conductor":"conductor","WM/ModifiedBy":"remixer","WM/Engineer":"engineer","WM/Producer":"producer","WM/DJMixer":"djmixer","WM/Mixer":"mixer","WM/Publisher":"label","WM/ContentGroupDescription":"grouping","WM/SubTitle":"subtitle","WM/SetSubTitle":"discsubtitle","WM/IsCompilation":"compilation","WM/SharedUserRating":"rating","WM/BeatsPerMinute":"bpm","WM/Mood":"mood","WM/Media":"media","WM/CatalogNo":"catalognumber","MusicBrainz/Album Status":"releasestatus","MusicBrainz/Album Type":"releasetype","MusicBrainz/Album Release Country":"releasecountry","WM/Script":"script","WM/Language":"language",Copyright:"copyright",LICENSE:"license","WM/EncodedBy":"encodedby","WM/EncodingSettings":"encodersettings","WM/Barcode":"barcode","WM/ISRC":"isrc","MusicBrainz/Track Id":"musicbrainz_recordingid","MusicBrainz/Release Track Id":"musicbrainz_trackid","MusicBrainz/Album Id":"musicbrainz_albumid","MusicBrainz/Artist Id":"musicbrainz_artistid","MusicBrainz/Album Artist Id":"musicbrainz_albumartistid","MusicBrainz/Release Group Id":"musicbrainz_releasegroupid","MusicBrainz/Work Id":"musicbrainz_workid","MusicBrainz/TRM Id":"musicbrainz_trmid","MusicBrainz/Disc Id":"musicbrainz_discid","Acoustid/Id":"acoustid_id","Acoustid/Fingerprint":"acoustid_fingerprint","MusicIP/PUID":"musicip_puid","WM/ARTISTS":"artists","WM/InitialKey":"key",ASIN:"asin","WM/Work":"work","WM/AuthorURL":"website","WM/Picture":"picture"};class a extends n.CommonTagMapper{static toRating(e){return{rating:parseFloat(e+1)/5}}constructor(){super(["asf"],i)}postMap(e){if("WM/SharedUserRating"===e.id){let t=e.id.split(":");e.value=a.toRating(e.value),e.id=t[0]}}}t.AsfTagMapper=a},9867:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.AsfUtil=void 0;let i=r(32235),a=r(60928);class o{static getParserForAttr(e){return o.attributeParsers[e]}static parseUnicodeAttr(e){return a.stripNulls(a.decodeString(e,"utf16le"))}static parseByteArrayAttr(e){return n.from(e)}static parseBoolAttr(e,t=0){return 1===o.parseWordAttr(e,t)}static parseDWordAttr(e,t=0){return e.readUInt32LE(t)}static parseQWordAttr(e,t=0){return i.UINT64_LE.get(e,t)}static parseWordAttr(e,t=0){return e.readUInt16LE(t)}}o.attributeParsers=[o.parseUnicodeAttr,o.parseByteArrayAttr,o.parseBoolAttr,o.parseDWordAttr,o.parseQWordAttr,o.parseWordAttr,o.parseByteArrayAttr],t.AsfUtil=o},48156:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0});class i{static fromBin(e,t=0){return new i(this.decode(e,t))}static decode(e,t=0){return(e.readUInt32LE(t).toString(16)+"-"+e.readUInt16LE(t+4).toString(16)+"-"+e.readUInt16LE(t+6).toString(16)+"-"+e.readUInt16BE(t+8).toString(16)+"-"+e.slice(t+10,t+16).toString("hex")).toUpperCase()}static decodeMediaType(e){switch(e.str){case i.AudioMedia.str:return"audio";case i.VideoMedia.str:return"video";case i.CommandMedia.str:return"command";case i.Degradable_JPEG_Media.str:return"degradable-jpeg";case i.FileTransferMedia.str:return"file-transfer";case i.BinaryMedia.str:return"binary"}}static encode(e){let t=n.alloc(16);return t.writeUInt32LE(parseInt(e.slice(0,8),16),0),t.writeUInt16LE(parseInt(e.slice(9,13),16),4),t.writeUInt16LE(parseInt(e.slice(14,18),16),6),n.from(e.slice(19,23),"hex").copy(t,8),n.from(e.slice(24),"hex").copy(t,10),t}constructor(e){this.str=e}equals(e){return this.str===e.str}toBin(){return i.encode(this.str)}}i.HeaderObject=new i("75B22630-668E-11CF-A6D9-00AA0062CE6C"),i.DataObject=new i("75B22636-668E-11CF-A6D9-00AA0062CE6C"),i.SimpleIndexObject=new i("33000890-E5B1-11CF-89F4-00A0C90349CB"),i.IndexObject=new i("D6E229D3-35DA-11D1-9034-00A0C90349BE"),i.MediaObjectIndexObject=new i("FEB103F8-12AD-4C64-840F-2A1D2F7AD48C"),i.TimecodeIndexObject=new i("3CB73FD0-0C4A-4803-953D-EDF7B6228F0C"),i.FilePropertiesObject=new i("8CABDCA1-A947-11CF-8EE4-00C00C205365"),i.StreamPropertiesObject=new i("B7DC0791-A9B7-11CF-8EE6-00C00C205365"),i.HeaderExtensionObject=new i("5FBF03B5-A92E-11CF-8EE3-00C00C205365"),i.CodecListObject=new i("86D15240-311D-11D0-A3A4-00A0C90348F6"),i.ScriptCommandObject=new i("1EFB1A30-0B62-11D0-A39B-00A0C90348F6"),i.MarkerObject=new i("F487CD01-A951-11CF-8EE6-00C00C205365"),i.BitrateMutualExclusionObject=new i("D6E229DC-35DA-11D1-9034-00A0C90349BE"),i.ErrorCorrectionObject=new i("75B22635-668E-11CF-A6D9-00AA0062CE6C"),i.ContentDescriptionObject=new i("75B22633-668E-11CF-A6D9-00AA0062CE6C"),i.ExtendedContentDescriptionObject=new i("D2D0A440-E307-11D2-97F0-00A0C95EA850"),i.ContentBrandingObject=new i("2211B3FA-BD23-11D2-B4B7-00A0C955FC6E"),i.StreamBitratePropertiesObject=new i("7BF875CE-468D-11D1-8D82-006097C9A2B2"),i.ContentEncryptionObject=new i("2211B3FB-BD23-11D2-B4B7-00A0C955FC6E"),i.ExtendedContentEncryptionObject=new i("298AE614-2622-4C17-B935-DAE07EE9289C"),i.DigitalSignatureObject=new i("2211B3FC-BD23-11D2-B4B7-00A0C955FC6E"),i.PaddingObject=new i("1806D474-CADF-4509-A4BA-9AABCB96AAE8"),i.ExtendedStreamPropertiesObject=new i("14E6A5CB-C672-4332-8399-A96952065B5A"),i.AdvancedMutualExclusionObject=new i("A08649CF-4775-4670-8A16-6E35357566CD"),i.GroupMutualExclusionObject=new i("D1465A40-5A79-4338-B71B-E36B8FD6C249"),i.StreamPrioritizationObject=new i("D4FED15B-88D3-454F-81F0-ED5C45999E24"),i.BandwidthSharingObject=new i("A69609E6-517B-11D2-B6AF-00C04FD908E9"),i.LanguageListObject=new i("7C4346A9-EFE0-4BFC-B229-393EDE415C85"),i.MetadataObject=new i("C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA"),i.MetadataLibraryObject=new i("44231C94-9498-49D1-A141-1D134E457054"),i.IndexParametersObject=new i("D6E229DF-35DA-11D1-9034-00A0C90349BE"),i.MediaObjectIndexParametersObject=new i("6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7"),i.TimecodeIndexParametersObject=new i("F55E496D-9797-4B5D-8C8B-604DFE9BFB24"),i.CompatibilityObject=new i("26F18B5D-4584-47EC-9F5F-0E651F0452C9"),i.AdvancedContentEncryptionObject=new i("43058533-6981-49E6-9B74-AD12CB86D58C"),i.AudioMedia=new i("F8699E40-5B4D-11CF-A8FD-00805F5C442B"),i.VideoMedia=new i("BC19EFC0-5B4D-11CF-A8FD-00805F5C442B"),i.CommandMedia=new i("59DACFC0-59E6-11D0-A3AC-00A0C90348F6"),i.JFIF_Media=new i("B61BE100-5B4E-11CF-A8FD-00805F5C442B"),i.Degradable_JPEG_Media=new i("35907DE0-E415-11CF-A917-00805F5C442B"),i.FileTransferMedia=new i("91BD222C-F21C-497A-8B6D-5AA86BFC0185"),i.BinaryMedia=new i("3AFB65E2-47EF-40F2-AC2C-70A90D71D343"),i.ASF_Index_Placeholder_Object=new i("D9AADE20-7C17-4F9C-BC28-8555DD98E2A2"),t.default=i},44820:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BasicParser=void 0;class r{init(e,t,r){return this.metadata=e,this.tokenizer=t,this.options=r,this}}t.BasicParser=r},54188:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CaseInsensitiveTagMap=void 0;let n=r(17289);class i extends n.CommonTagMapper{constructor(e,t){let r={};for(let e of Object.keys(t))r[e.toUpperCase()]=t[e];super(e,r)}getCommonName(e){return this.tagMap[e.toUpperCase()]}}t.CaseInsensitiveTagMap=i},94165:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CombinedTagMapper=void 0;let n=r(82534),i=r(11606),a=r(6149),o=r(35116),s=r(21278),l=r(95273),c=r(97658),u=r(26556),d=r(30620),h=r(12422);class p{constructor(){this.tagMappers={},[new n.ID3v1TagMapper,new o.ID3v22TagMapper,new i.ID3v24TagMapper,new l.MP4TagMapper,new l.MP4TagMapper,new c.VorbisTagMapper,new s.APEv2TagMapper,new a.AsfTagMapper,new u.RiffInfoTagMapper,new d.MatroskaTagMapper,new h.AiffTagMapper].forEach(e=>{this.registerTagMapper(e)})}mapTag(e,t,r){if(this.tagMappers[e])return this.tagMappers[e].mapGenericTag(t,r);throw Error("No generic tag mapper defined for tag-format: "+e)}registerTagMapper(e){for(let t of e.tagTypes)this.tagMappers[t]=e}}t.CombinedTagMapper=p},4026:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.FourCcToken=void 0;let i=r(60928),a=/^[\x21-\x7e][\x20-\x7e\x00()]{3}/;t.FourCcToken={len:4,get:(e,r)=>{let n=e.toString("binary",r,r+t.FourCcToken.len);if(!n.match(a))throw Error(`FourCC contains invalid characters: ${i.a2hex(n)} "${n}"`);return n},put:(e,t,r)=>{let i=n.from(r,"binary");if(4!==i.length)throw Error("Invalid length");return i.copy(e,t)}}},17289:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CommonTagMapper=void 0;class r{static toIntOrNull(e){let t=parseInt(e,10);return isNaN(t)?null:t}static normalizeTrack(e){let t=e.toString().split("/");return{no:parseInt(t[0],10)||null,of:parseInt(t[1],10)||null}}constructor(e,t){this.tagTypes=e,this.tagMap=t}mapGenericTag(e,t){e={id:e.id,value:e.value},this.postMap(e,t);let r=this.getCommonName(e.id);return r?{id:r,value:e.value}:null}getCommonName(e){return this.tagMap[e]}postMap(e,t){}}r.maxRatingScore=1,t.CommonTagMapper=r},77402:function(e,t){"use strict";function r(e){return t.commonTags.hasOwnProperty(e)&&!t.commonTags[e].multiple}function n(e){return!t.commonTags[e].multiple||t.commonTags[e].unique}Object.defineProperty(t,"__esModule",{value:!0}),t.isUnique=t.isSingleton=t.commonTags=void 0,t.commonTags={year:{multiple:!1},track:{multiple:!1},disk:{multiple:!1},title:{multiple:!1},artist:{multiple:!1},artists:{multiple:!0,unique:!0},albumartist:{multiple:!1},album:{multiple:!1},date:{multiple:!1},originaldate:{multiple:!1},originalyear:{multiple:!1},comment:{multiple:!0,unique:!1},genre:{multiple:!0,unique:!0},picture:{multiple:!0,unique:!0},composer:{multiple:!0,unique:!0},lyrics:{multiple:!0,unique:!1},albumsort:{multiple:!1,unique:!0},titlesort:{multiple:!1,unique:!0},work:{multiple:!1,unique:!0},artistsort:{multiple:!1,unique:!0},albumartistsort:{multiple:!1,unique:!0},composersort:{multiple:!1,unique:!0},lyricist:{multiple:!0,unique:!0},writer:{multiple:!0,unique:!0},conductor:{multiple:!0,unique:!0},remixer:{multiple:!0,unique:!0},arranger:{multiple:!0,unique:!0},engineer:{multiple:!0,unique:!0},producer:{multiple:!0,unique:!0},technician:{multiple:!0,unique:!0},djmixer:{multiple:!0,unique:!0},mixer:{multiple:!0,unique:!0},label:{multiple:!0,unique:!0},grouping:{multiple:!1},subtitle:{multiple:!0},discsubtitle:{multiple:!1},totaltracks:{multiple:!1},totaldiscs:{multiple:!1},compilation:{multiple:!1},rating:{multiple:!0},bpm:{multiple:!1},mood:{multiple:!1},media:{multiple:!1},catalognumber:{multiple:!0,unique:!0},tvShow:{multiple:!1},tvShowSort:{multiple:!1},tvSeason:{multiple:!1},tvEpisode:{multiple:!1},tvEpisodeId:{multiple:!1},tvNetwork:{multiple:!1},podcast:{multiple:!1},podcasturl:{multiple:!1},releasestatus:{multiple:!1},releasetype:{multiple:!0},releasecountry:{multiple:!1},script:{multiple:!1},language:{multiple:!1},copyright:{multiple:!1},license:{multiple:!1},encodedby:{multiple:!1},encodersettings:{multiple:!1},gapless:{multiple:!1},barcode:{multiple:!1},isrc:{multiple:!0},asin:{multiple:!1},musicbrainz_recordingid:{multiple:!1},musicbrainz_trackid:{multiple:!1},musicbrainz_albumid:{multiple:!1},musicbrainz_artistid:{multiple:!0},musicbrainz_albumartistid:{multiple:!0},musicbrainz_releasegroupid:{multiple:!1},musicbrainz_workid:{multiple:!1},musicbrainz_trmid:{multiple:!1},musicbrainz_discid:{multiple:!1},acoustid_id:{multiple:!1},acoustid_fingerprint:{multiple:!1},musicip_puid:{multiple:!1},musicip_fingerprint:{multiple:!1},website:{multiple:!1},"performer:instrument":{multiple:!0,unique:!0},averageLevel:{multiple:!1},peakLevel:{multiple:!1},notes:{multiple:!0,unique:!1},key:{multiple:!1},originalalbum:{multiple:!1},originalartist:{multiple:!1},discogs_artist_id:{multiple:!0,unique:!0},discogs_release_id:{multiple:!1},discogs_label_id:{multiple:!1},discogs_master_release_id:{multiple:!1},discogs_votes:{multiple:!1},discogs_rating:{multiple:!1},replaygain_track_peak:{multiple:!1},replaygain_track_gain:{multiple:!1},replaygain_album_peak:{multiple:!1},replaygain_album_gain:{multiple:!1},replaygain_track_minmax:{multiple:!1},replaygain_album_minmax:{multiple:!1},replaygain_undo:{multiple:!1},description:{multiple:!0},longDescription:{multiple:!1},category:{multiple:!0},hdVideo:{multiple:!1},keywords:{multiple:!0},movement:{multiple:!1},movementIndex:{multiple:!1},movementTotal:{multiple:!1},podcastId:{multiple:!1},showMovement:{multiple:!1},stik:{multiple:!1}},t.isSingleton=r,t.isUnique=n},61826:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.joinArtists=t.MetadataCollector=void 0;let n=r(27469),i=r(31464),a=r(77402),o=r(94165),s=r(17289),l=r(60928),c=r(20922),u=(0,i.default)("music-metadata:collector"),d=["matroska","APEv2","vorbis","ID3v2.4","ID3v2.3","ID3v2.2","exif","asf","iTunes","AIFF","ID3v1"];class h{constructor(e){this.opts=e,this.format={tagTypes:[],trackInfo:[]},this.native={},this.common={track:{no:null,of:null},disk:{no:null,of:null},movementIndex:{}},this.quality={warnings:[]},this.commonOrigin={},this.originPriority={},this.tagMapper=new o.CombinedTagMapper;let t=1;for(let e of d)this.originPriority[e]=t++;this.originPriority.artificial=500,this.originPriority.id3v1=600}hasAny(){return Object.keys(this.native).length>0}addStreamInfo(e){u(`streamInfo: type=${n.TrackType[e.type]}, codec=${e.codecName}`),this.format.trackInfo.push(e)}setFormat(e,t){u(`format: ${e} = ${t}`),this.format[e]=t,this.opts.observer&&this.opts.observer({metadata:this,tag:{type:"format",id:e,value:t}})}addTag(e,t,r){u(`tag ${e}.${t} = ${r}`),this.native[e]||(this.format.tagTypes.push(e),this.native[e]=[]),this.native[e].push({id:t,value:r}),this.toCommon(e,t,r)}addWarning(e){this.quality.warnings.push({message:e})}postMap(e,t){switch(t.id){case"artist":if(this.commonOrigin.artist===this.originPriority[e])return this.postMap("artificial",{id:"artists",value:t.value});this.common.artists||this.setGenericTag("artificial",{id:"artists",value:t.value});break;case"artists":if((!this.common.artist||this.commonOrigin.artist===this.originPriority.artificial)&&(!this.common.artists||-1===this.common.artists.indexOf(t.value))){let e={id:"artist",value:p((this.common.artists||[]).concat([t.value]))};this.setGenericTag("artificial",e)}break;case"picture":this.postFixPicture(t.value).then(r=>{null!==r&&(t.value=r,this.setGenericTag(e,t))});return;case"totaltracks":this.common.track.of=s.CommonTagMapper.toIntOrNull(t.value);return;case"totaldiscs":this.common.disk.of=s.CommonTagMapper.toIntOrNull(t.value);return;case"movementTotal":this.common.movementIndex.of=s.CommonTagMapper.toIntOrNull(t.value);return;case"track":case"disk":case"movementIndex":let r=this.common[t.id].of;this.common[t.id]=s.CommonTagMapper.normalizeTrack(t.value),this.common[t.id].of=null!=r?r:this.common[t.id].of;return;case"bpm":case"year":case"originalyear":t.value=parseInt(t.value,10);break;case"date":let n=parseInt(t.value.substr(0,4),10);isNaN(n)||(this.common.year=n);break;case"discogs_label_id":case"discogs_release_id":case"discogs_master_release_id":case"discogs_artist_id":case"discogs_votes":t.value="string"==typeof t.value?parseInt(t.value,10):t.value;break;case"replaygain_track_gain":case"replaygain_track_peak":case"replaygain_album_gain":case"replaygain_album_peak":t.value=(0,l.toRatio)(t.value);break;case"replaygain_track_minmax":t.value=t.value.split(",").map(e=>parseInt(e,10));break;case"replaygain_undo":let i=t.value.split(",").map(e=>parseInt(e,10));t.value={leftChannel:i[0],rightChannel:i[1]};break;case"gapless":case"compilation":case"podcast":case"showMovement":t.value="1"===t.value||1===t.value;break;case"isrc":if(this.common[t.id]&&-1!==this.common[t.id].indexOf(t.value))return}null!==t.value&&this.setGenericTag(e,t)}toCommonMetadata(){return{format:this.format,native:this.native,quality:this.quality,common:this.common}}async postFixPicture(e){if(e.data&&e.data.length>0){if(!e.format){let t=await c.fromBuffer(e.data);if(!t)return null;e.format=t.mime}return e.format=e.format.toLocaleLowerCase(),"image/jpg"===e.format&&(e.format="image/jpeg"),e}return this.addWarning("Empty picture tag found"),null}toCommon(e,t,r){let n={id:t,value:r},i=this.tagMapper.mapTag(e,n,this);i&&this.postMap(e,i)}setGenericTag(e,t){u(`common.${t.id} = ${t.value}`);let r=this.commonOrigin[t.id]||1e3,n=this.originPriority[e];if((0,a.isSingleton)(t.id)){if(!(n<=r))return u(`Ignore native tag (singleton): ${e}.${t.id} = ${t.value}`);this.common[t.id]=t.value,this.commonOrigin[t.id]=n}else if(n===r)(0,a.isUnique)(t.id)&&-1!==this.common[t.id].indexOf(t.value)?u(`Ignore duplicate value: ${e}.${t.id} = ${t.value}`):this.common[t.id].push(t.value);else{if(!(n<r))return u(`Ignore native tag (list): ${e}.${t.id} = ${t.value}`);this.common[t.id]=[t.value],this.commonOrigin[t.id]=n}this.opts.observer&&this.opts.observer({metadata:this,tag:{type:"common",id:t.id,value:t.value}})}}function p(e){return e.length>2?e.slice(0,e.length-1).join(", ")+" & "+e[e.length-1]:e.join(" & ")}t.MetadataCollector=h,t.joinArtists=p},4565:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RandomUint8ArrayReader=void 0;class r{constructor(e){this.uint8Array=e,this.fileSize=e.length}async randomRead(e,t,r,n){return e.set(this.uint8Array.subarray(n,n+r),t),r}}t.RandomUint8ArrayReader=r},60928:function(e,t,r){"use strict";var n=r(82957).Buffer;function i(e,t,r){return(e[t]&1<<r)!=0}function a(e,t,r,n){let i=t;if("utf16le"===n){for(;0!==e[i]||0!==e[i+1];){if(i>=r)return r;i+=2}return i}for(;0!==e[i];){if(i>=r)return r;i++}return i}function o(e){let t=e.indexOf("\0");return -1===t?e:e.substr(0,t)}function s(e){let t=e.length;if((1&t)!=0)throw Error("Buffer length must be even");for(let r=0;r<t;r+=2){let t=e[r];e[r]=e[r+1],e[r+1]=t}return e}function l(e,t){if(255===e[0]&&254===e[1])return l(e.subarray(2),t);if("utf16le"===t&&254===e[0]&&255===e[1]){if((1&e.length)!=0)throw Error("Expected even number of octets for 16-bit unicode string");return l(s(e),t)}return n.from(e).toString(t)}function c(e){return e=(e=e.replace(/^\x00+/g,"")).replace(/\x00+$/g,"")}function u(e,t,r,n){let i=t+~~(r/8),a=r%8,o=e[i];o&=255>>a;let s=8-a,l=n-s;return l<0?o>>=8-a-n:l>0&&(o<<=l,o|=u(e,t,r+s,l)),o}function d(e,t,r){return 1===u(e,t,r,1)}function h(e){let t=[];for(let r=0,n=e.length;r<n;r++){let n=Number(e.charCodeAt(r)).toString(16);t.push(1===n.length?"0"+n:n)}return t.join(" ")}function p(e){return 10*Math.log10(e)}function f(e){return Math.pow(10,e/10)}function m(e){let t=e.split(" ").map(e=>e.trim().toLowerCase());if(t.length>=1){let e=parseFloat(t[0]);return 2===t.length&&"db"===t[1]?{dB:e,ratio:f(e)}:{dB:p(e),ratio:e}}}Object.defineProperty(t,"__esModule",{value:!0}),t.toRatio=t.dbToRatio=t.ratioToDb=t.a2hex=t.isBitSet=t.getBitAllignedNumber=t.stripNulls=t.decodeString=t.trimRightNull=t.findZero=t.getBit=void 0,t.getBit=i,t.findZero=a,t.trimRightNull=o,t.decodeString=l,t.stripNulls=c,t.getBitAllignedNumber=u,t.isBitSet=d,t.a2hex=h,t.ratioToDb=p,t.dbToRatio=f,t.toRatio=m},25390:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanAppendingHeaders=t.selectCover=t.ratingToStars=t.orderTags=t.parseFromTokenizer=t.parseBuffer=t.parseStream=void 0;let n=r(61232),i=r(65496),a=r(4565),o=r(98770),s=r(50168),l=r(90166);function c(e,t,r={}){return d(n.fromStream(e,"string"==typeof t?{mimeType:t}:t),r)}async function u(e,t,r={}){let i=new a.RandomUint8ArrayReader(e);return await m(i,r),d(n.fromBuffer(e,"string"==typeof t?{mimeType:t}:t),r)}function d(e,t){return i.ParserFactory.parseOnContentType(e,t)}function h(e){let t={};for(let r of e)(t[r.id]=t[r.id]||[]).push(r.value);return t}function p(e){return void 0===e?0:1+Math.round(4*e)}function f(e){return e?e.reduce((e,t)=>t.name&&t.name.toLowerCase() in["front","cover","cover (front)"]?t:e):null}async function m(e,t={}){let r=e.fileSize;await (0,s.hasID3v1Header)(e)&&(r-=128,r-=await (0,l.getLyricsHeaderLength)(e)),t.apeHeader=await o.APEv2Parser.findApeFooterOffset(e,r)}t.parseStream=c,t.parseBuffer=u,t.parseFromTokenizer=d,t.orderTags=h,t.ratingToStars=p,t.selectCover=f,t.scanAppendingHeaders=m},29155:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DsdiffParser=void 0;let n=r(32235),i=r(31464),a=r(61232),o=r(4026),s=r(44820),l=r(83437),c=r(58342),u=(0,i.default)("music-metadata:parser:aiff");class d extends s.BasicParser{async parse(){let e=await this.tokenizer.readToken(c.ChunkHeader64);if("FRM8"!==e.chunkID)throw Error("Unexpected chunk-ID");let t=(await this.tokenizer.readToken(o.FourCcToken)).trim();if("DSD"===t)return this.metadata.setFormat("container",`DSDIFF/${t}`),this.metadata.setFormat("lossless",!0),this.readFmt8Chunks(e.chunkSize-BigInt(o.FourCcToken.len));throw Error(`Unsupported DSDIFF type: ${t}`)}async readFmt8Chunks(e){for(;e>=c.ChunkHeader64.len;){let t=await this.tokenizer.readToken(c.ChunkHeader64);u(`Chunk id=${t.chunkID}`),await this.readData(t),e-=BigInt(c.ChunkHeader64.len)+t.chunkSize}}async readData(e){u(`Reading data of chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);let t=this.tokenizer.position;switch(e.chunkID.trim()){case"FVER":let r=await this.tokenizer.readToken(n.UINT32_LE);u(`DSDIFF version=${r}`);break;case"PROP":if("SND "!==await this.tokenizer.readToken(o.FourCcToken))throw Error("Unexpected PROP-chunk ID");await this.handleSoundPropertyChunks(e.chunkSize-BigInt(o.FourCcToken.len));break;case"ID3":let i=await this.tokenizer.readToken(new n.Uint8ArrayType(Number(e.chunkSize))),s=a.fromBuffer(i);await new l.ID3v2Parser().parse(this.metadata,s,this.options);break;default:u(`Ignore chunk[ID=${e.chunkID}, size=${e.chunkSize}]`);break;case"DSD":this.metadata.setFormat("numberOfSamples",Number(e.chunkSize*BigInt(8)/BigInt(this.metadata.format.numberOfChannels))),this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate)}let c=e.chunkSize-BigInt(this.tokenizer.position-t);c>0&&(u(`After Parsing chunk, remaining ${c} bytes`),await this.tokenizer.ignore(Number(c)))}async handleSoundPropertyChunks(e){for(u(`Parsing sound-property-chunks, remainingSize=${e}`);e>0;){let t=await this.tokenizer.readToken(c.ChunkHeader64);u(`Sound-property-chunk[ID=${t.chunkID}, size=${t.chunkSize}]`);let r=this.tokenizer.position;switch(t.chunkID.trim()){case"FS":let i=await this.tokenizer.readToken(n.UINT32_BE);this.metadata.setFormat("sampleRate",i);break;case"CHNL":let a=await this.tokenizer.readToken(n.UINT16_BE);this.metadata.setFormat("numberOfChannels",a),await this.handleChannelChunks(t.chunkSize-BigInt(n.UINT16_BE.len));break;case"CMPR":let s=(await this.tokenizer.readToken(o.FourCcToken)).trim(),l=await this.tokenizer.readToken(n.UINT8),d=await this.tokenizer.readToken(new n.StringType(l,"ascii"));"DSD"===s&&(this.metadata.setFormat("lossless",!0),this.metadata.setFormat("bitsPerSample",1)),this.metadata.setFormat("codec",`${s} (${d})`);break;case"ABSS":let h=await this.tokenizer.readToken(n.UINT16_BE),p=await this.tokenizer.readToken(n.UINT8),f=await this.tokenizer.readToken(n.UINT8),m=await this.tokenizer.readToken(n.UINT32_BE);u(`ABSS ${h}:${p}:${f}.${m}`);break;case"LSCO":let g=await this.tokenizer.readToken(n.UINT16_BE);u(`LSCO lsConfig=${g}`);break;default:u(`Unknown sound-property-chunk[ID=${t.chunkID}, size=${t.chunkSize}]`),await this.tokenizer.ignore(Number(t.chunkSize))}let y=t.chunkSize-BigInt(this.tokenizer.position-r);y>0&&(u(`After Parsing sound-property-chunk ${t.chunkSize}, remaining ${y} bytes`),await this.tokenizer.ignore(Number(y))),e-=BigInt(c.ChunkHeader64.len)+t.chunkSize,u(`Parsing sound-property-chunks, remainingSize=${e}`)}if(this.metadata.format.lossless&&this.metadata.format.sampleRate&&this.metadata.format.numberOfChannels&&this.metadata.format.bitsPerSample){let e=this.metadata.format.sampleRate*this.metadata.format.numberOfChannels*this.metadata.format.bitsPerSample;this.metadata.setFormat("bitrate",e)}}async handleChannelChunks(e){u(`Parsing channel-chunks, remainingSize=${e}`);let t=[];for(;e>=o.FourCcToken.len;){let r=await this.tokenizer.readToken(o.FourCcToken);u(`Channel[ID=${r}]`),t.push(r),e-=BigInt(o.FourCcToken.len)}return u(`Channels: ${t.join(", ")}`),t}}t.DsdiffParser=d},58342:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChunkHeader64=void 0;let n=r(32235),i=r(4026);t.ChunkHeader64={len:12,get:(e,t)=>({chunkID:i.FourCcToken.get(e,t),chunkSize:n.INT64_BE.get(e,t+4)})}},91493:function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FormatChunk=t.ChannelType=t.DsdChunk=t.ChunkHeader=void 0;let i=r(32235),a=r(4026);t.ChunkHeader={len:12,get:(e,t)=>({id:a.FourCcToken.get(e,t),size:i.UINT64_LE.get(e,t+4)})},t.DsdChunk={len:16,get:(e,t)=>({fileSize:i.INT64_LE.get(e,t),metadataPointer:i.INT64_LE.get(e,t+8)})},function(e){e[e.mono=1]="mono",e[e.stereo=2]="stereo",e[e.channels=3]="channels",e[e.quad=4]="quad",e[e["4 channels"]=5]="4 channels",e[e["5 channels"]=6]="5 channels",e[e["5.1 channels"]=7]="5.1 channels"}(n=t.ChannelType||(t.ChannelType={})),t.FormatChunk={len:40,get:(e,t)=>({formatVersion:i.INT32_LE.get(e,t),formatID:i.INT32_LE.get(e,t+4),channelType:i.INT32_LE.get(e,t+8),channelNum:i.INT32_LE.get(e,t+12),samplingFrequency:i.INT32_LE.get(e,t+16),bitsPerSample:i.INT32_LE.get(e,t+20),sampleCount:i.INT64_LE.get(e,t+24),blockSizePerChannel:i.INT32_LE.get(e,t+32)})}},46003:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DsfParser=void 0;let n=r(31464),i=r(47178),a=r(91493),o=r(83437),s=(0,n.default)("music-metadata:parser:DSF");class l extends i.AbstractID3Parser{async postId3v2Parse(){let e=this.tokenizer.position,t=await this.tokenizer.readToken(a.ChunkHeader);if("DSD "!==t.id)throw Error("Invalid chunk signature");this.metadata.setFormat("container","DSF"),this.metadata.setFormat("lossless",!0);let r=await this.tokenizer.readToken(a.DsdChunk);if(r.metadataPointer!==BigInt(0))return s(`expect ID3v2 at offset=${r.metadataPointer}`),await this.parseChunks(r.fileSize-t.size),await this.tokenizer.ignore(Number(r.metadataPointer)-this.tokenizer.position-e),new o.ID3v2Parser().parse(this.metadata,this.tokenizer,this.options);s("No ID3v2 tag present")}async parseChunks(e){for(;e>=a.ChunkHeader.len;){let t=await this.tokenizer.readToken(a.ChunkHeader);if(s(`Parsing chunk name=${t.id} size=${t.size}`),"fmt "===t.id){let e=await this.tokenizer.readToken(a.FormatChunk);this.metadata.setFormat("numberOfChannels",e.channelNum),this.metadata.setFormat("sampleRate",e.samplingFrequency),this.metadata.setFormat("bitsPerSample",e.bitsPerSample),this.metadata.setFormat("numberOfSamples",e.sampleCount),this.metadata.setFormat("duration",Number(e.sampleCount)/e.samplingFrequency);let t=e.bitsPerSample*e.samplingFrequency*e.channelNum;this.metadata.setFormat("bitrate",t);return}this.tokenizer.ignore(Number(t.size)-a.ChunkHeader.len),e-=t.size}}}t.DsfParser=l},85370:function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FlacParser=void 0;let i=r(32235),a=r(31464),o=r(60928),s=r(45034),l=r(47178),c=r(4026),u=r(31701),d=r(40242),h=(0,a.default)("music-metadata:parser:FLAC");!function(e){e[e.STREAMINFO=0]="STREAMINFO",e[e.PADDING=1]="PADDING",e[e.APPLICATION=2]="APPLICATION",e[e.SEEKTABLE=3]="SEEKTABLE",e[e.VORBIS_COMMENT=4]="VORBIS_COMMENT",e[e.CUESHEET=5]="CUESHEET",e[e.PICTURE=6]="PICTURE"}(n||(n={}));class p extends l.AbstractID3Parser{constructor(){super(...arguments),this.padding=0}init(e,t,r){return super.init(e,t,r),this.vorbisParser=new u.VorbisParser(e,r),this}async postId3v2Parse(){let e;if("fLaC"!==(await this.tokenizer.readToken(c.FourCcToken)).toString())throw Error("Invalid FLAC preamble");do e=await this.tokenizer.readToken(f.BlockHeader),await this.parseDataBlock(e);while(!e.lastBlock);if(this.tokenizer.fileInfo.size&&this.metadata.format.duration){let e=this.tokenizer.fileInfo.size-this.tokenizer.position;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}parseDataBlock(e){switch(h(`blockHeader type=${e.type}, length=${e.length}`),e.type){case n.STREAMINFO:return this.parseBlockStreamInfo(e.length);case n.PADDING:this.padding+=e.length;break;case n.APPLICATION:case n.SEEKTABLE:break;case n.VORBIS_COMMENT:return this.parseComment(e.length);case n.CUESHEET:break;case n.PICTURE:return this.parsePicture(e.length).then();default:this.metadata.addWarning("Unknown block type: "+e.type)}return this.tokenizer.ignore(e.length).then()}async parseBlockStreamInfo(e){if(e!==f.BlockStreamInfo.len)throw Error("Unexpected block-stream-info length");let t=await this.tokenizer.readToken(f.BlockStreamInfo);this.metadata.setFormat("container","FLAC"),this.metadata.setFormat("codec","FLAC"),this.metadata.setFormat("lossless",!0),this.metadata.setFormat("numberOfChannels",t.channels),this.metadata.setFormat("bitsPerSample",t.bitsPerSample),this.metadata.setFormat("sampleRate",t.sampleRate),t.totalSamples>0&&this.metadata.setFormat("duration",t.totalSamples/t.sampleRate)}async parseComment(e){let t=await this.tokenizer.readToken(new i.Uint8ArrayType(e)),r=new d.VorbisDecoder(t,0);r.readStringUtf8();let n=r.readInt32();for(let e=0;e<n;e++){let e=r.parseUserComment();this.vorbisParser.addTag(e.key,e.value)}}async parsePicture(e){if(this.options.skipCovers)return this.tokenizer.ignore(e);{let t=await this.tokenizer.readToken(new s.VorbisPictureToken(e));this.vorbisParser.addTag("METADATA_BLOCK_PICTURE",t)}}}t.FlacParser=p;class f{}f.BlockHeader={len:4,get:(e,t)=>({lastBlock:o.getBit(e,t,7),type:o.getBitAllignedNumber(e,t,1,7),length:i.UINT24_BE.get(e,t+1)})},f.BlockStreamInfo={len:34,get:(e,t)=>({minimumBlockSize:i.UINT16_BE.get(e,t),maximumBlockSize:i.UINT16_BE.get(e,t+2)/1e3,minimumFrameSize:i.UINT24_BE.get(e,t+4),maximumFrameSize:i.UINT24_BE.get(e,t+7),sampleRate:i.UINT24_BE.get(e,t+10)>>4,channels:o.getBitAllignedNumber(e,t+12,4,3)+1,bitsPerSample:o.getBitAllignedNumber(e,t+12,7,5)+1,totalSamples:o.getBitAllignedNumber(e,t+13,4,36),fileMD5:new i.Uint8ArrayType(16).get(e,t+18)})}},50168:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.hasID3v1Header=t.ID3v1Parser=t.Genres=void 0;let i=r(31464),a=r(32235),o=r(60928),s=r(44820),l=r(98770),c=(0,i.default)("music-metadata:parser:ID3v1");t.Genres=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","Alt. Rock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta Rap","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychedelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast-Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Cappella","Euro-House","Dance Hall","Goa","Drum & Bass","Club-House","Hardcore","Terror","Indie","BritPop","Negerpunk","Polsk Punk","Beat","Christian Gangsta Rap","Heavy Metal","Black Metal","Crossover","Contemporary Christian","Christian Rock","Merengue","Salsa","Thrash Metal","Anime","JPop","Synthpop","Abstract","Art Rock","Baroque","Bhangra","Big Beat","Breakbeat","Chillout","Downtempo","Dub","EBM","Eclectic","Electro","Electroclash","Emo","Experimental","Garage","Global","IDM","Illbient","Industro-Goth","Jam Band","Krautrock","Leftfield","Lounge","Math Rock","New Romantic","Nu-Breakz","Post-Punk","Post-Rock","Psytrance","Shoegaze","Space Rock","Trop Rock","World Music","Neoclassical","Audiobook","Audio Theatre","Neue Deutsche Welle","Podcast","Indie Rock","G-Funk","Dubstep","Garage Rock","Psybient"];let u={len:128,get:(e,t)=>{let r=new d(3).get(e,t);return"TAG"===r?{header:r,title:new d(30).get(e,t+3),artist:new d(30).get(e,t+33),album:new d(30).get(e,t+63),year:new d(4).get(e,t+93),comment:new d(28).get(e,t+97),zeroByte:a.UINT8.get(e,t+127),track:a.UINT8.get(e,t+126),genre:a.UINT8.get(e,t+127)}:null}};class d extends a.StringType{constructor(e){super(e,"binary")}get(e,t){let r=super.get(e,t);return(r=(r=o.trimRightNull(r)).trim()).length>0?r:void 0}}class h extends s.BasicParser{static getGenre(e){if(e<t.Genres.length)return t.Genres[e]}async parse(){if(!this.tokenizer.fileInfo.size){c("Skip checking for ID3v1 because the file-size is unknown");return}if(this.options.apeHeader){this.tokenizer.ignore(this.options.apeHeader.offset-this.tokenizer.position);let e=new l.APEv2Parser;e.init(this.metadata,this.tokenizer,this.options),await e.parseTags(this.options.apeHeader.footer)}let e=this.tokenizer.fileInfo.size-u.len;if(this.tokenizer.position>e){c("Already consumed the last 128 bytes");return}let t=await this.tokenizer.readToken(u,e);if(t){for(let e of(c("ID3v1 header found at: pos=%s",this.tokenizer.fileInfo.size-u.len),["title","artist","album","comment","track","year"]))t[e]&&""!==t[e]&&this.addTag(e,t[e]);let e=h.getGenre(t.genre);e&&this.addTag("genre",e)}else c("ID3v1 header not found at: pos=%s",this.tokenizer.fileInfo.size-u.len)}addTag(e,t){this.metadata.addTag("ID3v1",e,t)}}async function p(e){if(e.fileSize>=128){let t=n.alloc(3);return await e.randomRead(t,0,t.length,e.fileSize-128),"TAG"===t.toString("binary")}return!1}t.ID3v1Parser=h,t.hasID3v1Header=p},82534:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v1TagMapper=void 0;let n=r(17289),i={title:"title",artist:"artist",album:"album",year:"year",comment:"comment",track:"track",genre:"genre"};class a extends n.CommonTagMapper{constructor(){super(["ID3v1"],i)}}t.ID3v1TagMapper=a},47178:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractID3Parser=void 0;let n=r(61232),i=r(31464),a=r(93367),o=r(83437),s=r(50168),l=r(44820),c=(0,i.default)("music-metadata:parser:ID3");class u extends l.BasicParser{constructor(){super(...arguments),this.id3parser=new o.ID3v2Parser}static async startsWithID3v2Header(e){return"ID3"===(await e.peekToken(a.ID3v2Header)).fileIdentifier}async parse(){try{await this.parseID3v2()}catch(e){if(e instanceof n.EndOfStreamError)c("End-of-stream");else throw e}}finalize(){}async parseID3v2(){if(await this.tryReadId3v2Headers(),c("End of ID3v2 header, go to MPEG-parser: pos=%s",this.tokenizer.position),await this.postId3v2Parse(),this.options.skipPostHeaders&&this.metadata.hasAny())this.finalize();else{let e=new s.ID3v1Parser;await e.init(this.metadata,this.tokenizer,this.options).parse(),this.finalize()}}async tryReadId3v2Headers(){if("ID3"===(await this.tokenizer.peekToken(a.ID3v2Header)).fileIdentifier)return c("Found ID3v2 header, pos=%s",this.tokenizer.position),await this.id3parser.parse(this.metadata,this.tokenizer,this.options),this.tryReadId3v2Headers()}}t.AbstractID3Parser=u},19995:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.FrameParser=t.parseGenre=void 0;let i=r(31464),a=r(32235),o=r(60928),s=r(93367),l=r(50168),c=(0,i.default)("music-metadata:id3v2:frame-parser"),u="latin1";function d(e){let t;let r=[],n="";for(let i of e)if("string"==typeof t){if("("===i&&""===t)n+="(",t=void 0;else if(")"===i){""!==n&&(r.push(n),n="");let e=h(t);e&&r.push(e),t=void 0}else t+=i}else"("===i?t="":n+=i;return n&&(0===r.length&&n.match(/^\d*$/)&&(n=l.Genres[n]),r.push(n)),r}function h(e){return"RX"===e?"Remix":"CR"===e?"Cover":e.match(/^\d*$/)?l.Genres[e]:void 0}t.parseGenre=d;class p{constructor(e,t){this.major=e,this.warningCollector=t}readData(e,t,r){let i,l;if(0===e.length){this.warningCollector.addWarning(`id3v2.${this.major} header has empty tag type=${t}`);return}let{encoding:h,bom:f}=s.TextEncodingToken.get(e,0),m=e.length,g=0,y=[],v=p.getNullTerminatorLength(h),b={};switch(c(`Parsing tag type=${t}, encoding=${h}, bom=${f}`),"TXXX"!==t&&"T"===t[0]?"T*":t){case"T*":case"IPLS":case"MVIN":case"MVNM":case"PCS":case"PCST":try{l=o.decodeString(e.slice(1),h).replace(/\x00+$/,"")}catch(e){this.warningCollector.addWarning(`id3v2.${this.major} type=${t} header has invalid string value: ${e.message}`)}switch(t){case"TMCL":case"TIPL":case"IPLS":y=this.splitValue(t,l),y=p.functionList(y);break;case"TRK":case"TRCK":case"TPOS":y=l;break;case"TCOM":case"TEXT":case"TOLY":case"TOPE":case"TPE1":case"TSRC":y=this.splitValue(t,l);break;case"TCO":case"TCON":y=this.splitValue(t,l).map(e=>d(e)).reduce((e,t)=>e.concat(t),[]);break;case"PCS":case"PCST":y=Array.isArray(y=this.major>=4?this.splitValue(t,l):[l])&&""===y[0]?1:0;break;default:y=this.major>=4?this.splitValue(t,l):[l]}break;case"TXXX":y={description:(y=p.readIdentifierAndData(e,g+1,m,h)).id,text:this.splitValue(t,o.decodeString(y.data,h).replace(/\x00+$/,""))};break;case"PIC":case"APIC":if(r){let t={};switch(g+=1,this.major){case 2:t.format=o.decodeString(e.slice(g,g+3),"latin1"),g+=3;break;case 3:case 4:i=o.findZero(e,g,m,u),t.format=o.decodeString(e.slice(g,i),u),g=i+1;break;default:throw Error("Warning: unexpected major versionIndex: "+this.major)}t.format=p.fixPictureMimeType(t.format),t.type=s.AttachedPictureType[e[g]],g+=1,i=o.findZero(e,g,m,h),t.description=o.decodeString(e.slice(g,i),h),g=i+v,t.data=n.from(e.slice(g,m)),y=t}break;case"CNT":case"PCNT":y=a.UINT32_BE.get(e,0);break;case"SYLT":for(g+=7,y=[];g<m;){let t=e.slice(g,g=o.findZero(e,g,m,h));g+=5,y.push(o.decodeString(t,h))}break;case"ULT":case"USLT":case"COM":case"COMM":g+=1,b.language=o.decodeString(e.slice(g,g+3),u),g+=3,i=o.findZero(e,g,m,h),b.description=o.decodeString(e.slice(g,i),h),g=i+v,b.text=o.decodeString(e.slice(g,m),h).replace(/\x00+$/,""),y=[b];break;case"UFID":y={owner_identifier:(y=p.readIdentifierAndData(e,g,m,u)).id,identifier:y.data};break;case"PRIV":y={owner_identifier:(y=p.readIdentifierAndData(e,g,m,u)).id,data:y.data};break;case"POPM":i=o.findZero(e,g,m,u);let _=o.decodeString(e.slice(g,i),u),w=m-(g=i+1);y={email:_,rating:a.UINT8.get(e,g),counter:w>=5?a.UINT32_BE.get(e,g+1):void 0};break;case"GEOB":{i=o.findZero(e,g+1,m,h);let t=o.decodeString(e.slice(g+1,i),u);g=i+1,i=o.findZero(e,g,m-g,h);let r=o.decodeString(e.slice(g,i),u);g=i+1,i=o.findZero(e,g,m-g,h),y={type:t,filename:r,description:o.decodeString(e.slice(g,i),u),data:e.slice(g+1,m)};break}case"WCOM":case"WCOP":case"WOAF":case"WOAR":case"WOAS":case"WORS":case"WPAY":case"WPUB":y=o.decodeString(e.slice(g,i),u);break;case"WXXX":{i=o.findZero(e,g+1,m,h);let t=o.decodeString(e.slice(g+1,i),h);g=i+("utf16le"===h?2:1),y={description:t,url:o.decodeString(e.slice(g,m),u)};break}case"WFD":case"WFED":y=o.decodeString(e.slice(g+1,o.findZero(e,g+1,m,h)),h);break;case"MCDI":y=e.slice(0,m);break;default:c("Warning: unsupported id3v2-tag-type: "+t)}return y}static fixPictureMimeType(e){switch(e=e.toLocaleLowerCase()){case"jpg":return"image/jpeg";case"png":return"image/png"}return e}static functionList(e){let t={};for(let r=0;r+1<e.length;r+=2){let n=e[r+1].split(",");t[e[r]]=t.hasOwnProperty(e[r])?t[e[r]].concat(n):n}return t}splitValue(e,t){let r;return this.major<4?(r=t.split(/\x00/g)).length>1?this.warningCollector.addWarning(`ID3v2.${this.major} ${e} uses non standard null-separator.`):r=t.split(/\//g):r=t.split(/\x00/g),p.trimArray(r)}static trimArray(e){return e.map(e=>e.replace(/\x00+$/,"").trim())}static readIdentifierAndData(e,t,r,n){let i=o.findZero(e,t,r,n),a=o.decodeString(e.slice(t,i),n);return t=i+p.getNullTerminatorLength(n),{id:a,data:e.slice(t,r)}}static getNullTerminatorLength(e){return"utf16le"===e?2:1}}t.FrameParser=p},35116:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v22TagMapper=t.id3v22TagMap=void 0;let n=r(54188);t.id3v22TagMap={TT2:"title",TP1:"artist",TP2:"albumartist",TAL:"album",TYE:"year",COM:"comment",TRK:"track",TPA:"disk",TCO:"genre",PIC:"picture",TCM:"composer",TOR:"originaldate",TOT:"originalalbum",TXT:"lyricist",TP3:"conductor",TPB:"label",TT1:"grouping",TT3:"subtitle",TLA:"language",TCR:"copyright",WCP:"license",TEN:"encodedby",TSS:"encodersettings",WAR:"website","COM:iTunPGAP":"gapless",PCS:"podcast",TCP:"compilation",TDR:"date",TS2:"albumartistsort",TSA:"albumsort",TSC:"composersort",TSP:"artistsort",TST:"titlesort",WFD:"podcasturl",TBP:"bpm"};class i extends n.CaseInsensitiveTagMap{constructor(){super(["ID3v2.2"],t.id3v22TagMap)}}t.ID3v22TagMapper=i},11606:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v24TagMapper=void 0;let n=r(17289),i=r(54188),a=r(60928),o={TIT2:"title",TPE1:"artist","TXXX:Artists":"artists",TPE2:"albumartist",TALB:"album",TDRV:"date",TORY:"originalyear",TPOS:"disk",TCON:"genre",APIC:"picture",TCOM:"composer","USLT:description":"lyrics",TSOA:"albumsort",TSOT:"titlesort",TOAL:"originalalbum",TSOP:"artistsort",TSO2:"albumartistsort",TSOC:"composersort",TEXT:"lyricist","TXXX:Writer":"writer",TPE3:"conductor",TPE4:"remixer","IPLS:arranger":"arranger","IPLS:engineer":"engineer","IPLS:producer":"producer","IPLS:DJ-mix":"djmixer","IPLS:mix":"mixer",TPUB:"label",TIT1:"grouping",TIT3:"subtitle",TRCK:"track",TCMP:"compilation",POPM:"rating",TBPM:"bpm",TMED:"media","TXXX:CATALOGNUMBER":"catalognumber","TXXX:MusicBrainz Album Status":"releasestatus","TXXX:MusicBrainz Album Type":"releasetype","TXXX:MusicBrainz Album Release Country":"releasecountry","TXXX:RELEASECOUNTRY":"releasecountry","TXXX:SCRIPT":"script",TLAN:"language",TCOP:"copyright",WCOP:"license",TENC:"encodedby",TSSE:"encodersettings","TXXX:BARCODE":"barcode","TXXX:ISRC":"isrc",TSRC:"isrc","TXXX:ASIN":"asin","TXXX:originalyear":"originalyear","UFID:http://musicbrainz.org":"musicbrainz_recordingid","TXXX:MusicBrainz Release Track Id":"musicbrainz_trackid","TXXX:MusicBrainz Album Id":"musicbrainz_albumid","TXXX:MusicBrainz Artist Id":"musicbrainz_artistid","TXXX:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","TXXX:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","TXXX:MusicBrainz Work Id":"musicbrainz_workid","TXXX:MusicBrainz TRM Id":"musicbrainz_trmid","TXXX:MusicBrainz Disc Id":"musicbrainz_discid","TXXX:ACOUSTID_ID":"acoustid_id","TXXX:Acoustid Id":"acoustid_id","TXXX:Acoustid Fingerprint":"acoustid_fingerprint","TXXX:MusicIP PUID":"musicip_puid","TXXX:MusicMagic Fingerprint":"musicip_fingerprint",WOAR:"website",TDRC:"date",TYER:"year",TDOR:"originaldate","TIPL:arranger":"arranger","TIPL:engineer":"engineer","TIPL:producer":"producer","TIPL:DJ-mix":"djmixer","TIPL:mix":"mixer",TMOO:"mood",SYLT:"lyrics",TSST:"discsubtitle",TKEY:"key",COMM:"comment",TOPE:"originalartist","PRIV:AverageLevel":"averageLevel","PRIV:PeakLevel":"peakLevel","TXXX:DISCOGS_ARTIST_ID":"discogs_artist_id","TXXX:DISCOGS_ARTISTS":"artists","TXXX:DISCOGS_ARTIST_NAME":"artists","TXXX:DISCOGS_ALBUM_ARTISTS":"albumartist","TXXX:DISCOGS_CATALOG":"catalognumber","TXXX:DISCOGS_COUNTRY":"releasecountry","TXXX:DISCOGS_DATE":"originaldate","TXXX:DISCOGS_LABEL":"label","TXXX:DISCOGS_LABEL_ID":"discogs_label_id","TXXX:DISCOGS_MASTER_RELEASE_ID":"discogs_master_release_id","TXXX:DISCOGS_RATING":"discogs_rating","TXXX:DISCOGS_RELEASED":"date","TXXX:DISCOGS_RELEASE_ID":"discogs_release_id","TXXX:DISCOGS_VOTES":"discogs_votes","TXXX:CATALOGID":"catalognumber","TXXX:STYLE":"genre","TXXX:REPLAYGAIN_TRACK_PEAK":"replaygain_track_peak","TXXX:REPLAYGAIN_TRACK_GAIN":"replaygain_track_gain","TXXX:REPLAYGAIN_ALBUM_PEAK":"replaygain_album_peak","TXXX:REPLAYGAIN_ALBUM_GAIN":"replaygain_album_gain","TXXX:MP3GAIN_MINMAX":"replaygain_track_minmax","TXXX:MP3GAIN_ALBUM_MINMAX":"replaygain_album_minmax","TXXX:MP3GAIN_UNDO":"replaygain_undo",MVNM:"movement",MVIN:"movementIndex",PCST:"podcast",TCAT:"category",TDES:"description",TDRL:"date",TGID:"podcastId",TKWD:"keywords",WFED:"podcasturl"};class s extends i.CaseInsensitiveTagMap{static toRating(e){return{source:e.email,rating:e.rating>0?(e.rating-1)/254*n.CommonTagMapper.maxRatingScore:void 0}}constructor(){super(["ID3v2.3","ID3v2.4"],o)}postMap(e,t){switch(e.id){case"UFID":"http://musicbrainz.org"===e.value.owner_identifier&&(e.id+=":"+e.value.owner_identifier,e.value=a.decodeString(e.value.identifier,"latin1"));break;case"PRIV":switch(e.value.owner_identifier){case"AverageLevel":case"PeakValue":e.id+=":"+e.value.owner_identifier,e.value=4===e.value.data.length?e.value.data.readUInt32LE(0):null,null===e.value&&t.addWarning("Failed to parse PRIV:PeakValue");break;default:t.addWarning(`Unknown PRIV owner-identifier: ${e.value.owner_identifier}`)}break;case"COMM":e.value=e.value?e.value.text:null;break;case"POPM":e.value=s.toRating(e.value)}}}t.ID3v24TagMapper=s},83437:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ID3v2Parser=void 0;let i=r(32235),a=r(60928),o=r(19995),s=r(93367);class l{static removeUnsyncBytes(e){let t=0,r=0;for(;t<e.length-1;)t!==r&&(e[r]=e[t]),t+=255===e[t]&&0===e[t+1]?2:1,r++;return t<e.length&&(e[r++]=e[t]),e.slice(0,r)}static getFrameHeaderLength(e){switch(e){case 2:return 6;case 3:case 4:return 10;default:throw Error("header versionIndex is incorrect")}}static readFrameFlags(e){return{status:{tag_alter_preservation:a.getBit(e,0,6),file_alter_preservation:a.getBit(e,0,5),read_only:a.getBit(e,0,4)},format:{grouping_identity:a.getBit(e,1,7),compression:a.getBit(e,1,3),encryption:a.getBit(e,1,2),unsynchronisation:a.getBit(e,1,1),data_length_indicator:a.getBit(e,1,0)}}}static readFrameData(e,t,r,n,i){let a=new o.FrameParser(r,i);switch(r){case 2:return a.readData(e,t.id,n);case 3:case 4:return t.flags.format.unsynchronisation&&(e=l.removeUnsyncBytes(e)),t.flags.format.data_length_indicator&&(e=e.slice(4,e.length)),a.readData(e,t.id,n);default:throw Error("Unexpected majorVer: "+r)}}static makeDescriptionTagName(e,t){return e+(t?":"+t:"")}async parse(e,t,r){this.tokenizer=t,this.metadata=e,this.options=r;let n=await this.tokenizer.readToken(s.ID3v2Header);if("ID3"!==n.fileIdentifier)throw Error("expected ID3-header file-identifier 'ID3' was not found");return this.id3Header=n,this.headerType="ID3v2."+n.version.major,n.flags.isExtendedHeader?this.parseExtendedHeader():this.parseId3Data(n.size)}async parseExtendedHeader(){let e=await this.tokenizer.readToken(s.ExtendedHeader),t=e.size-s.ExtendedHeader.len;return t>0?this.parseExtendedHeaderData(t,e.size):this.parseId3Data(this.id3Header.size-e.size)}async parseExtendedHeaderData(e,t){return await this.tokenizer.ignore(e),this.parseId3Data(this.id3Header.size-t)}async parseId3Data(e){let t=await this.tokenizer.readToken(new i.Uint8ArrayType(e));for(let e of this.parseMetadata(t))if("TXXX"===e.id){if(e.value)for(let t of e.value.text)this.addTag(l.makeDescriptionTagName(e.id,e.value.description),t)}else if("COM"===e.id)for(let t of e.value)this.addTag(l.makeDescriptionTagName(e.id,t.description),t.text);else if("COMM"===e.id)for(let t of e.value)this.addTag(l.makeDescriptionTagName(e.id,t.description),t);else if(Array.isArray(e.value))for(let t of e.value)this.addTag(e.id,t);else this.addTag(e.id,e.value)}addTag(e,t){this.metadata.addTag(this.headerType,e,t)}parseMetadata(e){let t=0,r=[];for(;t!==e.length;){let n=l.getFrameHeaderLength(this.id3Header.version.major);if(t+n>e.length){this.metadata.addWarning("Illegal ID3v2 tag length");break}let i=e.slice(t,t+=n),a=this.readFrameHeader(i,this.id3Header.version.major),o=e.slice(t,t+=a.length),s=l.readFrameData(o,a,this.id3Header.version.major,!this.options.skipCovers,this.metadata);s&&r.push({id:a.id,value:s})}return r}readFrameHeader(e,t){let r;switch(t){case 2:(r={id:n.from(e.slice(0,3)).toString("ascii"),length:i.UINT24_BE.get(e,3)}).id.match(/[A-Z0-9]{3}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;case 3:case 4:(r={id:n.from(e.slice(0,4)).toString("ascii"),length:(4===t?s.UINT32SYNCSAFE:i.UINT32_BE).get(e,4),flags:l.readFrameFlags(e.slice(8,10))}).id.match(/[A-Z0-9]{4}/g)||this.metadata.addWarning(`Invalid ID3v2.${this.id3Header.version.major} frame-header-ID: ${r.id}`);break;default:throw Error("Unexpected majorVer: "+t)}return r}}t.ID3v2Parser=l},93367:function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.TextEncodingToken=t.ExtendedHeader=t.ID3v2Header=t.UINT32SYNCSAFE=t.AttachedPictureType=void 0;let i=r(32235),a=r(60928);!function(e){e[e.Other=0]="Other",e[e["32x32 pixels 'file icon' (PNG only)"]=1]="32x32 pixels 'file icon' (PNG only)",e[e["Other file icon"]=2]="Other file icon",e[e["Cover (front)"]=3]="Cover (front)",e[e["Cover (back)"]=4]="Cover (back)",e[e["Leaflet page"]=5]="Leaflet page",e[e["Media (e.g. label side of CD)"]=6]="Media (e.g. label side of CD)",e[e["Lead artist/lead performer/soloist"]=7]="Lead artist/lead performer/soloist",e[e["Artist/performer"]=8]="Artist/performer",e[e.Conductor=9]="Conductor",e[e["Band/Orchestra"]=10]="Band/Orchestra",e[e.Composer=11]="Composer",e[e["Lyricist/text writer"]=12]="Lyricist/text writer",e[e["Recording Location"]=13]="Recording Location",e[e["During recording"]=14]="During recording",e[e["During performance"]=15]="During performance",e[e["Movie/video screen capture"]=16]="Movie/video screen capture",e[e["A bright coloured fish"]=17]="A bright coloured fish",e[e.Illustration=18]="Illustration",e[e["Band/artist logotype"]=19]="Band/artist logotype",e[e["Publisher/Studio logotype"]=20]="Publisher/Studio logotype"}(n=t.AttachedPictureType||(t.AttachedPictureType={})),t.UINT32SYNCSAFE={get:(e,t)=>127&e[t+3]|e[t+2]<<7|e[t+1]<<14|e[t]<<21,len:4},t.ID3v2Header={len:10,get:(e,r)=>({fileIdentifier:new i.StringType(3,"ascii").get(e,r),version:{major:i.INT8.get(e,r+3),revision:i.INT8.get(e,r+4)},flags:{unsynchronisation:a.getBit(e,r+5,7),isExtendedHeader:a.getBit(e,r+5,6),expIndicator:a.getBit(e,r+5,5),footer:a.getBit(e,r+5,4)},size:t.UINT32SYNCSAFE.get(e,r+6)})},t.ExtendedHeader={len:10,get:(e,t)=>({size:i.UINT32_BE.get(e,t),extendedFlags:i.UINT16_BE.get(e,t+4),sizeOfPadding:i.UINT32_BE.get(e,t+6),crcDataPresent:a.getBit(e,t+4,31)})},t.TextEncodingToken={len:1,get:(e,t)=>{switch(e[t]){case 0:return{encoding:"latin1"};case 1:return{encoding:"utf16le",bom:!0};case 2:return{encoding:"utf16le",bom:!1};default:return{encoding:"utf8",bom:!1}}}}},57721:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;let n=r(32235),i=r(4026);t.Header={len:8,get:(e,t)=>({chunkID:i.FourCcToken.get(e,t),chunkSize:Number(BigInt(n.UINT32_BE.get(e,t+4)))})}},90166:function(e,t,r){"use strict";var n=r(82957).Buffer;async function i(e){if(e.fileSize>=143){let r=n.alloc(15);await e.randomRead(r,0,r.length,e.fileSize-143);let i=r.toString("binary");if(i.substr(6)===t.endTag2)return parseInt(i.substr(0,6),10)+15}return 0}Object.defineProperty(t,"__esModule",{value:!0}),t.getLyricsHeaderLength=t.endTag2=void 0,t.endTag2="LYRICS200",t.getLyricsHeaderLength=i},30481:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elements=void 0;let n=r(989);t.elements={440786851:{name:"ebml",container:{17030:{name:"ebmlVersion",value:n.DataType.uint},17143:{name:"ebmlReadVersion",value:n.DataType.uint},17138:{name:"ebmlMaxIDWidth",value:n.DataType.uint},17139:{name:"ebmlMaxSizeWidth",value:n.DataType.uint},17026:{name:"docType",value:n.DataType.string},17031:{name:"docTypeVersion",value:n.DataType.uint},17029:{name:"docTypeReadVersion",value:n.DataType.uint}}},408125543:{name:"segment",container:{290298740:{name:"seekHead",container:{19899:{name:"seek",container:{21419:{name:"seekId",value:n.DataType.binary},21420:{name:"seekPosition",value:n.DataType.uint}}}}},357149030:{name:"info",container:{29604:{name:"uid",value:n.DataType.uid},29572:{name:"filename",value:n.DataType.string},3979555:{name:"prevUID",value:n.DataType.uid},3965867:{name:"prevFilename",value:n.DataType.string},4110627:{name:"nextUID",value:n.DataType.uid},4096955:{name:"nextFilename",value:n.DataType.string},2807729:{name:"timecodeScale",value:n.DataType.uint},17545:{name:"duration",value:n.DataType.float},17505:{name:"dateUTC",value:n.DataType.uint},31657:{name:"title",value:n.DataType.string},19840:{name:"muxingApp",value:n.DataType.string},22337:{name:"writingApp",value:n.DataType.string}}},524531317:{name:"cluster",multiple:!0,container:{231:{name:"timecode",value:n.DataType.uid},163:{name:"unknown",value:n.DataType.binary},167:{name:"position",value:n.DataType.uid},171:{name:"prevSize",value:n.DataType.uid}}},374648427:{name:"tracks",container:{174:{name:"entries",multiple:!0,container:{215:{name:"trackNumber",value:n.DataType.uint},29637:{name:"uid",value:n.DataType.uid},131:{name:"trackType",value:n.DataType.uint},185:{name:"flagEnabled",value:n.DataType.bool},136:{name:"flagDefault",value:n.DataType.bool},21930:{name:"flagForced",value:n.DataType.bool},156:{name:"flagLacing",value:n.DataType.bool},28135:{name:"minCache",value:n.DataType.uint},28136:{name:"maxCache",value:n.DataType.uint},2352003:{name:"defaultDuration",value:n.DataType.uint},2306383:{name:"timecodeScale",value:n.DataType.float},21358:{name:"name",value:n.DataType.string},2274716:{name:"language",value:n.DataType.string},134:{name:"codecID",value:n.DataType.string},25506:{name:"codecPrivate",value:n.DataType.binary},2459272:{name:"codecName",value:n.DataType.string},3839639:{name:"codecSettings",value:n.DataType.string},3883072:{name:"codecInfoUrl",value:n.DataType.string},2536e3:{name:"codecDownloadUrl",value:n.DataType.string},170:{name:"codecDecodeAll",value:n.DataType.bool},28587:{name:"trackOverlay",value:n.DataType.uint},224:{name:"video",container:{154:{name:"flagInterlaced",value:n.DataType.bool},21432:{name:"stereoMode",value:n.DataType.uint},176:{name:"pixelWidth",value:n.DataType.uint},186:{name:"pixelHeight",value:n.DataType.uint},21680:{name:"displayWidth",value:n.DataType.uint},21690:{name:"displayHeight",value:n.DataType.uint},21683:{name:"aspectRatioType",value:n.DataType.uint},3061028:{name:"colourSpace",value:n.DataType.uint},3126563:{name:"gammaValue",value:n.DataType.float}}},225:{name:"audio",container:{181:{name:"samplingFrequency",value:n.DataType.float},30901:{name:"outputSamplingFrequency",value:n.DataType.float},159:{name:"channels",value:n.DataType.uint},148:{name:"channels",value:n.DataType.uint},32123:{name:"channelPositions",value:n.DataType.binary},25188:{name:"bitDepth",value:n.DataType.uint}}},28032:{name:"contentEncodings",container:{25152:{name:"contentEncoding",container:{20529:{name:"order",value:n.DataType.uint},20530:{name:"scope",value:n.DataType.bool},20531:{name:"type",value:n.DataType.uint},20532:{name:"contentEncoding",container:{16980:{name:"contentCompAlgo",value:n.DataType.uint},16981:{name:"contentCompSettings",value:n.DataType.binary}}},20533:{name:"contentEncoding",container:{18401:{name:"contentEncAlgo",value:n.DataType.uint},18402:{name:"contentEncKeyID",value:n.DataType.binary},18403:{name:"contentSignature ",value:n.DataType.binary},18404:{name:"ContentSigKeyID  ",value:n.DataType.binary},18405:{name:"contentSigAlgo ",value:n.DataType.uint},18406:{name:"contentSigHashAlgo ",value:n.DataType.uint}}},25188:{name:"bitDepth",value:n.DataType.uint}}}}}}}}},475249515:{name:"cues",container:{187:{name:"cuePoint",container:{179:{name:"cueTime",value:n.DataType.uid},183:{name:"positions",container:{247:{name:"track",value:n.DataType.uint},241:{name:"clusterPosition",value:n.DataType.uint},21368:{name:"blockNumber",value:n.DataType.uint},234:{name:"codecState",value:n.DataType.uint},219:{name:"reference",container:{150:{name:"time",value:n.DataType.uint},151:{name:"cluster",value:n.DataType.uint},21343:{name:"number",value:n.DataType.uint},235:{name:"codecState",value:n.DataType.uint}}},240:{name:"relativePosition",value:n.DataType.uint}}}}}}},423732329:{name:"attachments",container:{24999:{name:"attachedFiles",multiple:!0,container:{18046:{name:"description",value:n.DataType.string},18030:{name:"name",value:n.DataType.string},18016:{name:"mimeType",value:n.DataType.string},18012:{name:"data",value:n.DataType.binary},18094:{name:"uid",value:n.DataType.uid}}}}},272869232:{name:"chapters",container:{17849:{name:"editionEntry",container:{182:{name:"chapterAtom",container:{29636:{name:"uid",value:n.DataType.uid},145:{name:"timeStart",value:n.DataType.uint},146:{name:"timeEnd",value:n.DataType.uid},152:{name:"hidden",value:n.DataType.bool},17816:{name:"enabled",value:n.DataType.uid},143:{name:"track",container:{137:{name:"trackNumber",value:n.DataType.uid},128:{name:"display",container:{133:{name:"string",value:n.DataType.string},17276:{name:"language ",value:n.DataType.string},17278:{name:"country ",value:n.DataType.string}}}}}}}}}}},307544935:{name:"tags",container:{29555:{name:"tag",multiple:!0,container:{25536:{name:"target",container:{25541:{name:"tagTrackUID",value:n.DataType.uid},25540:{name:"tagChapterUID",value:n.DataType.uint},25542:{name:"tagAttachmentUID",value:n.DataType.uid},25546:{name:"targetType",value:n.DataType.string},26826:{name:"targetTypeValue",value:n.DataType.uint},25545:{name:"tagEditionUID",value:n.DataType.uid}}},26568:{name:"simpleTags",multiple:!0,container:{17827:{name:"name",value:n.DataType.string},17543:{name:"string",value:n.DataType.string},17541:{name:"binary",value:n.DataType.binary},17530:{name:"language",value:n.DataType.string},17531:{name:"languageIETF",value:n.DataType.string},17540:{name:"default",value:n.DataType.bool}}}}}}}}}}},45238:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.MatroskaParser=void 0;let i=r(32235),a=r(31464),o=r(44820),s=r(989),l=r(30481),c=(0,a.default)("music-metadata:parser:matroska");class u extends o.BasicParser{constructor(){super(),this.padding=0,this.parserMap=new Map,this.ebmlMaxIDLength=4,this.ebmlMaxSizeLength=8,this.parserMap.set(s.DataType.uint,e=>this.readUint(e)),this.parserMap.set(s.DataType.string,e=>this.readString(e)),this.parserMap.set(s.DataType.binary,e=>this.readBuffer(e)),this.parserMap.set(s.DataType.uid,async e=>await this.readUint(e)===1),this.parserMap.set(s.DataType.bool,e=>this.readFlag(e)),this.parserMap.set(s.DataType.float,e=>this.readFloat(e))}init(e,t,r){return super.init(e,t,r),this}async parse(){let e=await this.parseContainer(l.elements,this.tokenizer.fileInfo.size,[]);if(this.metadata.setFormat("container",`EBML/${e.ebml.docType}`),e.segment){let t=e.segment.info;if(t){let e=t.timecodeScale?t.timecodeScale:1e6;if("number"==typeof t.duration){let r=t.duration*e/1e9;this.addTag("segment:title",t.title),this.metadata.setFormat("duration",r)}}let r=e.segment.tracks;if(r&&r.entries){r.entries.forEach(e=>{let t={codecName:e.codecID.replace("A_","").replace("V_",""),codecSettings:e.codecSettings,flagDefault:e.flagDefault,flagLacing:e.flagLacing,flagEnabled:e.flagEnabled,language:e.language,name:e.name,type:e.trackType,audio:e.audio,video:e.video};this.metadata.addStreamInfo(t)});let t=r.entries.filter(e=>e.trackType===s.TrackType.audio.valueOf()).reduce((e,t)=>!e||!e.flagDefault&&t.flagDefault||t.trackNumber&&t.trackNumber<e.trackNumber?t:e,null);t&&(this.metadata.setFormat("codec",t.codecID.replace("A_","")),this.metadata.setFormat("sampleRate",t.audio.samplingFrequency),this.metadata.setFormat("numberOfChannels",t.audio.channels)),e.segment.tags&&e.segment.tags.tag.forEach(e=>{let t=e.target,r=(null==t?void 0:t.targetTypeValue)?s.TargetType[t.targetTypeValue]:(null==t?void 0:t.targetType)?t.targetType:"track";e.simpleTags.forEach(e=>{let t=e.string?e.string:e.binary;this.addTag(`${r}:${e.name}`,t)})}),e.segment.attachments&&e.segment.attachments.attachedFiles.filter(e=>e.mimeType.startsWith("image/")).map(e=>({data:e.data,format:e.mimeType,description:e.description,name:e.name})).forEach(e=>{this.addTag("picture",e)})}}}async parseContainer(e,t,r){let n={};for(;this.tokenizer.position<t;){let t;try{t=await this.readElement()}catch(e){if("End-Of-Stream"===e.message)break;throw e}let i=e[t.id];if(i){if(c(`Element: name=${i.name}, container=${!!i.container}`),i.container){let e=await this.parseContainer(i.container,t.len>=0?this.tokenizer.position+t.len:-1,r.concat([i.name]));i.multiple?(n[i.name]||(n[i.name]=[]),n[i.name].push(e)):n[i.name]=e}else n[i.name]=await this.parserMap.get(i.value)(t)}else 236===t.id||c(`parseEbml: path=${r.join("/")}, unknown element: id=${t.id.toString(16)}`),this.padding+=t.len,await this.tokenizer.ignore(t.len)}return n}async readVintData(e){let t=await this.tokenizer.peekNumber(i.UINT8),r=128,a=1;for(;(t&r)==0;){if(a>e)throw Error("VINT value exceeding maximum size");++a,r>>=1}let o=n.alloc(a);return await this.tokenizer.readBuffer(o),o}async readElement(){let e=await this.readVintData(this.ebmlMaxIDLength),t=await this.readVintData(this.ebmlMaxSizeLength);t[0]^=128>>t.length-1;let r=Math.min(6,t.length);return{id:e.readUIntBE(0,e.length),len:t.readUIntBE(t.length-r,r)}}isMaxValue(e){if(e.length===this.ebmlMaxSizeLength){for(let t=1;t<this.ebmlMaxSizeLength;++t)if(255!==e[t])return!1;return!0}return!1}async readFloat(e){switch(e.len){case 0:return 0;case 4:return this.tokenizer.readNumber(i.Float32_BE);case 8:case 10:return this.tokenizer.readNumber(i.Float64_BE);default:throw Error(`Invalid IEEE-754 float length: ${e.len}`)}}async readFlag(e){return await this.readUint(e)===1}async readUint(e){let t=await this.readBuffer(e),r=Math.min(6,e.len);return t.readUIntBE(e.len-r,r)}async readString(e){return(await this.tokenizer.readToken(new i.StringType(e.len,"utf-8"))).replace(/\00.*$/g,"")}async readBuffer(e){let t=n.alloc(e.len);return await this.tokenizer.readBuffer(t),t}addTag(e,t){this.metadata.addTag("matroska",e,t)}}t.MatroskaParser=u},30620:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MatroskaTagMapper=void 0;let n=r(54188),i={"segment:title":"title","album:ARTIST":"albumartist","album:ARTISTSORT":"albumartistsort","album:TITLE":"album","album:DATE_RECORDED":"originaldate","album:PART_NUMBER":"disk","album:TOTAL_PARTS":"totaltracks","track:ARTIST":"artist","track:ARTISTSORT":"artistsort","track:TITLE":"title","track:PART_NUMBER":"track","track:MUSICBRAINZ_TRACKID":"musicbrainz_recordingid","track:MUSICBRAINZ_ALBUMID":"musicbrainz_albumid","track:MUSICBRAINZ_ARTISTID":"musicbrainz_artistid","track:PUBLISHER":"label","track:GENRE":"genre","track:ENCODER":"encodedby","track:ENCODER_OPTIONS":"encodersettings","edition:TOTAL_PARTS":"totaldiscs",picture:"picture"};class a extends n.CaseInsensitiveTagMap{constructor(){super(["matroska"],i)}}t.MatroskaTagMapper=a},989:function(e,t){"use strict";var r,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.TrackType=t.TargetType=t.DataType=void 0,function(e){e[e.string=0]="string",e[e.uint=1]="uint",e[e.uid=2]="uid",e[e.bool=3]="bool",e[e.binary=4]="binary",e[e.float=5]="float"}(r=t.DataType||(t.DataType={})),function(e){e[e.shot=10]="shot",e[e.scene=20]="scene",e[e.track=30]="track",e[e.part=40]="part",e[e.album=50]="album",e[e.edition=60]="edition",e[e.collection=70]="collection"}(n=t.TargetType||(t.TargetType={})),function(e){e[e.video=1]="video",e[e.audio=2]="audio",e[e.complex=3]="complex",e[e.logo=4]="logo",e[e.subtitle=17]="subtitle",e[e.button=18]="button",e[e.control=32]="control"}(i=t.TrackType||(t.TrackType={}))},41373:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Atom=void 0;let n=r(31464),i=r(16424),a=(0,n.default)("music-metadata:parser:MP4:Atom");class o{static async readAtom(e,t,r,n){let s=e.position,l=await e.readToken(i.Header);l.length===BigInt(1)&&(l.length=await e.readToken(i.ExtendedSize));let c=new o(l,l.length===BigInt(1),r),u=c.getPayloadLength(n);return a(`parse atom name=${c.atomPath}, extended=${c.extended}, offset=${s}, len=${c.header.length}`),await c.readData(e,t,u),c}constructor(e,t,r){this.header=e,this.extended=t,this.parent=r,this.children=[],this.atomPath=(this.parent?this.parent.atomPath+".":"")+this.header.name}getHeaderLength(){return this.extended?16:8}getPayloadLength(e){return(this.header.length===BigInt(0)?e:Number(this.header.length))-this.getHeaderLength()}async readAtoms(e,t,r){for(;r>0;){let n=await o.readAtom(e,t,this,r);this.children.push(n),r-=n.header.length===BigInt(0)?r:Number(n.header.length)}}async readData(e,t,r){switch(this.header.name){case"moov":case"udta":case"trak":case"mdia":case"minf":case"stbl":case"<id>":case"ilst":case"tref":return this.readAtoms(e,t,this.getPayloadLength(r));case"meta":let n="hdlr"===(await e.peekToken(i.Header)).name?0:4;return await e.ignore(n),this.readAtoms(e,t,this.getPayloadLength(r)-n);default:return t(this,r)}}}t.Atom=o},16424:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.ChapterText=t.StcoAtom=t.StszAtom=t.StscAtom=t.SampleToChunkToken=t.SttsAtom=t.TimeToSampleToken=t.SoundSampleDescriptionV0=t.SoundSampleDescriptionVersion=t.StsdAtom=t.TrackHeaderAtom=t.NameAtom=t.DataAtom=t.MvhdAtom=t.MdhdAtom=t.FixedLengthAtom=t.mhdr=t.tkhd=t.ftyp=t.ExtendedSize=t.Header=void 0;let i=r(32235),a=r(31464),o=r(4026),s=(0,a.default)("music-metadata:parser:MP4:atom");t.Header={len:8,get:(e,t)=>{let r=i.UINT32_BE.get(e,t);if(r<0)throw Error("Invalid atom header length");return{length:BigInt(r),name:new i.StringType(4,"binary").get(e,t+4)}},put:(e,t,r)=>(i.UINT32_BE.put(e,t,Number(r.length)),o.FourCcToken.put(e,t+4,r.name))},t.ExtendedSize=i.UINT64_BE,t.ftyp={len:4,get:(e,t)=>({type:new i.StringType(4,"ascii").get(e,t)})},t.tkhd={len:4,get:(e,t)=>({type:new i.StringType(4,"ascii").get(e,t)})},t.mhdr={len:8,get:(e,t)=>({version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),nextItemID:i.UINT32_BE.get(e,t+4)})};class l{constructor(e,t,r){if(this.len=e,e<t)throw Error(`Atom ${r} expected to be ${t}, but specifies ${e} bytes long.`);e>t&&s(`Warning: atom ${r} expected to be ${t}, but was actually ${e} bytes long.`)}}t.FixedLengthAtom=l;let c=(e,t)=>new Date(1e3*(i.UINT32_BE.get(e,t)-2082844800));class u extends l{constructor(e){super(e,24,"mdhd"),this.len=e}get(e,t){return{version:i.UINT8.get(e,t+0),flags:i.UINT24_BE.get(e,t+1),creationTime:c(e,t+4),modificationTime:c(e,t+8),timeScale:i.UINT32_BE.get(e,t+12),duration:i.UINT32_BE.get(e,t+16),language:i.UINT16_BE.get(e,t+20),quality:i.UINT16_BE.get(e,t+22)}}}t.MdhdAtom=u;class d extends l{constructor(e){super(e,100,"mvhd"),this.len=e}get(e,t){return{version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),creationTime:c(e,t+4),modificationTime:c(e,t+8),timeScale:i.UINT32_BE.get(e,t+12),duration:i.UINT32_BE.get(e,t+16),preferredRate:i.UINT32_BE.get(e,t+20),preferredVolume:i.UINT16_BE.get(e,t+24),previewTime:i.UINT32_BE.get(e,t+72),previewDuration:i.UINT32_BE.get(e,t+76),posterTime:i.UINT32_BE.get(e,t+80),selectionTime:i.UINT32_BE.get(e,t+84),selectionDuration:i.UINT32_BE.get(e,t+88),currentTime:i.UINT32_BE.get(e,t+92),nextTrackID:i.UINT32_BE.get(e,t+96)}}}t.MvhdAtom=d;class h{constructor(e){this.len=e}get(e,t){return{type:{set:i.UINT8.get(e,t+0),type:i.UINT24_BE.get(e,t+1)},locale:i.UINT24_BE.get(e,t+4),value:n.from(new i.Uint8ArrayType(this.len-8).get(e,t+8))}}}t.DataAtom=h;class p{constructor(e){this.len=e}get(e,t){return{version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),name:new i.StringType(this.len-4,"utf-8").get(e,t+4)}}}t.NameAtom=p;class f{constructor(e){this.len=e}get(e,t){return{version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),creationTime:c(e,t+4),modificationTime:c(e,t+8),trackId:i.UINT32_BE.get(e,t+12),duration:i.UINT32_BE.get(e,t+20),layer:i.UINT16_BE.get(e,t+24),alternateGroup:i.UINT16_BE.get(e,t+26),volume:i.UINT16_BE.get(e,t+28)}}}t.TrackHeaderAtom=f;let m=8,g=(e,t)=>({version:i.UINT8.get(e,t),flags:i.UINT24_BE.get(e,t+1),numberOfEntries:i.UINT32_BE.get(e,t+4)});class y{constructor(e){this.len=e}get(e,t){return{dataFormat:o.FourCcToken.get(e,t),dataReferenceIndex:i.UINT16_BE.get(e,t+10),description:new i.Uint8ArrayType(this.len-12).get(e,t+12)}}}class v{constructor(e){this.len=e}get(e,t){let r=g(e,t);t+=m;let n=[];for(let a=0;a<r.numberOfEntries;++a){let r=i.UINT32_BE.get(e,t);t+=i.UINT32_BE.len,n.push(new y(r).get(e,t)),t+=r}return{header:r,table:n}}}t.StsdAtom=v,t.SoundSampleDescriptionVersion={len:8,get:(e,t)=>({version:i.INT16_BE.get(e,t),revision:i.INT16_BE.get(e,t+2),vendor:i.INT32_BE.get(e,t+4)})},t.SoundSampleDescriptionV0={len:12,get:(e,t)=>({numAudioChannels:i.INT16_BE.get(e,t+0),sampleSize:i.INT16_BE.get(e,t+2),compressionId:i.INT16_BE.get(e,t+4),packetSize:i.INT16_BE.get(e,t+6),sampleRate:i.UINT16_BE.get(e,t+8)+i.UINT16_BE.get(e,t+10)/1e4})};class b{constructor(e,t){this.len=e,this.token=t}get(e,t){let r=i.INT32_BE.get(e,t+4);return{version:i.INT8.get(e,t+0),flags:i.INT24_BE.get(e,t+1),numberOfEntries:r,entries:E(e,this.token,t+8,this.len-8,r)}}}t.TimeToSampleToken={len:8,get:(e,t)=>({count:i.INT32_BE.get(e,t+0),duration:i.INT32_BE.get(e,t+4)})};class _ extends b{constructor(e){super(e,t.TimeToSampleToken),this.len=e}}t.SttsAtom=_,t.SampleToChunkToken={len:12,get:(e,t)=>({firstChunk:i.INT32_BE.get(e,t),samplesPerChunk:i.INT32_BE.get(e,t+4),sampleDescriptionId:i.INT32_BE.get(e,t+8)})};class w extends b{constructor(e){super(e,t.SampleToChunkToken),this.len=e}}t.StscAtom=w;class S{constructor(e){this.len=e}get(e,t){let r=i.INT32_BE.get(e,t+8);return{version:i.INT8.get(e,t),flags:i.INT24_BE.get(e,t+1),sampleSize:i.INT32_BE.get(e,t+4),numberOfEntries:r,entries:E(e,i.INT32_BE,t+12,this.len-12,r)}}}t.StszAtom=S;class T extends b{constructor(e){super(e,i.INT32_BE),this.len=e}}t.StcoAtom=T;class x{constructor(e){this.len=e}get(e,t){let r=i.INT16_BE.get(e,t+0);return new i.StringType(r,"utf-8").get(e,t+2)}}function E(e,t,r,n,i){if(s(`remainingLen=${n}, numberOfEntries=${i} * token-len=${t.len}`),0===n)return[];if(n!==i*t.len)throw Error("mismatch number-of-entries with remaining atom-length");let a=[];for(let n=0;n<i;++n)a.push(t.get(e,r)),r+=t.len;return a}t.ChapterText=x},53379:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.MP4Parser=void 0;let i=r(31464),a=r(32235),o=r(44820),s=r(50168),l=r(27469),c=r(41373),u=r(16424),d=(0,i.default)("music-metadata:parser:MP4"),h="iTunes",p={raw:{lossy:!1,format:"raw"},MAC3:{lossy:!0,format:"MACE 3:1"},MAC6:{lossy:!0,format:"MACE 6:1"},ima4:{lossy:!0,format:"IMA 4:1"},ulaw:{lossy:!0,format:"uLaw 2:1"},alaw:{lossy:!0,format:"uLaw 2:1"},Qclp:{lossy:!0,format:"QUALCOMM PureVoice"},".mp3":{lossy:!0,format:"MPEG-1 layer 3"},alac:{lossy:!1,format:"ALAC"},"ac-3":{lossy:!0,format:"AC-3"},mp4a:{lossy:!0,format:"MPEG-4/AAC"},mp4s:{lossy:!0,format:"MP4S"},c608:{lossy:!0,format:"CEA-608"},c708:{lossy:!0,format:"CEA-708"}};function f(e,t,r){return r.indexOf(e)===t}class m extends o.BasicParser{constructor(){super(...arguments),this.atomParsers={mvhd:async e=>{let t=await this.tokenizer.readToken(new u.MvhdAtom(e));this.metadata.setFormat("creationTime",t.creationTime),this.metadata.setFormat("modificationTime",t.modificationTime)},mdhd:async e=>{let t=await this.tokenizer.readToken(new u.MdhdAtom(e)),r=this.getTrackDescription();r.creationTime=t.creationTime,r.modificationTime=t.modificationTime,r.timeScale=t.timeScale,r.duration=t.duration},chap:async e=>{let t=this.getTrackDescription(),r=[];for(;e>=a.UINT32_BE.len;)r.push(await this.tokenizer.readNumber(a.UINT32_BE)),e-=a.UINT32_BE.len;t.chapterList=r},tkhd:async e=>{let t=await this.tokenizer.readToken(new u.TrackHeaderAtom(e));this.tracks.push(t)},mdat:async e=>{if(this.audioLengthInBytes=e,this.calculateBitRate(),this.options.includeChapters){let t=this.tracks.filter(e=>e.chapterList);if(1===t.length){let r=t[0].chapterList,n=this.tracks.filter(e=>-1!==r.indexOf(e.trackId));if(1===n.length)return this.parseChapterTrack(n[0],t[0],e)}}await this.tokenizer.ignore(e)},ftyp:async e=>{let t=[];for(;e>0;){let r=await this.tokenizer.readToken(u.ftyp);e-=u.ftyp.len;let n=r.type.replace(/\W/g,"");n.length>0&&t.push(n)}d(`ftyp: ${t.join("/")}`);let r=t.filter(f).join("/");this.metadata.setFormat("container",r)},stsd:async e=>{let t=await this.tokenizer.readToken(new u.StsdAtom(e));this.getTrackDescription().soundSampleDescription=t.table.map(e=>this.parseSoundSampleDescription(e))},stsc:async e=>{let t=await this.tokenizer.readToken(new u.StscAtom(e));this.getTrackDescription().sampleToChunkTable=t.entries},stts:async e=>{let t=await this.tokenizer.readToken(new u.SttsAtom(e));this.getTrackDescription().timeToSampleTable=t.entries},stsz:async e=>{let t=await this.tokenizer.readToken(new u.StszAtom(e)),r=this.getTrackDescription();r.sampleSize=t.sampleSize,r.sampleSizeTable=t.entries},stco:async e=>{let t=await this.tokenizer.readToken(new u.StcoAtom(e));this.getTrackDescription().chunkOffsetTable=t.entries},date:async e=>{let t=await this.tokenizer.readToken(new a.StringType(e,"utf-8"));this.addTag("date",t)}}}static read_BE_Integer(e,t){let r=(t?"INT":"UINT")+8*e.length+(e.length>1?"_BE":""),n=a[r];if(!n)throw Error('Token for integer type not found: "'+r+'"');return Number(n.get(e,0))}async parse(){this.tracks=[];let e=this.tokenizer.fileInfo.size;for(;!this.tokenizer.fileInfo.size||e>0;){try{let e=await this.tokenizer.peekToken(u.Header);if("\0\0\0\0"===e.name){let e=`Error at offset=${this.tokenizer.position}: box.id=0`;d(e),this.addWarning(e);break}}catch(t){let e=`Error at offset=${this.tokenizer.position}: ${t.message}`;d(e),this.addWarning(e);break}let t=await c.Atom.readAtom(this.tokenizer,(e,t)=>this.handleAtom(e,t),null,e);e-=t.header.length===BigInt(0)?e:Number(t.header.length)}let t=[];this.tracks.forEach(e=>{let r=[];e.soundSampleDescription.forEach(e=>{let t={},n=p[e.dataFormat];if(n?(r.push(n.format),t.codecName=n.format):t.codecName=`<${e.dataFormat}>`,e.description){let{description:r}=e;r.sampleRate>0&&(t.type=l.TrackType.audio,t.audio={samplingFrequency:r.sampleRate,bitDepth:r.sampleSize,channels:r.numAudioChannels})}this.metadata.addStreamInfo(t)}),r.length>=1&&t.push(r.join("/"))}),t.length>0&&this.metadata.setFormat("codec",t.filter(f).join("+"));let r=this.tracks.filter(e=>e.soundSampleDescription.length>=1&&e.soundSampleDescription[0].description&&e.soundSampleDescription[0].description.numAudioChannels>0);if(r.length>=1){let e=r[0];if(e.timeScale>0){let t=e.duration/e.timeScale;this.metadata.setFormat("duration",t)}let t=e.soundSampleDescription[0];if(t.description&&(this.metadata.setFormat("sampleRate",t.description.sampleRate),this.metadata.setFormat("bitsPerSample",t.description.sampleSize),this.metadata.setFormat("numberOfChannels",t.description.numAudioChannels),0===e.timeScale&&e.timeToSampleTable.length>0)){let r=e.timeToSampleTable.map(e=>e.count*e.duration).reduce((e,t)=>e+t)/t.description.sampleRate;this.metadata.setFormat("duration",r)}let n=p[t.dataFormat];n&&this.metadata.setFormat("lossless",!n.lossy),this.calculateBitRate()}}async handleAtom(e,t){if(e.parent)switch(e.parent.header.name){case"ilst":case"<id>":return this.parseMetadataItemData(e)}if(this.atomParsers[e.header.name])return this.atomParsers[e.header.name](t);d(`No parser for atom path=${e.atomPath}, payload-len=${t}, ignoring atom`),await this.tokenizer.ignore(t)}getTrackDescription(){return this.tracks[this.tracks.length-1]}calculateBitRate(){this.audioLengthInBytes&&this.metadata.format.duration&&this.metadata.setFormat("bitrate",8*this.audioLengthInBytes/this.metadata.format.duration)}addTag(e,t){this.metadata.addTag(h,e,t)}addWarning(e){d("Warning: "+e),this.metadata.addWarning(e)}parseMetadataItemData(e){let t=e.header.name;return e.readAtoms(this.tokenizer,async(e,r)=>{let n=e.getPayloadLength(r);switch(e.header.name){case"data":return this.parseValueAtom(t,e);case"name":case"mean":case"rate":let i=await this.tokenizer.readToken(new u.NameAtom(n));t+=":"+i.name;break;default:let o=await this.tokenizer.readToken(new a.BufferType(n));this.addWarning("Unsupported meta-item: "+t+"["+e.header.name+"] => value="+o.toString("hex")+" ascii="+o.toString("ascii"))}},e.getPayloadLength(0))}async parseValueAtom(e,t){let r=await this.tokenizer.readToken(new u.DataAtom(Number(t.header.length)-u.Header.len));if(0!==r.type.set)throw Error("Unsupported type-set != 0: "+r.type.set);switch(r.type.type){case 0:switch(e){case"trkn":case"disk":let i=a.UINT8.get(r.value,3),o=a.UINT8.get(r.value,5);this.addTag(e,i+"/"+o);break;case"gnre":let l=a.UINT8.get(r.value,1),c=s.Genres[l-1];this.addTag(e,c);break;case"rate":let h=r.value.toString("ascii");this.addTag(e,h);break;default:d("unknown proprietary value type for: "+t.atomPath)}break;case 1:case 18:this.addTag(e,r.value.toString("utf-8"));break;case 13:if(this.options.skipCovers)break;this.addTag(e,{format:"image/jpeg",data:n.from(r.value)});break;case 14:if(this.options.skipCovers)break;this.addTag(e,{format:"image/png",data:n.from(r.value)});break;case 21:this.addTag(e,m.read_BE_Integer(r.value,!0));break;case 22:this.addTag(e,m.read_BE_Integer(r.value,!1));break;case 65:this.addTag(e,r.value.readInt8(0));break;case 66:this.addTag(e,r.value.readInt16BE(0));break;case 67:this.addTag(e,r.value.readInt32BE(0));break;default:this.addWarning(`atom key=${e}, has unknown well-known-type (data-type): ${r.type.type}`)}}parseSoundSampleDescription(e){let t={dataFormat:e.dataFormat,dataReferenceIndex:e.dataReferenceIndex},r=0,n=u.SoundSampleDescriptionVersion.get(e.description,r);return r+=u.SoundSampleDescriptionVersion.len,0===n.version||1===n.version?t.description=u.SoundSampleDescriptionV0.get(e.description,r):d(`Warning: sound-sample-description ${n} not implemented`),t}async parseChapterTrack(e,t,r){if(!e.sampleSize&&e.chunkOffsetTable.length!==e.sampleSizeTable.length)throw Error("Expected equal chunk-offset-table & sample-size-table length.");let n=[];for(let i=0;i<e.chunkOffsetTable.length&&r>0;++i){let a=e.chunkOffsetTable[i]-this.tokenizer.position,o=e.sampleSize>0?e.sampleSize:e.sampleSizeTable[i];if((r-=a+o)<0)throw Error("Chapter chunk exceeding token length");await this.tokenizer.ignore(a);let s=await this.tokenizer.readToken(new u.ChapterText(o));d(`Chapter ${i+1}: ${s}`);let l={title:s,sampleOffset:this.findSampleOffset(t,this.tokenizer.position)};d(`Chapter title=${l.title}, offset=${l.sampleOffset}/${this.tracks[0].duration}`),n.push(l)}this.metadata.setFormat("chapters",n),await this.tokenizer.ignore(r)}findSampleOffset(e,t){let r=0;e.timeToSampleTable.forEach(e=>{r+=e.count*e.duration}),d(`Total duration=${r}`);let n=0;for(;n<e.chunkOffsetTable.length&&e.chunkOffsetTable[n]<t;)++n;return this.getChunkDuration(n+1,e)}getChunkDuration(e,t){let r=0,n=t.timeToSampleTable[r].count,i=t.timeToSampleTable[r].duration,a=1,o=this.getSamplesPerChunk(a,t.sampleToChunkTable),s=0;for(;a<e;){let e=Math.min(n,o);s+=e*i,n-=e,0==(o-=e)?(++a,o=this.getSamplesPerChunk(a,t.sampleToChunkTable)):(++r,n=t.timeToSampleTable[r].count,i=t.timeToSampleTable[r].duration)}return s}getSamplesPerChunk(e,t){for(let r=0;r<t.length-1;++r)if(e>=t[r].firstChunk&&e<t[r+1].firstChunk)return t[r].samplesPerChunk;return t[t.length-1].samplesPerChunk}}t.MP4Parser=m},95273:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MP4TagMapper=t.tagType=void 0;let n=r(54188),i={"\xa9nam":"title","\xa9ART":"artist",aART:"albumartist","----:com.apple.iTunes:Band":"albumartist","\xa9alb":"album","\xa9day":"date","\xa9cmt":"comment","\xa9com":"comment",trkn:"track",disk:"disk","\xa9gen":"genre",covr:"picture","\xa9wrt":"composer","\xa9lyr":"lyrics",soal:"albumsort",sonm:"titlesort",soar:"artistsort",soaa:"albumartistsort",soco:"composersort","----:com.apple.iTunes:LYRICIST":"lyricist","----:com.apple.iTunes:CONDUCTOR":"conductor","----:com.apple.iTunes:REMIXER":"remixer","----:com.apple.iTunes:ENGINEER":"engineer","----:com.apple.iTunes:PRODUCER":"producer","----:com.apple.iTunes:DJMIXER":"djmixer","----:com.apple.iTunes:MIXER":"mixer","----:com.apple.iTunes:LABEL":"label","\xa9grp":"grouping","----:com.apple.iTunes:SUBTITLE":"subtitle","----:com.apple.iTunes:DISCSUBTITLE":"discsubtitle",cpil:"compilation",tmpo:"bpm","----:com.apple.iTunes:MOOD":"mood","----:com.apple.iTunes:MEDIA":"media","----:com.apple.iTunes:CATALOGNUMBER":"catalognumber",tvsh:"tvShow",tvsn:"tvSeason",tves:"tvEpisode",sosn:"tvShowSort",tven:"tvEpisodeId",tvnn:"tvNetwork",pcst:"podcast",purl:"podcasturl","----:com.apple.iTunes:MusicBrainz Album Status":"releasestatus","----:com.apple.iTunes:MusicBrainz Album Type":"releasetype","----:com.apple.iTunes:MusicBrainz Album Release Country":"releasecountry","----:com.apple.iTunes:SCRIPT":"script","----:com.apple.iTunes:LANGUAGE":"language",cprt:"copyright","\xa9cpy":"copyright","----:com.apple.iTunes:LICENSE":"license","\xa9too":"encodedby",pgap:"gapless","----:com.apple.iTunes:BARCODE":"barcode","----:com.apple.iTunes:ISRC":"isrc","----:com.apple.iTunes:ASIN":"asin","----:com.apple.iTunes:NOTES":"comment","----:com.apple.iTunes:MusicBrainz Track Id":"musicbrainz_recordingid","----:com.apple.iTunes:MusicBrainz Release Track Id":"musicbrainz_trackid","----:com.apple.iTunes:MusicBrainz Album Id":"musicbrainz_albumid","----:com.apple.iTunes:MusicBrainz Artist Id":"musicbrainz_artistid","----:com.apple.iTunes:MusicBrainz Album Artist Id":"musicbrainz_albumartistid","----:com.apple.iTunes:MusicBrainz Release Group Id":"musicbrainz_releasegroupid","----:com.apple.iTunes:MusicBrainz Work Id":"musicbrainz_workid","----:com.apple.iTunes:MusicBrainz TRM Id":"musicbrainz_trmid","----:com.apple.iTunes:MusicBrainz Disc Id":"musicbrainz_discid","----:com.apple.iTunes:Acoustid Id":"acoustid_id","----:com.apple.iTunes:Acoustid Fingerprint":"acoustid_fingerprint","----:com.apple.iTunes:MusicIP PUID":"musicip_puid","----:com.apple.iTunes:fingerprint":"musicip_fingerprint","----:com.apple.iTunes:replaygain_track_gain":"replaygain_track_gain","----:com.apple.iTunes:replaygain_track_peak":"replaygain_track_peak","----:com.apple.iTunes:replaygain_album_gain":"replaygain_album_gain","----:com.apple.iTunes:replaygain_album_peak":"replaygain_album_peak","----:com.apple.iTunes:replaygain_track_minmax":"replaygain_track_minmax","----:com.apple.iTunes:replaygain_album_minmax":"replaygain_album_minmax","----:com.apple.iTunes:replaygain_undo":"replaygain_undo",gnre:"genre","----:com.apple.iTunes:ALBUMARTISTSORT":"albumartistsort","----:com.apple.iTunes:ARTISTS":"artists","----:com.apple.iTunes:ORIGINALDATE":"originaldate","----:com.apple.iTunes:ORIGINALYEAR":"originalyear",desc:"description",ldes:"longDescription","\xa9mvn":"movement","\xa9mvi":"movementIndex","\xa9mvc":"movementTotal","\xa9wrk":"work",catg:"category",egid:"podcastId",hdvd:"hdVideo",keyw:"keywords",shwm:"showMovement",stik:"stik",rate:"rating"};t.tagType="iTunes";class a extends n.CaseInsensitiveTagMap{constructor(){super([t.tagType],i)}postMap(e,t){"rate"===e.id&&(e.value={source:void 0,rating:parseFloat(e.value)/100})}}t.MP4TagMapper=a},77876:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedLameHeader=void 0;let n=r(32235),i=r(60928),a=r(36855);t.ExtendedLameHeader={len:27,get:(e,t)=>{let r=n.UINT32_BE.get(e,t+2);return{revision:i.getBitAllignedNumber(e,t,0,4),vbr_method:i.getBitAllignedNumber(e,t,4,4),lowpass_filter:100*n.UINT8.get(e,t+1),track_peak:0===r?void 0:r/8388608,track_gain:a.ReplayGain.get(e,6),album_gain:a.ReplayGain.get(e,8),music_length:n.UINT32_BE.get(e,t+20),music_crc:n.UINT8.get(e,t+24),header_crc:n.UINT16_BE.get(e,t+24)}}}},4187:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.MpegParser=void 0;let i=r(32235),a=r(61232),o=r(31464),s=r(60928),l=r(47178),c=r(57122),u=(0,o.default)("music-metadata:parser:mpeg"),d=1024,h=["AAC Main","AAC LC","AAC SSR","AAC LTP"],p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,void 0,void 0,-1],f=[void 0,["front-center"],["front-left","front-right"],["front-center","front-left","front-right"],["front-center","front-left","front-right","back-center"],["front-center","front-left","front-right","back-left","back-right"],["front-center","front-left","front-right","back-left","back-right","LFE-channel"],["front-center","front-left","front-right","side-left","side-right","back-left","back-right","LFE-channel"]];class m{constructor(e,t){this.versionIndex=s.getBitAllignedNumber(e,t+1,3,2),this.layer=m.LayerDescription[s.getBitAllignedNumber(e,t+1,5,2)],this.versionIndex>1&&0===this.layer?this.parseAdtsHeader(e,t):this.parseMpegHeader(e,t),this.isProtectedByCRC=!s.isBitSet(e,t+1,7)}calcDuration(e){return e*this.calcSamplesPerFrame()/this.samplingRate}calcSamplesPerFrame(){return m.samplesInFrameTable[1===this.version?0:1][this.layer]}calculateSideInfoLength(){if(3!==this.layer)return 2;if(3===this.channelModeIndex){if(1===this.version)return 17;if(2===this.version||2.5===this.version)return 9}else{if(1===this.version)return 32;if(2===this.version||2.5===this.version)return 17}}calcSlotSize(){return[null,4,1,1][this.layer]}parseMpegHeader(e,t){this.container="MPEG",this.bitrateIndex=s.getBitAllignedNumber(e,t+2,0,4),this.sampRateFreqIndex=s.getBitAllignedNumber(e,t+2,4,2),this.padding=s.isBitSet(e,t+2,6),this.privateBit=s.isBitSet(e,t+2,7),this.channelModeIndex=s.getBitAllignedNumber(e,t+3,0,2),this.modeExtension=s.getBitAllignedNumber(e,t+3,2,2),this.isCopyrighted=s.isBitSet(e,t+3,4),this.isOriginalMedia=s.isBitSet(e,t+3,5),this.emphasis=s.getBitAllignedNumber(e,t+3,7,2),this.version=m.VersionID[this.versionIndex],this.channelMode=m.ChannelMode[this.channelModeIndex],this.codec=`MPEG ${this.version} Layer ${this.layer}`;let r=this.calcBitrate();if(!r)throw Error("Cannot determine bit-rate");if(this.bitrate=1e3*r,this.samplingRate=this.calcSamplingRate(),null==this.samplingRate)throw Error("Cannot determine sampling-rate")}parseAdtsHeader(e,t){u("layer=0 => ADTS"),this.version=2===this.versionIndex?4:2,this.container="ADTS/MPEG-"+this.version;let r=s.getBitAllignedNumber(e,t+2,0,2);this.codec="AAC",this.codecProfile=h[r],u(`MPEG-4 audio-codec=${this.codec}`);let n=s.getBitAllignedNumber(e,t+2,2,4);this.samplingRate=p[n],u(`sampling-rate=${this.samplingRate}`);let i=s.getBitAllignedNumber(e,t+2,7,3);this.mp4ChannelConfig=f[i],u(`channel-config=${this.mp4ChannelConfig.join("+")}`),this.frameLength=s.getBitAllignedNumber(e,t+3,6,2)<<11}calcBitrate(){if(0===this.bitrateIndex||15===this.bitrateIndex)return;let e=`${Math.floor(this.version)}${this.layer}`;return m.bitrate_index[this.bitrateIndex][e]}calcSamplingRate(){return 3===this.sampRateFreqIndex?null:m.sampling_rate_freq_index[this.version][this.sampRateFreqIndex]}}m.SyncByte1=255,m.SyncByte2=224,m.VersionID=[2.5,null,2,1],m.LayerDescription=[0,3,2,1],m.ChannelMode=["stereo","joint_stereo","dual_channel","mono"],m.bitrate_index={1:{11:32,12:32,13:32,21:32,22:8,23:8},2:{11:64,12:48,13:40,21:48,22:16,23:16},3:{11:96,12:56,13:48,21:56,22:24,23:24},4:{11:128,12:64,13:56,21:64,22:32,23:32},5:{11:160,12:80,13:64,21:80,22:40,23:40},6:{11:192,12:96,13:80,21:96,22:48,23:48},7:{11:224,12:112,13:96,21:112,22:56,23:56},8:{11:256,12:128,13:112,21:128,22:64,23:64},9:{11:288,12:160,13:128,21:144,22:80,23:80},10:{11:320,12:192,13:160,21:160,22:96,23:96},11:{11:352,12:224,13:192,21:176,22:112,23:112},12:{11:384,12:256,13:224,21:192,22:128,23:128},13:{11:416,12:320,13:256,21:224,22:144,23:144},14:{11:448,12:384,13:320,21:256,22:160,23:160}},m.sampling_rate_freq_index={1:{0:44100,1:48e3,2:32e3},2:{0:22050,1:24e3,2:16e3},2.5:{0:11025,1:12e3,2:8e3}},m.samplesInFrameTable=[[0,384,1152,1152],[0,384,1152,576]];let g={len:4,get:(e,t)=>new m(e,t)};function y(e){return"V"+Math.floor((100-e)/10)}class v extends l.AbstractID3Parser{constructor(){super(...arguments),this.frameCount=0,this.syncFrameCount=-1,this.countSkipFrameData=0,this.totalDataLength=0,this.bitrates=[],this.calculateEofDuration=!1,this.buf_frame_header=n.alloc(4),this.syncPeek={buf:n.alloc(d),len:0}}async postId3v2Parse(){this.metadata.setFormat("lossless",!1);try{let e=!1;for(;!e;)await this.sync(),e=await this.parseCommonMpegHeader()}catch(e){if(e instanceof a.EndOfStreamError){if(u("End-of-stream"),this.calculateEofDuration){let e=this.frameCount*this.samplesPerFrame;this.metadata.setFormat("numberOfSamples",e);let t=e/this.metadata.format.sampleRate;u(`Calculate duration at EOF: ${t} sec.`,t),this.metadata.setFormat("duration",t)}}else throw e}}finalize(){let e=this.metadata.format,t=this.metadata.native.hasOwnProperty("ID3v1");if(e.duration&&this.tokenizer.fileInfo.size){let r=this.tokenizer.fileInfo.size-this.mpegOffset-(t?128:0);e.codecProfile&&"V"===e.codecProfile[0]&&this.metadata.setFormat("bitrate",8*r/e.duration)}else if(this.tokenizer.fileInfo.size&&"CBR"===e.codecProfile){let r=Math.round((this.tokenizer.fileInfo.size-this.mpegOffset-(t?128:0))/this.frame_size)*this.samplesPerFrame;this.metadata.setFormat("numberOfSamples",r);let n=r/e.sampleRate;u("Calculate CBR duration based on file size: %s",n),this.metadata.setFormat("duration",n)}}async sync(){let e=!1;for(;;){let t=0;if(this.syncPeek.len=await this.tokenizer.peekBuffer(this.syncPeek.buf,{length:d,mayBeLess:!0}),this.syncPeek.len<=163)throw new a.EndOfStreamError;for(;;){if(e&&(224&this.syncPeek.buf[t])==224){this.buf_frame_header[0]=m.SyncByte1,this.buf_frame_header[1]=this.syncPeek.buf[t],await this.tokenizer.ignore(t),u(`Sync at offset=${this.tokenizer.position-1}, frameCount=${this.frameCount}`),this.syncFrameCount===this.frameCount&&(u(`Re-synced MPEG stream, frameCount=${this.frameCount}`),this.frameCount=0,this.frame_size=0),this.syncFrameCount=this.frameCount;return}if(e=!1,-1===(t=this.syncPeek.buf.indexOf(m.SyncByte1,t))){if(this.syncPeek.len<this.syncPeek.buf.length)throw new a.EndOfStreamError;await this.tokenizer.ignore(this.syncPeek.len);break}++t,e=!0}}}async parseCommonMpegHeader(){let e;0===this.frameCount&&(this.mpegOffset=this.tokenizer.position-1),await this.tokenizer.peekBuffer(this.buf_frame_header,{offset:1,length:3});try{e=g.get(this.buf_frame_header,0)}catch(e){return await this.tokenizer.ignore(1),this.metadata.addWarning("Parse error: "+e.message),!1}return await this.tokenizer.ignore(3),this.metadata.setFormat("container",e.container),this.metadata.setFormat("codec",e.codec),this.metadata.setFormat("lossless",!1),this.metadata.setFormat("sampleRate",e.samplingRate),this.frameCount++,e.version>=2&&0===e.layer?this.parseAdts(e):this.parseAudioFrameHeader(e)}async parseAudioFrameHeader(e){this.metadata.setFormat("numberOfChannels","mono"===e.channelMode?1:2),this.metadata.setFormat("bitrate",e.bitrate),this.frameCount<2e5&&u("offset=%s MP%s bitrate=%s sample-rate=%s",this.tokenizer.position-4,e.layer,e.bitrate,e.samplingRate);let t=e.calcSlotSize();if(null===t)throw Error("invalid slot_size");let r=e.calcSamplesPerFrame();u(`samples_per_frame=${r}`);let n=r/8*e.bitrate/e.samplingRate+(e.padding?t:0);if(this.frame_size=Math.floor(n),this.audioFrameHeader=e,this.bitrates.push(e.bitrate),1===this.frameCount)return this.offset=g.len,await this.skipSideInformation(),!1;if(3===this.frameCount){if(this.areAllSame(this.bitrates)){if(this.samplesPerFrame=r,this.metadata.setFormat("codecProfile","CBR"),this.tokenizer.fileInfo.size)return!0}else if(this.metadata.format.duration)return!0;if(!this.options.duration)return!0}return(this.options.duration&&4===this.frameCount&&(this.samplesPerFrame=r,this.calculateEofDuration=!0),this.offset=4,e.isProtectedByCRC)?await this.parseCrc():await this.skipSideInformation(),!1}async parseAdts(e){let t=n.alloc(3);await this.tokenizer.readBuffer(t),e.frameLength+=s.getBitAllignedNumber(t,0,0,11),this.totalDataLength+=e.frameLength,this.samplesPerFrame=1024;let r=e.samplingRate/this.samplesPerFrame,i=8*(0===this.frameCount?0:this.totalDataLength/this.frameCount)*r+.5;if(this.metadata.setFormat("bitrate",i),u(`frame-count=${this.frameCount}, size=${e.frameLength} bytes, bit-rate=${i}`),await this.tokenizer.ignore(e.frameLength>7?e.frameLength-7:1),3===this.frameCount){if(this.metadata.setFormat("codecProfile",e.codecProfile),e.mp4ChannelConfig&&this.metadata.setFormat("numberOfChannels",e.mp4ChannelConfig.length),!this.options.duration)return!0;this.calculateEofDuration=!0}return!1}async parseCrc(){return this.crc=await this.tokenizer.readNumber(i.INT16_BE),this.offset+=2,this.skipSideInformation()}async skipSideInformation(){let e=this.audioFrameHeader.calculateSideInfoLength();await this.tokenizer.readToken(new i.Uint8ArrayType(e)),this.offset+=e,await this.readXtraInfoHeader()}async readXtraInfoHeader(){let e=await this.tokenizer.readToken(c.InfoTagHeaderTag);switch(this.offset+=c.InfoTagHeaderTag.len,e){case"Info":return this.metadata.setFormat("codecProfile","CBR"),this.readXingInfoHeader();case"Xing":let t=y((await this.readXingInfoHeader()).vbrScale);return this.metadata.setFormat("codecProfile",t),null;case"Xtra":break;case"LAME":let r=await this.tokenizer.readToken(c.LameEncoderVersion);if(this.frame_size>=this.offset+c.LameEncoderVersion.len)return this.offset+=c.LameEncoderVersion.len,this.metadata.setFormat("tool","LAME "+r),await this.skipFrameData(this.frame_size-this.offset),null;this.metadata.addWarning("Corrupt LAME header")}let n=this.frame_size-this.offset;return n<0?this.metadata.addWarning("Frame "+this.frameCount+"corrupt: negative frameDataLeft"):await this.skipFrameData(n),null}async readXingInfoHeader(){let e=this.tokenizer.position,t=await (0,c.readXingHeader)(this.tokenizer);if(this.offset+=this.tokenizer.position-e,t.lame&&(this.metadata.setFormat("tool","LAME "+s.stripNulls(t.lame.version)),t.lame.extended&&(this.metadata.setFormat("trackPeakLevel",t.lame.extended.track_peak),t.lame.extended.track_gain&&this.metadata.setFormat("trackGain",t.lame.extended.track_gain.adjustment),t.lame.extended.album_gain&&this.metadata.setFormat("albumGain",t.lame.extended.album_gain.adjustment),this.metadata.setFormat("duration",t.lame.extended.music_length/1e3))),t.streamSize){let e=this.audioFrameHeader.calcDuration(t.numFrames);return this.metadata.setFormat("duration",e),u("Get duration from Xing header: %s",this.metadata.format.duration),t}let r=this.frame_size-this.offset;return await this.skipFrameData(r),t}async skipFrameData(e){if(e<0)throw Error("frame-data-left cannot be negative");await this.tokenizer.ignore(e),this.countSkipFrameData+=e}areAllSame(e){let t=e[0];return e.every(e=>e===t)}}t.MpegParser=v},36855:function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.ReplayGain=void 0;let a=r(60928);!function(e){e[e.not_set=0]="not_set",e[e.radio=1]="radio",e[e.audiophile=2]="audiophile"}(n||(n={})),function(e){e[e.unspecified=0]="unspecified",e[e.engineer=1]="engineer",e[e.user=2]="user",e[e.automatic=3]="automatic",e[e.rms_average=4]="rms_average"}(i||(i={})),t.ReplayGain={len:2,get:(e,t)=>{let r=a.getBitAllignedNumber(e,t,0,3),n=a.getBitAllignedNumber(e,t,6,1),i=a.getBitAllignedNumber(e,t,7,9)/10;if(r>0)return{type:a.getBitAllignedNumber(e,t,0,3),origin:a.getBitAllignedNumber(e,t,3,3),adjustment:n?-i:i}}}},57122:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.readXingHeader=t.XingHeaderFlags=t.LameEncoderVersion=t.InfoTagHeaderTag=void 0;let i=r(32235),a=r(60928),o=r(77876);async function s(e){let r=await e.readToken(t.XingHeaderFlags),a={};if(r.frames&&(a.numFrames=await e.readToken(i.UINT32_BE)),r.bytes&&(a.streamSize=await e.readToken(i.UINT32_BE)),r.toc&&(a.toc=n.alloc(100),await e.readBuffer(a.toc)),r.vbrScale&&(a.vbrScale=await e.readToken(i.UINT32_BE)),"LAME"===await e.peekToken(new i.StringType(4,"ascii"))&&(await e.ignore(4),a.lame={version:await e.readToken(new i.StringType(5,"ascii"))},a.lame.version.match(/\d+.\d+/g))){let t=a.lame.version.match(/\d+.\d+/g)[0].split(".").map(e=>parseInt(e,10));t[0]>=3&&t[1]>=90&&(a.lame.extended=await e.readToken(o.ExtendedLameHeader))}return a}t.InfoTagHeaderTag=new i.StringType(4,"ascii"),t.LameEncoderVersion=new i.StringType(6,"ascii"),t.XingHeaderFlags={len:4,get:(e,t)=>({frames:a.isBitSet(e,t,31),bytes:a.isBitSet(e,t,30),toc:a.isBitSet(e,t,29),vbrScale:a.isBitSet(e,t,28)})},t.readXingHeader=s},63499:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(31464),i=r(32235),a=r(47178),o=r(33752),s=r(36149),l=(0,n.default)("music-metadata:parser:musepack");class c extends a.AbstractID3Parser{async postId3v2Parse(){let e;switch(await this.tokenizer.peekToken(new i.StringType(3,"binary"))){case"MP+":l("Musepack stream-version 7"),e=new s.MpcSv7Parser;break;case"MPC":l("Musepack stream-version 8"),e=new o.MpcSv8Parser;break;default:throw Error("Invalid Musepack signature prefix")}return e.init(this.metadata,this.tokenizer,this.options),e.parse()}}t.default=c},88038:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BitReader=void 0;let n=r(32235);class i{constructor(e){this.tokenizer=e,this.pos=0,this.dword=void 0}async read(e){for(;void 0===this.dword;)this.dword=await this.tokenizer.readToken(n.UINT32_LE);let t=this.dword;return(this.pos+=e,this.pos<32)?(t>>>=32-this.pos)&(1<<e)-1:((this.pos-=32,0===this.pos)?this.dword=void 0:(this.dword=await this.tokenizer.readToken(n.UINT32_LE),this.pos&&(t<<=this.pos,t|=this.dword>>>32-this.pos)),t&(1<<e)-1)}async ignore(e){if(this.pos>0){let t=32-this.pos;this.dword=void 0,e-=t,this.pos=0}let t=e%32,r=(e-t)/32;return await this.tokenizer.ignore(4*r),this.read(t)}}t.BitReader=i},36149:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MpcSv7Parser=void 0;let n=r(31464),i=r(44820),a=r(98770),o=r(88038),s=r(44398),l=(0,n.default)("music-metadata:parser:musepack");class c extends i.BasicParser{constructor(){super(...arguments),this.audioLength=0}async parse(){let e=await this.tokenizer.readToken(s.Header);if("MP+"!==e.signature)throw Error("Unexpected magic number");l(`stream-version=${e.streamMajorVersion}.${e.streamMinorVersion}`),this.metadata.setFormat("container","Musepack, SV7"),this.metadata.setFormat("sampleRate",e.sampleFrequency);let t=1152*(e.frameCount-1)+e.lastFrameLength;this.metadata.setFormat("numberOfSamples",t),this.duration=t/e.sampleFrequency,this.metadata.setFormat("duration",this.duration),this.bitreader=new o.BitReader(this.tokenizer),this.metadata.setFormat("numberOfChannels",e.midSideStereo||e.intensityStereo?2:1);let r=await this.bitreader.read(8);return this.metadata.setFormat("codec",(r/100).toFixed(2)),await this.skipAudioData(e.frameCount),l(`End of audio stream, switching to APEv2, offset=${this.tokenizer.position}`),a.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async skipAudioData(e){for(;e-- >0;){let e=await this.bitreader.read(20);this.audioLength+=20+e,await this.bitreader.ignore(e)}let t=await this.bitreader.read(11);this.audioLength+=t,this.metadata.setFormat("bitrate",this.audioLength/this.duration)}}t.MpcSv7Parser=c},44398:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;let i=r(32235),a=r(60928);t.Header={len:24,get:(e,t)=>{let r={signature:n.from(e).toString("latin1",t,t+3),streamMinorVersion:a.getBitAllignedNumber(e,t+3,0,4),streamMajorVersion:a.getBitAllignedNumber(e,t+3,4,4),frameCount:i.UINT32_LE.get(e,t+4),maxLevel:i.UINT16_LE.get(e,t+8),sampleFrequency:[44100,48e3,37800,32e3][a.getBitAllignedNumber(e,t+10,0,2)],link:a.getBitAllignedNumber(e,t+10,2,2),profile:a.getBitAllignedNumber(e,t+10,4,4),maxBand:a.getBitAllignedNumber(e,t+11,0,6),intensityStereo:a.isBitSet(e,t+11,6),midSideStereo:a.isBitSet(e,t+11,7),titlePeak:i.UINT16_LE.get(e,t+12),titleGain:i.UINT16_LE.get(e,t+14),albumPeak:i.UINT16_LE.get(e,t+16),albumGain:i.UINT16_LE.get(e,t+18),lastFrameLength:i.UINT32_LE.get(e,t+20)>>>20&2047,trueGapless:a.isBitSet(e,t+23,0)};return r.lastFrameLength=r.trueGapless?i.UINT32_LE.get(e,20)>>>20&2047:0,r}}},33752:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MpcSv8Parser=void 0;let n=r(31464),i=r(44820),a=r(98770),o=r(4026),s=r(68238),l=(0,n.default)("music-metadata:parser:musepack");class c extends i.BasicParser{constructor(){super(...arguments),this.audioLength=0}async parse(){if("MPCK"!==await this.tokenizer.readToken(o.FourCcToken))throw Error("Invalid Magic number");return this.metadata.setFormat("container","Musepack, SV8"),this.parsePacket()}async parsePacket(){let e=new s.StreamReader(this.tokenizer);for(;;){let t=await e.readPacketHeader();switch(l(`packet-header key=${t.key}, payloadLength=${t.payloadLength}`),t.key){case"SH":let r=await e.readStreamHeader(t.payloadLength);this.metadata.setFormat("numberOfSamples",r.sampleCount),this.metadata.setFormat("sampleRate",r.sampleFrequency),this.metadata.setFormat("duration",r.sampleCount/r.sampleFrequency),this.metadata.setFormat("numberOfChannels",r.channelCount);break;case"AP":this.audioLength+=t.payloadLength,await this.tokenizer.ignore(t.payloadLength);break;case"RG":case"EI":case"SO":case"ST":case"CT":await this.tokenizer.ignore(t.payloadLength);break;case"SE":return this.metadata.setFormat("bitrate",8*this.audioLength/this.metadata.format.duration),a.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options);default:throw Error(`Unexpected header: ${t.key}`)}}}}t.MpcSv8Parser=c},68238:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=void 0;let n=r(32235),i=r(31464),a=r(60928),o=(0,i.default)("music-metadata:parser:musepack:sv8"),s=new n.StringType(2,"binary"),l={len:5,get:(e,t)=>({crc:n.UINT32_LE.get(e,t),streamVersion:n.UINT8.get(e,t+4)})},c={len:2,get:(e,t)=>({sampleFrequency:[44100,48e3,37800,32e3][a.getBitAllignedNumber(e,t,0,3)],maxUsedBands:a.getBitAllignedNumber(e,t,3,5),channelCount:a.getBitAllignedNumber(e,t+1,0,4)+1,msUsed:a.isBitSet(e,t+1,4),audioBlockFrames:a.getBitAllignedNumber(e,t+1,5,3)})};class u{constructor(e){this.tokenizer=e}async readPacketHeader(){let e=await this.tokenizer.readToken(s),t=await this.readVariableSizeField();return{key:e,payloadLength:t.value-2-t.len}}async readStreamHeader(e){let t={};o(`Reading SH at offset=${this.tokenizer.position}`);let r=await this.tokenizer.readToken(l);e-=l.len,Object.assign(t,r),o(`SH.streamVersion = ${r.streamVersion}`);let n=await this.readVariableSizeField();e-=n.len,t.sampleCount=n.value;let i=await this.readVariableSizeField();e-=i.len,t.beginningOfSilence=i.value;let a=await this.tokenizer.readToken(c);return e-=c.len,Object.assign(t,a),await this.tokenizer.ignore(e),t}async readVariableSizeField(e=1,t=0){let r=await this.tokenizer.readNumber(n.UINT8);return(128&r)==0?{len:e,value:t+r}:(r&=127,r+=t,this.readVariableSizeField(e+1,r<<7))}}t.StreamReader=u},33978:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.OggParser=t.SegmentTable=void 0;let i=r(32235),a=r(61232),o=r(31464),s=r(60928),l=r(4026),c=r(44820),u=r(31701),d=r(75271),h=r(89858),p=r(93477),f=(0,o.default)("music-metadata:parser:ogg");class m{static sum(e,t,r){let n=0;for(let i=t;i<t+r;++i)n+=e[i];return n}constructor(e){this.len=e.page_segments}get(e,t){return{totalPageSize:m.sum(e,t,this.len)}}}t.SegmentTable=m;class g extends c.BasicParser{async parse(){f("pos=%s, parsePage()",this.tokenizer.position);try{let e;do{if(e=await this.tokenizer.readToken(g.Header),"OggS"!==e.capturePattern)throw Error("Invalid Ogg capture pattern");this.metadata.setFormat("container","Ogg"),this.header=e,this.pageNumber=e.pageSequenceNo,f("page#=%s, Ogg.id=%s",e.pageSequenceNo,e.capturePattern);let t=await this.tokenizer.readToken(new m(e));f("totalPageSize=%s",t.totalPageSize);let r=await this.tokenizer.readToken(new i.Uint8ArrayType(t.totalPageSize));if(f("firstPage=%s, lastPage=%s, continued=%s",e.headerType.firstPage,e.headerType.lastPage,e.headerType.continued),e.headerType.firstPage){let e=new i.StringType(7,"ascii").get(n.from(r),0);switch(e){case"\x01vorbis":f("Set page consumer to Ogg/Vorbis"),this.pageConsumer=new u.VorbisParser(this.metadata,this.options);break;case"OpusHea":f("Set page consumer to Ogg/Opus"),this.pageConsumer=new d.OpusParser(this.metadata,this.options,this.tokenizer);break;case"Speex  ":f("Set page consumer to Ogg/Speex"),this.pageConsumer=new h.SpeexParser(this.metadata,this.options,this.tokenizer);break;case"fishead":case"\0theora":f("Set page consumer to Ogg/Theora"),this.pageConsumer=new p.TheoraParser(this.metadata,this.options,this.tokenizer);break;default:throw Error("gg audio-codec not recognized (id="+e+")")}}this.pageConsumer.parsePage(e,r)}while(!e.headerType.lastPage)}catch(e){if(e instanceof a.EndOfStreamError)this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),f("End-of-stream"),this.metadata.addWarning("Last OGG-page is not marked with last-page flag"),this.header&&this.pageConsumer.calculateDuration(this.header);else if(e.message.startsWith("FourCC"))this.pageNumber>0&&(this.metadata.addWarning("Invalid FourCC ID, maybe last OGG-page is not marked with last-page flag"),this.pageConsumer.flush());else throw e}}}g.Header={len:27,get:(e,t)=>({capturePattern:l.FourCcToken.get(e,t),version:i.UINT8.get(e,t+4),headerType:{continued:s.getBit(e,t+5,0),firstPage:s.getBit(e,t+5,1),lastPage:s.getBit(e,t+5,2)},absoluteGranulePosition:Number(i.UINT64_LE.get(e,t+6)),streamSerialNumber:i.UINT32_LE.get(e,t+14),pageSequenceNo:i.UINT32_LE.get(e,t+18),pageChecksum:i.UINT32_LE.get(e,t+22),page_segments:i.UINT8.get(e,t+26)})},t.OggParser=g},6655:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdHeader=void 0;let n=r(32235);class i{constructor(e){if(this.len=e,e<19)throw Error("ID-header-page 0 should be at least 19 bytes long")}get(e,t){return{magicSignature:new n.StringType(8,"ascii").get(e,t+0),version:e.readUInt8(t+8),channelCount:e.readUInt8(t+9),preSkip:e.readInt16LE(t+10),inputSampleRate:e.readInt32LE(t+12),outputGain:e.readInt16LE(t+16),channelMapping:e.readUInt8(t+18)}}}t.IdHeader=i},75271:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpusParser=void 0;let n=r(32235),i=r(31701),a=r(6655);class o extends i.VorbisParser{constructor(e,t,r){super(e,t),this.tokenizer=r,this.lastPos=-1}parseFirstPage(e,t){if(this.metadata.setFormat("codec","Opus"),this.idHeader=new a.IdHeader(t.length).get(t,0),"OpusHead"!==this.idHeader.magicSignature)throw Error("Illegal ogg/Opus magic-signature");this.metadata.setFormat("sampleRate",this.idHeader.inputSampleRate),this.metadata.setFormat("numberOfChannels",this.idHeader.channelCount)}parseFullPage(e){"OpusTags"===new n.StringType(8,"ascii").get(e,0)&&(this.parseUserCommentList(e,8),this.lastPos=this.tokenizer.position-e.length)}calculateDuration(e){if(this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0){let t=e.absoluteGranulePosition-this.idHeader.preSkip;if(this.metadata.setFormat("numberOfSamples",t),this.metadata.setFormat("duration",t/48e3),-1!==this.lastPos&&this.tokenizer.fileInfo.size&&this.metadata.format.duration){let e=this.tokenizer.fileInfo.size-this.lastPos;this.metadata.setFormat("bitrate",8*e/this.metadata.format.duration)}}}}t.OpusParser=o},8502:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;let n=r(32235),i=r(60928);t.Header={len:80,get:(e,t)=>({speex:new n.StringType(8,"ascii").get(e,t+0),version:i.trimRightNull(new n.StringType(20,"ascii").get(e,t+8)),version_id:e.readInt32LE(t+28),header_size:e.readInt32LE(t+32),rate:e.readInt32LE(t+36),mode:e.readInt32LE(t+40),mode_bitstream_version:e.readInt32LE(t+44),nb_channels:e.readInt32LE(t+48),bitrate:e.readInt32LE(t+52),frame_size:e.readInt32LE(t+56),vbr:e.readInt32LE(t+60),frames_per_packet:e.readInt32LE(t+64),extra_headers:e.readInt32LE(t+68),reserved1:e.readInt32LE(t+72),reserved2:e.readInt32LE(t+76)})}},89858:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpeexParser=void 0;let n=r(31464),i=r(31701),a=r(8502),o=(0,n.default)("music-metadata:parser:ogg:speex");class s extends i.VorbisParser{constructor(e,t,r){super(e,t),this.tokenizer=r}parseFirstPage(e,t){o("First Ogg/Speex page");let r=a.Header.get(t,0);this.metadata.setFormat("codec",`Speex ${r.version}`),this.metadata.setFormat("numberOfChannels",r.nb_channels),this.metadata.setFormat("sampleRate",r.rate),-1!==r.bitrate&&this.metadata.setFormat("bitrate",r.bitrate)}}t.SpeexParser=s},8174:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IdentificationHeader=void 0;let n=r(32235);t.IdentificationHeader={len:42,get:(e,t)=>({id:new n.StringType(7,"ascii").get(e,t),vmaj:e.readUInt8(t+7),vmin:e.readUInt8(t+8),vrev:e.readUInt8(t+9),vmbw:e.readUInt16BE(t+10),vmbh:e.readUInt16BE(t+17),nombr:n.UINT24_BE.get(e,t+37),nqual:e.readUInt8(t+40)})}},93477:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TheoraParser=void 0;let n=r(31464),i=r(8174),a=(0,n.default)("music-metadata:parser:ogg:theora");class o{constructor(e,t,r){this.metadata=e,this.tokenizer=r}parsePage(e,t){e.headerType.firstPage&&this.parseFirstPage(e,t)}flush(){a("flush")}calculateDuration(e){a("duration calculation not implemented")}parseFirstPage(e,t){a("First Ogg/Theora page"),this.metadata.setFormat("codec","Theora");let r=i.IdentificationHeader.get(t,0);this.metadata.setFormat("bitrate",r.nombr)}}t.TheoraParser=o},45034:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.IdentificationHeader=t.CommonHeader=t.VorbisPictureToken=void 0;let i=r(32235),a=r(93367);class o{static fromBase64(e){return this.fromBuffer(n.from(e,"base64"))}static fromBuffer(e){return new o(e.length).get(e,0)}constructor(e){this.len=e}get(e,t){let r=a.AttachedPictureType[i.UINT32_BE.get(e,t)],o=i.UINT32_BE.get(e,t+=4),s=e.toString("utf-8",t+=4,t+o),l=i.UINT32_BE.get(e,t+=o),c=e.toString("utf-8",t+=4,t+l),u=i.UINT32_BE.get(e,t+=l),d=i.UINT32_BE.get(e,t+=4),h=i.UINT32_BE.get(e,t+=4),p=i.UINT32_BE.get(e,t+=4),f=i.UINT32_BE.get(e,t+=4);return{type:r,format:s,description:c,width:u,height:d,colour_depth:h,indexed_color:p,data:n.from(e.slice(t+=4,t+f))}}}t.VorbisPictureToken=o,t.CommonHeader={len:7,get:(e,t)=>({packetType:e.readUInt8(t),vorbis:new i.StringType(6,"ascii").get(e,t+1)})},t.IdentificationHeader={len:23,get:(e,t)=>{let r=new DataView(e.buffer,e.byteOffset);return{version:r.getUint32(t+0,!0),channelMode:r.getUint8(t+4),sampleRate:r.getUint32(t+5,!0),bitrateMax:r.getUint32(t+9,!0),bitrateNominal:r.getUint32(t+13,!0),bitrateMin:r.getUint32(t+17,!0)}}}},40242:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.VorbisDecoder=void 0;let i=r(32235);class a{constructor(e,t){this.data=e,this.offset=t}readInt32(){let e=i.UINT32_LE.get(this.data,this.offset);return this.offset+=4,e}readStringUtf8(){let e=this.readInt32(),t=n.from(this.data).toString("utf-8",this.offset,this.offset+e);return this.offset+=e,t}parseUserComment(){let e=this.offset,t=this.readStringUtf8(),r=t.indexOf("=");return{key:t.slice(0,r).toUpperCase(),value:t.slice(r+1),len:this.offset-e}}}t.VorbisDecoder=a},31701:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.VorbisParser=void 0;let i=r(32235),a=r(31464),o=r(40242),s=r(45034),l=(0,a.default)("music-metadata:parser:ogg:vorbis1");class c{constructor(e,t){this.metadata=e,this.options=t,this.pageSegments=[]}parsePage(e,t){if(e.headerType.firstPage)this.parseFirstPage(e,t);else{if(e.headerType.continued){if(0===this.pageSegments.length)throw Error("Cannot continue on previous page");this.pageSegments.push(t)}if(e.headerType.lastPage||!e.headerType.continued){if(this.pageSegments.length>0){let e=n.concat(this.pageSegments);this.parseFullPage(e)}this.pageSegments=e.headerType.lastPage?[]:[t]}}e.headerType.lastPage&&this.calculateDuration(e)}flush(){this.parseFullPage(n.concat(this.pageSegments))}parseUserComment(e,t){let r=new o.VorbisDecoder(e,t).parseUserComment();return this.addTag(r.key,r.value),r.len}addTag(e,t){if("METADATA_BLOCK_PICTURE"===e&&"string"==typeof t){if(this.options.skipCovers){l("Ignore picture");return}t=s.VorbisPictureToken.fromBase64(t),l(`Push picture: id=${e}, format=${t.format}`)}else l(`Push tag: id=${e}, value=${t}`);this.metadata.addTag("vorbis",e,t)}calculateDuration(e){this.metadata.format.sampleRate&&e.absoluteGranulePosition>=0&&(this.metadata.setFormat("numberOfSamples",e.absoluteGranulePosition),this.metadata.setFormat("duration",this.metadata.format.numberOfSamples/this.metadata.format.sampleRate))}parseFirstPage(e,t){this.metadata.setFormat("codec","Vorbis I"),l("Parse first page");let r=s.CommonHeader.get(t,0);if("vorbis"!==r.vorbis)throw Error("Metadata does not look like Vorbis");if(1===r.packetType){let e=s.IdentificationHeader.get(t,s.CommonHeader.len);this.metadata.setFormat("sampleRate",e.sampleRate),this.metadata.setFormat("bitrate",e.bitrateNominal),this.metadata.setFormat("numberOfChannels",e.channelMode),l("sample-rate=%s[hz], bitrate=%s[b/s], channel-mode=%s",e.sampleRate,e.bitrateNominal,e.channelMode)}else throw Error("First Ogg page should be type 1: the identification header")}parseFullPage(e){let t=s.CommonHeader.get(e,0);if(l("Parse full page: type=%s, byteLength=%s",t.packetType,e.byteLength),3===t.packetType)return this.parseUserCommentList(e,s.CommonHeader.len)}parseUserCommentList(e,t){let r=i.UINT32_LE.get(e,t);t+=4+r;let n=i.UINT32_LE.get(e,t);for(t+=4;n-- >0;)t+=this.parseUserComment(e,t)}}t.VorbisParser=c},97658:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VorbisTagMapper=void 0;let n=r(17289),i={TITLE:"title",ARTIST:"artist",ARTISTS:"artists",ALBUMARTIST:"albumartist","ALBUM ARTIST":"albumartist",ALBUM:"album",DATE:"date",ORIGINALDATE:"originaldate",ORIGINALYEAR:"originalyear",COMMENT:"comment",TRACKNUMBER:"track",DISCNUMBER:"disk",GENRE:"genre",METADATA_BLOCK_PICTURE:"picture",COMPOSER:"composer",LYRICS:"lyrics",ALBUMSORT:"albumsort",TITLESORT:"titlesort",WORK:"work",ARTISTSORT:"artistsort",ALBUMARTISTSORT:"albumartistsort",COMPOSERSORT:"composersort",LYRICIST:"lyricist",WRITER:"writer",CONDUCTOR:"conductor",REMIXER:"remixer",ARRANGER:"arranger",ENGINEER:"engineer",PRODUCER:"producer",DJMIXER:"djmixer",MIXER:"mixer",LABEL:"label",GROUPING:"grouping",SUBTITLE:"subtitle",DISCSUBTITLE:"discsubtitle",TRACKTOTAL:"totaltracks",DISCTOTAL:"totaldiscs",COMPILATION:"compilation",RATING:"rating",BPM:"bpm",KEY:"key",MOOD:"mood",MEDIA:"media",CATALOGNUMBER:"catalognumber",RELEASESTATUS:"releasestatus",RELEASETYPE:"releasetype",RELEASECOUNTRY:"releasecountry",SCRIPT:"script",LANGUAGE:"language",COPYRIGHT:"copyright",LICENSE:"license",ENCODEDBY:"encodedby",ENCODERSETTINGS:"encodersettings",BARCODE:"barcode",ISRC:"isrc",ASIN:"asin",MUSICBRAINZ_TRACKID:"musicbrainz_recordingid",MUSICBRAINZ_RELEASETRACKID:"musicbrainz_trackid",MUSICBRAINZ_ALBUMID:"musicbrainz_albumid",MUSICBRAINZ_ARTISTID:"musicbrainz_artistid",MUSICBRAINZ_ALBUMARTISTID:"musicbrainz_albumartistid",MUSICBRAINZ_RELEASEGROUPID:"musicbrainz_releasegroupid",MUSICBRAINZ_WORKID:"musicbrainz_workid",MUSICBRAINZ_TRMID:"musicbrainz_trmid",MUSICBRAINZ_DISCID:"musicbrainz_discid",ACOUSTID_ID:"acoustid_id",ACOUSTID_ID_FINGERPRINT:"acoustid_fingerprint",MUSICIP_PUID:"musicip_puid",WEBSITE:"website",NOTES:"notes",TOTALTRACKS:"totaltracks",TOTALDISCS:"totaldiscs",DISCOGS_ARTIST_ID:"discogs_artist_id",DISCOGS_ARTISTS:"artists",DISCOGS_ARTIST_NAME:"artists",DISCOGS_ALBUM_ARTISTS:"albumartist",DISCOGS_CATALOG:"catalognumber",DISCOGS_COUNTRY:"releasecountry",DISCOGS_DATE:"originaldate",DISCOGS_LABEL:"label",DISCOGS_LABEL_ID:"discogs_label_id",DISCOGS_MASTER_RELEASE_ID:"discogs_master_release_id",DISCOGS_RATING:"discogs_rating",DISCOGS_RELEASED:"date",DISCOGS_RELEASE_ID:"discogs_release_id",DISCOGS_VOTES:"discogs_votes",CATALOGID:"catalognumber",STYLE:"genre",REPLAYGAIN_TRACK_GAIN:"replaygain_track_gain",REPLAYGAIN_TRACK_PEAK:"replaygain_track_peak",REPLAYGAIN_ALBUM_GAIN:"replaygain_album_gain",REPLAYGAIN_ALBUM_PEAK:"replaygain_album_peak",REPLAYGAIN_MINMAX:"replaygain_track_minmax",REPLAYGAIN_ALBUM_MINMAX:"replaygain_album_minmax",REPLAYGAIN_UNDO:"replaygain_undo"};class a extends n.CommonTagMapper{static toRating(e,t,r){return{source:e?e.toLowerCase():e,rating:parseFloat(t)/r*n.CommonTagMapper.maxRatingScore}}constructor(){super(["vorbis"],i)}postMap(e){if("RATING"===e.id)e.value=a.toRating(void 0,e.value,100);else if(0===e.id.indexOf("RATING:")){let t=e.id.split(":");e.value=a.toRating(t[1],e.value,1),e.id=t[0]}}}t.VorbisTagMapper=a},93108:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListInfoTagValue=t.Header=void 0;let n=r(32235);t.Header={len:8,get:(e,t)=>({chunkID:e.toString("binary",t,t+4),chunkSize:n.UINT32_LE.get(e,4)})};class i{constructor(e){this.tagHeader=e,this.len=e.chunkSize,this.len+=1&this.len}get(e,t){return new n.StringType(this.tagHeader.chunkSize,"ascii").get(e,t)}}t.ListInfoTagValue=i},26556:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RiffInfoTagMapper=t.riffInfoTagMap=void 0;let n=r(17289);t.riffInfoTagMap={IART:"artist",ICRD:"date",INAM:"title",TITL:"title",IPRD:"album",ITRK:"track",IPRT:"track",COMM:"comment",ICMT:"comment",ICNT:"releasecountry",GNRE:"genre",IWRI:"writer",RATE:"rating",YEAR:"year",ISFT:"encodedby",CODE:"encodedby",TURL:"website",IGNR:"genre",IENG:"engineer",ITCH:"technician",IMED:"media",IRPD:"album"};class i extends n.CommonTagMapper{constructor(){super(["exif"],t.riffInfoTagMap)}}t.RiffInfoTagMapper=i},27469:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackType=void 0;var n=r(989);Object.defineProperty(t,"TrackType",{enumerable:!0,get:function(){return n.TrackType}})},93330:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BroadcastAudioExtensionChunk=void 0;let n=r(32235),i=r(60928);t.BroadcastAudioExtensionChunk={len:420,get:(e,t)=>({description:(0,i.stripNulls)(new n.StringType(256,"ascii").get(e,t)).trim(),originator:(0,i.stripNulls)(new n.StringType(32,"ascii").get(e,t+256)).trim(),originatorReference:(0,i.stripNulls)(new n.StringType(32,"ascii").get(e,t+288)).trim(),originationDate:(0,i.stripNulls)(new n.StringType(10,"ascii").get(e,t+320)).trim(),originationTime:(0,i.stripNulls)(new n.StringType(8,"ascii").get(e,t+330)).trim(),timeReferenceLow:n.UINT32_LE.get(e,t+338),timeReferenceHigh:n.UINT32_LE.get(e,t+342),version:n.UINT16_LE.get(e,t+346),umid:new n.Uint8ArrayType(64).get(e,t+348),loudnessValue:n.UINT16_LE.get(e,t+412),maxTruePeakLevel:n.UINT16_LE.get(e,t+414),maxMomentaryLoudness:n.UINT16_LE.get(e,t+416),maxShortTermLoudness:n.UINT16_LE.get(e,t+418)})}},88507:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.FactChunk=t.Format=t.WaveFormat=void 0,function(e){e[e.PCM=1]="PCM",e[e.ADPCM=2]="ADPCM",e[e.IEEE_FLOAT=3]="IEEE_FLOAT",e[e.MPEG_ADTS_AAC=5632]="MPEG_ADTS_AAC",e[e.MPEG_LOAS=5634]="MPEG_LOAS",e[e.RAW_AAC1=255]="RAW_AAC1",e[e.DOLBY_AC3_SPDIF=146]="DOLBY_AC3_SPDIF",e[e.DVM=8192]="DVM",e[e.RAW_SPORT=576]="RAW_SPORT",e[e.ESST_AC3=577]="ESST_AC3",e[e.DRM=9]="DRM",e[e.DTS2=8193]="DTS2",e[e.MPEG=80]="MPEG"}(r=t.WaveFormat||(t.WaveFormat={}));class n{constructor(e){if(e.chunkSize<16)throw Error("Invalid chunk size");this.len=e.chunkSize}get(e,t){return{wFormatTag:e.readUInt16LE(t),nChannels:e.readUInt16LE(t+2),nSamplesPerSec:e.readUInt32LE(t+4),nAvgBytesPerSec:e.readUInt32LE(t+8),nBlockAlign:e.readUInt16LE(t+12),wBitsPerSample:e.readUInt16LE(t+14)}}}t.Format=n;class i{constructor(e){if(e.chunkSize<4)throw Error("Invalid fact chunk size.");this.len=e.chunkSize}get(e,t){return{dwSampleLength:e.readUInt32LE(t)}}}t.FactChunk=i},33408:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WaveParser=void 0;let n=r(61232),i=r(32235),a=r(31464),o=r(93108),s=r(88507),l=r(83437),c=r(60928),u=r(4026),d=r(44820),h=r(93330),p=(0,a.default)("music-metadata:parser:RIFF");class f extends d.BasicParser{async parse(){let e=await this.tokenizer.readToken(o.Header);if(p(`pos=${this.tokenizer.position}, parse: chunkID=${e.chunkID}`),"RIFF"===e.chunkID)return this.parseRiffChunk(e.chunkSize).catch(e=>{if(!(e instanceof n.EndOfStreamError))throw e})}async parseRiffChunk(e){let t=await this.tokenizer.readToken(u.FourCcToken);if(this.metadata.setFormat("container",t),"WAVE"===t)return this.readWaveChunk(e-u.FourCcToken.len);throw Error(`Unsupported RIFF format: RIFF/${t}`)}async readWaveChunk(e){for(;e>=o.Header.len;){let t=await this.tokenizer.readToken(o.Header);switch(e-=o.Header.len+t.chunkSize,t.chunkSize>e&&this.metadata.addWarning("Data chunk size exceeds file size"),this.header=t,p(`pos=${this.tokenizer.position}, readChunk: chunkID=RIFF/WAVE/${t.chunkID}`),t.chunkID){case"LIST":await this.parseListTag(t);break;case"fact":this.metadata.setFormat("lossless",!1),this.fact=await this.tokenizer.readToken(new s.FactChunk(t));break;case"fmt ":let r=await this.tokenizer.readToken(new s.Format(t)),a=s.WaveFormat[r.wFormatTag];a||(p("WAVE/non-PCM format="+r.wFormatTag),a="non-PCM ("+r.wFormatTag+")"),this.metadata.setFormat("codec",a),this.metadata.setFormat("bitsPerSample",r.wBitsPerSample),this.metadata.setFormat("sampleRate",r.nSamplesPerSec),this.metadata.setFormat("numberOfChannels",r.nChannels),this.metadata.setFormat("bitrate",r.nBlockAlign*r.nSamplesPerSec*8),this.blockAlign=r.nBlockAlign;break;case"id3 ":case"ID3 ":let c=await this.tokenizer.readToken(new i.Uint8ArrayType(t.chunkSize)),u=n.fromBuffer(c);await new l.ID3v2Parser().parse(this.metadata,u,this.options);break;case"data":!1!==this.metadata.format.lossless&&this.metadata.setFormat("lossless",!0);let d=t.chunkSize;if(this.tokenizer.fileInfo.size){let e=this.tokenizer.fileInfo.size-this.tokenizer.position;e<d&&(this.metadata.addWarning("data chunk length exceeding file length"),d=e)}let f=this.fact?this.fact.dwSampleLength:4294967295===d?void 0:d/this.blockAlign;f&&(this.metadata.setFormat("numberOfSamples",f),this.metadata.setFormat("duration",f/this.metadata.format.sampleRate)),"ADPCM"===this.metadata.format.codec?this.metadata.setFormat("bitrate",352e3):this.metadata.setFormat("bitrate",this.blockAlign*this.metadata.format.sampleRate*8),await this.tokenizer.ignore(t.chunkSize);break;case"bext":let m=await this.tokenizer.readToken(h.BroadcastAudioExtensionChunk);Object.keys(m).forEach(e=>{this.metadata.addTag("exif","bext."+e,m[e])});let g=t.chunkSize-h.BroadcastAudioExtensionChunk.len;await this.tokenizer.ignore(g);break;case"\0\0\0\0":p(`Ignore padding chunk: RIFF/${t.chunkID} of ${t.chunkSize} bytes`),this.metadata.addWarning("Ignore chunk: RIFF/"+t.chunkID),await this.tokenizer.ignore(t.chunkSize);break;default:p(`Ignore chunk: RIFF/${t.chunkID} of ${t.chunkSize} bytes`),this.metadata.addWarning("Ignore chunk: RIFF/"+t.chunkID),await this.tokenizer.ignore(t.chunkSize)}this.header.chunkSize%2==1&&(p("Read odd padding byte"),await this.tokenizer.ignore(1))}}async parseListTag(e){let t=await this.tokenizer.readToken(new i.StringType(4,"binary"));return(p("pos=%s, parseListTag: chunkID=RIFF/WAVE/LIST/%s",this.tokenizer.position,t),"INFO"===t)?this.parseRiffInfoTags(e.chunkSize-4):(this.metadata.addWarning("Ignore chunk: RIFF/WAVE/LIST/"+t),p("Ignoring chunkID=RIFF/WAVE/LIST/"+t),this.tokenizer.ignore(e.chunkSize-4).then())}async parseRiffInfoTags(e){for(;e>=8;){let t=await this.tokenizer.readToken(o.Header),r=new o.ListInfoTagValue(t),n=await this.tokenizer.readToken(r);this.addTag(t.chunkID,c.stripNulls(n)),e-=8+r.len}if(0!==e)throw Error("Illegal remaining size: "+e)}addTag(e,t){this.metadata.addTag("exif",e,t)}}t.WaveParser=f},6421:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.WavPackParser=void 0;let i=r(32235),a=r(98770),o=r(4026),s=r(44820),l=r(56396),c=(0,r(31464).default)("music-metadata:parser:WavPack");class u extends s.BasicParser{async parse(){return this.audioDataSize=0,await this.parseWavPackBlocks(),a.APEv2Parser.tryParseApeHeader(this.metadata,this.tokenizer,this.options)}async parseWavPackBlocks(){do{if("wvpk"!==await this.tokenizer.peekToken(o.FourCcToken))break;let e=await this.tokenizer.readToken(l.WavPack.BlockHeaderToken);if("wvpk"!==e.BlockID)throw Error("Invalid WavPack Block-ID");c(`WavPack header blockIndex=${e.blockIndex}, len=${l.WavPack.BlockHeaderToken.len}`),0!==e.blockIndex||this.metadata.format.container||(this.metadata.setFormat("container","WavPack"),this.metadata.setFormat("lossless",!e.flags.isHybrid),this.metadata.setFormat("bitsPerSample",e.flags.bitsPerSample),e.flags.isDSD||(this.metadata.setFormat("sampleRate",e.flags.samplingRate),this.metadata.setFormat("duration",e.totalSamples/e.flags.samplingRate)),this.metadata.setFormat("numberOfChannels",e.flags.isMono?1:2),this.metadata.setFormat("numberOfSamples",e.totalSamples),this.metadata.setFormat("codec",e.flags.isDSD?"DSD":"PCM"));let t=e.blockSize-(l.WavPack.BlockHeaderToken.len-8);await (0===e.blockIndex?this.parseMetadataSubBlock(e,t):this.tokenizer.ignore(t)),e.blockSamples>0&&(this.audioDataSize+=e.blockSize)}while(!this.tokenizer.fileInfo.size||this.tokenizer.fileInfo.size-this.tokenizer.position>=l.WavPack.BlockHeaderToken.len);this.metadata.setFormat("bitrate",8*this.audioDataSize/this.metadata.format.duration)}async parseMetadataSubBlock(e,t){for(;t>l.WavPack.MetadataIdToken.len;){let r=await this.tokenizer.readToken(l.WavPack.MetadataIdToken),a=await this.tokenizer.readNumber(r.largeBlock?i.UINT24_LE:i.UINT8),o=n.alloc(2*a-(r.isOddSize?1:0));switch(await this.tokenizer.readBuffer(o),c(`Metadata Sub-Blocks functionId=0x${r.functionId.toString(16)}, id.largeBlock=${r.largeBlock},data-size=${o.length}`),r.functionId){case 0:break;case 14:c("ID_DSD_BLOCK");let s=1<<o.readUInt8(0),u=e.flags.samplingRate*s*8;if(!e.flags.isDSD)throw Error("Only expect DSD block if DSD-flag is set");this.metadata.setFormat("sampleRate",u),this.metadata.setFormat("duration",e.totalSamples/u);break;case 36:c("ID_ALT_TRAILER: trailer for non-wav files");break;case 38:this.metadata.setFormat("audioMD5",o);break;case 47:c(`ID_BLOCK_CHECKSUM: checksum=${o.toString("hex")}`);break;default:c(`Ignore unsupported meta-sub-block-id functionId=0x${r.functionId.toString(16)}`)}t-=l.WavPack.MetadataIdToken.len+(r.largeBlock?i.UINT24_LE.len:i.UINT8.len)+2*a,c(`remainingLength=${t}`),r.isOddSize&&this.tokenizer.ignore(1)}if(0!==t)throw Error("metadata-sub-block should fit it remaining length")}}t.WavPackParser=u},56396:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WavPack=void 0;let n=r(32235),i=r(4026),a=[6e3,8e3,9600,11025,12e3,16e3,22050,24e3,32e3,44100,48e3,64e3,88200,96e3,192e3,-1];class o{static isBitSet(e,t){return 1===o.getBitAllignedNumber(e,t,1)}static getBitAllignedNumber(e,t,r){return e>>>t&4294967295>>>32-r}}o.BlockHeaderToken={len:32,get:(e,t)=>{let r=n.UINT32_LE.get(e,t+24),s={BlockID:i.FourCcToken.get(e,t),blockSize:n.UINT32_LE.get(e,t+4),version:n.UINT16_LE.get(e,t+8),totalSamples:n.UINT32_LE.get(e,t+12),blockIndex:n.UINT32_LE.get(e,t+16),blockSamples:n.UINT32_LE.get(e,t+20),flags:{bitsPerSample:(1+o.getBitAllignedNumber(r,0,2))*8,isMono:o.isBitSet(r,2),isHybrid:o.isBitSet(r,3),isJointStereo:o.isBitSet(r,4),crossChannel:o.isBitSet(r,5),hybridNoiseShaping:o.isBitSet(r,6),floatingPoint:o.isBitSet(r,7),samplingRate:a[o.getBitAllignedNumber(r,23,4)],isDSD:o.isBitSet(r,31)},crc:new n.Uint8ArrayType(4).get(e,t+28)};return s.flags.isDSD&&(s.totalSamples*=8),s}},o.MetadataIdToken={len:1,get:(e,t)=>({functionId:o.getBitAllignedNumber(e[t],0,6),isOptional:o.isBitSet(e[t],5),isOddSize:o.isBitSet(e[t],6),largeBlock:o.isBitSet(e[t],7)})},t.WavPack=o},99376:function(e,t,r){"use strict";var n=r(35475);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useServerInsertedHTML")&&r.d(t,{useServerInsertedHTML:function(){return n.useServerInsertedHTML}})},48667:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i.a}});var n=r(88003),i=r.n(n),a={};for(var o in n)"default"!==o&&(a[o]=(function(e){return n[e]}).bind(0,o));r.d(t,a)},8221:function(e,t){"use strict";let r;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{DOMAttributeNames:function(){return n},default:function(){return o},isEqualNode:function(){return a}});let n={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv",noModule:"noModule"};function i(e){let{type:t,props:r}=e,i=document.createElement(t);for(let e in r){if(!r.hasOwnProperty(e)||"children"===e||"dangerouslySetInnerHTML"===e||void 0===r[e])continue;let a=n[e]||e.toLowerCase();"script"===t&&("async"===a||"defer"===a||"noModule"===a)?i[a]=!!r[e]:i.setAttribute(a,r[e])}let{children:a,dangerouslySetInnerHTML:o}=r;return o?i.innerHTML=o.__html||"":a&&(i.textContent="string"==typeof a?a:Array.isArray(a)?a.join(""):""),i}function a(e,t){if(e instanceof HTMLElement&&t instanceof HTMLElement){let r=t.getAttribute("nonce");if(r&&!e.getAttribute("nonce")){let n=t.cloneNode(!0);return n.setAttribute("nonce",""),n.nonce=r,r===e.nonce&&e.isEqualNode(n)}}return e.isEqualNode(t)}function o(){return{mountedInstances:new Set,updateHead:e=>{let t={};e.forEach(e=>{if("link"===e.type&&e.props["data-optimized-fonts"]){if(document.querySelector('style[data-href="'+e.props["data-href"]+'"]'))return;e.props.href=e.props["data-href"],e.props["data-href"]=void 0}let r=t[e.type]||[];r.push(e),t[e.type]=r});let n=t.title?t.title[0]:null,i="";if(n){let{children:e}=n.props;i="string"==typeof e?e:Array.isArray(e)?e.join(""):""}i!==document.title&&(document.title=i),["meta","base","link","style","script"].forEach(e=>{r(e,t[e]||[])})}}}r=(e,t)=>{let r=document.getElementsByTagName("head")[0],n=r.querySelector("meta[name=next-head-count]"),o=Number(n.content),s=[];for(let t=0,r=n.previousElementSibling;t<o;t++,r=(null==r?void 0:r.previousElementSibling)||null){var l;(null==r?void 0:null==(l=r.tagName)?void 0:l.toLowerCase())===e&&s.push(r)}let c=t.map(i).filter(e=>{for(let t=0,r=s.length;t<r;t++)if(a(s[t],e))return s.splice(t,1),!1;return!0});s.forEach(e=>{var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),c.forEach(e=>r.insertBefore(e,n)),n.content=(o-s.length+c.length).toString()},("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},63515:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{cancelIdleCallback:function(){return n},requestIdleCallback:function(){return r}});let r="undefined"!=typeof self&&self.requestIdleCallback&&self.requestIdleCallback.bind(window)||function(e){let t=Date.now();return self.setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},n="undefined"!=typeof self&&self.cancelIdleCallback&&self.cancelIdleCallback.bind(window)||function(e){return clearTimeout(e)};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},88003:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return w},handleClientScriptLoad:function(){return g},initScriptLoader:function(){return b}});let n=r(47043),i=r(53099),a=r(57437),o=n._(r(54887)),s=i._(r(2265)),l=r(48701),c=r(8221),u=r(63515),d=new Map,h=new Set,p=["onLoad","onReady","dangerouslySetInnerHTML","children","onError","strategy","stylesheets"],f=e=>{if(o.default.preinit){e.forEach(e=>{o.default.preinit(e,{as:"style"})});return}if("undefined"!=typeof window){let t=document.head;e.forEach(e=>{let r=document.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=e,t.appendChild(r)})}},m=e=>{let{src:t,id:r,onLoad:n=()=>{},onReady:i=null,dangerouslySetInnerHTML:a,children:o="",strategy:s="afterInteractive",onError:l,stylesheets:u}=e,m=r||t;if(m&&h.has(m))return;if(d.has(t)){h.add(m),d.get(t).then(n,l);return}let g=()=>{i&&i(),h.add(m)},y=document.createElement("script"),v=new Promise((e,t)=>{y.addEventListener("load",function(t){e(),n&&n.call(this,t),g()}),y.addEventListener("error",function(e){t(e)})}).catch(function(e){l&&l(e)});for(let[r,n]of(a?(y.innerHTML=a.__html||"",g()):o?(y.textContent="string"==typeof o?o:Array.isArray(o)?o.join(""):"",g()):t&&(y.src=t,d.set(t,v)),Object.entries(e))){if(void 0===n||p.includes(r))continue;let e=c.DOMAttributeNames[r]||r.toLowerCase();y.setAttribute(e,n)}"worker"===s&&y.setAttribute("type","text/partytown"),y.setAttribute("data-nscript",s),u&&f(u),document.body.appendChild(y)};function g(e){let{strategy:t="afterInteractive"}=e;"lazyOnload"===t?window.addEventListener("load",()=>{(0,u.requestIdleCallback)(()=>m(e))}):m(e)}function y(e){"complete"===document.readyState?(0,u.requestIdleCallback)(()=>m(e)):window.addEventListener("load",()=>{(0,u.requestIdleCallback)(()=>m(e))})}function v(){[...document.querySelectorAll('[data-nscript="beforeInteractive"]'),...document.querySelectorAll('[data-nscript="beforePageRender"]')].forEach(e=>{let t=e.id||e.getAttribute("src");h.add(t)})}function b(e){e.forEach(g),v()}function _(e){let{id:t,src:r="",onLoad:n=()=>{},onReady:i=null,strategy:c="afterInteractive",onError:u,stylesheets:d,...p}=e,{updateScripts:f,scripts:g,getIsSsr:v,appDir:b,nonce:_}=(0,s.useContext)(l.HeadManagerContext),w=(0,s.useRef)(!1);(0,s.useEffect)(()=>{let e=t||r;w.current||(i&&e&&h.has(e)&&i(),w.current=!0)},[i,t,r]);let S=(0,s.useRef)(!1);if((0,s.useEffect)(()=>{S.current||("afterInteractive"===c?m(e):"lazyOnload"===c&&y(e),S.current=!0)},[e,c]),("beforeInteractive"===c||"worker"===c)&&(f?(g[c]=(g[c]||[]).concat([{id:t,src:r,onLoad:n,onReady:i,onError:u,...p}]),f(g)):v&&v()?h.add(t||r):v&&!v()&&m(e)),b){if(d&&d.forEach(e=>{o.default.preinit(e,{as:"style"})}),"beforeInteractive"===c)return r?(o.default.preload(r,p.integrity?{as:"script",integrity:p.integrity,nonce:_,crossOrigin:p.crossOrigin}:{as:"script",nonce:_,crossOrigin:p.crossOrigin}),(0,a.jsx)("script",{nonce:_,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([r,{...p,id:t}])+")"}})):(p.dangerouslySetInnerHTML&&(p.children=p.dangerouslySetInnerHTML.__html,delete p.dangerouslySetInnerHTML),(0,a.jsx)("script",{nonce:_,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([0,{...p,id:t}])+")"}}));"afterInteractive"===c&&r&&o.default.preload(r,p.integrity?{as:"script",integrity:p.integrity,nonce:_,crossOrigin:p.crossOrigin}:{as:"script",nonce:_,crossOrigin:p.crossOrigin})}return null}Object.defineProperty(_,"__nextScript",{value:!0});let w=_;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},4784:function(e,t,r){var n="/",i=r(25566),a=r(82957).Buffer;!function(){var t={992:function(e){e.exports=function(e,r,n){if(e.filter)return e.filter(r,n);if(null==e||"function"!=typeof r)throw TypeError();for(var i=[],a=0;a<e.length;a++)if(t.call(e,a)){var o=e[a];r.call(n,o,a,e)&&i.push(o)}return i};var t=Object.prototype.hasOwnProperty},167:function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}var o,s,l=r(23).codes,c=l.ERR_AMBIGUOUS_ARGUMENT,u=l.ERR_INVALID_ARG_TYPE,d=l.ERR_INVALID_ARG_VALUE,h=l.ERR_INVALID_RETURN_VALUE,p=l.ERR_MISSING_ARGS,f=r(545),m=r(177).inspect,g=r(177).types,y=g.isPromise,v=g.isRegExp,b=Object.assign?Object.assign:r(604).assign,_=Object.is?Object.is:r(208);function w(){var e=r(176);o=e.isDeepEqual,s=e.isDeepStrictEqual}var S=!1,T=e.exports=M,x={};function E(e){if(e.message instanceof Error)throw e.message;throw new f(e)}function C(e,t,r,n,a){var o,s=arguments.length;if(0===s?o="Failed":1===s?(r=e,e=void 0):(!1===S&&(S=!0,(i.emitWarning?i.emitWarning:console.warn.bind(console))("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")),2===s&&(n="!=")),r instanceof Error)throw r;var l={actual:e,expected:t,operator:void 0===n?"fail":n,stackStartFn:a||C};void 0!==r&&(l.message=r);var c=new f(l);throw o&&(c.message=o,c.generatedMessage=!0),c}function A(e,t,r,n){if(!r){var i=!1;if(0===t)i=!0,n="No value argument passed to `assert.ok()`";else if(n instanceof Error)throw n;var a=new f({actual:r,expected:!0,message:n,operator:"==",stackStartFn:e});throw a.generatedMessage=i,a}}function M(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];A.apply(void 0,[M,t.length].concat(t))}function I(e,t,r){if(arguments.length<2)throw new p("actual","expected");void 0===o&&w(),s(e,t)&&E({actual:e,expected:t,message:r,operator:"notDeepStrictEqual",stackStartFn:I})}T.fail=C,T.AssertionError=f,T.ok=M,T.equal=function e(t,r,n){if(arguments.length<2)throw new p("actual","expected");t!=r&&E({actual:t,expected:r,message:n,operator:"==",stackStartFn:e})},T.notEqual=function e(t,r,n){if(arguments.length<2)throw new p("actual","expected");t==r&&E({actual:t,expected:r,message:n,operator:"!=",stackStartFn:e})},T.deepEqual=function e(t,r,n){if(arguments.length<2)throw new p("actual","expected");void 0===o&&w(),o(t,r)||E({actual:t,expected:r,message:n,operator:"deepEqual",stackStartFn:e})},T.notDeepEqual=function e(t,r,n){if(arguments.length<2)throw new p("actual","expected");void 0===o&&w(),o(t,r)&&E({actual:t,expected:r,message:n,operator:"notDeepEqual",stackStartFn:e})},T.deepStrictEqual=function e(t,r,n){if(arguments.length<2)throw new p("actual","expected");void 0===o&&w(),s(t,r)||E({actual:t,expected:r,message:n,operator:"deepStrictEqual",stackStartFn:e})},T.notDeepStrictEqual=I,T.strictEqual=function e(t,r,n){if(arguments.length<2)throw new p("actual","expected");_(t,r)||E({actual:t,expected:r,message:n,operator:"strictEqual",stackStartFn:e})},T.notStrictEqual=function e(t,r,n){if(arguments.length<2)throw new p("actual","expected");_(t,r)&&E({actual:t,expected:r,message:n,operator:"notStrictEqual",stackStartFn:e})};var R=function e(t,r,n){var i=this;a(this,e),r.forEach(function(e){e in t&&(void 0!==n&&"string"==typeof n[e]&&v(t[e])&&t[e].test(n[e])?i[e]=n[e]:i[e]=t[e])})};function k(e,t,r,n,i,a){if(!(r in e)||!s(e[r],t[r])){if(!n){var o=new f({actual:new R(e,i),expected:new R(t,i,e),operator:"deepStrictEqual",stackStartFn:a});throw o.actual=e,o.expected=t,o.operator=a.name,o}E({actual:e,expected:t,message:n,operator:a.name,stackStartFn:a})}}function P(e,t,r,i){if("function"!=typeof t){if(v(t))return t.test(e);if(2==arguments.length)throw new u("expected",["Function","RegExp"],t);if("object"!==n(e)||null===e){var a=new f({actual:e,expected:t,message:r,operator:"deepStrictEqual",stackStartFn:i});throw a.operator=i.name,a}var s=Object.keys(t);if(t instanceof Error)s.push("name","message");else if(0===s.length)throw new d("error",t,"may not be an empty object");return void 0===o&&w(),s.forEach(function(n){"string"==typeof e[n]&&v(t[n])&&t[n].test(e[n])||k(e,t,n,r,s,i)}),!0}return void 0!==t.prototype&&e instanceof t||!Error.isPrototypeOf(t)&&!0===t.call({},e)}function O(e){if("function"!=typeof e)throw new u("fn","Function",e);try{e()}catch(e){return e}return x}function N(e){return y(e)||null!==e&&"object"===n(e)&&"function"==typeof e.then&&"function"==typeof e.catch}function L(e){return Promise.resolve().then(function(){var t;if("function"==typeof e){if(!N(t=e()))throw new h("instance of Promise","promiseFn",t)}else if(N(e))t=e;else throw new u("promiseFn",["Function","Promise"],e);return Promise.resolve().then(function(){return t}).then(function(){return x}).catch(function(e){return e})})}function D(e,t,r,i){if("string"==typeof r){if(4==arguments.length)throw new u("error",["Object","Error","Function","RegExp"],r);if("object"===n(t)&&null!==t){if(t.message===r)throw new c("error/message",'The error message "'.concat(t.message,'" is identical to the message.'))}else if(t===r)throw new c("error/message",'The error "'.concat(t,'" is identical to the message.'));i=r,r=void 0}else if(null!=r&&"object"!==n(r)&&"function"!=typeof r)throw new u("error",["Object","Error","Function","RegExp"],r);if(t===x){var a="";r&&r.name&&(a+=" (".concat(r.name,")")),a+=i?": ".concat(i):".";var o="rejects"===e.name?"rejection":"exception";E({actual:void 0,expected:r,operator:e.name,message:"Missing expected ".concat(o).concat(a),stackStartFn:e})}if(r&&!P(t,r,i,e))throw t}function U(e,t,r,n){if(t!==x){if("string"==typeof r&&(n=r,r=void 0),!r||P(t,r)){var i=n?": ".concat(n):".",a="doesNotReject"===e.name?"rejection":"exception";E({actual:t,expected:r,operator:e.name,message:"Got unwanted ".concat(a).concat(i,"\n")+'Actual message: "'.concat(t&&t.message,'"'),stackStartFn:e})}throw t}}function F(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];A.apply(void 0,[F,t.length].concat(t))}T.throws=function e(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];D.apply(void 0,[e,O(t)].concat(n))},T.rejects=function e(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return L(t).then(function(t){return D.apply(void 0,[e,t].concat(n))})},T.doesNotThrow=function e(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];U.apply(void 0,[e,O(t)].concat(n))},T.doesNotReject=function e(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return L(t).then(function(t){return U.apply(void 0,[e,t].concat(n))})},T.ifError=function e(t){if(null!=t){var r="ifError got unwanted exception: ";"object"===n(t)&&"string"==typeof t.message?0===t.message.length&&t.constructor?r+=t.constructor.name:r+=t.message:r+=m(t);var i=new f({actual:t,expected:null,operator:"ifError",message:r,stackStartFn:e}),a=t.stack;if("string"==typeof a){var o=a.split("\n");o.shift();for(var s=i.stack.split("\n"),l=0;l<o.length;l++){var c=s.indexOf(o[l]);if(-1!==c){s=s.slice(0,c);break}}i.stack="".concat(s.join("\n"),"\n").concat(o.join("\n"))}throw i}},T.strict=b(F,T,{equal:T.strictEqual,deepEqual:T.deepStrictEqual,notEqual:T.notStrictEqual,notDeepEqual:T.notDeepStrictEqual}),T.strict.strict=T.strict},545:function(e,t,r){"use strict";function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){a(e,t,r[t])})}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}function c(e,t){return t&&("object"===v(t)||"function"==typeof t)?t:u(e)}function u(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}function h(e){var t="function"==typeof Map?new Map:void 0;return(h=function(e){if(null===e||!m(e))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return f(e,arguments,y(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),g(r,e)})(e)}function p(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function f(e,t,r){return(f=p()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&g(i,r.prototype),i}).apply(null,arguments)}function m(e){return -1!==Function.toString.call(e).indexOf("[native code]")}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var b=r(177).inspect,_=r(23).codes.ERR_INVALID_ARG_TYPE;function w(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}function S(e,t){if(t=Math.floor(t),0==e.length||0==t)return"";var r=e.length*t;for(t=Math.floor(Math.log(t)/Math.log(2));t;)e+=e,t--;return e+e.substring(0,r-e.length)}var T="",x="",E="",C="",A={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"},M=10;function I(e){var t=Object.keys(e),r=Object.create(Object.getPrototypeOf(e));return t.forEach(function(t){r[t]=e[t]}),Object.defineProperty(r,"message",{value:e.message}),r}function R(e){return b(e,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function k(e,t,r){var n="",a="",o=0,s="",l=!1,c=R(e),u=c.split("\n"),d=R(t).split("\n"),h=0,p="";if("strictEqual"===r&&"object"===v(e)&&"object"===v(t)&&null!==e&&null!==t&&(r="strictEqualObject"),1===u.length&&1===d.length&&u[0]!==d[0]){var f=u[0].length+d[0].length;if(f<=M){if(("object"!==v(e)||null===e)&&("object"!==v(t)||null===t)&&(0!==e||0!==t))return"".concat(A[r],"\n\n")+"".concat(u[0]," !== ").concat(d[0],"\n")}else if("strictEqualObject"!==r&&f<(i.stderr&&i.stderr.isTTY?i.stderr.columns:80)){for(;u[0][h]===d[0][h];)h++;h>2&&(p="\n  ".concat(S(" ",h),"^"),h=0)}}for(var m=u[u.length-1],g=d[d.length-1];m===g&&(h++<2?s="\n  ".concat(m).concat(s):n=m,u.pop(),d.pop(),0!==u.length&&0!==d.length);)m=u[u.length-1],g=d[d.length-1];var y=Math.max(u.length,d.length);if(0===y){var b=c.split("\n");if(b.length>30)for(b[26]="".concat(T,"...").concat(C);b.length>27;)b.pop();return"".concat(A.notIdentical,"\n\n").concat(b.join("\n"),"\n")}h>3&&(s="\n".concat(T,"...").concat(C).concat(s),l=!0),""!==n&&(s="\n  ".concat(n).concat(s),n="");var _=0,I=A[r]+"\n".concat(x,"+ actual").concat(C," ").concat(E,"- expected").concat(C),k=" ".concat(T,"...").concat(C," Lines skipped");for(h=0;h<y;h++){var P=h-o;if(u.length<h+1)P>1&&h>2&&(P>4?(a+="\n".concat(T,"...").concat(C),l=!0):P>3&&(a+="\n  ".concat(d[h-2]),_++),a+="\n  ".concat(d[h-1]),_++),o=h,n+="\n".concat(E,"-").concat(C," ").concat(d[h]),_++;else if(d.length<h+1)P>1&&h>2&&(P>4?(a+="\n".concat(T,"...").concat(C),l=!0):P>3&&(a+="\n  ".concat(u[h-2]),_++),a+="\n  ".concat(u[h-1]),_++),o=h,a+="\n".concat(x,"+").concat(C," ").concat(u[h]),_++;else{var O=d[h],N=u[h],L=N!==O&&(!w(N,",")||N.slice(0,-1)!==O);L&&w(O,",")&&O.slice(0,-1)===N&&(L=!1,N+=","),L?(P>1&&h>2&&(P>4?(a+="\n".concat(T,"...").concat(C),l=!0):P>3&&(a+="\n  ".concat(u[h-2]),_++),a+="\n  ".concat(u[h-1]),_++),o=h,a+="\n".concat(x,"+").concat(C," ").concat(N),n+="\n".concat(E,"-").concat(C," ").concat(O),_+=2):(a+=n,n="",(1===P||0===h)&&(a+="\n  ".concat(N),_++))}if(_>20&&h<y-2)return"".concat(I).concat(k,"\n").concat(a,"\n").concat(T,"...").concat(C).concat(n,"\n")+"".concat(T,"...").concat(C)}return"".concat(I).concat(l?k:"","\n").concat(a).concat(n).concat(s).concat(p)}var P=function(e){function t(e){if(o(this,t),"object"!==v(e)||null===e)throw new _("options","Object",e);var r,n=e.message,a=e.operator,s=e.stackStartFn,l=e.actual,d=e.expected,h=Error.stackTraceLimit;if(Error.stackTraceLimit=0,null!=n)r=c(this,y(t).call(this,String(n)));else if(i.stderr&&i.stderr.isTTY&&(i.stderr&&i.stderr.getColorDepth&&1!==i.stderr.getColorDepth()?(T="\x1b[34m",x="\x1b[32m",C="\x1b[39m",E="\x1b[31m"):(T="",x="",C="",E="")),"object"===v(l)&&null!==l&&"object"===v(d)&&null!==d&&"stack"in l&&l instanceof Error&&"stack"in d&&d instanceof Error&&(l=I(l),d=I(d)),"deepStrictEqual"===a||"strictEqual"===a)r=c(this,y(t).call(this,k(l,d,a)));else if("notDeepStrictEqual"===a||"notStrictEqual"===a){var p=A[a],f=R(l).split("\n");if("notStrictEqual"===a&&"object"===v(l)&&null!==l&&(p=A.notStrictEqualObject),f.length>30)for(f[26]="".concat(T,"...").concat(C);f.length>27;)f.pop();r=1===f.length?c(this,y(t).call(this,"".concat(p," ").concat(f[0]))):c(this,y(t).call(this,"".concat(p,"\n\n").concat(f.join("\n"),"\n")))}else{var m=R(l),g="",b=A[a];"notDeepEqual"===a||"notEqual"===a?(m="".concat(A[a],"\n\n").concat(m)).length>1024&&(m="".concat(m.slice(0,1021),"...")):(g="".concat(R(d)),m.length>512&&(m="".concat(m.slice(0,509),"...")),g.length>512&&(g="".concat(g.slice(0,509),"...")),"deepEqual"===a||"equal"===a?m="".concat(b,"\n\n").concat(m,"\n\nshould equal\n\n"):g=" ".concat(a," ").concat(g)),r=c(this,y(t).call(this,"".concat(m).concat(g)))}return Error.stackTraceLimit=h,r.generatedMessage=!n,Object.defineProperty(u(r),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),r.code="ERR_ASSERTION",r.actual=l,r.expected=d,r.operator=a,Error.captureStackTrace&&Error.captureStackTrace(u(r),s),r.stack,r.name="AssertionError",c(r)}return d(t,e),l(t,[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:b.custom,value:function(e,t){return b(this,n({},t,{customInspect:!1,depth:0}))}}]),t}(h(Error));e.exports=P},23:function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function a(e,t){return t&&("object"===n(t)||"function"==typeof t)?t:o(e)}function o(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u,d,h={};function p(e,t,r){function n(e,r,n){return"string"==typeof t?t:t(e,r,n)}r||(r=Error);var o=function(t){function r(t,o,l){var c;return i(this,r),(c=a(this,s(r).call(this,n(t,o,l)))).code=e,c}return l(r,t),r}(r);h[e]=o}function f(e,t){if(!Array.isArray(e))return"of ".concat(t," ").concat(String(e));var r=e.length;return(e=e.map(function(e){return String(e)}),r>2)?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}function m(e,t,r){return e.substr(!r||r<0?0:+r,t.length)===t}function g(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}function y(e,t,r){return"number"!=typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}p("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),p("ERR_INVALID_ARG_TYPE",function(e,t,i){if(void 0===u&&(u=r(167)),u("string"==typeof e,"'name' must be a string"),"string"==typeof t&&m(t,"not ")?(a="must not be",t=t.replace(/^not /,"")):a="must be",g(e," argument"))o="The ".concat(e," ").concat(a," ").concat(f(t,"type"));else{var a,o,s=y(e,".")?"property":"argument";o='The "'.concat(e,'" ').concat(s," ").concat(a," ").concat(f(t,"type"))}return o+". Received type ".concat(n(i))},TypeError),p("ERR_INVALID_ARG_VALUE",function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"is invalid";void 0===d&&(d=r(177));var i=d.inspect(t);return i.length>128&&(i="".concat(i.slice(0,128),"...")),"The argument '".concat(e,"' ").concat(n,". Received ").concat(i)},TypeError,RangeError),p("ERR_INVALID_RETURN_VALUE",function(e,t,r){var i;return i=r&&r.constructor&&r.constructor.name?"instance of ".concat(r.constructor.name):"type ".concat(n(r)),"Expected ".concat(e,' to be returned from the "').concat(t,'"')+" function but got ".concat(i,".")},TypeError),p("ERR_MISSING_ARGS",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];void 0===u&&(u=r(167)),u(t.length>0,"At least one arg needs to be specified");var i="The ",a=t.length;switch(t=t.map(function(e){return'"'.concat(e,'"')}),a){case 1:i+="".concat(t[0]," argument");break;case 2:i+="".concat(t[0]," and ").concat(t[1]," arguments");break;default:i+=t.slice(0,a-1).join(", ")+", and ".concat(t[a-1]," arguments")}return"".concat(i," must be specified")},TypeError),e.exports.codes=h},176:function(e,t,r){"use strict";function n(e,t){return o(e)||a(e,t)||i()}function i(){throw TypeError("Invalid attempt to destructure non-iterable instance")}function a(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r}function o(e){if(Array.isArray(e))return e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l=void 0!==/a/g.flags,c=function(e){var t=[];return e.forEach(function(e){return t.push(e)}),t},u=function(e){var t=[];return e.forEach(function(e,r){return t.push([r,e])}),t},d=Object.is?Object.is:r(208),h=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},p=Number.isNaN?Number.isNaN:r(718);function f(e){return e.call.bind(e)}var m=f(Object.prototype.hasOwnProperty),g=f(Object.prototype.propertyIsEnumerable),y=f(Object.prototype.toString),v=r(177).types,b=v.isAnyArrayBuffer,_=v.isArrayBufferView,w=v.isDate,S=v.isMap,T=v.isRegExp,x=v.isSet,E=v.isNativeError,C=v.isBoxedPrimitive,A=v.isNumberObject,M=v.isStringObject,I=v.isBooleanObject,R=v.isBigIntObject,k=v.isSymbolObject,P=v.isFloat32Array,O=v.isFloat64Array;function N(e){if(0===e.length||e.length>10)return!0;for(var t=0;t<e.length;t++){var r=e.charCodeAt(t);if(r<48||r>57)return!0}return 10===e.length&&e>=4294967296}function L(e){return Object.keys(e).filter(N).concat(h(e).filter(Object.prototype.propertyIsEnumerable.bind(e)))}function D(e,t){if(e===t)return 0;for(var r=e.length,n=t.length,i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0}var U=void 0,F=!0,B=!1,z=0,H=1,j=2,G=3;function V(e,t){return l?e.source===t.source&&e.flags===t.flags:RegExp.prototype.toString.call(e)===RegExp.prototype.toString.call(t)}function q(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function W(e,t){return e.byteLength===t.byteLength&&0===D(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function Z(e,t){return e.byteLength===t.byteLength&&0===D(new Uint8Array(e),new Uint8Array(t))}function X(e,t){return A(e)?A(t)&&d(Number.prototype.valueOf.call(e),Number.prototype.valueOf.call(t)):M(e)?M(t)&&String.prototype.valueOf.call(e)===String.prototype.valueOf.call(t):I(e)?I(t)&&Boolean.prototype.valueOf.call(e)===Boolean.prototype.valueOf.call(t):R(e)?R(t)&&BigInt.prototype.valueOf.call(e)===BigInt.prototype.valueOf.call(t):k(t)&&Symbol.prototype.valueOf.call(e)===Symbol.prototype.valueOf.call(t)}function $(e,t,r,n){if(e===t)return 0!==e||!r||d(e,t);if(r){if("object"!==s(e))return"number"==typeof e&&p(e)&&p(t);if("object"!==s(t)||null===e||null===t||Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1}else{if(null===e||"object"!==s(e))return(null===t||"object"!==s(t))&&e==t;if(null===t||"object"!==s(t))return!1}var i=y(e);if(i!==y(t))return!1;if(Array.isArray(e)){if(e.length!==t.length)return!1;var a=L(e,U),o=L(t,U);return a.length===o.length&&Y(e,t,r,n,H,a)}if("[object Object]"===i&&(!S(e)&&S(t)||!x(e)&&x(t)))return!1;if(w(e)){if(!w(t)||Date.prototype.getTime.call(e)!==Date.prototype.getTime.call(t))return!1}else if(T(e)){if(!T(t)||!V(e,t))return!1}else if(E(e)||e instanceof Error){if(e.message!==t.message||e.name!==t.name)return!1}else if(_(e)){if(!r&&(P(e)||O(e))){if(!q(e,t))return!1}else if(!W(e,t))return!1;var l=L(e,U),c=L(t,U);return l.length===c.length&&Y(e,t,r,n,z,l)}else if(x(e))return!!x(t)&&e.size===t.size&&Y(e,t,r,n,j);else if(S(e))return!!S(t)&&e.size===t.size&&Y(e,t,r,n,G);else if(b(e)){if(!Z(e,t))return!1}else if(C(e)&&!X(e,t))return!1;return Y(e,t,r,n,z)}function K(e,t){return t.filter(function(t){return g(e,t)})}function Y(e,t,r,n,i,a){if(5==arguments.length){a=Object.keys(e);var o=Object.keys(t);if(a.length!==o.length)return!1}for(var s=0;s<a.length;s++)if(!m(t,a[s]))return!1;if(r&&5==arguments.length){var l=h(e);if(0!==l.length){var c=0;for(s=0;s<l.length;s++){var u=l[s];if(g(e,u)){if(!g(t,u))return!1;a.push(u),c++}else if(g(t,u))return!1}var d=h(t);if(l.length!==d.length&&K(t,d).length!==c)return!1}else{var p=h(t);if(0!==p.length&&0!==K(t,p).length)return!1}}if(0===a.length&&(i===z||i===H&&0===e.length||0===e.size))return!0;if(void 0===n)n={val1:new Map,val2:new Map,position:0};else{var f=n.val1.get(e);if(void 0!==f){var y=n.val2.get(t);if(void 0!==y)return f===y}n.position++}n.val1.set(e,n.position),n.val2.set(t,n.position);var v=ea(e,t,r,a,n,i);return n.val1.delete(e),n.val2.delete(t),v}function Q(e,t,r,n){for(var i=c(e),a=0;a<i.length;a++){var o=i[a];if($(t,o,r,n))return e.delete(o),!0}return!1}function J(e){switch(s(e)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":e=+e;case"number":if(p(e))return!1}return!0}function ee(e,t,r){var n=J(r);return null!=n?n:t.has(n)&&!e.has(n)}function et(e,t,r,n,i){var a=J(r);if(null!=a)return a;var o=t.get(a);return!!((void 0!==o||t.has(a))&&$(n,o,!1,i))&&!e.has(a)&&$(n,o,!1,i)}function er(e,t,r,n){for(var i=null,a=c(e),o=0;o<a.length;o++){var l=a[o];if("object"===s(l)&&null!==l)null===i&&(i=new Set),i.add(l);else if(!t.has(l)){if(r||!ee(e,t,l))return!1;null===i&&(i=new Set),i.add(l)}}if(null!==i){for(var u=c(t),d=0;d<u.length;d++){var h=u[d];if("object"===s(h)&&null!==h){if(!Q(i,h,r,n))return!1}else if(!r&&!e.has(h)&&!Q(i,h,r,n))return!1}return 0===i.size}return!0}function en(e,t,r,n,i,a){for(var o=c(e),s=0;s<o.length;s++){var l=o[s];if($(r,l,i,a)&&$(n,t.get(l),i,a))return e.delete(l),!0}return!1}function ei(e,t,r,i){for(var a=null,o=u(e),l=0;l<o.length;l++){var c=n(o[l],2),d=c[0],h=c[1];if("object"===s(d)&&null!==d)null===a&&(a=new Set),a.add(d);else{var p=t.get(d);if(void 0===p&&!t.has(d)||!$(h,p,r,i)){if(r||!et(e,t,d,h,i))return!1;null===a&&(a=new Set),a.add(d)}}}if(null!==a){for(var f=u(t),m=0;m<f.length;m++){var g=n(f[m],2),d=g[0],y=g[1];if("object"===s(d)&&null!==d){if(!en(a,e,d,y,r,i))return!1}else if(!r&&(!e.has(d)||!$(e.get(d),y,!1,i))&&!en(a,e,d,y,!1,i))return!1}return 0===a.size}return!0}function ea(e,t,r,n,i,a){var o=0;if(a===j){if(!er(e,t,r,i))return!1}else if(a===G){if(!ei(e,t,r,i))return!1}else if(a===H)for(;o<e.length;o++)if(m(e,o)){if(!m(t,o)||!$(e[o],t[o],r,i))return!1}else{if(m(t,o))return!1;for(var s=Object.keys(e);o<s.length;o++){var l=s[o];if(!m(t,l)||!$(e[l],t[l],r,i))return!1}if(s.length!==Object.keys(t).length)return!1;return!0}for(o=0;o<n.length;o++){var c=n[o];if(!$(e[c],t[c],r,i))return!1}return!0}function eo(e,t){return $(e,t,B)}function es(e,t){return $(e,t,F)}e.exports={isDeepEqual:eo,isDeepStrictEqual:es}},256:function(e,t,r){"use strict";var n=r(925),i=r(139),a=i(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&a(e,".prototype.")>-1?i(r):r}},139:function(e,t,r){"use strict";var n=r(174),i=r(925),a=i("%Function.prototype.apply%"),o=i("%Function.prototype.call%"),s=i("%Reflect.apply%",!0)||n.call(o,a),l=i("%Object.getOwnPropertyDescriptor%",!0),c=i("%Object.defineProperty%",!0),u=i("%Math.max%");if(c)try{c({},"a",{value:1})}catch(e){c=null}e.exports=function(e){var t=s(n,o,arguments);return l&&c&&l(t,"length").configurable&&c(t,"length",{value:1+u(0,e.length-(arguments.length-1))}),t};var d=function(){return s(n,a,arguments)};c?c(e.exports,"apply",{value:d}):e.exports.apply=d},69:function(e,t,r){"use strict";var n=r(935),i="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),a=Object.prototype.toString,o=Array.prototype.concat,s=Object.defineProperty,l=function(e){return"function"==typeof e&&"[object Function]"===a.call(e)},c=function(){var e={};try{for(var t in s(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}},u=s&&c(),d=function(e,t,r,n){(!(t in e)||l(n)&&n())&&(u?s(e,t,{configurable:!0,enumerable:!1,value:r,writable:!0}):e[t]=r)},h=function(e,t){var r=arguments.length>2?arguments[2]:{},a=n(t);i&&(a=o.call(a,Object.getOwnPropertySymbols(t)));for(var s=0;s<a.length;s+=1)d(e,a[s],t[a[s]],r[a[s]])};h.supportsDescriptors=!!u,e.exports=h},604:function(e){"use strict";function t(e,t){if(null==e)throw TypeError("Cannot convert first argument to object");for(var r=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var a=Object.keys(Object(i)),o=0,s=a.length;o<s;o++){var l=a[o],c=Object.getOwnPropertyDescriptor(i,l);void 0!==c&&c.enumerable&&(r[l]=i[l])}}return r}function r(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:t})}e.exports={assign:t,polyfill:r}},144:function(e){var t=Object.prototype.hasOwnProperty,r=Object.prototype.toString;e.exports=function(e,n,i){if("[object Function]"!==r.call(n))throw TypeError("iterator must be a function");var a=e.length;if(a===+a)for(var o=0;o<a;o++)n.call(i,e[o],o,e);else for(var s in e)t.call(e,s)&&n.call(i,e[s],s,e)}},426:function(e){"use strict";var t="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,n=Object.prototype.toString,i="[object Function]";e.exports=function(e){var a,o=this;if("function"!=typeof o||n.call(o)!==i)throw TypeError(t+o);for(var s=r.call(arguments,1),l=function(){if(!(this instanceof a))return o.apply(e,s.concat(r.call(arguments)));var t=o.apply(this,s.concat(r.call(arguments)));return Object(t)===t?t:this},c=Math.max(0,o.length-s.length),u=[],d=0;d<c;d++)u.push("$"+d);if(a=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(l),o.prototype){var h=function(){};h.prototype=o.prototype,a.prototype=new h,h.prototype=null}return a}},174:function(e,t,r){"use strict";var n=r(426);e.exports=Function.prototype.bind||n},500:function(e,t,r){"use strict";var n,i=SyntaxError,a=Function,o=TypeError,s=function(e){try{return a('"use strict"; return ('+e+").constructor;")()}catch(e){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(e){l=null}var c=function(){throw new o},u=l?function(){try{return arguments.callee,c}catch(e){try{return l(arguments,"callee").get}catch(e){return c}}}():c,d=r(115)(),h=Object.getPrototypeOf||function(e){return e.__proto__},p={},f="undefined"==typeof Uint8Array?n:h(Uint8Array),m={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":d?h([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":p,"%AsyncGenerator%":p,"%AsyncGeneratorFunction%":p,"%AsyncIteratorPrototype%":p,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":a,"%GeneratorFunction%":p,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":d?h(h([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&d?h((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&d?h((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":d?h(""[Symbol.iterator]()):n,"%Symbol%":d?Symbol:n,"%SyntaxError%":i,"%ThrowTypeError%":u,"%TypedArray%":f,"%TypeError%":o,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},g=function e(t){var r;if("%AsyncFunction%"===t)r=s("async function () {}");else if("%GeneratorFunction%"===t)r=s("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=s("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&(r=h(i.prototype))}return m[t]=r,r},y={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},v=r(174),b=r(101),_=v.call(Function.call,Array.prototype.concat),w=v.call(Function.apply,Array.prototype.splice),S=v.call(Function.call,String.prototype.replace),T=v.call(Function.call,String.prototype.slice),x=v.call(Function.call,RegExp.prototype.exec),E=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,C=/\\(\\)?/g,A=function(e){var t=T(e,0,1),r=T(e,-1);if("%"===t&&"%"!==r)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new i("invalid intrinsic syntax, expected opening `%`");var n=[];return S(e,E,function(e,t,r,i){n[n.length]=r?S(i,C,"$1"):t||e}),n},M=function(e,t){var r,n=e;if(b(y,n)&&(n="%"+(r=y[n])[0]+"%"),b(m,n)){var a=m[n];if(a===p&&(a=g(n)),void 0===a&&!t)throw new o("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:a}}throw new i("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new o('"allowMissing" argument must be a boolean');if(null===x(/^%?[^%]*%?$/g,e))throw new i("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=A(e),n=r.length>0?r[0]:"",a=M("%"+n+"%",t),s=a.name,c=a.value,u=!1,d=a.alias;d&&(n=d[0],w(r,_([0,1],d)));for(var h=1,p=!0;h<r.length;h+=1){var f=r[h],g=T(f,0,1),y=T(f,-1);if(('"'===g||"'"===g||"`"===g||'"'===y||"'"===y||"`"===y)&&g!==y)throw new i("property names with quotes must have matching quotes");if("constructor"!==f&&p||(u=!0),n+="."+f,b(m,s="%"+n+"%"))c=m[s];else if(null!=c){if(!(f in c)){if(!t)throw new o("base intrinsic for "+e+" exists, but the property is not available.");return}if(l&&h+1>=r.length){var v=l(c,f);c=(p=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:c[f]}else p=b(c,f),c=c[f];p&&!u&&(m[s]=c)}}return c}},925:function(e,t,r){"use strict";var n,i=SyntaxError,a=Function,o=TypeError,s=function(e){try{return a('"use strict"; return ('+e+").constructor;")()}catch(e){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(e){l=null}var c=function(){throw new o},u=l?function(){try{return arguments.callee,c}catch(e){try{return l(arguments,"callee").get}catch(e){return c}}}():c,d=r(115)(),h=r(504)(),p=Object.getPrototypeOf||(h?function(e){return e.__proto__}:null),f={},m="undefined"!=typeof Uint8Array&&p?p(Uint8Array):n,g={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":d&&p?p([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?n:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":a,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":d&&p?p(p([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&d&&p?p((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&d&&p?p((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":d&&p?p(""[Symbol.iterator]()):n,"%Symbol%":d?Symbol:n,"%SyntaxError%":i,"%ThrowTypeError%":u,"%TypedArray%":m,"%TypeError%":o,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet};if(p)try{null.error}catch(e){var y=p(p(e));g["%Error.prototype%"]=y}var v=function e(t){var r;if("%AsyncFunction%"===t)r=s("async function () {}");else if("%GeneratorFunction%"===t)r=s("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=s("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&p&&(r=p(i.prototype))}return g[t]=r,r},b={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},_=r(174),w=r(101),S=_.call(Function.call,Array.prototype.concat),T=_.call(Function.apply,Array.prototype.splice),x=_.call(Function.call,String.prototype.replace),E=_.call(Function.call,String.prototype.slice),C=_.call(Function.call,RegExp.prototype.exec),A=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,M=/\\(\\)?/g,I=function(e){var t=E(e,0,1),r=E(e,-1);if("%"===t&&"%"!==r)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new i("invalid intrinsic syntax, expected opening `%`");var n=[];return x(e,A,function(e,t,r,i){n[n.length]=r?x(i,M,"$1"):t||e}),n},R=function(e,t){var r,n=e;if(w(b,n)&&(n="%"+(r=b[n])[0]+"%"),w(g,n)){var a=g[n];if(a===f&&(a=v(n)),void 0===a&&!t)throw new o("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:a}}throw new i("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new o('"allowMissing" argument must be a boolean');if(null===C(/^%?[^%]*%?$/,e))throw new i("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=I(e),n=r.length>0?r[0]:"",a=R("%"+n+"%",t),s=a.name,c=a.value,u=!1,d=a.alias;d&&(n=d[0],T(r,S([0,1],d)));for(var h=1,p=!0;h<r.length;h+=1){var f=r[h],m=E(f,0,1),y=E(f,-1);if(('"'===m||"'"===m||"`"===m||'"'===y||"'"===y||"`"===y)&&m!==y)throw new i("property names with quotes must have matching quotes");if("constructor"!==f&&p||(u=!0),n+="."+f,w(g,s="%"+n+"%"))c=g[s];else if(null!=c){if(!(f in c)){if(!t)throw new o("base intrinsic for "+e+" exists, but the property is not available.");return}if(l&&h+1>=r.length){var v=l(c,f);c=(p=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:c[f]}else p=w(c,f),c=c[f];p&&!u&&(g[s]=c)}}return c}},504:function(e){"use strict";var t={foo:{}},r=Object;e.exports=function(){return({__proto__:t}).foo===t.foo&&!(({__proto__:null})instanceof r)}},942:function(e,t,r){"use strict";var n="undefined"!=typeof Symbol&&Symbol,i=r(773);e.exports=function(){return"function"==typeof n&&"function"==typeof Symbol&&"symbol"==typeof n("foo")&&"symbol"==typeof Symbol("bar")&&i()}},773:function(e){"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t||"[object Symbol]"!==Object.prototype.toString.call(t)||"[object Symbol]"!==Object.prototype.toString.call(r))return!1;var n=42;for(t in e[t]=n,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var i=Object.getOwnPropertySymbols(e);if(1!==i.length||i[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==n||!0!==a.enumerable)return!1}return!0}},115:function(e,t,r){"use strict";var n="undefined"!=typeof Symbol&&Symbol,i=r(832);e.exports=function(){return"function"==typeof n&&"function"==typeof Symbol&&"symbol"==typeof n("foo")&&"symbol"==typeof Symbol("bar")&&i()}},832:function(e){"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t||"[object Symbol]"!==Object.prototype.toString.call(t)||"[object Symbol]"!==Object.prototype.toString.call(r))return!1;var n=42;for(t in e[t]=n,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var i=Object.getOwnPropertySymbols(e);if(1!==i.length||i[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==n||!0!==a.enumerable)return!1}return!0}},101:function(e,t,r){"use strict";var n=r(174);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},782:function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},157:function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,r=Object.prototype.toString,n=function(e){return(!t||!e||"object"!=typeof e||!(Symbol.toStringTag in e))&&"[object Arguments]"===r.call(e)},i=function(e){return!!n(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==r.call(e)&&"[object Function]"===r.call(e.callee)},a=function(){return n(arguments)}();n.isLegacyArguments=i,e.exports=a?n:i},391:function(e){"use strict";var t=Object.prototype.toString,r=Function.prototype.toString,n=/^\s*(?:function)?\*/,i="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,a=Object.getPrototypeOf,o=function(){if(!i)return!1;try{return Function("return function*() {}")()}catch(e){}}(),s=o?a(o):{};e.exports=function(e){return"function"==typeof e&&(!!n.test(r.call(e))||(i?a(e)===s:"[object GeneratorFunction]"===t.call(e)))}},460:function(e){"use strict";e.exports=function(e){return e!=e}},718:function(e,t,r){"use strict";var n=r(139),i=r(69),a=r(460),o=r(625),s=r(171),l=n(o(),Number);i(l,{getPolyfill:o,implementation:a,shim:s}),e.exports=l},625:function(e,t,r){"use strict";var n=r(460);e.exports=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:n}},171:function(e,t,r){"use strict";var n=r(69),i=r(625);e.exports=function(){var e=i();return n(Number,{isNaN:e},{isNaN:function(){return Number.isNaN!==e}}),e}},994:function(e,t,n){"use strict";var i=n(144),a=n(349),o=n(256),s=o("Object.prototype.toString"),l=n(942)()&&"symbol"==typeof Symbol.toStringTag,c=a(),u=o("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return -1},d=o("String.prototype.slice"),h={},p=n(24),f=Object.getPrototypeOf;l&&p&&f&&i(c,function(e){var t=new r.g[e];if(!(Symbol.toStringTag in t))throw EvalError("this engine has support for Symbol.toStringTag, but "+e+" does not have the property! Please report this.");var n=f(t),i=p(n,Symbol.toStringTag);i||(i=p(f(n),Symbol.toStringTag)),h[e]=i.get});var m=function(e){var t=!1;return i(h,function(r,n){if(!t)try{t=r.call(e)===n}catch(e){}}),t};e.exports=function(e){return!!e&&"object"==typeof e&&(l?!!p&&m(e):u(c,d(s(e),8,-1))>-1)}},208:function(e){"use strict";var t=function(e){return e!=e};e.exports=function(e,r){return 0===e&&0===r?1/e==1/r:!!(e===r||t(e)&&t(r))}},579:function(e,t,r){"use strict";var n;if(!Object.keys){var i=Object.prototype.hasOwnProperty,a=Object.prototype.toString,o=r(412),s=Object.prototype.propertyIsEnumerable,l=!s.call({toString:null},"toString"),c=s.call(function(){},"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=function(e){var t=e.constructor;return t&&t.prototype===e},h={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!h["$"+e]&&i.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{d(window[e])}catch(e){return!0}}catch(e){return!0}return!1}(),f=function(e){if("undefined"==typeof window||!p)return d(e);try{return d(e)}catch(e){return!1}};n=function(e){var t=null!==e&&"object"==typeof e,r="[object Function]"===a.call(e),n=o(e),s=t&&"[object String]"===a.call(e),d=[];if(!t&&!r&&!n)throw TypeError("Object.keys called on a non-object");var h=c&&r;if(s&&e.length>0&&!i.call(e,0))for(var p=0;p<e.length;++p)d.push(String(p));if(n&&e.length>0)for(var m=0;m<e.length;++m)d.push(String(m));else for(var g in e)!(h&&"prototype"===g)&&i.call(e,g)&&d.push(String(g));if(l)for(var y=f(e),v=0;v<u.length;++v)!(y&&"constructor"===u[v])&&i.call(e,u[v])&&d.push(u[v]);return d}}e.exports=n},935:function(e,t,r){"use strict";var n=Array.prototype.slice,i=r(412),a=Object.keys,o=a?function(e){return a(e)}:r(579),s=Object.keys;o.shim=function(){return Object.keys?!function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)&&(Object.keys=function(e){return i(e)?s(n.call(e)):s(e)}):Object.keys=o,Object.keys||o},e.exports=o},412:function(e){"use strict";var t=Object.prototype.toString;e.exports=function(e){var r=t.call(e),n="[object Arguments]"===r;return n||(n="[object Array]"!==r&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===t.call(e.callee)),n}},369:function(e){e.exports=function(e){return e instanceof a}},584:function(e,t,r){"use strict";var n=r(157),i=r(391),a=r(490),o=r(994);function s(e){return e.call.bind(e)}var l="undefined"!=typeof BigInt,c="undefined"!=typeof Symbol,u=s(Object.prototype.toString),d=s(Number.prototype.valueOf),h=s(String.prototype.valueOf),p=s(Boolean.prototype.valueOf);if(l)var f=s(BigInt.prototype.valueOf);if(c)var m=s(Symbol.prototype.valueOf);function g(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function y(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch}function v(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):o(e)||H(e)}function b(e){return"Uint8Array"===a(e)}function _(e){return"Uint8ClampedArray"===a(e)}function w(e){return"Uint16Array"===a(e)}function S(e){return"Uint32Array"===a(e)}function T(e){return"Int8Array"===a(e)}function x(e){return"Int16Array"===a(e)}function E(e){return"Int32Array"===a(e)}function C(e){return"Float32Array"===a(e)}function A(e){return"Float64Array"===a(e)}function M(e){return"BigInt64Array"===a(e)}function I(e){return"BigUint64Array"===a(e)}function R(e){return"[object Map]"===u(e)}function k(e){return"undefined"!=typeof Map&&(R.working?R(e):e instanceof Map)}function P(e){return"[object Set]"===u(e)}function O(e){return"undefined"!=typeof Set&&(P.working?P(e):e instanceof Set)}function N(e){return"[object WeakMap]"===u(e)}function L(e){return"undefined"!=typeof WeakMap&&(N.working?N(e):e instanceof WeakMap)}function D(e){return"[object WeakSet]"===u(e)}function U(e){return D(e)}function F(e){return"[object ArrayBuffer]"===u(e)}function B(e){return"undefined"!=typeof ArrayBuffer&&(F.working?F(e):e instanceof ArrayBuffer)}function z(e){return"[object DataView]"===u(e)}function H(e){return"undefined"!=typeof DataView&&(z.working?z(e):e instanceof DataView)}t.isArgumentsObject=n,t.isGeneratorFunction=i,t.isTypedArray=o,t.isPromise=y,t.isArrayBufferView=v,t.isUint8Array=b,t.isUint8ClampedArray=_,t.isUint16Array=w,t.isUint32Array=S,t.isInt8Array=T,t.isInt16Array=x,t.isInt32Array=E,t.isFloat32Array=C,t.isFloat64Array=A,t.isBigInt64Array=M,t.isBigUint64Array=I,R.working="undefined"!=typeof Map&&R(new Map),t.isMap=k,P.working="undefined"!=typeof Set&&P(new Set),t.isSet=O,N.working="undefined"!=typeof WeakMap&&N(new WeakMap),t.isWeakMap=L,D.working="undefined"!=typeof WeakSet&&D(new WeakSet),t.isWeakSet=U,F.working="undefined"!=typeof ArrayBuffer&&F(new ArrayBuffer),t.isArrayBuffer=B,z.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&z(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=H;var j="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function G(e){return"[object SharedArrayBuffer]"===u(e)}function V(e){return void 0!==j&&(void 0===G.working&&(G.working=G(new j)),G.working?G(e):e instanceof j)}function q(e){return"[object AsyncFunction]"===u(e)}function W(e){return"[object Map Iterator]"===u(e)}function Z(e){return"[object Set Iterator]"===u(e)}function X(e){return"[object Generator]"===u(e)}function $(e){return"[object WebAssembly.Module]"===u(e)}function K(e){return g(e,d)}function Y(e){return g(e,h)}function Q(e){return g(e,p)}function J(e){return l&&g(e,f)}function ee(e){return c&&g(e,m)}function et(e){return K(e)||Y(e)||Q(e)||J(e)||ee(e)}function er(e){return"undefined"!=typeof Uint8Array&&(B(e)||V(e))}t.isSharedArrayBuffer=V,t.isAsyncFunction=q,t.isMapIterator=W,t.isSetIterator=Z,t.isGeneratorObject=X,t.isWebAssemblyCompiledModule=$,t.isNumberObject=K,t.isStringObject=Y,t.isBooleanObject=Q,t.isBigIntObject=J,t.isSymbolObject=ee,t.isBoxedPrimitive=et,t.isAnyArrayBuffer=er,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw Error(e+" is not supported in userland")}})})},177:function(e,t,r){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},a=/%[sdj%]/g;t.format=function(e){if(!x(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(c(arguments[r]));return t.join(" ")}for(var r=1,n=arguments,i=n.length,o=String(e).replace(a,function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),s=n[r];r<i;s=n[++r])w(s)||!M(s)?o+=" "+s:o+=" "+c(s);return o},t.deprecate=function(e,r){if(void 0!==i&&!0===i.noDeprecation)return e;if(void 0===i)return function(){return t.deprecate(e,r).apply(this,arguments)};var n=!1;return function(){if(!n){if(i.throwDeprecation)throw Error(r);i.traceDeprecation?console.trace(r):console.error(r),n=!0}return e.apply(this,arguments)}};var o={},s=/^$/;if(i.env.NODE_DEBUG){var l=i.env.NODE_DEBUG;s=RegExp("^"+(l=l.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase())+"$","i")}function c(e,r){var n={seen:[],stylize:d};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),_(r)?n.showHidden=r:r&&t._extend(n,r),C(n.showHidden)&&(n.showHidden=!1),C(n.depth)&&(n.depth=2),C(n.colors)&&(n.colors=!1),C(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),p(n,e,n.depth)}function u(e,t){var r=c.styles[t];return r?"\x1b["+c.colors[r][0]+"m"+e+"\x1b["+c.colors[r][1]+"m":e}function d(e,t){return e}function h(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}function p(e,r,n){if(e.customInspect&&r&&k(r.inspect)&&r.inspect!==t.inspect&&!(r.constructor&&r.constructor.prototype===r)){var i,a=r.inspect(n,e);return x(a)||(a=p(e,a,n)),a}var o=f(e,r);if(o)return o;var s=Object.keys(r),l=h(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(r)),R(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return m(r);if(0===s.length){if(k(r)){var c=r.name?": "+r.name:"";return e.stylize("[Function"+c+"]","special")}if(A(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(I(r))return e.stylize(Date.prototype.toString.call(r),"date");if(R(r))return m(r)}var u="",d=!1,_=["{","}"];return(b(r)&&(d=!0,_=["[","]"]),k(r)&&(u=" [Function"+(r.name?": "+r.name:"")+"]"),A(r)&&(u=" "+RegExp.prototype.toString.call(r)),I(r)&&(u=" "+Date.prototype.toUTCString.call(r)),R(r)&&(u=" "+m(r)),0!==s.length||d&&0!=r.length)?n<0?A(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),i=d?g(e,r,n,l,s):s.map(function(t){return y(e,r,n,l,t,d)}),e.seen.pop(),v(i,u,_)):_[0]+u+_[1]}function f(e,t){if(C(t))return e.stylize("undefined","undefined");if(x(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return T(t)?e.stylize(""+t,"number"):_(t)?e.stylize(""+t,"boolean"):w(t)?e.stylize("null","null"):void 0}function m(e){return"["+Error.prototype.toString.call(e)+"]"}function g(e,t,r,n,i){for(var a=[],o=0,s=t.length;o<s;++o)U(t,String(o))?a.push(y(e,t,r,n,String(o),!0)):a.push("");return i.forEach(function(i){i.match(/^\d+$/)||a.push(y(e,t,r,n,i,!0))}),a}function y(e,t,r,n,i,a){var o,s,l;if((l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),U(n,i)||(o="["+i+"]"),!s&&(0>e.seen.indexOf(l.value)?(s=w(r)?p(e,l.value,null):p(e,l.value,r-1)).indexOf("\n")>-1&&(s=a?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),C(o)){if(a&&i.match(/^\d+$/))return s;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function v(e,t,r){var n=0;return e.reduce(function(e,t){return n++,t.indexOf("\n")>=0&&n++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function b(e){return Array.isArray(e)}function _(e){return"boolean"==typeof e}function w(e){return null===e}function S(e){return null==e}function T(e){return"number"==typeof e}function x(e){return"string"==typeof e}function E(e){return"symbol"==typeof e}function C(e){return void 0===e}function A(e){return M(e)&&"[object RegExp]"===O(e)}function M(e){return"object"==typeof e&&null!==e}function I(e){return M(e)&&"[object Date]"===O(e)}function R(e){return M(e)&&("[object Error]"===O(e)||e instanceof Error)}function k(e){return"function"==typeof e}function P(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function O(e){return Object.prototype.toString.call(e)}function N(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(!o[e=e.toUpperCase()]){if(s.test(e)){var r=i.pid;o[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,n)}}else o[e]=function(){}}return o[e]},t.inspect=c,c.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=r(584),t.isArray=b,t.isBoolean=_,t.isNull=w,t.isNullOrUndefined=S,t.isNumber=T,t.isString=x,t.isSymbol=E,t.isUndefined=C,t.isRegExp=A,t.types.isRegExp=A,t.isObject=M,t.isDate=I,t.types.isDate=I,t.isError=R,t.types.isNativeError=R,t.isFunction=k,t.isPrimitive=P,t.isBuffer=r(369);var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function D(){var e=new Date,t=[N(e.getHours()),N(e.getMinutes()),N(e.getSeconds())].join(":");return[e.getDate(),L[e.getMonth()],t].join(" ")}function U(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",D(),t.format.apply(t,arguments))},t.inherits=r(782),t._extend=function(e,t){if(!t||!M(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var F="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function B(e,t){if(!e){var r=Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}function z(e){if("function"!=typeof e)throw TypeError('The "original" argument must be of type Function');function t(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var n=t.pop();if("function"!=typeof n)throw TypeError("The last argument must be of type Function");var a=this,o=function(){return n.apply(a,arguments)};e.apply(this,t).then(function(e){i.nextTick(o.bind(null,null,e))},function(e){i.nextTick(B.bind(null,e,o))})}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,n(e)),t}t.promisify=function(e){if("function"!=typeof e)throw TypeError('The "original" argument must be of type Function');if(F&&e[F]){var t=e[F];if("function"!=typeof t)throw TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,F,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise(function(e,n){t=e,r=n}),i=[],a=0;a<arguments.length;a++)i.push(arguments[a]);i.push(function(e,n){e?r(e):t(n)});try{e.apply(this,i)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),F&&Object.defineProperty(t,F,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=F,t.callbackify=z},490:function(e,t,n){"use strict";var i=n(144),a=n(349),o=n(256),s=o("Object.prototype.toString"),l=n(942)()&&"symbol"==typeof Symbol.toStringTag,c=a(),u=o("String.prototype.slice"),d={},h=n(24),p=Object.getPrototypeOf;l&&h&&p&&i(c,function(e){if("function"==typeof r.g[e]){var t=new r.g[e];if(!(Symbol.toStringTag in t))throw EvalError("this engine has support for Symbol.toStringTag, but "+e+" does not have the property! Please report this.");var n=p(t),i=h(n,Symbol.toStringTag);i||(i=h(p(n),Symbol.toStringTag)),d[e]=i.get}});var f=function(e){var t=!1;return i(d,function(r,n){if(!t)try{var i=r.call(e);i===n&&(t=i)}catch(e){}}),t},m=n(994);e.exports=function(e){return!!m(e)&&(l?f(e):u(s(e),8,-1))}},349:function(e,t,n){"use strict";var i=n(992);e.exports=function(){return i(["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],function(e){return"function"==typeof r.g[e]})}},24:function(e,t,r){"use strict";var n=r(500)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n}},o={};function s(e){var r=o[e];if(void 0!==r)return r.exports;var n=o[e]={exports:{}},i=!0;try{t[e](n,n.exports,s),i=!1}finally{i&&delete o[e]}return n.exports}s.ab=n+"/";var l=s(167);e.exports=l}()},64654:function(e,t,r){"use strict";r.d(t,{pk:function(){return eF},wT:function(){return eK},sy:function(){return u},yv:function(){return c}});var n,i,a,o,s,l,c,u,d=r(2265),h=r(54887);function p(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e){if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=p(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t)}return n}var f=function(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=p(e))&&(n&&(n+=" "),n+=t);return n};let m={data:""},g=e=>{if("object"==typeof window){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||m},y=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,v=/\/\*[^]*?\*\/|  +/g,b=/\n+/g,_=(e,t)=>{let r="",n="",i="";for(let a in e){let o=e[a];"@"==a[0]?"i"==a[1]?r=a+" "+o+";":n+="f"==a[1]?_(o,a):a+"{"+_(o,"k"==a[1]?"":t)+"}":"object"==typeof o?n+=_(o,t?t.replace(/([^,])+/g,e=>a.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)):a):null!=o&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=_.p?_.p(a,o):a+":"+o+";")}return r+(t&&i?t+"{"+i+"}":i)+n},w={},S=e=>{if("object"==typeof e){let t="";for(let r in e)t+=r+S(e[r]);return t}return e},T=(e,t,r,n,i)=>{let a=S(e),o=w[a]||(w[a]=(e=>{let t=0,r=11;for(;t<e.length;)r=101*r+e.charCodeAt(t++)>>>0;return"go"+r})(a));if(!w[o]){let t=a!==e?e:(e=>{let t,r,n=[{}];for(;t=y.exec(e.replace(v,""));)t[4]?n.shift():t[3]?(r=t[3].replace(b," ").trim(),n.unshift(n[0][r]=n[0][r]||{})):n[0][t[1]]=t[2].replace(b," ").trim();return n[0]})(e);w[o]=_(i?{["@keyframes "+o]:t}:t,r?"":"."+o)}let s=r&&w.g?w.g:null;return r&&(w.g=w[o]),((e,t,r,n)=>{n?t.data=t.data.replace(n,e):-1===t.data.indexOf(e)&&(t.data=r?e+t.data:t.data+e)})(w[o],t,n,s),o},x=(e,t,r)=>e.reduce((e,n,i)=>{let a=t[i];if(a&&a.call){let e=a(r),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;a=t?"."+t:e&&"object"==typeof e?e.props?"":_(e,""):!1===e?"":e}return e+n+(null==a?"":a)},"");function E(e){let t=this||{},r=e.call?e(t.p):e;return T(r.unshift?r.raw?x(r,[].slice.call(arguments,1),t.p):r.reduce((e,r)=>Object.assign(e,r&&r.call?r(t.p):r),{}):r,g(t.target),t.g,t.o,t.k)}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function A(e,t,r){return t&&C(e.prototype,t),r&&C(e,r),e}function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function I(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function R(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}function k(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}E.bind({g:1}),E.bind({k:1});var P=function(){return""},O=d.createContext({enqueueSnackbar:P,closeSnackbar:P}),N="@media (max-width:599.95px)",L="@media (min-width:600px)",D=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},U=function(e){return""+D(e.vertical)+D(e.horizontal)},F=function(e){return!!e||0===e},B="unmounted",z="exited",H="entering",j="entered",G="exiting",V=function(e){function t(t){r=e.call(this,t)||this;var r,n,i=t.appear;return r.appearStatus=null,t.in?i?(n=z,r.appearStatus=H):n=j:n=t.unmountOnExit||t.mountOnEnter?B:z,r.state={status:n},r.nextCallback=null,r}I(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===B?{status:z}:null};var r=t.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(e){var t=null;if(e!==this.props){var r=this.state.status;this.props.in?r!==H&&r!==j&&(t=H):(r===H||r===j)&&(t=G)}this.updateStatus(!1,t)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var e=this.props.timeout,t=e,r=e;return null!=e&&"number"!=typeof e&&"string"!=typeof e&&(r=e.exit,t=e.enter),{exit:r,enter:t}},r.updateStatus=function(e,t){void 0===e&&(e=!1),null!==t?(this.cancelNextCallback(),t===H?this.performEnter(e):this.performExit()):this.props.unmountOnExit&&this.state.status===z&&this.setState({status:B})},r.performEnter=function(e){var t=this,r=this.props.enter,n=e,i=this.getTimeouts();if(!e&&!r){this.safeSetState({status:j},function(){t.props.onEntered&&t.props.onEntered(t.node,n)});return}this.props.onEnter&&this.props.onEnter(this.node,n),this.safeSetState({status:H},function(){t.props.onEntering&&t.props.onEntering(t.node,n),t.onTransitionEnd(i.enter,function(){t.safeSetState({status:j},function(){t.props.onEntered&&t.props.onEntered(t.node,n)})})})},r.performExit=function(){var e=this,t=this.props.exit,r=this.getTimeouts();if(!t){this.safeSetState({status:z},function(){e.props.onExited&&e.props.onExited(e.node)});return}this.props.onExit&&this.props.onExit(this.node),this.safeSetState({status:G},function(){e.props.onExiting&&e.props.onExiting(e.node),e.onTransitionEnd(r.exit,function(){e.safeSetState({status:z},function(){e.props.onExited&&e.props.onExited(e.node)})})})},r.cancelNextCallback=function(){null!==this.nextCallback&&this.nextCallback.cancel&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},r.setNextCallback=function(e){var t=this,r=!0;return this.nextCallback=function(){r&&(r=!1,t.nextCallback=null,e())},this.nextCallback.cancel=function(){r=!1},this.nextCallback},r.onTransitionEnd=function(e,t){this.setNextCallback(t);var r=null==e&&!this.props.addEndListener;if(!this.node||r){setTimeout(this.nextCallback,0);return}this.props.addEndListener&&this.props.addEndListener(this.node,this.nextCallback),null!=e&&setTimeout(this.nextCallback,e)},r.render=function(){var e=this.state.status;if(e===B)return null;var t=this.props;return(0,t.children)(e,R(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]))},A(t,[{key:"node",get:function(){var e,t=null===(e=this.props.nodeRef)||void 0===e?void 0:e.current;if(!t)throw Error("notistack - Custom snackbar is not refForwarding");return t}}]),t}(d.Component);function q(){}function W(e,t){"function"==typeof e?e(t):e&&(e.current=t)}function Z(e,t){return(0,d.useMemo)(function(){return null==e&&null==t?null:function(r){W(e,r),W(t,r)}},[e,t])}function X(e){var t=e.timeout,r=e.style,n=void 0===r?{}:r,i=e.mode;return{duration:"object"==typeof t?t[i]||0:t,easing:n.transitionTimingFunction,delay:n.transitionDelay}}V.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:q,onEntering:q,onEntered:q,onExit:q,onExiting:q,onExited:q};var $={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},K=function(e){e.scrollTop=e.scrollTop},Y=function(e){return Math.round(e)+"ms"};function Q(e,t){void 0===e&&(e=["all"]);var r=t||{},n=r.duration,i=void 0===n?300:n,a=r.easing,o=void 0===a?$.easeInOut:a,s=r.delay,l=void 0===s?0:s;return(Array.isArray(e)?e:[e]).map(function(e){return e+" "+("string"==typeof i?i:Y(i))+" "+o+" "+("string"==typeof l?l:Y(l))}).join(",")}function J(e){return e&&e.ownerDocument||document}function ee(e){return J(e).defaultView||window}function et(e,t){var r;function n(){for(var n=this,i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];var s=function(){e.apply(n,a)};clearTimeout(r),r=setTimeout(s,t)}return void 0===t&&(t=166),n.clear=function(){clearTimeout(r)},n}function er(e,t){var r,n=t.getBoundingClientRect(),i=ee(t);if(t.fakeTransform)r=t.fakeTransform;else{var a=i.getComputedStyle(t);r=a.getPropertyValue("-webkit-transform")||a.getPropertyValue("transform")}var o=0,s=0;if(r&&"none"!==r&&"string"==typeof r){var l=r.split("(")[1].split(")")[0].split(",");o=parseInt(l[4],10),s=parseInt(l[5],10)}switch(e){case"left":return"translateX("+(i.innerWidth+o-n.left)+"px)";case"right":return"translateX(-"+(n.left+n.width-o)+"px)";case"up":return"translateY("+(i.innerHeight+s-n.top)+"px)";default:return"translateY(-"+(n.top+n.height-s)+"px)"}}function en(e,t){if(t){var r=er(e,t);r&&(t.style.webkitTransform=r,t.style.transform=r)}}var ei=(0,d.forwardRef)(function(e,t){var r=e.children,n=e.direction,i=void 0===n?"down":n,a=e.in,o=e.style,s=e.timeout,l=void 0===s?0:s,c=e.onEnter,u=e.onEntered,h=e.onExit,p=e.onExited,f=R(e,["children","direction","in","style","timeout","onEnter","onEntered","onExit","onExited"]),m=(0,d.useRef)(null),g=Z(r.ref,m),y=Z(g,t),v=function(e,t){en(i,e),K(e),c&&c(e,t)},b=function(e){var t=(null==o?void 0:o.transitionTimingFunction)||$.easeOut,r=X({timeout:l,mode:"enter",style:M({},o,{transitionTimingFunction:t})});e.style.webkitTransition=Q("-webkit-transform",r),e.style.transition=Q("transform",r),e.style.webkitTransform="none",e.style.transform="none"},_=function(e){var t=(null==o?void 0:o.transitionTimingFunction)||$.sharp,r=X({timeout:l,mode:"exit",style:M({},o,{transitionTimingFunction:t})});e.style.webkitTransition=Q("-webkit-transform",r),e.style.transition=Q("transform",r),en(i,e),h&&h(e)},w=function(e){e.style.webkitTransition="",e.style.transition="",p&&p(e)},S=(0,d.useCallback)(function(){m.current&&en(i,m.current)},[i]);return(0,d.useEffect)(function(){if(!a&&"down"!==i&&"right"!==i){var e=et(function(){m.current&&en(i,m.current)}),t=ee(m.current);return t.addEventListener("resize",e),function(){e.clear(),t.removeEventListener("resize",e)}}},[i,a]),(0,d.useEffect)(function(){a||S()},[a,S]),(0,d.createElement)(V,Object.assign({appear:!0,nodeRef:m,onEnter:v,onEntered:u,onEntering:b,onExit:_,onExited:w,in:a,timeout:l},f),function(e,t){return(0,d.cloneElement)(r,M({ref:y,style:M({visibility:"exited"!==e||a?void 0:"hidden"},o,{},r.props.style)},t))})});ei.displayName="Slide";var ea=function(e){return d.createElement("svg",Object.assign({viewBox:"0 0 24 24",focusable:"false",style:{fontSize:20,marginInlineEnd:8,userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0}},e))},eo=function(){return d.createElement(ea,null,d.createElement("path",{d:"M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41\n        10.59L10 14.17L17.59 6.58L19 8L10 17Z"}))},es=function(){return d.createElement(ea,null,d.createElement("path",{d:"M13,14H11V10H13M13,18H11V16H13M1,21H23L12,2L1,21Z"}))},el=function(){return d.createElement(ea,null,d.createElement("path",{d:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,\n        6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,\n        13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"}))},ec=function(){return d.createElement(ea,null,d.createElement("path",{d:"M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,\n        0 22,12A10,10 0 0,0 12,2Z"}))},eu={maxSnack:3,persist:!1,hideIconVariant:!1,disableWindowBlurListener:!1,variant:"default",autoHideDuration:5e3,iconVariant:{default:void 0,success:d.createElement(eo,null),warning:d.createElement(es,null),error:d.createElement(el,null),info:d.createElement(ec,null)},anchorOrigin:{vertical:"bottom",horizontal:"left"},TransitionComponent:ei,transitionDuration:{enter:225,exit:195}},ed=function(e,t){var r=function(e){return"number"==typeof e||null===e};return r(e)?e:r(t)?t:eu.autoHideDuration},eh=function(e,t){var r=function(e,t){return t.some(function(t){return typeof e===t})};return r(e,["string","number"])?e:r(e,["object"])?M({},eu.transitionDuration,{},r(t,["object"])&&t,{},e):r(t,["string","number"])?t:r(t,["object"])?M({},eu.transitionDuration,{},t):eu.transitionDuration},ep=function(e,t){return function(r,n){return(void 0===n&&(n=!1),n)?M({},eu[r],{},t[r],{},e[r]):"autoHideDuration"===r?ed(e.autoHideDuration,t.autoHideDuration):"transitionDuration"===r?eh(e.transitionDuration,t.transitionDuration):e[r]||t[r]||eu[r]}};function ef(e){return Object.entries(e).reduce(function(e,t){var r,n=t[0],i=t[1];return M({},e,((r={})[n]=E(i),r))},{})}var em="notistack-SnackbarContainer",eg="notistack-Snackbar",ey="notistack-CollapseWrapper",ev="notistack-MuiContent",eb=function(e){return"notistack-MuiContent-"+e},e_=ef({root:{height:0},entered:{height:"auto"}}),ew="0px",eS=175,eT=(0,d.forwardRef)(function(e,t){var r=e.children,n=e.in,i=e.onExited,a=(0,d.useRef)(null),o=(0,d.useRef)(null),s=Z(t,o),l=function(){return a.current?a.current.clientHeight:0},c=function(e){e.style.height=ew},u=function(e){var t=l(),r=X({timeout:eS,mode:"enter"}),n=r.duration,i=r.easing;e.style.transitionDuration="string"==typeof n?n:n+"ms",e.style.height=t+"px",e.style.transitionTimingFunction=i||""},h=function(e){e.style.height="auto"},p=function(e){e.style.height=l()+"px"},m=function(e){K(e);var t=X({timeout:eS,mode:"exit"}),r=t.duration,n=t.easing;e.style.transitionDuration="string"==typeof r?r:r+"ms",e.style.height=ew,e.style.transitionTimingFunction=n||""};return(0,d.createElement)(V,{in:n,unmountOnExit:!0,onEnter:c,onEntered:h,onEntering:u,onExit:p,onExited:i,onExiting:m,nodeRef:o,timeout:eS},function(e,t){return(0,d.createElement)("div",Object.assign({ref:s,className:f(e_.root,"entered"===e&&e_.entered),style:M({pointerEvents:"all",overflow:"hidden",minHeight:ew,transition:Q("height")},"entered"===e&&{overflow:"visible"},{},"exited"===e&&!n&&{visibility:"hidden"})},t),(0,d.createElement)("div",{ref:a,className:ey,style:{display:"flex",width:"100%"}},r))})});eT.displayName="Collapse";var ex={right:"left",left:"right",bottom:"up",top:"down"},eE=function(e){return"center"!==e.horizontal?ex[e.horizontal]:ex[e.vertical]},eC=function(e){return"anchorOrigin"+U(e)},eA=function(e){void 0===e&&(e={});var t={containerRoot:!0,containerAnchorOriginTopCenter:!0,containerAnchorOriginBottomCenter:!0,containerAnchorOriginTopRight:!0,containerAnchorOriginBottomRight:!0,containerAnchorOriginTopLeft:!0,containerAnchorOriginBottomLeft:!0};return Object.keys(e).filter(function(e){return!t[e]}).reduce(function(t,r){var n;return M({},t,((n={})[r]=e[r],n))},{})},eM=function(){};function eI(e,t){return e.reduce(function(e,r){return null==r?e:function(){for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var o=[].concat(i);t&&-1===o.indexOf(t)&&o.push(t),e.apply(this,o),r.apply(this,o)}},eM)}var eR="undefined"!=typeof window?d.useLayoutEffect:d.useEffect;function ek(e){var t=(0,d.useRef)(e);return eR(function(){t.current=e}),(0,d.useCallback)(function(){return t.current.apply(void 0,arguments)},[])}var eP=(0,d.forwardRef)(function(e,t){var r=e.children,n=e.className,i=e.autoHideDuration,a=e.disableWindowBlurListener,o=void 0!==a&&a,s=e.onClose,l=e.id,c=e.open,u=e.SnackbarProps,h=void 0===u?{}:u,p=(0,d.useRef)(),m=ek(function(){s&&s.apply(void 0,arguments)}),g=ek(function(e){s&&null!=e&&(p.current&&clearTimeout(p.current),p.current=setTimeout(function(){m(null,"timeout",l)},e))});(0,d.useEffect)(function(){return c&&g(i),function(){p.current&&clearTimeout(p.current)}},[c,i,g]);var y=function(){p.current&&clearTimeout(p.current)},v=(0,d.useCallback)(function(){null!=i&&g(.5*i)},[i,g]),b=function(e){h.onMouseEnter&&h.onMouseEnter(e),y()},_=function(e){h.onMouseLeave&&h.onMouseLeave(e),v()};return(0,d.useEffect)(function(){if(!o&&c)return window.addEventListener("focus",v),window.addEventListener("blur",y),function(){window.removeEventListener("focus",v),window.removeEventListener("blur",y)}},[o,v,c]),(0,d.createElement)("div",Object.assign({ref:t},h,{className:f(eg,n),onMouseEnter:b,onMouseLeave:_}),r)});eP.displayName="Snackbar";var eO=ef({root:((n={display:"flex",flexWrap:"wrap",flexGrow:1})[L]={flexGrow:"initial",minWidth:"288px"},n)}),eN=(0,d.forwardRef)(function(e,t){var r=e.className,n=R(e,["className"]);return d.createElement("div",Object.assign({ref:t,className:f(eO.root,r)},n))});eN.displayName="SnackbarContent";var eL=ef({root:{backgroundColor:"#313131",fontSize:"0.875rem",lineHeight:1.43,letterSpacing:"0.01071em",color:"#fff",alignItems:"center",padding:"6px 16px",borderRadius:"4px",boxShadow:"0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12)"},lessPadding:{paddingLeft:"20px"},default:{backgroundColor:"#313131"},success:{backgroundColor:"#43a047"},error:{backgroundColor:"#d32f2f"},warning:{backgroundColor:"#ff9800"},info:{backgroundColor:"#2196f3"},message:{display:"flex",alignItems:"center",padding:"8px 0"},action:{display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:"16px",marginRight:"-8px"}}),eD="notistack-snackbar",eU=(0,d.forwardRef)(function(e,t){var r=e.id,n=e.message,i=e.action,a=e.iconVariant,o=e.variant,s=e.hideIconVariant,l=e.style,c=e.className,u=a[o],h=i;return"function"==typeof h&&(h=h(r)),d.createElement(eN,{ref:t,role:"alert","aria-describedby":eD,style:l,className:f(ev,eb(o),eL.root,eL[o],c,!s&&u&&eL.lessPadding)},d.createElement("div",{id:eD,className:eL.message},s?null:u,n),h&&d.createElement("div",{className:eL.action},h))});eU.displayName="MaterialDesignContent";var eF=(0,d.memo)(eU),eB=ef({wrappedRoot:{width:"100%",position:"relative",transform:"translateX(0)",top:0,right:0,bottom:0,left:0,minWidth:"288px"}}),ez=function(e){var t=(0,d.useRef)(),r=(0,d.useState)(!0),n=r[0],i=r[1],a=eI([e.snack.onClose,e.onClose]),o=function(){e.snack.requestClose&&a(null,"instructed",e.snack.id)},s=(0,d.useCallback)(function(){t.current=setTimeout(function(){i(function(e){return!e})},125)},[]);(0,d.useEffect)(function(){return function(){t.current&&clearTimeout(t.current)}},[]);var l=e.snack,c=e.classes,u=e.Component,h=void 0===u?eF:u,p=(0,d.useMemo)(function(){return eA(c)},[c]),m=l.open,g=l.SnackbarProps,y=l.TransitionComponent,v=l.TransitionProps,b=l.transitionDuration,_=l.disableWindowBlurListener,w=l.content,S=R(l,["open","SnackbarProps","TransitionComponent","TransitionProps","transitionDuration","disableWindowBlurListener","content","entered","requestClose","onEnter","onEntered","onExit","onExited"]),T=M({direction:eE(S.anchorOrigin),timeout:b},v),x=w;"function"==typeof x&&(x=x(S.id,S.message));var E=["onEnter","onEntered","onExit","onExited"].reduce(function(t,r){var n;return M({},t,((n={})[r]=eI([e.snack[r],e[r]],S.id),n))},{});return d.createElement(eT,{in:n,onExited:E.onExited},d.createElement(eP,{open:m,id:S.id,disableWindowBlurListener:_,autoHideDuration:S.autoHideDuration,className:f(eB.wrappedRoot,p.root,p[eC(S.anchorOrigin)]),SnackbarProps:g,onClose:a},d.createElement(y,Object.assign({},T,{appear:!0,in:m,onExit:E.onExit,onExited:s,onEnter:E.onEnter,onEntered:eI([E.onEntered,o],S.id)}),x||d.createElement(h,Object.assign({},S)))))},eH=20,ej=6,eG=2,eV="."+ey,eq=16,eW=ef({root:((i={boxSizing:"border-box",display:"flex",maxHeight:"100%",position:"fixed",zIndex:1400,height:"auto",width:"auto",transition:Q(["top","right","bottom","left","max-width"],{duration:300,easing:"ease"}),pointerEvents:"none"})[eV]={padding:ej+"px 0px",transition:"padding 300ms ease 0ms"},i.maxWidth="calc(100% - "+2*eH+"px)",i[N]={width:"100%",maxWidth:"calc(100% - "+2*eq+"px)"},i),rootDense:((a={})[eV]={padding:eG+"px 0px"},a),top:{top:eH-ej+"px",flexDirection:"column"},bottom:{bottom:eH-ej+"px",flexDirection:"column-reverse"},left:((o={left:eH+"px"})[L]={alignItems:"flex-start"},o[N]={left:eq+"px"},o),right:((s={right:eH+"px"})[L]={alignItems:"flex-end"},s[N]={right:eq+"px"},s),center:((l={left:"50%",transform:"translateX(-50%)"})[L]={alignItems:"center"},l)}),eZ=function(e){var t=e.classes,r=void 0===t?{}:t,n=e.anchorOrigin,i=e.dense,a=e.children,o=f(em,eW[n.vertical],eW[n.horizontal],eW.root,r.containerRoot,r["containerAnchorOrigin"+U(n)],i&&eW.rootDense);return d.createElement("div",{className:o},a)},eX=(0,d.memo)(eZ),e$=function(e){return!("string"==typeof e||(0,d.isValidElement)(e))},eK=function(e){function t(t){var r;return(r=e.call(this,t)||this).enqueueSnackbar=function(e,t){if(void 0===t&&(t={}),null==e)throw Error("enqueueSnackbar called with invalid argument");var n=e$(e)?e:t,i=e$(e)?e.message:e,a=n.key,o=n.preventDuplicate,s=R(n,["key","preventDuplicate"]),l=F(a),c=l?a:new Date().getTime()+Math.random(),u=ep(s,r.props),d=M({id:c},s,{message:i,open:!0,entered:!1,requestClose:!1,persist:u("persist"),action:u("action"),content:u("content"),variant:u("variant"),anchorOrigin:u("anchorOrigin"),disableWindowBlurListener:u("disableWindowBlurListener"),autoHideDuration:u("autoHideDuration"),hideIconVariant:u("hideIconVariant"),TransitionComponent:u("TransitionComponent"),transitionDuration:u("transitionDuration"),TransitionProps:u("TransitionProps",!0),iconVariant:u("iconVariant",!0),style:u("style",!0),SnackbarProps:u("SnackbarProps",!0),className:f(r.props.className,s.className)});return d.persist&&(d.autoHideDuration=void 0),r.setState(function(e){if(void 0===o&&r.props.preventDuplicate||o){var t=function(e){return l?e.id===c:e.message===i},n=e.queue.findIndex(t)>-1,a=e.snacks.findIndex(t)>-1;if(n||a)return e}return r.handleDisplaySnack(M({},e,{queue:[].concat(e.queue,[d])}))}),c},r.handleDisplaySnack=function(e){return e.snacks.length>=r.maxSnack?r.handleDismissOldest(e):r.processQueue(e)},r.processQueue=function(e){var t=e.queue,r=e.snacks;return t.length>0?M({},e,{snacks:[].concat(r,[t[0]]),queue:t.slice(1,t.length)}):e},r.handleDismissOldest=function(e){if(e.snacks.some(function(e){return!e.open||e.requestClose}))return e;var t=!1,n=!1;e.snacks.reduce(function(e,t){return e+(t.open&&t.persist?1:0)},0)===r.maxSnack&&(n=!0);var i=e.snacks.map(function(e){return t||e.persist&&!n?M({},e):(t=!0,e.entered)?(e.onClose&&e.onClose(null,"maxsnack",e.id),r.props.onClose&&r.props.onClose(null,"maxsnack",e.id),M({},e,{open:!1})):M({},e,{requestClose:!0})});return M({},e,{snacks:i})},r.handleEnteredSnack=function(e,t,n){if(!F(n))throw Error("handleEnteredSnack Cannot be called with undefined key");r.setState(function(e){return{snacks:e.snacks.map(function(e){return e.id===n?M({},e,{entered:!0}):M({},e)})}})},r.handleCloseSnack=function(e,t,n){r.props.onClose&&r.props.onClose(e,t,n);var i=void 0===n;r.setState(function(e){var t=e.snacks,r=e.queue;return{snacks:t.map(function(e){return i||e.id===n?e.entered?M({},e,{open:!1}):M({},e,{requestClose:!0}):M({},e)}),queue:r.filter(function(e){return e.id!==n})}})},r.closeSnackbar=function(e){var t=r.state.snacks.find(function(t){return t.id===e});F(e)&&t&&t.onClose&&t.onClose(null,"instructed",e),r.handleCloseSnack(null,"instructed",e)},r.handleExitedSnack=function(e,t){if(!F(t))throw Error("handleExitedSnack Cannot be called with undefined key");r.setState(function(e){var n=r.processQueue(M({},e,{snacks:e.snacks.filter(function(e){return e.id!==t})}));return 0===n.queue.length?n:r.handleDismissOldest(n)})},c=r.enqueueSnackbar,u=r.closeSnackbar,r.state={snacks:[],queue:[],contextValue:{enqueueSnackbar:r.enqueueSnackbar.bind(k(r)),closeSnackbar:r.closeSnackbar.bind(k(r))}},r}return I(t,e),t.prototype.render=function(){var e=this,t=this.state.contextValue,r=this.props,n=r.domRoot,i=r.children,a=r.dense,o=void 0!==a&&a,s=r.Components,l=void 0===s?{}:s,c=r.classes,u=this.state.snacks.reduce(function(e,t){var r,n=U(t.anchorOrigin),i=e[n]||[];return M({},e,((r={})[n]=[].concat(i,[t]),r))},{}),p=Object.keys(u).map(function(t){var r=u[t],n=r[0];return d.createElement(eX,{key:t,dense:o,anchorOrigin:n.anchorOrigin,classes:c},r.map(function(t){return d.createElement(ez,{key:t.id,snack:t,classes:c,Component:l[t.variant],onClose:e.handleCloseSnack,onEnter:e.props.onEnter,onExit:e.props.onExit,onExited:eI([e.handleExitedSnack,e.props.onExited],t.id),onEntered:eI([e.handleEnteredSnack,e.props.onEntered],t.id)})}))});return d.createElement(O.Provider,{value:t},i,n?(0,h.createPortal)(p,n):p)},A(t,[{key:"maxSnack",get:function(){return this.props.maxSnack||eu.maxSnack}}]),t}(d.Component)},81970:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=void 0;class r{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise((e,t)=>{this.reject=t,this.resolve=e})}}t.Deferred=r},24838:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EndOfStreamError=t.defaultMessages=void 0,t.defaultMessages="End-Of-Stream";class r extends Error{constructor(){super(t.defaultMessages)}}t.EndOfStreamError=r},27216:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=t.EndOfStreamError=void 0;let n=r(24838),i=r(81970);var a=r(24838);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return a.EndOfStreamError}});let o=1048576;class s{constructor(e){if(this.s=e,this.deferred=null,this.endOfStream=!1,this.peekQueue=[],!e.read||!e.once)throw Error("Expected an instance of stream.Readable");this.s.once("end",()=>this.reject(new n.EndOfStreamError)),this.s.once("error",e=>this.reject(e)),this.s.once("close",()=>this.reject(Error("Stream closed")))}async peek(e,t,r){let n=await this.read(e,t,r);return this.peekQueue.push(e.subarray(t,t+n)),n}async read(e,t,r){if(0===r)return 0;if(0===this.peekQueue.length&&this.endOfStream)throw new n.EndOfStreamError;let i=r,a=0;for(;this.peekQueue.length>0&&i>0;){let r=this.peekQueue.pop();if(!r)throw Error("peekData should be defined");let n=Math.min(r.length,i);e.set(r.subarray(0,n),t+a),a+=n,i-=n,n<r.length&&this.peekQueue.push(r.subarray(n))}for(;i>0&&!this.endOfStream;){let r=Math.min(i,o),n=await this.readFromStream(e,t+a,r);if(a+=n,n<r)break;i-=n}return a}async readFromStream(e,t,r){let n=this.s.read(r);if(n)return e.set(n,t),n.length;{let n={buffer:e,offset:t,length:r,deferred:new i.Deferred};return this.deferred=n.deferred,this.s.once("readable",()=>{this.readDeferred(n)}),n.deferred.promise}}readDeferred(e){let t=this.s.read(e.length);t?(e.buffer.set(t,e.offset),e.deferred.resolve(t.length),this.deferred=null):this.s.once("readable",()=>{this.readDeferred(e)})}reject(e){this.endOfStream=!0,this.deferred&&(this.deferred.reject(e),this.deferred=null)}}t.StreamReader=s},93763:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StreamReader=t.EndOfStreamError=void 0;var n=r(24838);Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return n.EndOfStreamError}});var i=r(27216);Object.defineProperty(t,"StreamReader",{enumerable:!0,get:function(){return i.StreamReader}})},59679:function(e,t){"use strict";var r,n=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.suspense_list"),p=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.for("react.view_transition");function g(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case a:case s:case o:case d:case h:case m:return e;default:switch(e=e&&e.$$typeof){case c:case u:case f:case p:case l:return e;default:return t}}case i:return t}}}Symbol.for("react.client.reference"),r=l,r=c,r=n,t.A4=u,r=a,r=f,t._Y=p,r=i,r=s,r=o,r=d,r=h,r=function(e){return g(e)===l},r=function(e){return g(e)===c},r=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},r=function(e){return g(e)===u},r=function(e){return g(e)===a},r=function(e){return g(e)===f},r=function(e){return g(e)===p},r=function(e){return g(e)===i},r=function(e){return g(e)===s},r=function(e){return g(e)===o},r=function(e){return g(e)===d},r=function(e){return g(e)===h}},16093:function(e,t){"use strict";t.ConcurrentRoot=1,t.ContinuousEventPriority=4,t.DefaultEventPriority=16,t.DiscreteEventPriority=1},81907:function(e,t,r){e.exports=function(e){var t,n,i,a,o,s={};"use strict";var l=r(2265),c=r(16697),u=Object.assign;function d(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var h=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,p=Symbol.for("react.element"),f=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),b=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),x=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var E=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var C=Symbol.iterator;function A(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=C&&e[C]||e["@@iterator"])?e:null}function M(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case m:return"Fragment";case f:return"Portal";case y:return"Profiler";case g:return"StrictMode";case w:return"Suspense";case S:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case b:return(e.displayName||"Context")+".Consumer";case v:return(e._context.displayName||"Context")+".Provider";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:M(e.type)||"Memo";case x:t=e._payload,e=e._init;try{return M(e(t))}catch(e){}}return null}function I(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return M(t);case 8:return t===g?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function R(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do 0!=(4098&(t=e).flags)&&(r=t.return),e=t.return;while(e)}return 3===t.tag?r:null}function k(e){if(R(e)!==e)throw Error(d(188))}function P(e){var t=e.alternate;if(!t){if(null===(t=R(e)))throw Error(d(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(n=i.return)){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return k(i),e;if(a===n)return k(i),t;a=a.sibling}throw Error(d(188))}if(r.return!==n.return)r=i,n=a;else{for(var o=!1,s=i.child;s;){if(s===r){o=!0,r=i,n=a;break}if(s===n){o=!0,n=i,r=a;break}s=s.sibling}if(!o){for(s=a.child;s;){if(s===r){o=!0,r=a,n=i;break}if(s===n){o=!0,n=a,r=i;break}s=s.sibling}if(!o)throw Error(d(189))}}if(r.alternate!==n)throw Error(d(190))}if(3!==r.tag)throw Error(d(188));return r.stateNode.current===r?e:t}function O(e){return null!==(e=P(e))?N(e):null}function N(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=N(e);if(null!==t)return t;e=e.sibling}return null}function L(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){if(4!==e.tag){var t=L(e);if(null!==t)return t}e=e.sibling}return null}var D,U=Array.isArray,F=e.getPublicInstance,B=e.getRootHostContext,z=e.getChildHostContext,H=e.prepareForCommit,j=e.resetAfterCommit,G=e.createInstance,V=e.appendInitialChild,q=e.finalizeInitialChildren,W=e.prepareUpdate,Z=e.shouldSetTextContent,X=e.createTextInstance,$=e.scheduleTimeout,K=e.cancelTimeout,Y=e.noTimeout,Q=e.isPrimaryRenderer,J=e.supportsMutation,ee=e.supportsPersistence,et=e.supportsHydration,er=e.getInstanceFromNode,en=e.preparePortalMount,ei=e.getCurrentEventPriority,ea=e.detachDeletedInstance,eo=e.supportsMicrotasks,es=e.scheduleMicrotask,el=e.supportsTestSelectors,ec=e.findFiberRoot,eu=e.getBoundingRect,ed=e.getTextContent,eh=e.isHiddenSubtree,ep=e.matchAccessibilityRole,ef=e.setFocusIfFocusable,em=e.setupIntersectionObserver,eg=e.appendChild,ey=e.appendChildToContainer,ev=e.commitTextUpdate,eb=e.commitMount,e_=e.commitUpdate,ew=e.insertBefore,eS=e.insertInContainerBefore,eT=e.removeChild,ex=e.removeChildFromContainer,eE=e.resetTextContent,eC=e.hideInstance,eA=e.hideTextInstance,eM=e.unhideInstance,eI=e.unhideTextInstance,eR=e.clearContainer,ek=e.cloneInstance,eP=e.createContainerChildSet,eO=e.appendChildToContainerChildSet,eN=e.finalizeContainerChildren,eL=e.replaceContainerChildren,eD=e.cloneHiddenInstance,eU=e.cloneHiddenTextInstance,eF=e.canHydrateInstance,eB=e.canHydrateTextInstance,ez=e.canHydrateSuspenseInstance,eH=e.isSuspenseInstancePending,ej=e.isSuspenseInstanceFallback,eG=e.registerSuspenseInstanceRetry,eV=e.getNextHydratableSibling,eq=e.getFirstHydratableChild,eW=e.getFirstHydratableChildWithinContainer,eZ=e.getFirstHydratableChildWithinSuspenseInstance,eX=e.hydrateInstance,e$=e.hydrateTextInstance,eK=e.hydrateSuspenseInstance,eY=e.getNextHydratableInstanceAfterSuspenseInstance,eQ=e.commitHydratedContainer,eJ=e.commitHydratedSuspenseInstance,e0=e.clearSuspenseBoundary,e1=e.clearSuspenseBoundaryFromContainer,e2=e.shouldDeleteUnhydratedTailInstances,e3=e.didNotMatchHydratedContainerTextInstance,e4=e.didNotMatchHydratedTextInstance;function e5(e){if(void 0===D)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var e6=!1;function e8(e,t){if(!e||e6)return"";e6=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t){if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var n=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){n=e}e.call(t.prototype)}}else{try{throw Error()}catch(e){n=e}e()}}catch(t){if(t&&n&&"string"==typeof t.stack){for(var i=t.stack.split("\n"),a=n.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do if(o--,0>--s||i[o]!==a[s]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=s);break}}}finally{e6=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?e5(e):""}var e7=Object.prototype.hasOwnProperty,e9=[],te=-1;function tt(e){return{current:e}}function tr(e){0>te||(e.current=e9[te],e9[te]=null,te--)}function tn(e,t){e9[++te]=e.current,e.current=t}var ti={},ta=tt(ti),to=tt(!1),ts=ti;function tl(e,t){var r=e.type.contextTypes;if(!r)return ti;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in r)a[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function tc(e){return null!=(e=e.childContextTypes)}function tu(){tr(to),tr(ta)}function td(e,t,r){if(ta.current!==ti)throw Error(d(168));tn(ta,t),tn(to,r)}function th(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!=typeof n.getChildContext)return r;for(var i in n=n.getChildContext())if(!(i in t))throw Error(d(108,I(e)||"Unknown",i));return u({},r,n)}function tp(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ti,ts=ta.current,tn(ta,e),tn(to,to.current),!0}function tf(e,t,r){var n=e.stateNode;if(!n)throw Error(d(169));r?(e=th(e,t,ts),n.__reactInternalMemoizedMergedChildContext=e,tr(to),tr(ta),tn(ta,e)):tr(to),tn(to,r)}var tm=Math.clz32?Math.clz32:tv,tg=Math.log,ty=Math.LN2;function tv(e){return 0==(e>>>=0)?32:31-(tg(e)/ty|0)|0}var tb=64,t_=4194304;function tw(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function tS(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,o=268435455&r;if(0!==o){var s=o&~i;0!==s?n=tw(s):0!=(a&=o)&&(n=tw(a))}else 0!=(o=r&~i)?n=tw(o):0!==a&&(n=tw(a));if(0===n)return 0;if(0!==t&&t!==n&&0==(t&i)&&((i=n&-n)>=(a=t&-t)||16===i&&0!=(4194240&a)))return t;if(0!=(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)i=1<<(r=31-tm(t)),n|=e[r],t&=~i;return n}function tT(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return -1}}function tx(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-tm(a),s=1<<o,l=i[o];-1===l?(0==(s&r)||0!=(s&n))&&(i[o]=tT(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}function tE(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function tC(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function tA(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-tm(t)]=r}function tM(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-tm(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function tI(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-tm(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var tR=0;function tk(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var tP=c.unstable_scheduleCallback,tO=c.unstable_cancelCallback,tN=c.unstable_shouldYield,tL=c.unstable_requestPaint,tD=c.unstable_now,tU=c.unstable_ImmediatePriority,tF=c.unstable_UserBlockingPriority,tB=c.unstable_NormalPriority,tz=c.unstable_IdlePriority,tH=null,tj=null;function tG(e){if(tj&&"function"==typeof tj.onCommitFiberRoot)try{tj.onCommitFiberRoot(tH,e,void 0,128==(128&e.current.flags))}catch(e){}}function tV(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t}var tq="function"==typeof Object.is?Object.is:tV,tW=null,tZ=!1,tX=!1;function t$(e){null===tW?tW=[e]:tW.push(e)}function tK(e){tZ=!0,t$(e)}function tY(){if(!tX&&null!==tW){tX=!0;var e=0,t=tR;try{var r=tW;for(tR=1;e<r.length;e++){var n=r[e];do n=n(!0);while(null!==n)}tW=null,tZ=!1}catch(t){throw null!==tW&&(tW=tW.slice(e+1)),tP(tU,tY),t}finally{tR=t,tX=!1}}return null}var tQ=h.ReactCurrentBatchConfig;function tJ(e,t){if(tq(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!e7.call(t,i)||!tq(e[i],t[i]))return!1}return!0}function t0(e){switch(e.tag){case 5:return e5(e.type);case 16:return e5("Lazy");case 13:return e5("Suspense");case 19:return e5("SuspenseList");case 0:case 2:case 15:return e=e8(e.type,!1);case 11:return e=e8(e.type.render,!1);case 1:return e=e8(e.type,!0);default:return""}}function t1(e,t){if(e&&e.defaultProps)for(var r in t=u({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}var t2=tt(null),t3=null,t4=null,t5=null;function t6(){t5=t4=t3=null}function t8(e,t,r){Q?(tn(t2,t._currentValue),t._currentValue=r):(tn(t2,t._currentValue2),t._currentValue2=r)}function t7(e){var t=t2.current;tr(t2),Q?e._currentValue=t:e._currentValue2=t}function t9(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function re(e,t){t3=e,t5=t4=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(ir=!0),e.firstContext=null)}function rt(e){var t=Q?e._currentValue:e._currentValue2;if(t5!==e){if(e={context:e,memoizedValue:t,next:null},null===t4){if(null===t3)throw Error(d(308));t4=e,t3.dependencies={lanes:0,firstContext:e}}else t4=t4.next=e}return t}var rr=null,rn=!1;function ri(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ra(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ro(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function rs(e,t){var r=e.updateQueue;null!==r&&(r=r.shared,null!==ac&&0!=(1&e.mode)&&0==(2&al)?(null===(e=r.interleaved)?(t.next=t,null===rr?rr=[r]:rr.push(r)):(t.next=e.next,e.next=t),r.interleaved=t):(null===(e=r.pending)?t.next=t:(t.next=e.next,e.next=t),r.pending=t))}function rl(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&r))){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,tI(e,r)}}function rc(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,a=null;if(null!==(r=r.firstBaseUpdate)){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===a?i=a=o:a=a.next=o,r=r.next}while(null!==r);null===a?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function ru(e,t,r,n){var i=e.updateQueue;rn=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,c=l.next;l.next=null,null===o?a=c:o.next=c,o=l;var d=e.alternate;null!==d&&(s=(d=d.updateQueue).lastBaseUpdate)!==o&&(null===s?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l)}if(null!==a){var h=i.baseState;for(o=0,d=c=l=null,s=a;;){var p=s.lane,f=s.eventTime;if((n&p)===p){null!==d&&(d=d.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});a:{var m=e,g=s;switch(p=t,f=r,g.tag){case 1:if("function"==typeof(m=g.payload)){h=m.call(f,h,p);break a}h=m;break a;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(p="function"==typeof(m=g.payload)?m.call(f,h,p):m))break a;h=u({},h,p);break a;case 2:rn=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=i.effects)?i.effects=[s]:p.push(s))}else f={eventTime:f,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===d?(c=d=f,l=h):d=d.next=f,o|=p;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(p=s).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}if(null===d&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,null!==(t=i.shared.interleaved)){i=t;do o|=i.lane,i=i.next;while(i!==t)}else null===a&&(i.shared.lanes=0);ag|=o,e.lanes=o,e.memoizedState=h}}function rd(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(null!==i){if(n.callback=null,n=r,"function"!=typeof i)throw Error(d(191,i));i.call(n)}}}var rh=(new l.Component).refs;function rp(e,t,r,n){r=null==(r=r(n,t=e.memoizedState))?t:u({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var rf={isMounted:function(e){return!!(e=e._reactInternals)&&R(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=aN(),i=aL(e),a=ro(n,i);a.payload=t,null!=r&&(a.callback=r),rs(e,a),null!==(t=aD(e,i,n))&&rl(t,e,i)},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=aN(),i=aL(e),a=ro(n,i);a.tag=1,a.payload=t,null!=r&&(a.callback=r),rs(e,a),null!==(t=aD(e,i,n))&&rl(t,e,i)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=aN(),n=aL(e),i=ro(r,n);i.tag=2,null!=t&&(i.callback=t),rs(e,i),null!==(t=aD(e,n,r))&&rl(t,e,n)}};function rm(e,t,r,n,i,a,o){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,a,o):!t.prototype||!t.prototype.isPureReactComponent||!tJ(r,n)||!tJ(i,a)}function rg(e,t,r){var n=!1,i=ti,a=t.contextType;return"object"==typeof a&&null!==a?a=rt(a):(i=tc(t)?ts:ta.current,a=(n=null!=(n=t.contextTypes))?tl(e,i):ti),t=new t(r,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=rf,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function ry(e,t,r,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&rf.enqueueReplaceState(t,t.state,null)}function rv(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=rh,ri(e);var a=t.contextType;"object"==typeof a&&null!==a?i.context=rt(a):(a=tc(t)?ts:ta.current,i.context=tl(e,a)),i.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(rp(e,t,a,r),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&rf.enqueueReplaceState(i,i.state,null),ru(e,r,i,n),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4194308)}var rb=[],r_=0,rw=null,rS=0,rT=[],rx=0,rE=null,rC=1,rA="";function rM(e,t){rb[r_++]=rS,rb[r_++]=rw,rw=e,rS=t}function rI(e,t,r){rT[rx++]=rC,rT[rx++]=rA,rT[rx++]=rE,rE=e;var n=rC;e=rA;var i=32-tm(n)-1;n&=~(1<<i),r+=1;var a=32-tm(t)+i;if(30<a){var o=i-i%5;a=(n&(1<<o)-1).toString(32),n>>=o,i-=o,rC=1<<32-tm(t)+i|r<<i|n,rA=a+e}else rC=1<<a|r<<i|n,rA=e}function rR(e){null!==e.return&&(rM(e,1),rI(e,1,0))}function rk(e){for(;e===rw;)rw=rb[--r_],rb[r_]=null,rS=rb[--r_],rb[r_]=null;for(;e===rE;)rE=rT[--rx],rT[rx]=null,rA=rT[--rx],rT[rx]=null,rC=rT[--rx],rT[rx]=null}var rP=null,rO=null,rN=!1,rL=!1,rD=null;function rU(e,t){var r=on(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function rF(e,t){switch(e.tag){case 5:return null!==(t=eF(t,e.type,e.pendingProps))&&(e.stateNode=t,rP=e,rO=eq(t),!0);case 6:return null!==(t=eB(t,e.pendingProps))&&(e.stateNode=t,rP=e,rO=null,!0);case 13:if(null!==(t=ez(t))){var r=null!==rE?{id:rC,overflow:rA}:null;return e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=on(18,null,null,0)).stateNode=t,r.return=e,e.child=r,rP=e,rO=null,!0}return!1;default:return!1}}function rB(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function rz(e){if(rN){var t=rO;if(t){var r=t;if(!rF(e,t)){if(rB(e))throw Error(d(418));t=eV(r);var n=rP;t&&rF(e,t)?rU(n,r):(e.flags=-4097&e.flags|2,rN=!1,rP=e)}}else{if(rB(e))throw Error(d(418));e.flags=-4097&e.flags|2,rN=!1,rP=e}}}function rH(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;rP=e}function rj(e){if(!et||e!==rP)return!1;if(!rN)return rH(e),rN=!0,!1;if(3!==e.tag&&(5!==e.tag||e2(e.type)&&!Z(e.type,e.memoizedProps))){var t=rO;if(t){if(rB(e)){for(e=rO;e;)e=eV(e);throw Error(d(418))}for(;t;)rU(e,t),t=eV(t)}}if(rH(e),13===e.tag){if(!et)throw Error(d(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(d(317));rO=eY(e)}else rO=rP?eV(e.stateNode):null;return!0}function rG(){et&&(rO=rP=null,rL=rN=!1)}function rV(e){null===rD?rD=[e]:rD.push(e)}function rq(e,t,r){if(null!==(e=r.ref)&&"function"!=typeof e&&"object"!=typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(d(309));var n=r.stateNode}if(!n)throw Error(d(147,e));var i=n,a=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===a?t.ref:((t=function(e){var t=i.refs;t===rh&&(t=i.refs={}),null===e?delete t[a]:t[a]=e})._stringRef=a,t)}if("string"!=typeof e)throw Error(d(284));if(!r._owner)throw Error(d(290,e))}return e}function rW(e,t){throw Error(d(31,"[object Object]"===(e=Object.prototype.toString.call(t))?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rZ(e){return(0,e._init)(e._payload)}function rX(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=oo(e,t)).index=0,e.sibling=null,e}function a(t,r,n){return(t.index=n,e)?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function s(e,t,r,n){return null===t||6!==t.tag?(t=ou(r,e.mode,n)).return=e:(t=i(t,r)).return=e,t}function l(e,t,r,n){var a=r.type;return a===m?u(e,t,r.props.children,n,r.key):(null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===x&&rZ(a)===t.type)?(n=i(t,r.props)).ref=rq(e,t,r):(n=os(r.type,r.key,r.props,null,e.mode,n)).ref=rq(e,t,r),n.return=e,n)}function c(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?(t=od(r,e.mode,n)).return=e:(t=i(t,r.children||[])).return=e,t}function u(e,t,r,n,a){return null===t||7!==t.tag?(t=ol(r,e.mode,n,a)).return=e:(t=i(t,r)).return=e,t}function h(e,t,r){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=ou(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case p:return(r=os(t.type,t.key,t.props,null,e.mode,r)).ref=rq(e,null,t),r.return=e,r;case f:return(t=od(t,e.mode,r)).return=e,t;case x:return h(e,(0,t._init)(t._payload),r)}if(U(t)||A(t))return(t=ol(t,e.mode,r,null)).return=e,t;rW(e,t)}return null}function g(e,t,r,n){var i=null!==t?t.key:null;if("string"==typeof r&&""!==r||"number"==typeof r)return null!==i?null:s(e,t,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case p:return r.key===i?l(e,t,r,n):null;case f:return r.key===i?c(e,t,r,n):null;case x:return g(e,t,(i=r._init)(r._payload),n)}if(U(r)||A(r))return null!==i?null:u(e,t,r,n,null);rW(e,r)}return null}function y(e,t,r,n,i){if("string"==typeof n&&""!==n||"number"==typeof n)return s(t,e=e.get(r)||null,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case p:return l(t,e=e.get(null===n.key?r:n.key)||null,n,i);case f:return c(t,e=e.get(null===n.key?r:n.key)||null,n,i);case x:return y(e,t,r,(0,n._init)(n._payload),i)}if(U(n)||A(n))return u(t,e=e.get(r)||null,n,i,null);rW(t,n)}return null}function v(i,o,s,l){for(var c=null,u=null,d=o,p=o=0,f=null;null!==d&&p<s.length;p++){d.index>p?(f=d,d=null):f=d.sibling;var m=g(i,d,s[p],l);if(null===m){null===d&&(d=f);break}e&&d&&null===m.alternate&&t(i,d),o=a(m,o,p),null===u?c=m:u.sibling=m,u=m,d=f}if(p===s.length)return r(i,d),rN&&rM(i,p),c;if(null===d){for(;p<s.length;p++)null!==(d=h(i,s[p],l))&&(o=a(d,o,p),null===u?c=d:u.sibling=d,u=d);return rN&&rM(i,p),c}for(d=n(i,d);p<s.length;p++)null!==(f=y(d,i,p,s[p],l))&&(e&&null!==f.alternate&&d.delete(null===f.key?p:f.key),o=a(f,o,p),null===u?c=f:u.sibling=f,u=f);return e&&d.forEach(function(e){return t(i,e)}),rN&&rM(i,p),c}function b(i,o,s,l){var c=A(s);if("function"!=typeof c)throw Error(d(150));if(null==(s=c.call(s)))throw Error(d(151));for(var u=c=null,p=o,f=o=0,m=null,v=s.next();null!==p&&!v.done;f++,v=s.next()){p.index>f?(m=p,p=null):m=p.sibling;var b=g(i,p,v.value,l);if(null===b){null===p&&(p=m);break}e&&p&&null===b.alternate&&t(i,p),o=a(b,o,f),null===u?c=b:u.sibling=b,u=b,p=m}if(v.done)return r(i,p),rN&&rM(i,f),c;if(null===p){for(;!v.done;f++,v=s.next())null!==(v=h(i,v.value,l))&&(o=a(v,o,f),null===u?c=v:u.sibling=v,u=v);return rN&&rM(i,f),c}for(p=n(i,p);!v.done;f++,v=s.next())null!==(v=y(p,i,f,v.value,l))&&(e&&null!==v.alternate&&p.delete(null===v.key?f:v.key),o=a(v,o,f),null===u?c=v:u.sibling=v,u=v);return e&&p.forEach(function(e){return t(i,e)}),rN&&rM(i,f),c}function _(e,n,a,s){if("object"==typeof a&&null!==a&&a.type===m&&null===a.key&&(a=a.props.children),"object"==typeof a&&null!==a){switch(a.$$typeof){case p:a:{for(var l=a.key,c=n;null!==c;){if(c.key===l){if((l=a.type)===m){if(7===c.tag){r(e,c.sibling),(n=i(c,a.props.children)).return=e,e=n;break a}}else if(c.elementType===l||"object"==typeof l&&null!==l&&l.$$typeof===x&&rZ(l)===c.type){r(e,c.sibling),(n=i(c,a.props)).ref=rq(e,c,a),n.return=e,e=n;break a}r(e,c);break}t(e,c),c=c.sibling}a.type===m?((n=ol(a.props.children,e.mode,s,a.key)).return=e,e=n):((s=os(a.type,a.key,a.props,null,e.mode,s)).ref=rq(e,n,a),s.return=e,e=s)}return o(e);case f:a:{for(c=a.key;null!==n;){if(n.key===c){if(4===n.tag&&n.stateNode.containerInfo===a.containerInfo&&n.stateNode.implementation===a.implementation){r(e,n.sibling),(n=i(n,a.children||[])).return=e,e=n;break a}r(e,n);break}t(e,n),n=n.sibling}(n=od(a,e.mode,s)).return=e,e=n}return o(e);case x:return _(e,n,(c=a._init)(a._payload),s)}if(U(a))return v(e,n,a,s);if(A(a))return b(e,n,a,s);rW(e,a)}return"string"==typeof a&&""!==a||"number"==typeof a?(a=""+a,null!==n&&6===n.tag?(r(e,n.sibling),(n=i(n,a)).return=e):(r(e,n),(n=ou(a,e.mode,s)).return=e),o(e=n)):r(e,n)}return _}var r$=rX(!0),rK=rX(!1),rY={},rQ=tt(rY),rJ=tt(rY),r0=tt(rY);function r1(e){if(e===rY)throw Error(d(174));return e}function r2(e,t){tn(r0,t),tn(rJ,e),tn(rQ,rY),e=B(t),tr(rQ),tn(rQ,e)}function r3(){tr(rQ),tr(rJ),tr(r0)}function r4(e){var t=r1(r0.current),r=r1(rQ.current);t=z(r,e.type,t),r!==t&&(tn(rJ,e),tn(rQ,t))}function r5(e){rJ.current===e&&(tr(rQ),tr(rJ))}var r6=tt(0);function r8(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||eH(r)||ej(r)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var r7=[];function r9(){for(var e=0;e<r7.length;e++){var t=r7[e];Q?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}r7.length=0}var ne=h.ReactCurrentDispatcher,nt=h.ReactCurrentBatchConfig,nr=0,nn=null,ni=null,na=null,no=!1,ns=!1,nl=0,nc=0;function nu(){throw Error(d(321))}function nd(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!tq(e[r],t[r]))return!1;return!0}function nh(e,t,r,n,i,a){if(nr=a,nn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ne.current=null===e||null===e.memoizedState?nX:n$,e=r(n,i),ns){a=0;do{if(ns=!1,nl=0,25<=a)throw Error(d(301));a+=1,na=ni=null,t.updateQueue=null,ne.current=nK,e=r(n,i)}while(ns)}if(ne.current=nZ,t=null!==ni&&null!==ni.next,nr=0,na=ni=nn=null,no=!1,t)throw Error(d(300));return e}function np(){var e=0!==nl;return nl=0,e}function nf(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===na?nn.memoizedState=na=e:na=na.next=e,na}function nm(){if(null===ni){var e=nn.alternate;e=null!==e?e.memoizedState:null}else e=ni.next;var t=null===na?nn.memoizedState:na.next;if(null!==t)na=t,ni=e;else{if(null===e)throw Error(d(310));e={memoizedState:(ni=e).memoizedState,baseState:ni.baseState,baseQueue:ni.baseQueue,queue:ni.queue,next:null},null===na?nn.memoizedState=na=e:na=na.next=e}return na}function ng(e,t){return"function"==typeof t?t(e):t}function ny(e){var t=nm(),r=t.queue;if(null===r)throw Error(d(311));r.lastRenderedReducer=e;var n=ni,i=n.baseQueue,a=r.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}n.baseQueue=i=a,r.pending=null}if(null!==i){a=i.next,n=n.baseState;var s=o=null,l=null,c=a;do{var u=c.lane;if((nr&u)===u)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(s=l=h,o=n):l=l.next=h,nn.lanes|=u,ag|=u}c=c.next}while(null!==c&&c!==a);null===l?o=n:l.next=s,tq(n,t.memoizedState)||(ir=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,r.lastRenderedState=n}if(null!==(e=r.interleaved)){i=e;do a=i.lane,nn.lanes|=a,ag|=a,i=i.next;while(i!==e)}else null===i&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function nv(e){var t=nm(),r=t.queue;if(null===r)throw Error(d(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(null!==i){r.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);tq(a,t.memoizedState)||(ir=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function nb(){}function n_(e,t){var r=nn,n=nm(),i=t(),a=!tq(n.memoizedState,i);if(a&&(n.memoizedState=i,ir=!0),n=n.queue,nk(nT.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||null!==na&&1&na.memoizedState.tag){if(r.flags|=2048,nC(9,nS.bind(null,r,n,i,t),void 0,null),null===ac)throw Error(d(349));0!=(30&nr)||nw(r,t,i)}return i}function nw(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=nn.updateQueue)?(t={lastEffect:null,stores:null},nn.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function nS(e,t,r,n){t.value=r,t.getSnapshot=n,nx(t)&&aD(e,1,-1)}function nT(e,t,r){return r(function(){nx(t)&&aD(e,1,-1)})}function nx(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!tq(e,r)}catch(e){return!0}}function nE(e){var t=nf();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ng,lastRenderedState:e},t.queue=e,e=e.dispatch=nj.bind(null,nn,e),[t.memoizedState,e]}function nC(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=nn.updateQueue)?(t={lastEffect:null,stores:null},nn.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function nA(){return nm().memoizedState}function nM(e,t,r,n){var i=nf();nn.flags|=e,i.memoizedState=nC(1|t,r,void 0,void 0===n?null:n)}function nI(e,t,r,n){var i=nm();n=void 0===n?null:n;var a=void 0;if(null!==ni){var o=ni.memoizedState;if(a=o.destroy,null!==n&&nd(n,o.deps)){i.memoizedState=nC(t,r,a,n);return}}nn.flags|=e,i.memoizedState=nC(1|t,r,a,n)}function nR(e,t){return nM(8390656,8,e,t)}function nk(e,t){return nI(2048,8,e,t)}function nP(e,t){return nI(4,2,e,t)}function nO(e,t){return nI(4,4,e,t)}function nN(e,t){return"function"==typeof t?(t(e=e()),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function nL(e,t,r){return r=null!=r?r.concat([e]):null,nI(4,4,nN.bind(null,t,e),r)}function nD(){}function nU(e,t){var r=nm();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&nd(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function nF(e,t){var r=nm();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&nd(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function nB(e,t){var r=tR;tR=0!==r&&4>r?r:4,e(!0);var n=nt.transition;nt.transition={};try{e(!1),t()}finally{tR=r,nt.transition=n}}function nz(){return nm().memoizedState}function nH(e,t,r){var n=aL(e);r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},nG(e)?nV(t,r):(nq(e,t,r),null!==(e=aD(e,n,r=aN()))&&nW(e,t,n))}function nj(e,t,r){var n=aL(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(nG(e))nV(t,i);else{nq(e,t,i);var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,r);if(i.hasEagerState=!0,i.eagerState=s,tq(s,o))return}catch(e){}finally{}null!==(e=aD(e,n,r=aN()))&&nW(e,t,n)}}function nG(e){var t=e.alternate;return e===nn||null!==t&&t===nn}function nV(e,t){ns=no=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function nq(e,t,r){null!==ac&&0!=(1&e.mode)&&0==(2&al)?(null===(e=t.interleaved)?(r.next=r,null===rr?rr=[t]:rr.push(t)):(r.next=e.next,e.next=r),t.interleaved=r):(null===(e=t.pending)?r.next=r:(r.next=e.next,e.next=r),t.pending=r)}function nW(e,t,r){if(0!=(4194240&r)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,tI(e,r)}}var nZ={readContext:rt,useCallback:nu,useContext:nu,useEffect:nu,useImperativeHandle:nu,useInsertionEffect:nu,useLayoutEffect:nu,useMemo:nu,useReducer:nu,useRef:nu,useState:nu,useDebugValue:nu,useDeferredValue:nu,useTransition:nu,useMutableSource:nu,useSyncExternalStore:nu,useId:nu,unstable_isNewReconciler:!1},nX={readContext:rt,useCallback:function(e,t){return nf().memoizedState=[e,void 0===t?null:t],e},useContext:rt,useEffect:nR,useImperativeHandle:function(e,t,r){return r=null!=r?r.concat([e]):null,nM(4194308,4,nN.bind(null,t,e),r)},useLayoutEffect:function(e,t){return nM(4194308,4,e,t)},useInsertionEffect:function(e,t){return nM(4,2,e,t)},useMemo:function(e,t){var r=nf();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=nf();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=nH.bind(null,nn,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},nf().memoizedState=e},useState:nE,useDebugValue:nD,useDeferredValue:function(e){var t=nE(e),r=t[0],n=t[1];return nR(function(){var t=nt.transition;nt.transition={};try{n(e)}finally{nt.transition=t}},[e]),r},useTransition:function(){var e=nE(!1),t=e[0];return e=nB.bind(null,e[1]),nf().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=nn,i=nf();if(rN){if(void 0===r)throw Error(d(407));r=r()}else{if(r=t(),null===ac)throw Error(d(349));0!=(30&nr)||nw(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,nR(nT.bind(null,n,a,e),[e]),n.flags|=2048,nC(9,nS.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=nf(),t=ac.identifierPrefix;if(rN){var r=rA,n=rC;t=":"+t+"R"+(r=(n&~(1<<32-tm(n)-1)).toString(32)+r),0<(r=nl++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=nc++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},n$={readContext:rt,useCallback:nU,useContext:rt,useEffect:nk,useImperativeHandle:nL,useInsertionEffect:nP,useLayoutEffect:nO,useMemo:nF,useReducer:ny,useRef:nA,useState:function(){return ny(ng)},useDebugValue:nD,useDeferredValue:function(e){var t=ny(ng),r=t[0],n=t[1];return nk(function(){var t=nt.transition;nt.transition={};try{n(e)}finally{nt.transition=t}},[e]),r},useTransition:function(){return[ny(ng)[0],nm().memoizedState]},useMutableSource:nb,useSyncExternalStore:n_,useId:nz,unstable_isNewReconciler:!1},nK={readContext:rt,useCallback:nU,useContext:rt,useEffect:nk,useImperativeHandle:nL,useInsertionEffect:nP,useLayoutEffect:nO,useMemo:nF,useReducer:nv,useRef:nA,useState:function(){return nv(ng)},useDebugValue:nD,useDeferredValue:function(e){var t=nv(ng),r=t[0],n=t[1];return nk(function(){var t=nt.transition;nt.transition={};try{n(e)}finally{nt.transition=t}},[e]),r},useTransition:function(){return[nv(ng)[0],nm().memoizedState]},useMutableSource:nb,useSyncExternalStore:n_,useId:nz,unstable_isNewReconciler:!1};function nY(e,t){try{var r="",n=t;do r+=t0(n),n=n.return;while(n);var i=r}catch(e){i="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:i}}function nQ(e,t){try{console.error(t.value)}catch(e){setTimeout(function(){throw e})}}var nJ="function"==typeof WeakMap?WeakMap:Map;function n0(e,t,r){(r=ro(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){ax||(ax=!0,aE=n),nQ(e,t)},r}function n1(e,t,r){(r=ro(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"==typeof n){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){nQ(e,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(r.callback=function(){nQ(e,t),"function"!=typeof n&&(null===aC?aC=new Set([this]):aC.add(this));var r=t.stack;this.componentDidCatch(t.value,{componentStack:null!==r?r:""})}),r}function n2(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new nJ;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=a8.bind(null,e,t,r),t.then(e,e))}function n3(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function n4(e,t,r,n,i){return 0==(1&e.mode)?e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=ro(-1,1)).tag=2,rs(r,t))),r.lanes|=1):(e.flags|=65536,e.lanes=i),e}function n5(e){e.flags|=4}function n6(e,t){if(null!==e&&e.child===t.child)return!0;if(0!=(16&t.flags))return!1;for(e=t.child;null!==e;){if(0!=(12854&e.flags)||0!=(12854&e.subtreeFlags))return!1;e=e.sibling}return!0}if(J)t=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)V(e,r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},n=function(){},i=function(e,t,r,n,i){(e=e.memoizedProps)!==n&&(r=W(t.stateNode,r,e,n,i,r1(rQ.current)),(t.updateQueue=r)&&n5(t))},a=function(e,t,r,n){r!==n&&n5(t)};else if(ee){t=function(e,r,n,i){for(var a=r.child;null!==a;){if(5===a.tag){var o=a.stateNode;n&&i&&(o=eD(o,a.type,a.memoizedProps,a)),V(e,o)}else if(6===a.tag)o=a.stateNode,n&&i&&(o=eU(o,a.memoizedProps,a)),V(e,o);else if(4!==a.tag){if(22===a.tag&&null!==a.memoizedState)null!==(o=a.child)&&(o.return=a),t(e,a,!0,!0);else if(null!==a.child){a.child.return=a,a=a.child;continue}}if(a===r)break;for(;null===a.sibling;){if(null===a.return||a.return===r)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};var n8=function(e,t,r,n){for(var i=t.child;null!==i;){if(5===i.tag){var a=i.stateNode;r&&n&&(a=eD(a,i.type,i.memoizedProps,i)),eO(e,a)}else if(6===i.tag)a=i.stateNode,r&&n&&(a=eU(a,i.memoizedProps,i)),eO(e,a);else if(4!==i.tag){if(22===i.tag&&null!==i.memoizedState)null!==(a=i.child)&&(a.return=i),n8(e,i,!0,!0);else if(null!==i.child){i.child.return=i,i=i.child;continue}}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};n=function(e,t){var r=t.stateNode;if(!n6(e,t)){var n=eP(e=r.containerInfo);n8(n,t,!1,!1),r.pendingChildren=n,n5(t),eN(e,n)}},i=function(e,r,n,i,a){var o=e.stateNode,s=e.memoizedProps;if((e=n6(e,r))&&s===i)r.stateNode=o;else{var l=r.stateNode,c=r1(rQ.current),u=null;s!==i&&(u=W(l,n,s,i,a,c)),e&&null===u?r.stateNode=o:(q(o=ek(o,u,n,s,i,r,e,l),n,i,a,c)&&n5(r),r.stateNode=o,e?n5(r):t(o,r,!1,!1))}},a=function(e,t,r,n){r!==n?(e=r1(r0.current),r=r1(rQ.current),t.stateNode=X(n,e,r,t),n5(t)):t.stateNode=e.stateNode}}else n=function(){},i=function(){},a=function(){};function n7(e,t){if(!rN)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function n9(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=14680064&i.subtreeFlags,n|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function ie(e,r,o){var s=r.pendingProps;switch(rk(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return n9(r),null;case 1:case 17:return tc(r.type)&&tu(),n9(r),null;case 3:return s=r.stateNode,r3(),tr(to),tr(ta),r9(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(null===e||null===e.child)&&(rj(r)?n5(r):null===e||e.memoizedState.isDehydrated&&0==(256&r.flags)||(r.flags|=1024,null!==rD&&(aH(rD),rD=null))),n(e,r),n9(r),null;case 5:r5(r),o=r1(r0.current);var l=r.type;if(null!==e&&null!=r.stateNode)i(e,r,l,s,o),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!s){if(null===r.stateNode)throw Error(d(166));return n9(r),null}if(e=r1(rQ.current),rj(r)){if(!et)throw Error(d(175));e=eX(r.stateNode,r.type,r.memoizedProps,o,e,r,!rL),r.updateQueue=e,null!==e&&n5(r)}else{var c=G(l,s,o,e,r);t(c,r,!1,!1),r.stateNode=c,q(c,l,s,o,e)&&n5(r)}null!==r.ref&&(r.flags|=512,r.flags|=2097152)}return n9(r),null;case 6:if(e&&null!=r.stateNode)a(e,r,e.memoizedProps,s);else{if("string"!=typeof s&&null===r.stateNode)throw Error(d(166));if(e=r1(r0.current),o=r1(rQ.current),rj(r)){if(!et)throw Error(d(176));if((o=e$(e=r.stateNode,s=r.memoizedProps,r,!rL))&&null!==(l=rP))switch(c=0!=(1&l.mode),l.tag){case 3:e3(l.stateNode.containerInfo,e,s,c);break;case 5:e4(l.type,l.memoizedProps,l.stateNode,e,s,c)}o&&n5(r)}else r.stateNode=X(s,e,o,r)}return n9(r),null;case 13:if(tr(r6),s=r.memoizedState,rN&&null!==rO&&0!=(1&r.mode)&&0==(128&r.flags)){for(e=rO;e;)e=eV(e);return rG(),r.flags|=98560,r}if(null!==s&&null!==s.dehydrated){if(s=rj(r),null===e){if(!s)throw Error(d(318));if(!et)throw Error(d(344));if(!(e=null!==(e=r.memoizedState)?e.dehydrated:null))throw Error(d(317));eK(e,r)}else rG(),0==(128&r.flags)&&(r.memoizedState=null),r.flags|=4;return n9(r),null}if(null!==rD&&(aH(rD),rD=null),0!=(128&r.flags))return r.lanes=o,r;return s=null!==s,o=!1,null===e?rj(r):o=null!==e.memoizedState,s&&!o&&(r.child.flags|=8192,0!=(1&r.mode)&&(null===e||0!=(1&r6.current)?0===af&&(af=3):aK())),null!==r.updateQueue&&(r.flags|=4),n9(r),null;case 4:return r3(),n(e,r),null===e&&en(r.stateNode.containerInfo),n9(r),null;case 10:return t7(r.type._context),n9(r),null;case 19:if(tr(r6),null===(l=r.memoizedState))return n9(r),null;if(s=0!=(128&r.flags),null===(c=l.rendering)){if(s)n7(l,!1);else{if(0!==af||null!==e&&0!=(128&e.flags))for(e=r.child;null!==e;){if(null!==(c=r8(e))){for(r.flags|=128,n7(l,!1),null!==(e=c.updateQueue)&&(r.updateQueue=e,r.flags|=4),r.subtreeFlags=0,e=o,s=r.child;null!==s;)o=s,l=e,o.flags&=14680066,null===(c=o.alternate)?(o.childLanes=0,o.lanes=l,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,l=c.dependencies,o.dependencies=null===l?null:{lanes:l.lanes,firstContext:l.firstContext}),s=s.sibling;return tn(r6,1&r6.current|2),r.child}e=e.sibling}null!==l.tail&&tD()>aS&&(r.flags|=128,s=!0,n7(l,!1),r.lanes=4194304)}}else{if(!s){if(null!==(e=r8(c))){if(r.flags|=128,s=!0,null!==(e=e.updateQueue)&&(r.updateQueue=e,r.flags|=4),n7(l,!0),null===l.tail&&"hidden"===l.tailMode&&!c.alternate&&!rN)return n9(r),null}else 2*tD()-l.renderingStartTime>aS&&1073741824!==o&&(r.flags|=128,s=!0,n7(l,!1),r.lanes=4194304)}l.isBackwards?(c.sibling=r.child,r.child=c):(null!==(e=l.last)?e.sibling=c:r.child=c,l.last=c)}if(null!==l.tail)return r=l.tail,l.rendering=r,l.tail=r.sibling,l.renderingStartTime=tD(),r.sibling=null,e=r6.current,tn(r6,s?1&e|2:1&e),r;return n9(r),null;case 22:case 23:return aW(),s=null!==r.memoizedState,null!==e&&null!==e.memoizedState!==s&&(r.flags|=8192),s&&0!=(1&r.mode)?0!=(1073741824&ah)&&(n9(r),J&&6&r.subtreeFlags&&(r.flags|=8192)):n9(r),null;case 24:case 25:return null}throw Error(d(156,r.tag))}var it=h.ReactCurrentOwner,ir=!1;function ii(e,t,r,n){t.child=null===e?rK(t,null,r,n):r$(t,e.child,r,n)}function ia(e,t,r,n,i){r=r.render;var a=t.ref;return(re(t,i),n=nh(e,t,r,n,a,i),r=np(),null===e||ir)?(rN&&r&&rR(t),t.flags|=1,ii(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,iC(e,t,i))}function io(e,t,r,n,i){if(null===e){var a=r.type;return"function"!=typeof a||oi(a)||void 0!==a.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=os(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,is(e,t,a,n,i))}if(a=e.child,0==(e.lanes&i)){var o=a.memoizedProps;if((r=null!==(r=r.compare)?r:tJ)(o,n)&&e.ref===t.ref)return iC(e,t,i)}return t.flags|=1,(e=oo(a,n)).ref=t.ref,e.return=t,t.child=e}function is(e,t,r,n,i){if(null!==e&&tJ(e.memoizedProps,n)&&e.ref===t.ref){if(ir=!1,0==(e.lanes&i))return t.lanes=e.lanes,iC(e,t,i);0!=(131072&e.flags)&&(ir=!0)}return iu(e,t,r,n,i)}function il(e,t,r){var n=t.pendingProps,i=n.children,a=null!==e?e.memoizedState:null;if("hidden"===n.mode){if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null},tn(ap,ah),ah|=r;else{if(0==(1073741824&r))return e=null!==a?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null},t.updateQueue=null,tn(ap,ah),ah|=e,null;t.memoizedState={baseLanes:0,cachePool:null},n=null!==a?a.baseLanes:r,tn(ap,ah),ah|=n}}else null!==a?(n=a.baseLanes|r,t.memoizedState=null):n=r,tn(ap,ah),ah|=n;return ii(e,t,i,r),t.child}function ic(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function iu(e,t,r,n,i){var a=tc(r)?ts:ta.current;return(a=tl(t,a),re(t,i),r=nh(e,t,r,n,a,i),n=np(),null===e||ir)?(rN&&n&&rR(t),t.flags|=1,ii(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,iC(e,t,i))}function id(e,t,r,n,i){if(tc(r)){var a=!0;tp(t)}else a=!1;if(re(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),rg(t,r,n),rv(t,r,n,i),n=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,c=r.contextType;c="object"==typeof c&&null!==c?rt(c):tl(t,c=tc(r)?ts:ta.current);var u=r.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof o.getSnapshotBeforeUpdate;d||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==n||l!==c)&&ry(t,o,n,c),rn=!1;var h=t.memoizedState;o.state=h,ru(t,n,o,i),l=t.memoizedState,s!==n||h!==l||to.current||rn?("function"==typeof u&&(rp(t,r,u,n),l=t.memoizedState),(s=rn||rm(t,r,s,n,h,l,c))?(d||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4194308)):("function"==typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=c,n=s):("function"==typeof o.componentDidMount&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,ra(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:t1(t.type,s),o.props=c,d=t.pendingProps,h=o.context,l="object"==typeof(l=r.contextType)&&null!==l?rt(l):tl(t,l=tc(r)?ts:ta.current);var p=r.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==d||h!==l)&&ry(t,o,n,l),rn=!1,h=t.memoizedState,o.state=h,ru(t,n,o,i);var f=t.memoizedState;s!==d||h!==f||to.current||rn?("function"==typeof p&&(rp(t,r,p,n),f=t.memoizedState),(c=rn||rm(t,r,c,n,h,f,l)||!1)?(u||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(n,f,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(n,f,l)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),o.props=n,o.state=f,o.context=l,n=c):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return ih(e,t,r,n,a,i)}function ih(e,t,r,n,i,a){ic(e,t);var o=0!=(128&t.flags);if(!n&&!o)return i&&tf(t,r,!1),iC(e,t,a);n=t.stateNode,it.current=t;var s=o&&"function"!=typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&o?(t.child=r$(t,e.child,null,a),t.child=r$(t,null,s,a)):ii(e,t,s,a),t.memoizedState=n.state,i&&tf(t,r,!0),t.child}function ip(e){var t=e.stateNode;t.pendingContext?td(e,t.pendingContext,t.pendingContext!==t.context):t.context&&td(e,t.context,!1),r2(e,t.containerInfo)}function im(e,t,r,n,i){return rG(),rV(i),t.flags|=256,ii(e,t,r,n),t.child}var ig={dehydrated:null,treeContext:null,retryLane:0};function iy(e){return{baseLanes:e,cachePool:null}}function iv(e,t,r){var n,i=t.pendingProps,a=r6.current,o=!1,s=0!=(128&t.flags);if((n=s)||(n=(null===e||null!==e.memoizedState)&&0!=(2&a)),n?(o=!0,t.flags&=-129):(null===e||null!==e.memoizedState)&&(a|=1),tn(r6,1&a),null===e)return(rz(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated))?(0==(1&t.mode)?t.lanes=1:ej(e)?t.lanes=8:t.lanes=1073741824,null):(a=i.children,e=i.fallback,o?(i=t.mode,o=t.child,a={mode:"hidden",children:a},0==(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=a):o=oc(a,i,0,null),e=ol(e,i,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=iy(r),t.memoizedState=ig,e):ib(t,a));if(null!==(a=e.memoizedState)&&null!==(n=a.dehydrated)){if(s)return 256&t.flags?(t.flags&=-257,iS(e,t,r,Error(d(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,a=t.mode,i=oc({mode:"visible",children:i.children},a,0,null),o=ol(o,a,r,null),o.flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,0!=(1&t.mode)&&r$(t,e.child,null,r),t.child.memoizedState=iy(r),t.memoizedState=ig,o);if(0==(1&t.mode))t=iS(e,t,r,null);else if(ej(n))t=iS(e,t,r,Error(d(419)));else if(i=0!=(r&e.childLanes),ir||i){if(null!==(i=ac)){switch(r&-r){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(i=0!=(o&(i.suspendedLanes|r))?0:o)&&i!==a.retryLane&&(a.retryLane=i,aD(e,i,-1))}aK(),t=iS(e,t,r,Error(d(421)))}else eH(n)?(t.flags|=128,t.child=e.child,eG(n,t=a9.bind(null,e)),t=null):(r=a.treeContext,et&&(rO=eZ(n),rP=t,rN=!0,rD=null,rL=!1,null!==r&&(rT[rx++]=rC,rT[rx++]=rA,rT[rx++]=rE,rC=r.id,rA=r.overflow,rE=t)),t=ib(t,t.pendingProps.children),t.flags|=4096);return t}return o?(i=iw(e,t,i.children,i.fallback,r),o=t.child,a=e.child.memoizedState,o.memoizedState=null===a?iy(r):{baseLanes:a.baseLanes|r,cachePool:null},o.childLanes=e.childLanes&~r,t.memoizedState=ig,i):(r=i_(e,t,i.children,r),t.memoizedState=null,r)}function ib(e,t){return(t=oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function i_(e,t,r,n){var i=e.child;return e=i.sibling,r=oo(i,{mode:"visible",children:r}),0==(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r}function iw(e,t,r,n,i){var a=t.mode,o=(e=e.child).sibling,s={mode:"hidden",children:r};return 0==(1&a)&&t.child!==e?((r=t.child).childLanes=0,r.pendingProps=s,t.deletions=null):(r=oo(e,s)).subtreeFlags=14680064&e.subtreeFlags,null!==o?n=oo(o,n):(n=ol(n,a,i,null),n.flags|=2),n.return=t,r.return=t,r.sibling=n,t.child=r,n}function iS(e,t,r,n){return null!==n&&rV(n),r$(t,e.child,null,r),e=ib(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function iT(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),t9(e.return,t,r)}function ix(e,t,r,n,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function iE(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(ii(e,t,n.children,r),0!=(2&(n=r6.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))a:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&iT(e,r,t);else if(19===e.tag)iT(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)break a;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(tn(r6,n),0==(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(i=null,r=t.child;null!==r;)null!==(e=r.alternate)&&null===r8(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),ix(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===r8(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}ix(t,!0,r,null,a);break;case"together":ix(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function iC(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),ag|=t.lanes,0==(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(d(153));if(null!==t.child){for(r=oo(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=oo(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function iA(e,t,r){switch(t.tag){case 3:ip(t),rG();break;case 5:r4(t);break;case 1:tc(t.type)&&tp(t);break;case 4:r2(t,t.stateNode.containerInfo);break;case 10:t8(t,t.type._context,t.memoizedProps.value);break;case 13:var n=t.memoizedState;if(null!==n){if(null!==n.dehydrated)return tn(r6,1&r6.current),t.flags|=128,null;if(0!=(r&t.child.childLanes))return iv(e,t,r);return tn(r6,1&r6.current),null!==(e=iC(e,t,r))?e.sibling:null}tn(r6,1&r6.current);break;case 19:if(n=0!=(r&t.childLanes),0!=(128&e.flags)){if(n)return iE(e,t,r);t.flags|=128}var i=t.memoizedState;if(null!==i&&(i.rendering=null,i.tail=null,i.lastEffect=null),tn(r6,r6.current),!n)return null;break;case 22:case 23:return t.lanes=0,il(e,t,r)}return iC(e,t,r)}function iM(e,t){switch(rk(t),t.tag){case 1:return tc(t.type)&&tu(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return r3(),tr(to),tr(ta),r9(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return r5(t),null;case 13:if(tr(r6),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(d(340));rG()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return tr(r6),null;case 4:return r3(),null;case 10:return t7(t.type._context),null;case 22:case 23:return aW(),null;default:return null}}var iI=!1,iR=!1,ik="function"==typeof WeakSet?WeakSet:Set,iP=null;function iO(e,t){var r=e.ref;if(null!==r){if("function"==typeof r)try{r(null)}catch(r){a6(e,t,r)}else r.current=null}}function iN(e,t,r){try{r()}catch(r){a6(e,t,r)}}var iL=!1;function iD(e,t){for(H(e.containerInfo),iP=t;null!==iP;)if(t=(e=iP).child,0!=(1028&e.subtreeFlags)&&null!==t)t.return=e,iP=t;else for(;null!==iP;){e=iP;try{var r=e.alternate;if(0!=(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==r){var n=r.memoizedProps,i=r.memoizedState,a=e.stateNode,o=a.getSnapshotBeforeUpdate(e.elementType===e.type?n:t1(e.type,n),i);a.__reactInternalSnapshotBeforeUpdate=o}break;case 3:J&&eR(e.stateNode.containerInfo);break;default:throw Error(d(163))}}catch(t){a6(e,e.return,t)}if(null!==(t=e.sibling)){t.return=e.return,iP=t;break}iP=e.return}return r=iL,iL=!1,r}function iU(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&iN(t,r,a)}i=i.next}while(i!==n)}}function iF(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function iB(e){var t=e.ref;if(null!==t){var r=e.stateNode;e=5===e.tag?F(r):r,"function"==typeof t?t(e):t.current=e}}function iz(e,t,r){if(tj&&"function"==typeof tj.onCommitFiberUnmount)try{tj.onCommitFiberUnmount(tH,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var i=n,a=i.destroy;i=i.tag,void 0!==a&&(0!=(2&i)?iN(t,r,a):0!=(4&i)&&iN(t,r,a)),n=n.next}while(n!==e)}break;case 1:if(iO(t,r),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){a6(t,r,e)}break;case 5:iO(t,r);break;case 4:J?iX(e,t,r):ee&&ee&&(r=eP(t=t.stateNode.containerInfo),eL(t,r))}}function iH(e,t,r){for(var n=t;;)if(iz(e,n,r),null===n.child||J&&4===n.tag){if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}else n.child.return=n,n=n.child}function ij(e){var t=e.alternate;null!==t&&(e.alternate=null,ij(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&ea(t),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function iG(e){return 5===e.tag||3===e.tag||4===e.tag}function iV(e){a:for(;;){for(;null===e.sibling;){if(null===e.return||iG(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags||null===e.child||4===e.tag)continue a;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function iq(e){if(J){a:{for(var t=e.return;null!==t;){if(iG(t))break a;t=t.return}throw Error(d(160))}var r=t;switch(r.tag){case 5:t=r.stateNode,32&r.flags&&(eE(t),r.flags&=-33),r=iV(e),iZ(e,r,t);break;case 3:case 4:t=r.stateNode.containerInfo,r=iV(e),iW(e,r,t);break;default:throw Error(d(161))}}}function iW(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?eS(r,e,t):ey(r,e);else if(4!==n&&null!==(e=e.child))for(iW(e,t,r),e=e.sibling;null!==e;)iW(e,t,r),e=e.sibling}function iZ(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?ew(r,e,t):eg(r,e);else if(4!==n&&null!==(e=e.child))for(iZ(e,t,r),e=e.sibling;null!==e;)iZ(e,t,r),e=e.sibling}function iX(e,t,r){for(var n,i,a=t,o=!1;;){if(!o){o=a.return;a:for(;;){if(null===o)throw Error(d(160));switch(n=o.stateNode,o.tag){case 5:i=!1;break a;case 3:case 4:n=n.containerInfo,i=!0;break a}o=o.return}o=!0}if(5===a.tag||6===a.tag)iH(e,a,r),i?ex(n,a.stateNode):eT(n,a.stateNode);else if(18===a.tag)i?e1(n,a.stateNode):e0(n,a.stateNode);else if(4===a.tag){if(null!==a.child){n=a.stateNode.containerInfo,i=!0,a.child.return=a,a=a.child;continue}}else if(iz(e,a,r),null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;4===(a=a.return).tag&&(o=!1)}a.sibling.return=a.return,a=a.sibling}}function i$(e,t){if(J){switch(t.tag){case 0:case 11:case 14:case 15:iU(3,t,t.return),iF(3,t),iU(5,t,t.return);return;case 1:case 12:case 17:return;case 5:var r=t.stateNode;if(null!=r){var n=t.memoizedProps;e=null!==e?e.memoizedProps:n;var i=t.type,a=t.updateQueue;t.updateQueue=null,null!==a&&e_(r,a,i,e,n,t)}return;case 6:if(null===t.stateNode)throw Error(d(162));r=t.memoizedProps,ev(t.stateNode,null!==e?e.memoizedProps:r,r);return;case 3:et&&null!==e&&e.memoizedState.isDehydrated&&eQ(t.stateNode.containerInfo);return;case 13:case 19:iK(t);return}throw Error(d(163))}switch(t.tag){case 0:case 11:case 14:case 15:iU(3,t,t.return),iF(3,t),iU(5,t,t.return);return;case 12:case 22:case 23:return;case 13:case 19:iK(t);return;case 3:et&&null!==e&&e.memoizedState.isDehydrated&&eQ(t.stateNode.containerInfo)}a:if(ee){switch(t.tag){case 1:case 5:case 6:break a;case 3:case 4:eL((t=t.stateNode).containerInfo,t.pendingChildren);break a}throw Error(d(163))}}function iK(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new ik),t.forEach(function(t){var n=oe.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))})}}function iY(e,t){for(iP=t;null!==iP;){var r=(t=iP).deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e;J?iX(a,i,t):iH(a,i,t);var o=i.alternate;null!==o&&(o.return=null),i.return=null}catch(e){a6(i,t,e)}}if(r=t.child,0!=(12854&t.subtreeFlags)&&null!==r)r.return=t,iP=r;else for(;null!==iP;){t=iP;try{var s=t.flags;if(32&s&&J&&eE(t.stateNode),512&s){var l=t.alternate;if(null!==l){var c=l.ref;null!==c&&("function"==typeof c?c(null):c.current=null)}}if(8192&s)switch(t.tag){case 13:if(null!==t.memoizedState){var u=t.alternate;(null===u||null===u.memoizedState)&&(aw=tD())}break;case 22:var d=null!==t.memoizedState,h=t.alternate,p=null!==h&&null!==h.memoizedState;if(r=t,J){a:if(n=r,i=d,a=null,J)for(var f=n;;){if(5===f.tag){if(null===a){a=f;var m=f.stateNode;i?eC(m):eM(f.stateNode,f.memoizedProps)}}else if(6===f.tag){if(null===a){var g=f.stateNode;i?eA(g):eI(g,f.memoizedProps)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===n)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===n)break;for(;null===f.sibling;){if(null===f.return||f.return===n)break a;a===f&&(a=null),f=f.return}a===f&&(a=null),f.sibling.return=f.return,f=f.sibling}}if(d&&!p&&0!=(1&r.mode)){iP=r;for(var y=r.child;null!==y;){for(r=iP=y;null!==iP;){var v=(n=iP).child;switch(n.tag){case 0:case 11:case 14:case 15:iU(4,n,n.return);break;case 1:iO(n,n.return);var b=n.stateNode;if("function"==typeof b.componentWillUnmount){var _=n.return;try{b.props=n.memoizedProps,b.state=n.memoizedState,b.componentWillUnmount()}catch(e){a6(n,_,e)}}break;case 5:iO(n,n.return);break;case 22:if(null!==n.memoizedState){i1(r);continue}}null!==v?(v.return=n,iP=v):i1(r)}y=y.sibling}}}switch(4102&s){case 2:iq(t),t.flags&=-3;break;case 6:iq(t),t.flags&=-3,i$(t.alternate,t);break;case 4096:t.flags&=-4097;break;case 4100:t.flags&=-4097,i$(t.alternate,t);break;case 4:i$(t.alternate,t)}}catch(e){a6(t,t.return,e)}if(null!==(r=t.sibling)){r.return=t.return,iP=r;break}iP=t.return}}}function iQ(e,t,r){iP=e,iJ(e,t,r)}function iJ(e,t,r){for(var n=0!=(1&e.mode);null!==iP;){var i=iP,a=i.child;if(22===i.tag&&n){var o=null!==i.memoizedState||iI;if(!o){var s=i.alternate,l=null!==s&&null!==s.memoizedState||iR;s=iI;var c=iR;if(iI=o,(iR=l)&&!c)for(iP=i;null!==iP;)l=(o=iP).child,22===o.tag&&null!==o.memoizedState?i2(i):null!==l?(l.return=o,iP=l):i2(i);for(;null!==a;)iP=a,iJ(a,t,r),a=a.sibling;iP=i,iI=s,iR=c}i0(e,t,r)}else 0!=(8772&i.subtreeFlags)&&null!==a?(a.return=i,iP=a):i0(e,t,r)}}function i0(e){for(;null!==iP;){var t=iP;if(0!=(8772&t.flags)){var r=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:iR||iF(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!iR){if(null===r)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:t1(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}}var a=t.updateQueue;null!==a&&rd(t,a,n);break;case 3:var o=t.updateQueue;if(null!==o){if(r=null,null!==t.child)switch(t.child.tag){case 5:r=F(t.child.stateNode);break;case 1:r=t.child.stateNode}rd(t,o,r)}break;case 5:var s=t.stateNode;null===r&&4&t.flags&&eb(s,t.type,t.memoizedProps,t);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(et&&null===t.memoizedState){var l=t.alternate;if(null!==l){var c=l.memoizedState;if(null!==c){var u=c.dehydrated;null!==u&&eJ(u)}}}break;default:throw Error(d(163))}iR||512&t.flags&&iB(t)}catch(e){a6(t,t.return,e)}}if(t===e){iP=null;break}if(null!==(r=t.sibling)){r.return=t.return,iP=r;break}iP=t.return}}function i1(e){for(;null!==iP;){var t=iP;if(t===e){iP=null;break}var r=t.sibling;if(null!==r){r.return=t.return,iP=r;break}iP=t.return}}function i2(e){for(;null!==iP;){var t=iP;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{iF(4,t)}catch(e){a6(t,r,e)}break;case 1:var n=t.stateNode;if("function"==typeof n.componentDidMount){var i=t.return;try{n.componentDidMount()}catch(e){a6(t,i,e)}}var a=t.return;try{iB(t)}catch(e){a6(t,a,e)}break;case 5:var o=t.return;try{iB(t)}catch(e){a6(t,o,e)}}}catch(e){a6(t,t.return,e)}if(t===e){iP=null;break}var s=t.sibling;if(null!==s){s.return=t.return,iP=s;break}iP=t.return}}var i3=0,i4=1,i5=2,i6=3,i8=4;if("function"==typeof Symbol&&Symbol.for){var i7=Symbol.for;i3=i7("selector.component"),i4=i7("selector.has_pseudo_class"),i5=i7("selector.role"),i6=i7("selector.test_id"),i8=i7("selector.text")}function i9(e){var t=er(e);if(null!=t){if("string"!=typeof t.memoizedProps["data-testname"])throw Error(d(364));return t}if(null===(e=ec(e)))throw Error(d(362));return e.stateNode.current}function ae(e,t){switch(t.$$typeof){case i3:if(e.type===t.value)return!0;break;case i4:a:{t=t.value,e=[e,0];for(var r=0;r<e.length;){var n=e[r++],i=e[r++],a=t[i];if(5!==n.tag||!eh(n)){for(;null!=a&&ae(n,a);)a=t[++i];if(i===t.length){t=!0;break a}for(n=n.child;null!==n;)e.push(n,i),n=n.sibling}}t=!1}return t;case i5:if(5===e.tag&&ep(e.stateNode,t.value))return!0;break;case i8:if((5===e.tag||6===e.tag)&&null!==(e=ed(e))&&0<=e.indexOf(t.value))return!0;break;case i6:if(5===e.tag&&"string"==typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase())return!0;break;default:throw Error(d(365))}return!1}function at(e){switch(e.$$typeof){case i3:return"<"+(M(e.value)||"Unknown")+">";case i4:return":has("+(at(e)||"")+")";case i5:return'[role="'+e.value+'"]';case i8:return'"'+e.value+'"';case i6:return'[data-testname="'+e.value+'"]';default:throw Error(d(365))}}function ar(e,t){var r=[];e=[e,0];for(var n=0;n<e.length;){var i=e[n++],a=e[n++],o=t[a];if(5!==i.tag||!eh(i)){for(;null!=o&&ae(i,o);)o=t[++a];if(a===t.length)r.push(i);else for(i=i.child;null!==i;)e.push(i,a),i=i.sibling}}return r}function an(e,t){if(!el)throw Error(d(363));e=ar(e=i9(e),t),t=[],e=Array.from(e);for(var r=0;r<e.length;){var n=e[r++];if(5===n.tag)eh(n)||t.push(n.stateNode);else for(n=n.child;null!==n;)e.push(n),n=n.sibling}return t}var ai=Math.ceil,aa=h.ReactCurrentDispatcher,ao=h.ReactCurrentOwner,as=h.ReactCurrentBatchConfig,al=0,ac=null,au=null,ad=0,ah=0,ap=tt(0),af=0,am=null,ag=0,ay=0,av=0,ab=null,a_=null,aw=0,aS=1/0;function aT(){aS=tD()+500}var ax=!1,aE=null,aC=null,aA=!1,aM=null,aI=0,aR=0,ak=null,aP=-1,aO=0;function aN(){return 0!=(6&al)?tD():-1!==aP?aP:aP=tD()}function aL(e){return 0==(1&e.mode)?1:0!=(2&al)&&0!==ad?ad&-ad:null!==tQ.transition?(0===aO&&(e=tb,0==(4194240&(tb<<=1))&&(tb=64),aO=e),aO):0!==(e=tR)?e:ei()}function aD(e,t,r){if(50<aR)throw aR=0,ak=null,Error(d(185));var n=aU(e,t);return null===n?null:(tA(n,t,r),(0==(2&al)||n!==ac)&&(n===ac&&(0==(2&al)&&(ay|=t),4===af&&aG(n,ad)),aF(n,r),1===t&&0===al&&0==(1&e.mode)&&(aT(),tZ&&tY())),n)}function aU(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}function aF(e,t){var r=e.callbackNode;tx(e,t);var n=tS(e,e===ac?ad:0);if(0===n)null!==r&&tO(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&tO(r),1===t)0===e.tag?tK(aV.bind(null,e)):t$(aV.bind(null,e)),eo?es(function(){0===al&&tY()}):tP(tU,tY),r=null;else{switch(tk(n)){case 1:r=tU;break;case 4:r=tF;break;case 16:default:r=tB;break;case 536870912:r=tz}r=ot(r,aB.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function aB(e,t){if(aP=-1,aO=0,0!=(6&al))throw Error(d(327));var r=e.callbackNode;if(a4()&&e.callbackNode!==r)return null;var n=tS(e,e===ac?ad:0);if(0===n)return null;if(0!=(30&n)||0!=(n&e.expiredLanes)||t)t=aY(e,n);else{t=n;var i=al;al|=2;var a=a$();for((ac!==e||ad!==t)&&(aT(),aZ(e,t));;)try{aJ();break}catch(t){aX(e,t)}t6(),aa.current=a,al=i,null!==au?t=0:(ac=null,ad=0,t=af)}if(0!==t){if(2===t&&0!==(i=tE(e))&&(n=i,t=az(e,i)),1===t)throw r=am,aZ(e,0),aG(e,n),aF(e,tD()),r;if(6===t)aG(e,n);else{if(i=e.current.alternate,0==(30&n)&&!aj(i)&&(2===(t=aY(e,n))&&0!==(a=tE(e))&&(n=a,t=az(e,a)),1===t))throw r=am,aZ(e,0),aG(e,n),aF(e,tD()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(d(345));case 2:case 5:a2(e,a_);break;case 3:if(aG(e,n),(130023424&n)===n&&10<(t=aw+500-tD())){if(0!==tS(e,0))break;if(((i=e.suspendedLanes)&n)!==n){aN(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=$(a2.bind(null,e,a_),t);break}a2(e,a_);break;case 4:if(aG(e,n),(4194240&n)===n)break;for(i=-1,t=e.eventTimes;0<n;){var o=31-tm(n);a=1<<o,(o=t[o])>i&&(i=o),n&=~a}if(n=i,10<(n=(120>(n=tD()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ai(n/1960))-n)){e.timeoutHandle=$(a2.bind(null,e,a_),n);break}a2(e,a_);break;default:throw Error(d(329))}}}return aF(e,tD()),e.callbackNode===r?aB.bind(null,e):null}function az(e,t){var r=ab;return e.current.memoizedState.isDehydrated&&(aZ(e,t).flags|=256),2!==(e=aY(e,t))&&(t=a_,a_=r,null!==t&&aH(t)),e}function aH(e){null===a_?a_=e:a_.push.apply(a_,e)}function aj(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!tq(a(),i))return!1}catch(e){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function aG(e,t){for(t&=~av,t&=~ay,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-tm(t),n=1<<r;e[r]=-1,t&=~n}}function aV(e){if(0!=(6&al))throw Error(d(327));a4();var t=tS(e,0);if(0==(1&t))return aF(e,tD()),null;var r=aY(e,t);if(0!==e.tag&&2===r){var n=tE(e);0!==n&&(t=n,r=az(e,n))}if(1===r)throw r=am,aZ(e,0),aG(e,t),aF(e,tD()),r;if(6===r)throw Error(d(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,a2(e,a_),aF(e,tD()),null}function aq(e){null!==aM&&0===aM.tag&&0==(6&al)&&a4();var t=al;al|=1;var r=as.transition,n=tR;try{if(as.transition=null,tR=1,e)return e()}finally{tR=n,as.transition=r,0==(6&(al=t))&&tY()}}function aW(){ah=ap.current,tr(ap)}function aZ(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==Y&&(e.timeoutHandle=Y,K(r)),null!==au)for(r=au.return;null!==r;){var n=r;switch(rk(n),n.tag){case 1:null!=(n=n.type.childContextTypes)&&tu();break;case 3:r3(),tr(to),tr(ta),r9();break;case 5:r5(n);break;case 4:r3();break;case 13:case 19:tr(r6);break;case 10:t7(n.type._context);break;case 22:case 23:aW()}r=r.return}if(ac=e,au=e=oo(e.current,null),ad=ah=t,af=0,am=null,av=ay=ag=0,a_=ab=null,null!==rr){for(t=0;t<rr.length;t++)if(null!==(n=(r=rr[t]).interleaved)){r.interleaved=null;var i=n.next,a=r.pending;if(null!==a){var o=a.next;a.next=i,n.next=o}r.pending=n}rr=null}return e}function aX(e,t){for(;;){var r=au;try{if(t6(),ne.current=nZ,no){for(var n=nn.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}no=!1}if(nr=0,na=ni=nn=null,ns=!1,nl=0,ao.current=null,null===r||null===r.return){af=1,am=t,au=null;break}a:{var a=e,o=r.return,s=r,l=t;if(t=ad,s.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var c=l,u=s,h=u.tag;if(0==(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=n3(o);if(null!==f){f.flags&=-257,n4(f,o,s,a,t),1&f.mode&&n2(a,c,t),t=f,l=c;var m=t.updateQueue;if(null===m){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break a}if(0==(1&t)){n2(a,c,t),aK();break a}l=Error(d(426))}else if(rN&&1&s.mode){var y=n3(o);if(null!==y){0==(65536&y.flags)&&(y.flags|=256),n4(y,o,s,a,t),rV(l);break a}}a=l,4!==af&&(af=2),null===ab?ab=[a]:ab.push(a),l=nY(l,s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=n0(s,l,t);rc(s,v);break a;case 1:a=l;var b=s.type,_=s.stateNode;if(0==(128&s.flags)&&("function"==typeof b.getDerivedStateFromError||null!==_&&"function"==typeof _.componentDidCatch&&(null===aC||!aC.has(_)))){s.flags|=65536,t&=-t,s.lanes|=t;var w=n1(s,a,t);rc(s,w);break a}}s=s.return}while(null!==s)}a1(r)}catch(e){t=e,au===r&&null!==r&&(au=r=r.return);continue}break}}function a$(){var e=aa.current;return aa.current=nZ,null===e?nZ:e}function aK(){(0===af||3===af||2===af)&&(af=4),null===ac||0==(268435455&ag)&&0==(268435455&ay)||aG(ac,ad)}function aY(e,t){var r=al;al|=2;var n=a$();for(ac===e&&ad===t||aZ(e,t);;)try{aQ();break}catch(t){aX(e,t)}if(t6(),al=r,aa.current=n,null!==au)throw Error(d(261));return ac=null,ad=0,af}function aQ(){for(;null!==au;)a0(au)}function aJ(){for(;null!==au&&!tN();)a0(au)}function a0(e){var t=o(e.alternate,e,ah);e.memoizedProps=e.pendingProps,null===t?a1(e):au=t,ao.current=null}function a1(e){var t=e;do{var r=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(r=ie(r,t,ah))){au=r;return}}else{if(null!==(r=iM(r,t))){r.flags&=32767,au=r;return}if(null!==e)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{af=6,au=null;return}}if(null!==(t=t.sibling)){au=t;return}au=t=e}while(null!==t);0===af&&(af=5)}function a2(e,t){var r=tR,n=as.transition;try{as.transition=null,tR=1,a3(e,t,r)}finally{as.transition=n,tR=r}return null}function a3(e,t,r){do a4();while(null!==aM);if(0!=(6&al))throw Error(d(327));var n=e.finishedWork,i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(d(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(tM(e,a),e===ac&&(au=ac=null,ad=0),0==(2064&n.subtreeFlags)&&0==(2064&n.flags)||aA||(aA=!0,ot(tB,function(){return a4(),null})),a=0!=(15990&n.flags),0!=(15990&n.subtreeFlags)||a){a=as.transition,as.transition=null;var o=tR;tR=1;var s=al;al|=4,ao.current=null,iD(e,n),iY(e,n,i),j(e.containerInfo),e.current=n,iQ(n,e,i),tL(),al=s,tR=o,as.transition=a}else e.current=n;if(aA&&(aA=!1,aM=e,aI=i),0===(a=e.pendingLanes)&&(aC=null),tG(n.stateNode,r),aF(e,tD()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r(t[n]);if(ax)throw ax=!1,e=aE,aE=null,e;return 0!=(1&aI)&&0!==e.tag&&a4(),0!=(1&(a=e.pendingLanes))?e===ak?aR++:(aR=0,ak=e):aR=0,tY(),null}function a4(){if(null!==aM){var e=tk(aI),t=as.transition,r=tR;try{if(as.transition=null,tR=16>e?16:e,null===aM)var n=!1;else{if(e=aM,aM=null,aI=0,0!=(6&al))throw Error(d(331));var i=al;for(al|=4,iP=e.current;null!==iP;){var a=iP,o=a.child;if(0!=(16&iP.flags)){var s=a.deletions;if(null!==s){for(var l=0;l<s.length;l++){var c=s[l];for(iP=c;null!==iP;){var u=iP;switch(u.tag){case 0:case 11:case 15:iU(8,u,a)}var h=u.child;if(null!==h)h.return=u,iP=h;else for(;null!==iP;){var p=(u=iP).sibling,f=u.return;if(ij(u),u===c){iP=null;break}if(null!==p){p.return=f,iP=p;break}iP=f}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}iP=a}}if(0!=(2064&a.subtreeFlags)&&null!==o)o.return=a,iP=o;else for(;null!==iP;){if(a=iP,0!=(2048&a.flags))switch(a.tag){case 0:case 11:case 15:iU(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,iP=v;break}iP=a.return}}var b=e.current;for(iP=b;null!==iP;){var _=(o=iP).child;if(0!=(2064&o.subtreeFlags)&&null!==_)_.return=o,iP=_;else for(o=b;null!==iP;){if(s=iP,0!=(2048&s.flags))try{switch(s.tag){case 0:case 11:case 15:iF(9,s)}}catch(e){a6(s,s.return,e)}if(s===o){iP=null;break}var w=s.sibling;if(null!==w){w.return=s.return,iP=w;break}iP=s.return}}if(al=i,tY(),tj&&"function"==typeof tj.onPostCommitFiberRoot)try{tj.onPostCommitFiberRoot(tH,e)}catch(e){}n=!0}return n}finally{tR=r,as.transition=t}}return!1}function a5(e,t,r){t=n0(e,t=nY(r,t),1),rs(e,t),t=aN(),null!==(e=aU(e,1))&&(tA(e,1,t),aF(e,t))}function a6(e,t,r){if(3===e.tag)a5(e,e,r);else for(;null!==t;){if(3===t.tag){a5(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===aC||!aC.has(n))){e=n1(t,e=nY(r,e),1),rs(t,e),e=aN(),null!==(t=aU(t,1))&&(tA(t,1,e),aF(t,e));break}}t=t.return}}function a8(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=aN(),e.pingedLanes|=e.suspendedLanes&r,ac===e&&(ad&r)===r&&(4===af||3===af&&(130023424&ad)===ad&&500>tD()-aw?aZ(e,0):av|=r),aF(e,t)}function a7(e,t){0===t&&(0==(1&e.mode)?t=1:(t=t_,0==(130023424&(t_<<=1))&&(t_=4194304)));var r=aN();null!==(e=aU(e,t))&&(tA(e,t,r),aF(e,r))}function a9(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),a7(e,r)}function oe(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(d(314))}null!==n&&n.delete(t),a7(e,r)}function ot(e,t){return tP(e,t)}function or(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function on(e,t,r,n){return new or(e,t,r,n)}function oi(e){return!(!(e=e.prototype)||!e.isReactComponent)}function oa(e){if("function"==typeof e)return oi(e)?1:0;if(null!=e){if((e=e.$$typeof)===_)return 11;if(e===T)return 14}return 2}function oo(e,t){var r=e.alternate;return null===r?((r=on(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function os(e,t,r,n,i,a){var o=2;if(n=e,"function"==typeof e)oi(e)&&(o=1);else if("string"==typeof e)o=5;else a:switch(e){case m:return ol(r.children,i,a,t);case g:o=8,i|=8;break;case y:return(e=on(12,r,t,2|i)).elementType=y,e.lanes=a,e;case w:return(e=on(13,r,t,i)).elementType=w,e.lanes=a,e;case S:return(e=on(19,r,t,i)).elementType=S,e.lanes=a,e;case E:return oc(r,i,a,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case v:o=10;break a;case b:o=9;break a;case _:o=11;break a;case T:o=14;break a;case x:o=16,n=null;break a}throw Error(d(130,null==e?e:typeof e,""))}return(t=on(o,r,t,i)).elementType=e,t.type=n,t.lanes=a,t}function ol(e,t,r,n){return(e=on(7,e,n,t)).lanes=r,e}function oc(e,t,r,n){return(e=on(22,e,n,t)).elementType=E,e.lanes=r,e.stateNode={},e}function ou(e,t,r){return(e=on(6,e,null,t)).lanes=r,e}function od(e,t,r){return(t=on(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function oh(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Y,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tC(0),this.expirationTimes=tC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tC(0),this.identifierPrefix=n,this.onRecoverableError=i,et&&(this.mutableSourceEagerHydrationData=null)}function op(e,t,r,n,i,a,o,s,l){return e=new oh(e,t,r,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=on(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null},ri(a),e}function of(e){if(!e)return ti;e=e._reactInternals;a:{if(R(e)!==e||1!==e.tag)throw Error(d(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break a;case 1:if(tc(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break a}}t=t.return}while(null!==t);throw Error(d(171))}if(1===e.tag){var r=e.type;if(tc(r))return th(e,r,t)}return t}function om(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(d(188));throw Error(d(268,e=Object.keys(e).join(",")))}return null===(e=O(t))?null:e.stateNode}function og(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function oy(e,t){og(e,t),(e=e.alternate)&&og(e,t)}function ov(e){return null===(e=O(e))?null:e.stateNode}function ob(){return null}return o=function(e,t,r){if(null!==e){if(e.memoizedProps!==t.pendingProps||to.current)ir=!0;else{if(0==(e.lanes&r)&&0==(128&t.flags))return ir=!1,iA(e,t,r);ir=0!=(131072&e.flags)}}else ir=!1,rN&&0!=(1048576&t.flags)&&rI(t,rS,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var i=tl(t,ta.current);re(t,r),i=nh(null,t,n,e,i,r);var a=np();return t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,tc(n)?(a=!0,tp(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,ri(t),i.updater=rf,t.stateNode=i,i._reactInternals=t,rv(t,n,e,r),t=ih(null,t,n,!0,a,r)):(t.tag=0,rN&&a&&rR(t),ii(null,t,i,r),t=t.child),t;case 16:n=t.elementType;a:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,n=(i=n._init)(n._payload),t.type=n,i=t.tag=oa(n),e=t1(n,e),i){case 0:t=iu(null,t,n,e,r);break a;case 1:t=id(null,t,n,e,r);break a;case 11:t=ia(null,t,n,e,r);break a;case 14:t=io(null,t,n,t1(n.type,e),r);break a}throw Error(d(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:t1(n,i),iu(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:t1(n,i),id(e,t,n,i,r);case 3:a:{if(ip(t),null===e)throw Error(d(387));n=t.pendingProps,i=(a=t.memoizedState).element,ra(e,t),ru(t,n,null,r);var o=t.memoizedState;if(n=o.element,et&&a.isDehydrated){if(a={element:n,isDehydrated:!1,cache:o.cache,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=im(e,t,n,r,i=Error(d(423)));break a}if(n!==i){t=im(e,t,n,r,i=Error(d(424)));break a}for(et&&(rO=eW(t.stateNode.containerInfo),rP=t,rN=!0,rD=null,rL=!1),r=rK(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(rG(),n===i){t=iC(e,t,r);break a}ii(e,t,n,r)}t=t.child}return t;case 5:return r4(t),null===e&&rz(t),n=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,o=i.children,Z(n,i)?o=null:null!==a&&Z(n,a)&&(t.flags|=32),ic(e,t),ii(e,t,o,r),t.child;case 6:return null===e&&rz(t),null;case 13:return iv(e,t,r);case 4:return r2(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=r$(t,null,n,r):ii(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:t1(n,i),ia(e,t,n,i,r);case 7:return ii(e,t,t.pendingProps,r),t.child;case 8:case 12:return ii(e,t,t.pendingProps.children,r),t.child;case 10:a:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,t8(t,n,o=i.value),null!==a){if(tq(a.value,o)){if(a.children===i.children&&!to.current){t=iC(e,t,r);break a}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var s=a.dependencies;if(null!==s){o=a.child;for(var l=s.firstContext;null!==l;){if(l.context===n){if(1===a.tag){(l=ro(-1,r&-r)).tag=2;var c=a.updateQueue;if(null!==c){var u=(c=c.shared).pending;null===u?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}a.lanes|=r,null!==(l=a.alternate)&&(l.lanes|=r),t9(a.return,r,t),s.lanes|=r;break}l=l.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(d(341));o.lanes|=r,null!==(s=o.alternate)&&(s.lanes|=r),t9(o,r,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}}ii(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,re(t,r),n=n(i=rt(i)),t.flags|=1,ii(e,t,n,r),t.child;case 14:return i=t1(n=t.type,t.pendingProps),i=t1(n.type,i),io(e,t,n,i,r);case 15:return is(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:t1(n,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,tc(n)?(e=!0,tp(t)):e=!1,re(t,r),rg(t,n,i),rv(t,n,i,r),ih(null,t,n,!0,e,r);case 19:return iE(e,t,r);case 22:return il(e,t,r)}throw Error(d(156,t.tag))},s.attemptContinuousHydration=function(e){13===e.tag&&(aD(e,134217728,aN()),oy(e,134217728))},s.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=aN(),r=aL(e);aD(e,r,t),oy(e,r)}},s.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=tw(t.pendingLanes);0!==r&&(tI(t,1|r),aF(t,tD()),0==(6&al)&&(aT(),tY()))}break;case 13:var n=aN();aq(function(){return aD(e,1,n)}),oy(e,1)}},s.batchedUpdates=function(e,t){var r=al;al|=1;try{return e(t)}finally{0===(al=r)&&(aT(),tZ&&tY())}},s.createComponentSelector=function(e){return{$$typeof:i3,value:e}},s.createContainer=function(e,t,r,n,i,a,o){return op(e,t,!1,null,r,n,i,a,o)},s.createHasPseudoClassSelector=function(e){return{$$typeof:i4,value:e}},s.createHydrationContainer=function(e,t,r,n,i,a,o,s,l){return(e=op(r,n,!0,e,i,a,o,s,l)).context=of(null),r=e.current,(a=ro(n=aN(),i=aL(r))).callback=null!=t?t:null,rs(r,a),e.current.lanes=i,tA(e,i,n),aF(e,n),e},s.createPortal=function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:f,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}},s.createRoleSelector=function(e){return{$$typeof:i5,value:e}},s.createTestNameSelector=function(e){return{$$typeof:i6,value:e}},s.createTextSelector=function(e){return{$$typeof:i8,value:e}},s.deferredUpdates=function(e){var t=tR,r=as.transition;try{return as.transition=null,tR=16,e()}finally{tR=t,as.transition=r}},s.discreteUpdates=function(e,t,r,n,i){var a=tR,o=as.transition;try{return as.transition=null,tR=1,e(t,r,n,i)}finally{tR=a,as.transition=o,0===al&&aT()}},s.findAllNodes=an,s.findBoundingRects=function(e,t){if(!el)throw Error(d(363));t=an(e,t),e=[];for(var r=0;r<t.length;r++)e.push(eu(t[r]));for(t=e.length-1;0<t;t--){r=e[t];for(var n=r.x,i=n+r.width,a=r.y,o=a+r.height,s=t-1;0<=s;s--)if(t!==s){var l=e[s],c=l.x,u=c+l.width,h=l.y,p=h+l.height;if(n>=c&&a>=h&&i<=u&&o<=p){e.splice(t,1);break}if(n!==c||r.width!==l.width||p<a||h>o){if(!(a!==h||r.height!==l.height||u<n||c>i)){c>n&&(l.width+=c-n,l.x=n),u<i&&(l.width=i-c),e.splice(t,1);break}}else{h>a&&(l.height+=h-a,l.y=a),p<o&&(l.height=o-h),e.splice(t,1);break}}}return e},s.findHostInstance=om,s.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=P(e))?L(e):null)?null:e.stateNode},s.findHostInstanceWithWarning=function(e){return om(e)},s.flushControlled=function(e){var t=al;al|=1;var r=as.transition,n=tR;try{as.transition=null,tR=1,e()}finally{tR=n,as.transition=r,0===(al=t)&&(aT(),tY())}},s.flushPassiveEffects=a4,s.flushSync=aq,s.focusWithin=function(e,t){if(!el)throw Error(d(363));for(t=Array.from(t=ar(e=i9(e),t)),e=0;e<t.length;){var r=t[e++];if(!eh(r)){if(5===r.tag&&ef(r.stateNode))return!0;for(r=r.child;null!==r;)t.push(r),r=r.sibling}}return!1},s.getCurrentUpdatePriority=function(){return tR},s.getFindAllNodesFailureDescription=function(e,t){if(!el)throw Error(d(363));var r=0,n=[];e=[i9(e),0];for(var i=0;i<e.length;){var a=e[i++],o=e[i++],s=t[o];if((5!==a.tag||!eh(a))&&(ae(a,s)&&(n.push(at(s)),++o>r&&(r=o)),o<t.length))for(a=a.child;null!==a;)e.push(a,o),a=a.sibling}if(r<t.length){for(e=[];r<t.length;r++)e.push(at(t[r]));return"findAllNodes was able to match part of the selector:\n  "+n.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},s.getPublicRootInstance=function(e){return(e=e.current).child?5===e.child.tag?F(e.child.stateNode):e.child.stateNode:null},s.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:h.ReactCurrentDispatcher,findHostInstanceByFiber:ov,findFiberByHostInstance:e.findFiberByHostInstance||ob,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},"undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{tH=t.inject(e),tj=t}catch(e){}e=!!t.checkDCE}}return e},s.isAlreadyRendering=function(){return!1},s.observeVisibleRects=function(e,t,r,n){if(!el)throw Error(d(363));var i=em(e=an(e,t),r,n).disconnect;return{disconnect:function(){i()}}},s.registerMutableSourceForHydration=function(e,t){var r=t._getVersion;r=r(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r)},s.runWithPriority=function(e,t){var r=tR;try{return tR=e,t()}finally{tR=r}},s.shouldError=function(){return null},s.shouldSuspend=function(){return!1},s.updateContainer=function(e,t,r,n){var i=t.current,a=aN(),o=aL(i);return r=of(r),null===t.context?t.context=r:t.pendingContext=r,(t=ro(a,o)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),rs(i,t),null!==(e=aD(i,o,a))&&rl(e,i,o),o},s}},49971:function(e,t,r){"use strict";e.exports=r(16093)},27975:function(e,t,r){"use strict";e.exports=r(81907)},86739:function(e,t,r){"use strict";r.d(t,{ZP:function(){return y}});var n=r(74610),i=r(88671),a=r(2265),o=r(54887),s={disabled:!1},l=r(79610),c=function(e){return e.scrollTop},u="unmounted",d="exited",h="entering",p="entered",f="exiting",m=function(e){function t(t,r){n=e.call(this,t,r)||this;var n,i,a=r,o=a&&!a.isMounting?t.enter:t.appear;return n.appearStatus=null,t.in?o?(i=d,n.appearStatus=h):i=p:i=t.unmountOnExit||t.mountOnEnter?u:d,n.state={status:i},n.nextCallback=null,n}(0,i.Z)(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===u?{status:d}:null};var r=t.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(e){var t=null;if(e!==this.props){var r=this.state.status;this.props.in?r!==h&&r!==p&&(t=h):(r===h||r===p)&&(t=f)}this.updateStatus(!1,t)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var e,t,r,n=this.props.timeout;return e=t=r=n,null!=n&&"number"!=typeof n&&(e=n.exit,t=n.enter,r=void 0!==n.appear?n.appear:t),{exit:e,enter:t,appear:r}},r.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t){if(this.cancelNextCallback(),t===h){if(this.props.unmountOnExit||this.props.mountOnEnter){var r=this.props.nodeRef?this.props.nodeRef.current:o.findDOMNode(this);r&&c(r)}this.performEnter(e)}else this.performExit()}else this.props.unmountOnExit&&this.state.status===d&&this.setState({status:u})},r.performEnter=function(e){var t=this,r=this.props.enter,n=this.context?this.context.isMounting:e,i=this.props.nodeRef?[n]:[o.findDOMNode(this),n],a=i[0],l=i[1],c=this.getTimeouts(),u=n?c.appear:c.enter;if(!e&&!r||s.disabled){this.safeSetState({status:p},function(){t.props.onEntered(a)});return}this.props.onEnter(a,l),this.safeSetState({status:h},function(){t.props.onEntering(a,l),t.onTransitionEnd(u,function(){t.safeSetState({status:p},function(){t.props.onEntered(a,l)})})})},r.performExit=function(){var e=this,t=this.props.exit,r=this.getTimeouts(),n=this.props.nodeRef?void 0:o.findDOMNode(this);if(!t||s.disabled){this.safeSetState({status:d},function(){e.props.onExited(n)});return}this.props.onExit(n),this.safeSetState({status:f},function(){e.props.onExiting(n),e.onTransitionEnd(r.exit,function(){e.safeSetState({status:d},function(){e.props.onExited(n)})})})},r.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},r.setNextCallback=function(e){var t=this,r=!0;return this.nextCallback=function(n){r&&(r=!1,t.nextCallback=null,e(n))},this.nextCallback.cancel=function(){r=!1},this.nextCallback},r.onTransitionEnd=function(e,t){this.setNextCallback(t);var r=this.props.nodeRef?this.props.nodeRef.current:o.findDOMNode(this),n=null==e&&!this.props.addEndListener;if(!r||n){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[r,this.nextCallback],a=i[0],s=i[1];this.props.addEndListener(a,s)}null!=e&&setTimeout(this.nextCallback,e)},r.render=function(){var e=this.state.status;if(e===u)return null;var t=this.props,r=t.children,i=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,(0,n.Z)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return a.createElement(l.Z.Provider,{value:null},"function"==typeof r?r(e,i):a.cloneElement(a.Children.only(r),i))},t}(a.Component);function g(){}m.contextType=l.Z,m.propTypes={},m.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:g,onEntering:g,onEntered:g,onExit:g,onExiting:g,onExited:g},m.UNMOUNTED=u,m.EXITED=d,m.ENTERING=h,m.ENTERED=p,m.EXITING=f;var y=m},79610:function(e,t,r){"use strict";var n=r(2265);t.Z=n.createContext(null)},20185:function(e,t,r){"use strict";let n;let{SymbolDispose:i}=r(56770),{AbortError:a,codes:o}=r(56367),{isNodeStream:s,isWebStream:l,kControllerErrorFunction:c}=r(96636),u=r(80618),{ERR_INVALID_ARG_TYPE:d}=o,h=(e,t)=>{if("object"!=typeof e||!("aborted"in e))throw new d(t,"AbortSignal",e)};e.exports.addAbortSignal=function(t,r){if(h(t,"signal"),!s(r)&&!l(r))throw new d("stream",["ReadableStream","WritableStream","Stream"],r);return e.exports.addAbortSignalNoValidate(t,r)},e.exports.addAbortSignalNoValidate=function(e,t){if("object"!=typeof e||!("aborted"in e))return t;let o=s(t)?()=>{t.destroy(new a(void 0,{cause:e.reason}))}:()=>{t[c](new a(void 0,{cause:e.reason}))};return e.aborted?o():u(t,(n=n||r(1088).addAbortListener)(e,o)[i]),t}},1381:function(e,t,r){"use strict";let{StringPrototypeSlice:n,SymbolIterator:i,TypedArrayPrototypeSet:a,Uint8Array:o}=r(56770),{Buffer:s}=r(82957),{inspect:l}=r(1088);e.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){let t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){let t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;let e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,r=""+t.data;for(;null!==(t=t.next);)r+=e+t.data;return r}concat(e){if(0===this.length)return s.alloc(0);let t=s.allocUnsafe(e>>>0),r=this.head,n=0;for(;r;)a(t,r.data,n),n+=r.data.length,r=r.next;return t}consume(e,t){let r=this.head.data;if(e<r.length){let t=r.slice(0,e);return this.head.data=r.slice(e),t}return e===r.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[i](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",r=this.head,i=0;do{let a=r.data;if(e>a.length)t+=a,e-=a.length;else{e===a.length?(t+=a,++i,r.next?this.head=r.next:this.head=this.tail=null):(t+=n(a,0,e),this.head=r,r.data=n(a,e));break}++i}while(null!==(r=r.next));return this.length-=i,t}_getBuffer(e){let t=s.allocUnsafe(e),r=e,n=this.head,i=0;do{let s=n.data;if(e>s.length)a(t,s,r-e),e-=s.length;else{e===s.length?(a(t,s,r-e),++i,n.next?this.head=n.next:this.head=this.tail=null):(a(t,new o(s.buffer,s.byteOffset,e),r-e),this.head=n,n.data=s.slice(e));break}++i}while(null!==(n=n.next));return this.length-=i,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return l(this,{...t,depth:0,customInspect:!1})}}},44581:function(e,t,r){"use strict";let{pipeline:n}=r(9237),i=r(21544),{destroyer:a}=r(28589),{isNodeStream:o,isReadable:s,isWritable:l,isWebStream:c,isTransformStream:u,isWritableStream:d,isReadableStream:h}=r(96636),{AbortError:p,codes:{ERR_INVALID_ARG_VALUE:f,ERR_MISSING_ARGS:m}}=r(56367),g=r(80618);e.exports=function(...e){let t,r,y,v,b;if(0===e.length)throw new m("streams");if(1===e.length)return i.from(e[0]);let _=[...e];if("function"==typeof e[0]&&(e[0]=i.from(e[0])),"function"==typeof e[e.length-1]){let t=e.length-1;e[t]=i.from(e[t])}for(let t=0;t<e.length;++t)if(o(e[t])||c(e[t])){if(t<e.length-1&&!(s(e[t])||h(e[t])||u(e[t])))throw new f(`streams[${t}]`,_[t],"must be readable");if(t>0&&!(l(e[t])||d(e[t])||u(e[t])))throw new f(`streams[${t}]`,_[t],"must be writable")}function w(e){let t=v;v=null,t?t(e):e?b.destroy(e):E||x||b.destroy()}let S=e[0],T=n(e,w),x=!!(l(S)||d(S)||u(S)),E=!!(s(T)||h(T)||u(T));if(b=new i({writableObjectMode:!!(null!=S&&S.writableObjectMode),readableObjectMode:!!(null!=T&&T.readableObjectMode),writable:x,readable:E}),x){if(o(S))b._write=function(e,r,n){S.write(e,r)?n():t=n},b._final=function(e){S.end(),r=e},S.on("drain",function(){if(t){let e=t;t=null,e()}});else if(c(S)){let e=(u(S)?S.writable:S).getWriter();b._write=async function(t,r,n){try{await e.ready,e.write(t).catch(()=>{}),n()}catch(e){n(e)}},b._final=async function(t){try{await e.ready,e.close().catch(()=>{}),r=t}catch(e){t(e)}}}g(u(T)?T.readable:T,()=>{if(r){let e=r;r=null,e()}})}if(E){if(o(T))T.on("readable",function(){if(y){let e=y;y=null,e()}}),T.on("end",function(){b.push(null)}),b._read=function(){for(;;){let e=T.read();if(null===e){y=b._read;return}if(!b.push(e))return}};else if(c(T)){let e=(u(T)?T.readable:T).getReader();b._read=async function(){for(;;)try{let{value:t,done:r}=await e.read();if(!b.push(t))return;if(r){b.push(null);return}}catch{return}}}}return b._destroy=function(e,n){e||null===v||(e=new p),y=null,t=null,r=null,null===v?n(e):(v=n,o(T)&&a(T,e))},b}},28589:function(e,t,r){"use strict";let n=r(25566),{aggregateTwoErrors:i,codes:{ERR_MULTIPLE_CALLBACK:a},AbortError:o}=r(56367),{Symbol:s}=r(56770),{kIsDestroyed:l,isDestroyed:c,isFinished:u,isServerRequest:d}=r(96636),h=s("kDestroy"),p=s("kConstruct");function f(e,t,r){e&&(e.stack,t&&!t.errored&&(t.errored=e),r&&!r.errored&&(r.errored=e))}function m(e,t){let r=this._readableState,n=this._writableState,a=n||r;return null!=n&&n.destroyed||null!=r&&r.destroyed?"function"==typeof t&&t():(f(e,n,r),n&&(n.destroyed=!0),r&&(r.destroyed=!0),a.constructed?g(this,e,t):this.once(h,function(r){g(this,i(r,e),t)})),this}function g(e,t,r){let i=!1;function a(t){if(i)return;i=!0;let a=e._readableState,o=e._writableState;f(t,o,a),o&&(o.closed=!0),a&&(a.closed=!0),"function"==typeof r&&r(t),t?n.nextTick(y,e,t):n.nextTick(v,e)}try{e._destroy(t||null,a)}catch(e){a(e)}}function y(e,t){b(e,t),v(e)}function v(e){let t=e._readableState,r=e._writableState;r&&(r.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!=r&&r.emitClose||null!=t&&t.emitClose)&&e.emit("close")}function b(e,t){let r=e._readableState,n=e._writableState;null!=n&&n.errorEmitted||null!=r&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),e.emit("error",t))}function _(){let e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)}function w(e,t,r){let i=e._readableState,a=e._writableState;if(null!=a&&a.destroyed||null!=i&&i.destroyed)return this;null!=i&&i.autoDestroy||null!=a&&a.autoDestroy?e.destroy(t):t&&(t.stack,a&&!a.errored&&(a.errored=t),i&&!i.errored&&(i.errored=t),r?n.nextTick(b,e,t):b(e,t))}function S(e,t){if("function"!=typeof e._construct)return;let r=e._readableState,i=e._writableState;r&&(r.constructed=!1),i&&(i.constructed=!1),e.once(p,t),e.listenerCount(p)>1||n.nextTick(T,e)}function T(e){let t=!1;function r(r){if(t){w(e,null!=r?r:new a);return}t=!0;let i=e._readableState,o=e._writableState,s=o||i;i&&(i.constructed=!0),o&&(o.constructed=!0),s.destroyed?e.emit(h,r):r?w(e,r,!0):n.nextTick(x,e)}try{e._construct(e=>{n.nextTick(r,e)})}catch(e){n.nextTick(r,e)}}function x(e){e.emit(p)}function E(e){return(null==e?void 0:e.setHeader)&&"function"==typeof e.abort}function C(e){e.emit("close")}function A(e,t){e.emit("error",t),n.nextTick(C,e)}function M(e,t){!(!e||c(e))&&(t||u(e)||(t=new o),d(e)?(e.socket=null,e.destroy(t)):E(e)?e.abort():E(e.req)?e.req.abort():"function"==typeof e.destroy?e.destroy(t):"function"==typeof e.close?e.close():t?n.nextTick(A,e,t):n.nextTick(C,e),e.destroyed||(e[l]=!0))}e.exports={construct:S,destroyer:M,destroy:m,undestroy:_,errorOrDestroy:w}},21544:function(e,t,r){"use strict";let n,i;let{ObjectDefineProperties:a,ObjectGetOwnPropertyDescriptor:o,ObjectKeys:s,ObjectSetPrototypeOf:l}=r(56770);e.exports=d;let c=r(40476),u=r(76243);l(d.prototype,c.prototype),l(d,c);{let e=s(u.prototype);for(let t=0;t<e.length;t++){let r=e[t];d.prototype[r]||(d.prototype[r]=u.prototype[r])}}function d(e){if(!(this instanceof d))return new d(e);c.call(this,e),u.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}function h(){return void 0===n&&(n={}),n}a(d.prototype,{writable:{__proto__:null,...o(u.prototype,"writable")},writableHighWaterMark:{__proto__:null,...o(u.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...o(u.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...o(u.prototype,"writableBuffer")},writableLength:{__proto__:null,...o(u.prototype,"writableLength")},writableFinished:{__proto__:null,...o(u.prototype,"writableFinished")},writableCorked:{__proto__:null,...o(u.prototype,"writableCorked")},writableEnded:{__proto__:null,...o(u.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...o(u.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),d.fromWeb=function(e,t){return h().newStreamDuplexFromReadableWritablePair(e,t)},d.toWeb=function(e){return h().newReadableWritablePairFromDuplex(e)},d.from=function(e){return i||(i=r(28885)),i(e,"body")}},28885:function(e,t,r){"use strict";let n=r(25566),i=r(82957),{isReadable:a,isWritable:o,isIterable:s,isNodeStream:l,isReadableNodeStream:c,isWritableNodeStream:u,isDuplexNodeStream:d,isReadableStream:h,isWritableStream:p}=r(96636),f=r(80618),{AbortError:m,codes:{ERR_INVALID_ARG_TYPE:g,ERR_INVALID_RETURN_VALUE:y}}=r(56367),{destroyer:v}=r(28589),b=r(21544),_=r(40476),w=r(76243),{createDeferredPromise:S}=r(1088),T=r(97631),x=globalThis.Blob||i.Blob,E=void 0!==x?function(e){return e instanceof x}:function(e){return!1},C=globalThis.AbortController||r(78918).AbortController,{FunctionPrototypeCall:A}=r(56770);class M extends b{constructor(e){super(e),(null==e?void 0:e.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(null==e?void 0:e.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function I(e){let{promise:t,resolve:r}=S(),i=new C,a=i.signal;return{value:e(async function*(){for(;;){let e=t;t=null;let{chunk:i,done:o,cb:s}=await e;if(n.nextTick(s),o)return;if(a.aborted)throw new m(void 0,{cause:a.reason});({promise:t,resolve:r}=S()),yield i}}(),{signal:a}),write(e,t,n){let i=r;r=null,i({chunk:e,done:!1,cb:n})},final(e){let t=r;r=null,t({done:!0,cb:e})},destroy(e,t){i.abort(),t(e)}}}function R(e){let t,r,n,i,s;let l=e.readable&&"function"!=typeof e.readable.read?_.wrap(e.readable):e.readable,c=e.writable,u=!!a(l),d=!!o(c);function h(e){let t=i;i=null,t?t(e):e&&s.destroy(e)}return s=new M({readableObjectMode:!!(null!=l&&l.readableObjectMode),writableObjectMode:!!(null!=c&&c.writableObjectMode),readable:u,writable:d}),d&&(f(c,e=>{d=!1,e&&v(l,e),h(e)}),s._write=function(e,r,n){c.write(e,r)?n():t=n},s._final=function(e){c.end(),r=e},c.on("drain",function(){if(t){let e=t;t=null,e()}}),c.on("finish",function(){if(r){let e=r;r=null,e()}})),u&&(f(l,e=>{u=!1,e&&v(l,e),h(e)}),l.on("readable",function(){if(n){let e=n;n=null,e()}}),l.on("end",function(){s.push(null)}),s._read=function(){for(;;){let e=l.read();if(null===e){n=s._read;return}if(!s.push(e))return}}),s._destroy=function(e,a){e||null===i||(e=new m),n=null,t=null,r=null,null===i?a(e):(i=a,v(c,e),v(l,e))},s}e.exports=function e(t,r){if(d(t))return t;if(c(t))return R({readable:t});if(u(t))return R({writable:t});if(l(t))return R({writable:!1,readable:!1});if(h(t))return R({readable:_.fromWeb(t)});if(p(t))return R({writable:w.fromWeb(t)});if("function"==typeof t){let{value:e,write:i,final:a,destroy:o}=I(t);if(s(e))return T(M,e,{objectMode:!0,write:i,final:a,destroy:o});let l=null==e?void 0:e.then;if("function"==typeof l){let t;let r=A(l,e,e=>{if(null!=e)throw new y("nully","body",e)},e=>{v(t,e)});return t=new M({objectMode:!0,readable:!1,write:i,final(e){a(async()=>{try{await r,n.nextTick(e,null)}catch(t){n.nextTick(e,t)}})},destroy:o})}throw new y("Iterable, AsyncIterable or AsyncFunction",r,e)}if(E(t))return e(t.arrayBuffer());if(s(t))return T(M,t,{objectMode:!0,writable:!1});if(h(null==t?void 0:t.readable)&&p(null==t?void 0:t.writable))return M.fromWeb(t);if("object"==typeof(null==t?void 0:t.writable)||"object"==typeof(null==t?void 0:t.readable))return R({readable:null!=t&&t.readable?c(null==t?void 0:t.readable)?null==t?void 0:t.readable:e(t.readable):void 0,writable:null!=t&&t.writable?u(null==t?void 0:t.writable)?null==t?void 0:t.writable:e(t.writable):void 0});let i=null==t?void 0:t.then;if("function"==typeof i){let e;return A(i,t,t=>{null!=t&&e.push(t),e.push(null)},t=>{v(e,t)}),e=new M({objectMode:!0,writable:!1,read(){}})}throw new g(r,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],t)}},80618:function(e,t,r){"use strict";let n;let i=r(25566),{AbortError:a,codes:o}=r(56367),{ERR_INVALID_ARG_TYPE:s,ERR_STREAM_PREMATURE_CLOSE:l}=o,{kEmptyObject:c,once:u}=r(1088),{validateAbortSignal:d,validateFunction:h,validateObject:p,validateBoolean:f}=r(62518),{Promise:m,PromisePrototypeThen:g,SymbolDispose:y}=r(56770),{isClosed:v,isReadable:b,isReadableNodeStream:_,isReadableStream:w,isReadableFinished:S,isReadableErrored:T,isWritable:x,isWritableNodeStream:E,isWritableStream:C,isWritableFinished:A,isWritableErrored:M,isNodeStream:I,willEmitClose:R,kIsClosedPromise:k}=r(96636);function P(e){return e.setHeader&&"function"==typeof e.abort}let O=()=>{};function N(e,t,o){var f,m;if(2==arguments.length?(o=t,t=c):null==t?t=c:p(t,"options"),h(o,"callback"),d(t.signal,"options.signal"),o=u(o),w(e)||C(e))return L(e,t,o);if(!I(e))throw new s("stream",["ReadableStream","WritableStream","Stream"],e);let g=null!==(f=t.readable)&&void 0!==f?f:_(e),k=null!==(m=t.writable)&&void 0!==m?m:E(e),N=e._writableState,D=e._readableState,U=()=>{e.writable||z()},F=R(e)&&_(e)===g&&E(e)===k,B=A(e,!1),z=()=>{B=!0,e.destroyed&&(F=!1),F&&(!e.readable||g)||g&&!H||o.call(e)},H=S(e,!1),j=()=>{H=!0,e.destroyed&&(F=!1),F&&(!e.writable||k)||k&&!B||o.call(e)},G=t=>{o.call(e,t)},V=v(e),q=()=>{V=!0;let t=M(e)||T(e);return t&&"boolean"!=typeof t?o.call(e,t):g&&!H&&_(e,!0)&&!S(e,!1)||k&&!B&&!A(e,!1)?o.call(e,new l):void o.call(e)},W=()=>{V=!0;let t=M(e)||T(e);if(t&&"boolean"!=typeof t)return o.call(e,t);o.call(e)},Z=()=>{e.req.on("finish",z)};P(e)?(e.on("complete",z),F||e.on("abort",q),e.req?Z():e.on("request",Z)):k&&!N&&(e.on("end",U),e.on("close",U)),F||"boolean"!=typeof e.aborted||e.on("aborted",q),e.on("end",j),e.on("finish",z),!1!==t.error&&e.on("error",G),e.on("close",q),V?i.nextTick(q):null!=N&&N.errorEmitted||null!=D&&D.errorEmitted?F||i.nextTick(W):!g&&(!F||b(e))&&(B||!1===x(e))?i.nextTick(W):!k&&(!F||x(e))&&(H||!1===b(e))?i.nextTick(W):D&&e.req&&e.aborted&&i.nextTick(W);let X=()=>{o=O,e.removeListener("aborted",q),e.removeListener("complete",z),e.removeListener("abort",q),e.removeListener("request",Z),e.req&&e.req.removeListener("finish",z),e.removeListener("end",U),e.removeListener("close",U),e.removeListener("finish",z),e.removeListener("end",j),e.removeListener("error",G),e.removeListener("close",q)};if(t.signal&&!V){let s=()=>{let r=o;X(),r.call(e,new a(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)i.nextTick(s);else{let i=(n=n||r(1088).addAbortListener)(t.signal,s),a=o;o=u((...t)=>{i[y](),a.apply(e,t)})}}return X}function L(e,t,o){let s=!1,l=O;if(t.signal){if(l=()=>{s=!0,o.call(e,new a(void 0,{cause:t.signal.reason}))},t.signal.aborted)i.nextTick(l);else{let i=(n=n||r(1088).addAbortListener)(t.signal,l),a=o;o=u((...t)=>{i[y](),a.apply(e,t)})}}let c=(...t)=>{s||i.nextTick(()=>o.apply(e,t))};return g(e[k].promise,c,c),O}function D(e,t){var r;let n=!1;return null===t&&(t=c),null!==(r=t)&&void 0!==r&&r.cleanup&&(f(t.cleanup,"cleanup"),n=t.cleanup),new m((r,i)=>{let a=N(e,t,e=>{n&&a(),e?i(e):r()})})}e.exports=N,e.exports.finished=D},97631:function(e,t,r){"use strict";let n=r(25566),{PromisePrototypeThen:i,SymbolAsyncIterator:a,SymbolIterator:o}=r(56770),{Buffer:s}=r(82957),{ERR_INVALID_ARG_TYPE:l,ERR_STREAM_NULL_VALUES:c}=r(56367).codes;function u(e,t,r){let u,d;if("string"==typeof t||t instanceof s)return new e({objectMode:!0,...r,read(){this.push(t),this.push(null)}});if(t&&t[a])d=!0,u=t[a]();else if(t&&t[o])d=!1,u=t[o]();else throw new l("iterable",["Iterable"],t);let h=new e({objectMode:!0,highWaterMark:1,...r}),p=!1;async function f(e){let t=null!=e,r="function"==typeof u.throw;if(t&&r){let{value:t,done:r}=await u.throw(e);if(await t,r)return}if("function"==typeof u.return){let{value:e}=await u.return();await e}}async function m(){for(;;){try{let{value:e,done:t}=d?await u.next():u.next();if(t)h.push(null);else{let t=e&&"function"==typeof e.then?await e:e;if(null===t)throw p=!1,new c;if(h.push(t))continue;p=!1}}catch(e){h.destroy(e)}break}}return h._read=function(){p||(p=!0,m())},h._destroy=function(e,t){i(f(e),()=>n.nextTick(t,e),r=>n.nextTick(t,r||e))},h}e.exports=u},17497:function(e,t,r){"use strict";let{ArrayIsArray:n,ObjectSetPrototypeOf:i}=r(56770),{EventEmitter:a}=r(55445);function o(e){a.call(this,e)}function s(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?n(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}i(o.prototype,a.prototype),i(o,a),o.prototype.pipe=function(e,t){let r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",i),e._isStdio||t&&!1===t.end||(r.on("end",l),r.on("close",c));let o=!1;function l(){o||(o=!0,e.end())}function c(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){d(),0===a.listenerCount(this,"error")&&this.emit("error",e)}function d(){r.removeListener("data",n),e.removeListener("drain",i),r.removeListener("end",l),r.removeListener("close",c),r.removeListener("error",u),e.removeListener("error",u),r.removeListener("end",d),r.removeListener("close",d),e.removeListener("close",d)}return s(r,"error",u),s(e,"error",u),r.on("end",d),r.on("close",d),e.on("close",d),e.emit("pipe",r),e},e.exports={Stream:o,prependListener:s}},53296:function(e,t,r){"use strict";let n=globalThis.AbortController||r(78918).AbortController,{codes:{ERR_INVALID_ARG_VALUE:i,ERR_INVALID_ARG_TYPE:a,ERR_MISSING_ARGS:o,ERR_OUT_OF_RANGE:s},AbortError:l}=r(56367),{validateAbortSignal:c,validateInteger:u,validateObject:d}=r(62518),h=r(56770).Symbol("kWeak"),p=r(56770).Symbol("kResistStopPropagation"),{finished:f}=r(80618),m=r(44581),{addAbortSignalNoValidate:g}=r(20185),{isWritable:y,isNodeStream:v}=r(96636),{deprecate:b}=r(1088),{ArrayPrototypePush:_,Boolean:w,MathFloor:S,Number:T,NumberIsNaN:x,Promise:E,PromiseReject:C,PromiseResolve:A,PromisePrototypeThen:M,Symbol:I}=r(56770),R=I("kEmpty"),k=I("kEof");function P(e,t){if(null!=t&&d(t,"options"),(null==t?void 0:t.signal)!=null&&c(t.signal,"options.signal"),v(e)&&!y(e))throw new i("stream",e,"must be writable");let r=m(this,e);return null!=t&&t.signal&&g(t.signal,r),r}function O(e,t){if("function"!=typeof e)throw new a("fn",["Function","AsyncFunction"],e);null!=t&&d(t,"options"),(null==t?void 0:t.signal)!=null&&c(t.signal,"options.signal");let n=1;(null==t?void 0:t.concurrency)!=null&&(n=S(t.concurrency));let i=n-1;return(null==t?void 0:t.highWaterMark)!=null&&(i=S(t.highWaterMark)),u(n,"options.concurrency",1),u(i,"options.highWaterMark",0),i+=n,(async function*(){let a,o;let s=r(1088).AbortSignalAny([null==t?void 0:t.signal].filter(w)),c=this,u=[],d={signal:s},h=!1,p=0;function f(){h=!0,m()}function m(){p-=1,g()}function g(){o&&!h&&p<n&&u.length<i&&(o(),o=null)}(async function(){try{for await(let t of c){if(h)return;if(s.aborted)throw new l;try{if((t=e(t,d))===R)continue;t=A(t)}catch(e){t=C(e)}p+=1,M(t,m,f),u.push(t),a&&(a(),a=null),!h&&(u.length>=i||p>=n)&&await new E(e=>{o=e})}u.push(k)}catch(t){let e=C(t);M(e,m,f),u.push(e)}finally{h=!0,a&&(a(),a=null)}})();try{for(;;){for(;u.length>0;){let e=await u[0];if(e===k)return;if(s.aborted)throw new l;e!==R&&(yield e),u.shift(),g()}await new E(e=>{a=e})}}finally{h=!0,o&&(o(),o=null)}}).call(this)}function N(e){return null!=e&&d(e,"options"),(null==e?void 0:e.signal)!=null&&c(e.signal,"options.signal"),(async function*(){let t=0;for await(let n of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new l({cause:e.signal.reason});yield[t++,n]}}).call(this)}async function L(e,t){for await(let r of B.call(this,e,t))return!0;return!1}async function D(e,t){if("function"!=typeof e)throw new a("fn",["Function","AsyncFunction"],e);return!await L.call(this,async(...t)=>!await e(...t),t)}async function U(e,t){for await(let r of B.call(this,e,t))return r}async function F(e,t){if("function"!=typeof e)throw new a("fn",["Function","AsyncFunction"],e);async function r(t,r){return await e(t,r),R}for await(let e of O.call(this,r,t));}function B(e,t){if("function"!=typeof e)throw new a("fn",["Function","AsyncFunction"],e);async function r(t,r){return await e(t,r)?t:R}return O.call(this,r,t)}class z extends o{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function H(e,t,r){var i,o;if("function"!=typeof e)throw new a("reducer",["Function","AsyncFunction"],e);null!=r&&d(r,"options"),(null==r?void 0:r.signal)!=null&&c(r.signal,"options.signal");let s=arguments.length>1;if(null!=r&&null!==(i=r.signal)&&void 0!==i&&i.aborted){let e=new l(void 0,{cause:r.signal.reason});throw this.once("error",()=>{}),await f(this.destroy(e)),e}let u=new n,m=u.signal;if(null!=r&&r.signal){let e={once:!0,[h]:this,[p]:!0};r.signal.addEventListener("abort",()=>u.abort(),e)}let g=!1;try{for await(let n of this){if(g=!0,null!=r&&null!==(o=r.signal)&&void 0!==o&&o.aborted)throw new l;s?t=await e(t,n,{signal:m}):(t=n,s=!0)}if(!g&&!s)throw new z}finally{u.abort()}return t}async function j(e){null!=e&&d(e,"options"),(null==e?void 0:e.signal)!=null&&c(e.signal,"options.signal");let t=[];for await(let n of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new l(void 0,{cause:e.signal.reason});_(t,n)}return t}function G(e,t){let r=O.call(this,e,t);return(async function*(){for await(let e of r)yield*e}).call(this)}function V(e){if(x(e=T(e)))return 0;if(e<0)throw new s("number",">= 0",e);return e}function q(e,t){return null!=t&&d(t,"options"),(null==t?void 0:t.signal)!=null&&c(t.signal,"options.signal"),e=V(e),(async function*(){var r,n;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new l;for await(let r of this){if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new l;e--<=0&&(yield r)}}).call(this)}function W(e,t){return null!=t&&d(t,"options"),(null==t?void 0:t.signal)!=null&&c(t.signal,"options.signal"),e=V(e),(async function*(){var r,n;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new l;for await(let r of this){if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new l;if(e-- >0&&(yield r),e<=0)return}}).call(this)}e.exports.streamReturningOperators={asIndexedPairs:b(N,"readable.asIndexedPairs will be removed in a future version."),drop:q,filter:B,flatMap:G,map:O,take:W,compose:P},e.exports.promiseReturningOperators={every:D,forEach:F,reduce:H,toArray:j,some:L,find:U}},87173:function(e,t,r){"use strict";let{ObjectSetPrototypeOf:n}=r(56770);e.exports=a;let i=r(18798);function a(e){if(!(this instanceof a))return new a(e);i.call(this,e)}n(a.prototype,i.prototype),n(a,i),a.prototype._transform=function(e,t,r){r(null,e)}},9237:function(e,t,r){let n,i,a;"use strict";let o=r(25566),{ArrayIsArray:s,Promise:l,SymbolAsyncIterator:c,SymbolDispose:u}=r(56770),d=r(80618),{once:h}=r(1088),p=r(28589),f=r(21544),{aggregateTwoErrors:m,codes:{ERR_INVALID_ARG_TYPE:g,ERR_INVALID_RETURN_VALUE:y,ERR_MISSING_ARGS:v,ERR_STREAM_DESTROYED:b,ERR_STREAM_PREMATURE_CLOSE:_},AbortError:w}=r(56367),{validateFunction:S,validateAbortSignal:T}=r(62518),{isIterable:x,isReadable:E,isReadableNodeStream:C,isNodeStream:A,isTransformStream:M,isWebStream:I,isReadableStream:R,isReadableFinished:k}=r(96636),P=globalThis.AbortController||r(78918).AbortController;function O(e,t,r){let n=!1;return e.on("close",()=>{n=!0}),{destroy:t=>{n||(n=!0,p.destroyer(e,t||new b("pipe")))},cleanup:d(e,{readable:t,writable:r},e=>{n=!e})}}function N(e){return S(e[e.length-1],"streams[stream.length - 1]"),e.pop()}function L(e){if(x(e))return e;if(C(e))return D(e);throw new g("val",["Readable","Iterable","AsyncIterable"],e)}async function*D(e){i||(i=r(40476)),yield*i.prototype[c].call(e)}async function U(e,t,r,{end:n}){let i;let a=null,o=e=>{if(e&&(i=e),a){let e=a;a=null,e()}},s=()=>new l((e,t)=>{i?t(i):a=()=>{i?t(i):e()}});t.on("drain",o);let c=d(t,{readable:!1},o);try{for await(let r of(t.writableNeedDrain&&await s(),e))t.write(r)||await s();n&&(t.end(),await s()),r()}catch(e){r(i!==e?m(i,e):e)}finally{c(),t.off("drain",o)}}async function F(e,t,r,{end:n}){M(t)&&(t=t.writable);let i=t.getWriter();try{for await(let t of e)await i.ready,i.write(t).catch(()=>{});await i.ready,n&&await i.close(),r()}catch(e){try{await i.abort(e),r(e)}catch(e){r(e)}}}function B(...e){return z(e,h(N(e)))}function z(e,t,i){let l,c,d,h;if(1===e.length&&s(e[0])&&(e=e[0]),e.length<2)throw new v("streams");let p=new P,m=p.signal,b=null==i?void 0:i.signal,_=[];function S(){B(new w)}T(b,"options.signal"),a=a||r(1088).addAbortListener,b&&(l=a(b,S));let k=[],N=0;function D(e){B(e,0==--N)}function B(e,r){var n;if(e&&(!c||"ERR_STREAM_PREMATURE_CLOSE"===c.code)&&(c=e),c||r){for(;k.length;)k.shift()(c);null===(n=l)||void 0===n||n[u](),p.abort(),r&&(c||_.forEach(e=>e()),o.nextTick(t,c,d))}}for(let t=0;t<e.length;t++){let a=e[t],s=t<e.length-1,l=t>0,c=s||(null==i?void 0:i.end)!==!1,u=t===e.length-1;if(A(a)){if(c){let{destroy:e,cleanup:t}=O(a,s,l);k.push(e),E(a)&&u&&_.push(t)}function z(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&D(e)}a.on("error",z),E(a)&&u&&_.push(()=>{a.removeListener("error",z)})}if(0===t){if("function"==typeof a){if(!x(h=a({signal:m})))throw new y("Iterable, AsyncIterable or Stream","source",h)}else h=x(a)||C(a)||M(a)?a:f.from(a)}else if("function"==typeof a){var j,G;if(h=a(h=M(h)?L(null===(j=h)||void 0===j?void 0:j.readable):L(h),{signal:m}),s){if(!x(h,!0))throw new y("AsyncIterable",`transform[${t-1}]`,h)}else{n||(n=r(87173));let e=new n({objectMode:!0}),t=null===(G=h)||void 0===G?void 0:G.then;if("function"==typeof t)N++,t.call(h,t=>{d=t,null!=t&&e.write(t),c&&e.end(),o.nextTick(D)},t=>{e.destroy(t),o.nextTick(D,t)});else if(x(h,!0))N++,U(h,e,D,{end:c});else if(R(h)||M(h)){let t=h.readable||h;N++,U(t,e,D,{end:c})}else throw new y("AsyncIterable or Promise","destination",h);let{destroy:i,cleanup:a}=O(h=e,!1,!0);k.push(i),u&&_.push(a)}}else if(A(a)){if(C(h)){N+=2;let e=H(h,a,D,{end:c});E(a)&&u&&_.push(e)}else if(M(h)||R(h)){let e=h.readable||h;N++,U(e,a,D,{end:c})}else if(x(h))N++,U(h,a,D,{end:c});else throw new g("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],h);h=a}else if(I(a)){if(C(h))N++,F(L(h),a,D,{end:c});else if(R(h)||x(h))N++,F(h,a,D,{end:c});else if(M(h))N++,F(h.readable,a,D,{end:c});else throw new g("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],h);h=a}else h=f.from(a)}return(null!=m&&m.aborted||null!=b&&b.aborted)&&o.nextTick(S),h}function H(e,t,r,{end:n}){let i=!1;if(t.on("close",()=>{i||r(new _)}),e.pipe(t,{end:!1}),n){function a(){i=!0,t.end()}k(e)?o.nextTick(a):e.once("end",a)}else r();return d(e,{readable:!0,writable:!1},t=>{let n=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&n&&n.ended&&!n.errored&&!n.errorEmitted?e.once("end",r).once("error",r):r(t)}),d(t,{readable:!1,writable:!0},r)}e.exports={pipelineImpl:z,pipeline:B}},40476:function(e,t,r){"use strict";let n;let i=r(25566),{ArrayPrototypeIndexOf:a,NumberIsInteger:o,NumberIsNaN:s,NumberParseInt:l,ObjectDefineProperties:c,ObjectKeys:u,ObjectSetPrototypeOf:d,Promise:h,SafeSet:p,SymbolAsyncDispose:f,SymbolAsyncIterator:m,Symbol:g}=r(56770);e.exports=el,el.ReadableState=es;let{EventEmitter:y}=r(55445),{Stream:v,prependListener:b}=r(17497),{Buffer:_}=r(82957),{addAbortSignal:w}=r(20185),S=r(80618),T=r(1088).debuglog("stream",e=>{T=e}),x=r(1381),E=r(28589),{getHighWaterMark:C,getDefaultHighWaterMark:A}=r(7181),{aggregateTwoErrors:M,codes:{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:R,ERR_OUT_OF_RANGE:k,ERR_STREAM_PUSH_AFTER_EOF:P,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:O},AbortError:N}=r(56367),{validateObject:L}=r(62518),D=g("kPaused"),{StringDecoder:U}=r(64582),F=r(97631);d(el.prototype,v.prototype),d(el,v);let B=()=>{},{errorOrDestroy:z}=E,H=1,j=2,G=4,V=8,q=16,W=32,Z=64,X=128,$=256,K=512,Y=1024,Q=2048,J=4096,ee=8192,et=16384,er=32768,en=65536,ei=131072,ea=262144;function eo(e){return{enumerable:!1,get(){return(this.state&e)!=0},set(t){t?this.state|=e:this.state&=~e}}}function es(e,t,n){"boolean"!=typeof n&&(n=t instanceof r(21544)),this.state=Q|J|q|W,e&&e.objectMode&&(this.state|=H),n&&e&&e.readableObjectMode&&(this.state|=H),this.highWaterMark=e?C(this,e,"readableHighWaterMark",n):A(!1),this.buffer=new x,this.length=0,this.pipes=[],this.flowing=null,this[D]=null,e&&!1===e.emitClose&&(this.state&=~Q),e&&!1===e.autoDestroy&&(this.state&=~J),this.errored=null,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new U(e.encoding),this.encoding=e.encoding)}function el(e){if(!(this instanceof el))return new el(e);let t=this instanceof r(21544);this._readableState=new es(e,this,t),e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&!t&&w(e.signal,this)),v.call(this,e),E.construct(this,()=>{this._readableState.needReadable&&ey(this,this._readableState)})}function ec(e,t,r,n){let i;T("readableAddChunk",t);let a=e._readableState;if((a.state&H)==0&&("string"==typeof t?(r=r||a.defaultEncoding,a.encoding!==r&&(n&&a.encoding?t=_.from(t,r).toString(a.encoding):(t=_.from(t,r),r=""))):t instanceof _?r="":v._isUint8Array(t)?(t=v._uint8ArrayToBuffer(t),r=""):null!=t&&(i=new I("chunk",["string","Buffer","Uint8Array"],t))),i)z(e,i);else if(null===t)a.state&=~V,ef(e,a);else if((a.state&H)!=0||t&&t.length>0){if(n){if((a.state&G)!=0)z(e,new O);else{if(a.destroyed||a.errored)return!1;eu(e,a,t,!0)}}else if(a.ended)z(e,new P);else{if(a.destroyed||a.errored)return!1;a.state&=~V,a.decoder&&!r?(t=a.decoder.write(t),a.objectMode||0!==t.length?eu(e,a,t,!1):ey(e,a)):eu(e,a,t,!1)}}else n||(a.state&=~V,ey(e,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function eu(e,t,r,n){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?((t.state&en)!=0?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),(t.state&Z)!=0&&em(e)),ey(e,t)}c(es.prototype,{objectMode:eo(H),ended:eo(j),endEmitted:eo(G),reading:eo(V),constructed:eo(q),sync:eo(W),needReadable:eo(Z),emittedReadable:eo(X),readableListening:eo($),resumeScheduled:eo(K),errorEmitted:eo(Y),emitClose:eo(Q),autoDestroy:eo(J),destroyed:eo(ee),closed:eo(et),closeEmitted:eo(er),multiAwaitDrain:eo(en),readingMore:eo(ei),dataEmitted:eo(ea)}),el.prototype.destroy=E.destroy,el.prototype._undestroy=E.undestroy,el.prototype._destroy=function(e,t){t(e)},el.prototype[y.captureRejectionSymbol]=function(e){this.destroy(e)},el.prototype[f]=function(){let e;return this.destroyed||(e=this.readableEnded?null:new N,this.destroy(e)),new h((t,r)=>S(this,n=>n&&n!==e?r(n):t(null)))},el.prototype.push=function(e,t){return ec(this,e,t,!1)},el.prototype.unshift=function(e,t){return ec(this,e,t,!0)},el.prototype.isPaused=function(){let e=this._readableState;return!0===e[D]||!1===e.flowing},el.prototype.setEncoding=function(e){let t=new U(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;let r=this._readableState.buffer,n="";for(let e of r)n+=t.write(e);return r.clear(),""!==n&&r.push(n),this._readableState.length=n.length,this};let ed=1073741824;function eh(e){if(e>ed)throw new k("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}function ep(e,t){return e<=0||0===t.length&&t.ended?0:(t.state&H)!=0?1:s(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function ef(e,t){if(T("onEofChunk"),!t.ended){if(t.decoder){let e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?em(e):(t.needReadable=!1,t.emittedReadable=!0,eg(e))}}function em(e){let t=e._readableState;T("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(T("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(eg,e))}function eg(e){let t=e._readableState;T("emitReadable_",t.destroyed,t.length,t.ended),!t.destroyed&&!t.errored&&(t.length||t.ended)&&(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,ex(e)}function ey(e,t){!t.readingMore&&t.constructed&&(t.readingMore=!0,i.nextTick(ev,e,t))}function ev(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){let r=t.length;if(T("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function eb(e,t){return function(){let r=e._readableState;r.awaitDrainWriters===t?(T("pipeOnDrain",1),r.awaitDrainWriters=null):r.multiAwaitDrain&&(T("pipeOnDrain",r.awaitDrainWriters.size),r.awaitDrainWriters.delete(t)),(!r.awaitDrainWriters||0===r.awaitDrainWriters.size)&&e.listenerCount("data")&&e.resume()}}function e_(e){let t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[D]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function ew(e){T("readable nexttick read 0"),e.read(0)}function eS(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(eT,e,t))}function eT(e,t){T("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),ex(e),t.flowing&&!t.reading&&e.read(0)}function ex(e){let t=e._readableState;for(T("flow",t.flowing);t.flowing&&null!==e.read(););}function eE(e,t){"function"!=typeof e.read&&(e=el.wrap(e,{objectMode:!0}));let r=eC(e,t);return r.stream=e,r}async function*eC(e,t){let r,n=B;function i(t){this===e?(n(),n=B):n=t}e.on("readable",i);let a=S(e,{writable:!1},e=>{r=e?M(r,e):null,n(),n=B});try{for(;;){let t=e.destroyed?null:e.read();if(null!==t)yield t;else if(r)throw r;else{if(null===r)return;await new h(i)}}}catch(e){throw r=M(r,e)}finally{(r||(null==t?void 0:t.destroyOnReturn)!==!1)&&(void 0===r||e._readableState.autoDestroy)?E.destroyer(e,null):(e.off("readable",i),a())}}function eA(e,t){let r;return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r)}function eM(e){let t=e._readableState;T("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(eI,t,e))}function eI(e,t){if(T("endReadableNT",e.endEmitted,e.length),!e.errored&&!e.closeEmitted&&!e.endEmitted&&0===e.length){if(e.endEmitted=!0,t.emit("end"),t.writable&&!1===t.allowHalfOpen)i.nextTick(eR,t);else if(e.autoDestroy){let e=t._writableState;(!e||e.autoDestroy&&(e.finished||!1===e.writable))&&t.destroy()}}}function eR(e){!e.writable||e.writableEnded||e.destroyed||e.end()}function ek(){return void 0===n&&(n={}),n}el.prototype.read=function(e){let t;T("read",e),void 0===e?e=NaN:o(e)||(e=l(e,10));let r=this._readableState,n=e;if(e>r.highWaterMark&&(r.highWaterMark=eh(e)),0!==e&&(r.state&=~X),0===e&&r.needReadable&&((0!==r.highWaterMark?r.length>=r.highWaterMark:r.length>0)||r.ended))return T("read: emitReadable",r.length,r.ended),0===r.length&&r.ended?eM(this):em(this),null;if(0===(e=ep(e,r))&&r.ended)return 0===r.length&&eM(this),null;let i=(r.state&Z)!=0;if(T("need readable",i),(0===r.length||r.length-e<r.highWaterMark)&&T("length less than watermark",i=!0),r.ended||r.reading||r.destroyed||r.errored||!r.constructed)T("reading, ended or constructing",i=!1);else if(i){T("do read"),r.state|=V|W,0===r.length&&(r.state|=Z);try{this._read(r.highWaterMark)}catch(e){z(this,e)}r.state&=~W,r.reading||(e=ep(n,r))}return null===(t=e>0?eA(e,r):null)?(r.needReadable=r.length<=r.highWaterMark,e=0):(r.length-=e,r.multiAwaitDrain?r.awaitDrainWriters.clear():r.awaitDrainWriters=null),0===r.length&&(r.ended||(r.needReadable=!0),n!==e&&r.ended&&eM(this)),null===t||r.errorEmitted||r.closeEmitted||(r.dataEmitted=!0,this.emit("data",t)),t},el.prototype._read=function(e){throw new R("_read()")},el.prototype.pipe=function(e,t){let r;let n=this,a=this._readableState;1!==a.pipes.length||a.multiAwaitDrain||(a.multiAwaitDrain=!0,a.awaitDrainWriters=new p(a.awaitDrainWriters?[a.awaitDrainWriters]:[])),a.pipes.push(e),T("pipe count=%d opts=%j",a.pipes.length,t);let o=t&&!1===t.end||e===i.stdout||e===i.stderr?y:l;function s(e,t){T("onunpipe"),e===n&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,u())}function l(){T("onend"),e.end()}a.endEmitted?i.nextTick(o):n.once("end",o),e.on("unpipe",s);let c=!1;function u(){T("cleanup"),e.removeListener("close",m),e.removeListener("finish",g),r&&e.removeListener("drain",r),e.removeListener("error",f),e.removeListener("unpipe",s),n.removeListener("end",l),n.removeListener("end",y),n.removeListener("data",h),c=!0,r&&a.awaitDrainWriters&&(!e._writableState||e._writableState.needDrain)&&r()}function d(){c||(1===a.pipes.length&&a.pipes[0]===e?(T("false write response, pause",0),a.awaitDrainWriters=e,a.multiAwaitDrain=!1):a.pipes.length>1&&a.pipes.includes(e)&&(T("false write response, pause",a.awaitDrainWriters.size),a.awaitDrainWriters.add(e)),n.pause()),r||(r=eb(n,e),e.on("drain",r))}function h(t){T("ondata");let r=e.write(t);T("dest.write",r),!1===r&&d()}function f(t){if(T("onerror",t),y(),e.removeListener("error",f),0===e.listenerCount("error")){let r=e._writableState||e._readableState;r&&!r.errorEmitted?z(e,t):e.emit("error",t)}}function m(){e.removeListener("finish",g),y()}function g(){T("onfinish"),e.removeListener("close",m),y()}function y(){T("unpipe"),n.unpipe(e)}return n.on("data",h),b(e,"error",f),e.once("close",m),e.once("finish",g),e.emit("pipe",n),!0===e.writableNeedDrain?d():a.flowing||(T("pipe resume"),n.resume()),e},el.prototype.unpipe=function(e){let t=this._readableState,r={hasUnpiped:!1};if(0===t.pipes.length)return this;if(!e){let e=t.pipes;t.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}let n=a(t.pipes,e);return -1===n||(t.pipes.splice(n,1),0===t.pipes.length&&this.pause(),e.emit("unpipe",this,r)),this},el.prototype.on=function(e,t){let r=v.prototype.on.call(this,e,t),n=this._readableState;return"data"===e?(n.readableListening=this.listenerCount("readable")>0,!1!==n.flowing&&this.resume()):"readable"!==e||n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,T("on readable",n.length,n.reading),n.length?em(this):n.reading||i.nextTick(ew,this)),r},el.prototype.addListener=el.prototype.on,el.prototype.removeListener=function(e,t){let r=v.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(e_,this),r},el.prototype.off=el.prototype.removeListener,el.prototype.removeAllListeners=function(e){let t=v.prototype.removeAllListeners.apply(this,arguments);return("readable"===e||void 0===e)&&i.nextTick(e_,this),t},el.prototype.resume=function(){let e=this._readableState;return e.flowing||(T("resume"),e.flowing=!e.readableListening,eS(this,e)),e[D]=!1,this},el.prototype.pause=function(){return T("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(T("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[D]=!0,this},el.prototype.wrap=function(e){let t=!1;e.on("data",r=>{!this.push(r)&&e.pause&&(t=!0,e.pause())}),e.on("end",()=>{this.push(null)}),e.on("error",e=>{z(this,e)}),e.on("close",()=>{this.destroy()}),e.on("destroy",()=>{this.destroy()}),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};let r=u(e);for(let t=1;t<r.length;t++){let n=r[t];void 0===this[n]&&"function"==typeof e[n]&&(this[n]=e[n].bind(e))}return this},el.prototype[m]=function(){return eE(this)},el.prototype.iterator=function(e){return void 0!==e&&L(e,"options"),eE(this,e)},c(el.prototype,{readable:{__proto__:null,get(){let e=this._readableState;return!!e&&!1!==e.readable&&!e.destroyed&&!e.errorEmitted&&!e.endEmitted},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(!1!==this._readableState.readable&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),c(es.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[D]},set(e){this[D]=!!e}}}),el._fromList=eA,el.from=function(e,t){return F(el,e,t)},el.fromWeb=function(e,t){return ek().newStreamReadableFromReadableStream(e,t)},el.toWeb=function(e,t){return ek().newReadableStreamFromStreamReadable(e,t)},el.wrap=function(e,t){var r,n;return new el({objectMode:null===(r=null!==(n=e.readableObjectMode)&&void 0!==n?n:e.objectMode)||void 0===r||r,...t,destroy(t,r){E.destroyer(e,t),r(t)}}).wrap(e)}},7181:function(e,t,r){"use strict";let{MathFloor:n,NumberIsInteger:i}=r(56770),{validateInteger:a}=r(62518),{ERR_INVALID_ARG_VALUE:o}=r(56367).codes,s=16384,l=16;function c(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}function u(e){return e?l:s}function d(e,t){a(t,"value",0),e?l=t:s=t}function h(e,t,r,a){let s=c(t,a,r);if(null!=s){if(!i(s)||s<0)throw new o(a?`options.${r}`:"options.highWaterMark",s);return n(s)}return u(e.objectMode)}e.exports={getHighWaterMark:h,getDefaultHighWaterMark:u,setDefaultHighWaterMark:d}},18798:function(e,t,r){"use strict";let{ObjectSetPrototypeOf:n,Symbol:i}=r(56770);e.exports=c;let{ERR_METHOD_NOT_IMPLEMENTED:a}=r(56367).codes,o=r(21544),{getHighWaterMark:s}=r(7181);n(c.prototype,o.prototype),n(c,o);let l=i("kCallback");function c(e){if(!(this instanceof c))return new c(e);let t=e?s(this,e,"readableHighWaterMark",!0):null;0===t&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),o.call(this,e),this._readableState.sync=!1,this[l]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",d)}function u(e){"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush((t,r)=>{if(t){e?e(t):this.destroy(t);return}null!=r&&this.push(r),this.push(null),e&&e()})}function d(){this._final!==u&&u.call(this)}c.prototype._final=u,c.prototype._transform=function(e,t,r){throw new a("_transform()")},c.prototype._write=function(e,t,r){let n=this._readableState,i=this._writableState,a=n.length;this._transform(e,t,(e,t)=>{if(e){r(e);return}null!=t&&this.push(t),i.ended||a===n.length||n.length<n.highWaterMark?r():this[l]=r})},c.prototype._read=function(){if(this[l]){let e=this[l];this[l]=null,e()}}},96636:function(e,t,r){"use strict";let{SymbolAsyncIterator:n,SymbolIterator:i,SymbolFor:a}=r(56770),o=a("nodejs.stream.destroyed"),s=a("nodejs.stream.errored"),l=a("nodejs.stream.readable"),c=a("nodejs.stream.writable"),u=a("nodejs.stream.disturbed"),d=a("nodejs.webstream.isClosedPromise"),h=a("nodejs.webstream.controllerErrorFunction");function p(e,t=!1){var r;return!!(e&&"function"==typeof e.pipe&&"function"==typeof e.on&&(!t||"function"==typeof e.pause&&"function"==typeof e.resume)&&(!e._writableState||(null===(r=e._readableState)||void 0===r?void 0:r.readable)!==!1)&&(!e._writableState||e._readableState))}function f(e){var t;return!!(e&&"function"==typeof e.write&&"function"==typeof e.on&&(!e._readableState||(null===(t=e._writableState)||void 0===t?void 0:t.writable)!==!1))}function m(e){return!!(e&&"function"==typeof e.pipe&&e._readableState&&"function"==typeof e.on&&"function"==typeof e.write)}function g(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function y(e){return!!(e&&!g(e)&&"function"==typeof e.pipeThrough&&"function"==typeof e.getReader&&"function"==typeof e.cancel)}function v(e){return!!(e&&!g(e)&&"function"==typeof e.getWriter&&"function"==typeof e.abort)}function b(e){return!!(e&&!g(e)&&"object"==typeof e.readable&&"object"==typeof e.writable)}function _(e){return y(e)||v(e)||b(e)}function w(e,t){return null!=e&&(!0===t?"function"==typeof e[n]:!1===t?"function"==typeof e[i]:"function"==typeof e[n]||"function"==typeof e[i])}function S(e){if(!g(e))return null;let t=e._writableState,r=e._readableState,n=t||r;return!!(e.destroyed||e[o]||null!=n&&n.destroyed)}function T(e){if(!f(e))return null;if(!0===e.writableEnded)return!0;let t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function x(e,t){if(!f(e))return null;if(!0===e.writableFinished)return!0;let r=e._writableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.finished)?null:!!(r.finished||!1===t&&!0===r.ended&&0===r.length))}function E(e){if(!p(e))return null;if(!0===e.readableEnded)return!0;let t=e._readableState;return!!t&&!t.errored&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function C(e,t){if(!p(e))return null;let r=e._readableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.endEmitted)?null:!!(r.endEmitted||!1===t&&!0===r.ended&&0===r.length))}function A(e){return e&&null!=e[l]?e[l]:"boolean"!=typeof(null==e?void 0:e.readable)?null:!S(e)&&p(e)&&e.readable&&!C(e)}function M(e){return e&&null!=e[c]?e[c]:"boolean"!=typeof(null==e?void 0:e.writable)?null:!S(e)&&f(e)&&e.writable&&!T(e)}function I(e,t){return g(e)?!!S(e)||!((null==t?void 0:t.readable)!==!1&&A(e)||(null==t?void 0:t.writable)!==!1&&M(e)):null}function R(e){var t,r;return g(e)?e.writableErrored?e.writableErrored:null!==(t=null===(r=e._writableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null}function k(e){var t,r;return g(e)?e.readableErrored?e.readableErrored:null!==(t=null===(r=e._readableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null}function P(e){if(!g(e))return null;if("boolean"==typeof e.closed)return e.closed;let t=e._writableState,r=e._readableState;return"boolean"==typeof(null==t?void 0:t.closed)||"boolean"==typeof(null==r?void 0:r.closed)?(null==t?void 0:t.closed)||(null==r?void 0:r.closed):"boolean"==typeof e._closed&&O(e)?e._closed:null}function O(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}function N(e){return"boolean"==typeof e._sent100&&O(e)}function L(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)===void 0}function D(e){if(!g(e))return null;let t=e._writableState,r=e._readableState,n=t||r;return!n&&N(e)||!!(n&&n.autoDestroy&&n.emitClose&&!1===n.closed)}function U(e){var t;return!!(e&&(null!==(t=e[u])&&void 0!==t?t:e.readableDidRead||e.readableAborted))}function F(e){var t,r,n,i,a,o,l,c,u,d;return!!(e&&(null!==(t=null!==(r=null!==(n=null!==(i=null!==(a=null!==(o=e[s])&&void 0!==o?o:e.readableErrored)&&void 0!==a?a:e.writableErrored)&&void 0!==i?i:null===(l=e._readableState)||void 0===l?void 0:l.errorEmitted)&&void 0!==n?n:null===(c=e._writableState)||void 0===c?void 0:c.errorEmitted)&&void 0!==r?r:null===(u=e._readableState)||void 0===u?void 0:u.errored)&&void 0!==t?t:null===(d=e._writableState)||void 0===d?void 0:d.errored))}e.exports={isDestroyed:S,kIsDestroyed:o,isDisturbed:U,kIsDisturbed:u,isErrored:F,kIsErrored:s,isReadable:A,kIsReadable:l,kIsClosedPromise:d,kControllerErrorFunction:h,kIsWritable:c,isClosed:P,isDuplexNodeStream:m,isFinished:I,isIterable:w,isReadableNodeStream:p,isReadableStream:y,isReadableEnded:E,isReadableFinished:C,isReadableErrored:k,isNodeStream:g,isWebStream:_,isWritable:M,isWritableNodeStream:f,isWritableStream:v,isWritableEnded:T,isWritableFinished:x,isWritableErrored:R,isServerRequest:L,isServerResponse:N,willEmitClose:D,isTransformStream:b}},76243:function(e,t,r){"use strict";let n;let i=r(25566),{ArrayPrototypeSlice:a,Error:o,FunctionPrototypeSymbolHasInstance:s,ObjectDefineProperty:l,ObjectDefineProperties:c,ObjectSetPrototypeOf:u,StringPrototypeToLowerCase:d,Symbol:h,SymbolHasInstance:p}=r(56770);e.exports=L,L.WritableState=O;let{EventEmitter:f}=r(55445),m=r(17497).Stream,{Buffer:g}=r(82957),y=r(28589),{addAbortSignal:v}=r(20185),{getHighWaterMark:b,getDefaultHighWaterMark:_}=r(7181),{ERR_INVALID_ARG_TYPE:w,ERR_METHOD_NOT_IMPLEMENTED:S,ERR_MULTIPLE_CALLBACK:T,ERR_STREAM_CANNOT_PIPE:x,ERR_STREAM_DESTROYED:E,ERR_STREAM_ALREADY_FINISHED:C,ERR_STREAM_NULL_VALUES:A,ERR_STREAM_WRITE_AFTER_END:M,ERR_UNKNOWN_ENCODING:I}=r(56367).codes,{errorOrDestroy:R}=y;function k(){}u(L.prototype,m.prototype),u(L,m);let P=h("kOnFinished");function O(e,t,n){"boolean"!=typeof n&&(n=t instanceof r(21544)),this.objectMode=!!(e&&e.objectMode),n&&(this.objectMode=this.objectMode||!!(e&&e.writableObjectMode)),this.highWaterMark=e?b(this,e,"writableHighWaterMark",n):_(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let i=!!(e&&!1===e.decodeStrings);this.decodeStrings=!i,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=z.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,N(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[P]=[]}function N(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function L(e){let t=this instanceof r(21544);if(!t&&!s(L,this))return new L(e);this._writableState=new O(e,this,t),e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&v(e.signal,this)),m.call(this,e),y.construct(this,()=>{let e=this._writableState;e.writing||V(this,e),X(this,e)})}function D(e,t,r,n){let a;let o=e._writableState;if("function"==typeof r)n=r,r=o.defaultEncoding;else{if(r){if("buffer"!==r&&!g.isEncoding(r))throw new I(r)}else r=o.defaultEncoding;"function"!=typeof n&&(n=k)}if(null===t)throw new A;if(!o.objectMode){if("string"==typeof t)!1!==o.decodeStrings&&(t=g.from(t,r),r="buffer");else if(t instanceof g)r="buffer";else if(m._isUint8Array(t))t=m._uint8ArrayToBuffer(t),r="buffer";else throw new w("chunk",["string","Buffer","Uint8Array"],t)}return(o.ending?a=new M:o.destroyed&&(a=new E("write")),a)?(i.nextTick(n,a),R(e,a,!0),a):(o.pendingcb++,U(e,o,t,r,n))}function U(e,t,r,n,i){let a=t.objectMode?1:r.length;t.length+=a;let o=t.length<t.highWaterMark;return o||(t.needDrain=!0),t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:r,encoding:n,callback:i}),t.allBuffers&&"buffer"!==n&&(t.allBuffers=!1),t.allNoop&&i!==k&&(t.allNoop=!1)):(t.writelen=a,t.writecb=i,t.writing=!0,t.sync=!0,e._write(r,n,t.onwrite),t.sync=!1),o&&!t.errored&&!t.destroyed}function F(e,t,r,n,i,a,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new E("write")):r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function B(e,t,r,n){--t.pendingcb,n(r),G(t),R(e,r)}function z(e,t){let r=e._writableState,n=r.sync,a=r.writecb;if("function"!=typeof a){R(e,new T);return}r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0,t?(t.stack,r.errored||(r.errored=t),e._readableState&&!e._readableState.errored&&(e._readableState.errored=t),n?i.nextTick(B,e,r,t,a):B(e,r,t,a)):(r.buffered.length>r.bufferedIndex&&V(e,r),n?null!==r.afterWriteTickInfo&&r.afterWriteTickInfo.cb===a?r.afterWriteTickInfo.count++:(r.afterWriteTickInfo={count:1,cb:a,stream:e,state:r},i.nextTick(H,r.afterWriteTickInfo)):j(e,r,1,a))}function H({stream:e,state:t,count:r,cb:n}){return t.afterWriteTickInfo=null,j(e,t,r,n)}function j(e,t,r,n){for(t.ending||e.destroyed||0!==t.length||!t.needDrain||(t.needDrain=!1,e.emit("drain"));r-- >0;)t.pendingcb--,n();t.destroyed&&G(t),X(e,t)}function G(e){var t,r;if(e.writing)return;for(let r=e.bufferedIndex;r<e.buffered.length;++r){let{chunk:n,callback:i}=e.buffered[r],a=e.objectMode?1:n.length;e.length-=a,i(null!==(t=e.errored)&&void 0!==t?t:new E("write"))}let n=e[P].splice(0);for(let t=0;t<n.length;t++)n[t](null!==(r=e.errored)&&void 0!==r?r:new E("end"));N(e)}function V(e,t){if(t.corked||t.bufferProcessing||t.destroyed||!t.constructed)return;let{buffered:r,bufferedIndex:n,objectMode:i}=t,o=r.length-n;if(!o)return;let s=n;if(t.bufferProcessing=!0,o>1&&e._writev){t.pendingcb-=o-1;let n=t.allNoop?k:e=>{for(let t=s;t<r.length;++t)r[t].callback(e)},i=t.allNoop&&0===s?r:a(r,s);i.allBuffers=t.allBuffers,F(e,t,!0,t.length,i,"",n),N(t)}else{do{let{chunk:n,encoding:a,callback:o}=r[s];r[s++]=null,F(e,t,!1,i?1:n.length,n,a,o)}while(s<r.length&&!t.writing);s===r.length?N(t):s>256?(r.splice(0,s),t.bufferedIndex=0):t.bufferedIndex=s}t.bufferProcessing=!1}function q(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function W(e,t){let r=!1;function n(n){if(r){R(e,null!=n?n:T());return}if(r=!0,t.pendingcb--,n){let r=t[P].splice(0);for(let e=0;e<r.length;e++)r[e](n);R(e,n,t.sync)}else q(t)&&(t.prefinished=!0,e.emit("prefinish"),t.pendingcb++,i.nextTick($,e,t))}t.sync=!0,t.pendingcb++;try{e._final(n)}catch(e){n(e)}t.sync=!1}function Z(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.finalCalled=!0,W(e,t)))}function X(e,t,r){q(t)&&(Z(e,t),0===t.pendingcb&&(r?(t.pendingcb++,i.nextTick((e,t)=>{q(t)?$(e,t):t.pendingcb--},e,t)):q(t)&&(t.pendingcb++,$(e,t))))}function $(e,t){t.pendingcb--,t.finished=!0;let r=t[P].splice(0);for(let e=0;e<r.length;e++)r[e]();if(e.emit("finish"),t.autoDestroy){let t=e._readableState;(!t||t.autoDestroy&&(t.endEmitted||!1===t.readable))&&e.destroy()}}O.prototype.getBuffer=function(){return a(this.buffered,this.bufferedIndex)},l(O.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),l(L,p,{__proto__:null,value:function(e){return!!s(this,e)||this===L&&e&&e._writableState instanceof O}}),L.prototype.pipe=function(){R(this,new x)},L.prototype.write=function(e,t,r){return!0===D(this,e,t,r)},L.prototype.cork=function(){this._writableState.corked++},L.prototype.uncork=function(){let e=this._writableState;e.corked&&(e.corked--,e.writing||V(this,e))},L.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=d(e)),!g.isEncoding(e))throw new I(e);return this._writableState.defaultEncoding=e,this},L.prototype._write=function(e,t,r){if(this._writev)this._writev([{chunk:e,encoding:t}],r);else throw new S("_write()")},L.prototype._writev=null,L.prototype.end=function(e,t,r){let n;let a=this._writableState;if("function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e){let r=D(this,e,t);r instanceof o&&(n=r)}return a.corked&&(a.corked=1,this.uncork()),n||(a.errored||a.ending?a.finished?n=new C("end"):a.destroyed&&(n=new E("end")):(a.ending=!0,X(this,a,!0),a.ended=!0)),"function"==typeof r&&(n||a.finished?i.nextTick(r,n):a[P].push(r)),this},c(L.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get(){let e=this._writableState;return!!e&&!1!==e.writable&&!e.destroyed&&!e.errored&&!e.ending&&!e.ended},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){let e=this._writableState;return!!e&&!e.destroyed&&!e.ending&&e.needDrain}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(!1!==this._writableState.writable&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});let K=y.destroy;function Y(){return void 0===n&&(n={}),n}L.prototype.destroy=function(e,t){let r=this._writableState;return!r.destroyed&&(r.bufferedIndex<r.buffered.length||r[P].length)&&i.nextTick(G,r),K.call(this,e,t),this},L.prototype._undestroy=y.undestroy,L.prototype._destroy=function(e,t){t(e)},L.prototype[f.captureRejectionSymbol]=function(e){this.destroy(e)},L.fromWeb=function(e,t){return Y().newStreamWritableFromWritableStream(e,t)},L.toWeb=function(e){return Y().newWritableStreamFromStreamWritable(e)}},62518:function(e,t,r){"use strict";let{ArrayIsArray:n,ArrayPrototypeIncludes:i,ArrayPrototypeJoin:a,ArrayPrototypeMap:o,NumberIsInteger:s,NumberIsNaN:l,NumberMAX_SAFE_INTEGER:c,NumberMIN_SAFE_INTEGER:u,NumberParseInt:d,ObjectPrototypeHasOwnProperty:h,RegExpPrototypeExec:p,String:f,StringPrototypeToUpperCase:m,StringPrototypeTrim:g}=r(56770),{hideStackFrames:y,codes:{ERR_SOCKET_BAD_PORT:v,ERR_INVALID_ARG_TYPE:b,ERR_INVALID_ARG_VALUE:_,ERR_OUT_OF_RANGE:w,ERR_UNKNOWN_SIGNAL:S}}=r(56367),{normalizeEncoding:T}=r(1088),{isAsyncFunction:x,isArrayBufferView:E}=r(1088).types,C={};function A(e){return e===(0|e)}function M(e){return e===e>>>0}let I=/^[0-7]+$/,R="must be a 32-bit unsigned integer or an octal string";function k(e,t,r){if(void 0===e&&(e=r),"string"==typeof e){if(null===p(I,e))throw new _(t,e,R);e=d(e,8)}return N(e,t),e}let P=y((e,t,r=u,n=c)=>{if("number"!=typeof e)throw new b(t,"number",e);if(!s(e))throw new w(t,"an integer",e);if(e<r||e>n)throw new w(t,`>= ${r} && <= ${n}`,e)}),O=y((e,t,r=-2147483648,n=2147483647)=>{if("number"!=typeof e)throw new b(t,"number",e);if(!s(e))throw new w(t,"an integer",e);if(e<r||e>n)throw new w(t,`>= ${r} && <= ${n}`,e)}),N=y((e,t,r=!1)=>{if("number"!=typeof e)throw new b(t,"number",e);if(!s(e))throw new w(t,"an integer",e);let n=r?1:0,i=4294967295;if(e<n||e>i)throw new w(t,`>= ${n} && <= ${i}`,e)});function L(e,t){if("string"!=typeof e)throw new b(t,"string",e)}function D(e,t,r,n){if("number"!=typeof e)throw new b(t,"number",e);if(null!=r&&e<r||null!=n&&e>n||(null!=r||null!=n)&&l(e))throw new w(t,`${null!=r?`>= ${r}`:""}${null!=r&&null!=n?" && ":""}${null!=n?`<= ${n}`:""}`,e)}let U=y((e,t,r)=>{if(!i(r,e))throw new _(t,e,"must be one of: "+a(o(r,e=>"string"==typeof e?`'${e}'`:f(e)),", "))});function F(e,t){if("boolean"!=typeof e)throw new b(t,"boolean",e)}function B(e,t,r){return null!=e&&h(e,t)?e[t]:r}let z=y((e,t,r=null)=>{let i=B(r,"allowArray",!1),a=B(r,"allowFunction",!1);if(!B(r,"nullable",!1)&&null===e||!i&&n(e)||"object"!=typeof e&&(!a||"function"!=typeof e))throw new b(t,"Object",e)}),H=y((e,t)=>{if(null!=e&&"object"!=typeof e&&"function"!=typeof e)throw new b(t,"a dictionary",e)}),j=y((e,t,r=0)=>{if(!n(e))throw new b(t,"Array",e);if(e.length<r)throw new _(t,e,`must be longer than ${r}`)});function G(e,t){j(e,t);for(let r=0;r<e.length;r++)L(e[r],`${t}[${r}]`)}function V(e,t){j(e,t);for(let r=0;r<e.length;r++)F(e[r],`${t}[${r}]`)}function q(e,t){j(e,t);for(let r=0;r<e.length;r++){let n=e[r],i=`${t}[${r}]`;if(null==n)throw new b(i,"AbortSignal",n);K(n,i)}}function W(e,t="signal"){if(L(e,t),void 0===C[e]){if(void 0!==C[m(e)])throw new S(e+" (signals must use all capital letters)");throw new S(e)}}let Z=y((e,t="buffer")=>{if(!E(e))throw new b(t,["Buffer","TypedArray","DataView"],e)});function X(e,t){let r=T(t),n=e.length;if("hex"===r&&n%2!=0)throw new _("encoding",t,`is invalid for data of length ${n}`)}function $(e,t="Port",r=!0){if("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===g(e).length||+e!=+e>>>0||e>65535||0===e&&!r)throw new v(t,e,r);return 0|e}let K=y((e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new b(t,"AbortSignal",e)}),Y=y((e,t)=>{if("function"!=typeof e)throw new b(t,"Function",e)}),Q=y((e,t)=>{if("function"!=typeof e||x(e))throw new b(t,"Function",e)}),J=y((e,t)=>{if(void 0!==e)throw new b(t,"undefined",e)});function ee(e,t,r){if(!i(r,e))throw new b(t,`('${a(r,"|")}')`,e)}let et=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function er(e,t){if(void 0===e||!p(et,e))throw new _(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function en(e){if("string"==typeof e)return er(e,"hints"),e;if(n(e)){let t=e.length,r="";if(0===t)return r;for(let n=0;n<t;n++){let i=e[n];er(i,"hints"),r+=i,n!==t-1&&(r+=", ")}return r}throw new _("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}e.exports={isInt32:A,isUint32:M,parseFileMode:k,validateArray:j,validateStringArray:G,validateBooleanArray:V,validateAbortSignalArray:q,validateBoolean:F,validateBuffer:Z,validateDictionary:H,validateEncoding:X,validateFunction:Y,validateInt32:O,validateInteger:P,validateNumber:D,validateObject:z,validateOneOf:U,validatePlainFunction:Q,validatePort:$,validateSignalName:W,validateString:L,validateUint32:N,validateUndefined:J,validateUnion:ee,validateAbortSignal:K,validateLinkHeaderValue:en}},80578:function(e,t,r){"use strict";let n=r(78674),i=r(99557),a=n.Readable.destroy;e.exports=n.Readable,e.exports._uint8ArrayToBuffer=n._uint8ArrayToBuffer,e.exports._isUint8Array=n._isUint8Array,e.exports.isDisturbed=n.isDisturbed,e.exports.isErrored=n.isErrored,e.exports.isReadable=n.isReadable,e.exports.Readable=n.Readable,e.exports.Writable=n.Writable,e.exports.Duplex=n.Duplex,e.exports.Transform=n.Transform,e.exports.PassThrough=n.PassThrough,e.exports.addAbortSignal=n.addAbortSignal,e.exports.finished=n.finished,e.exports.destroy=n.destroy,e.exports.destroy=a,e.exports.pipeline=n.pipeline,e.exports.compose=n.compose,Object.defineProperty(n,"promises",{configurable:!0,enumerable:!0,get:()=>i}),e.exports.Stream=n.Stream,e.exports.default=e.exports},56367:function(e,t,r){"use strict";let{format:n,inspect:i}=r(54618),{AggregateError:a}=r(56770),o=globalThis.AggregateError||a,s=Symbol("kIsNodeError"),l=["string","function","number","object","Function","Object","boolean","bigint","symbol"],c=/^([A-Z][a-z0-9]*)+$/,u="__node_internal_",d={};function h(e,t){if(!e)throw new d.ERR_INTERNAL_ASSERTION(t)}function p(e){let t="",r=e.length,n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function f(e,t,r){if("function"==typeof t)return h(t.length<=r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${t.length}).`),t(...r);let i=(t.match(/%[dfijoOs]/g)||[]).length;return(h(i===r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${i}).`),0===r.length)?t:n(t,...r)}function m(e,t,r){r||(r=Error);class n extends r{constructor(...r){super(f(e,t,r))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(n.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=e,n.prototype[s]=!0,d[e]=n}function g(e){let t=u+e.name;return Object.defineProperty(e,"name",{value:t}),e}function y(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;let r=new o([t,e],t.message);return r.code=t.code,r}return e||t}class v extends Error{constructor(e="The operation was aborted",t){if(void 0!==t&&"object"!=typeof t)throw new d.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}}m("ERR_ASSERTION","%s",Error),m("ERR_INVALID_ARG_TYPE",(e,t,r)=>{h("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let n="The ";e.endsWith(" argument")?n+=`${e} `:n+=`"${e}" ${e.includes(".")?"property":"argument"} `,n+="must be ";let a=[],o=[],s=[];for(let e of t)h("string"==typeof e,"All expected entries have to be of type string"),l.includes(e)?a.push(e.toLowerCase()):c.test(e)?o.push(e):(h("object"!==e,'The value "object" should be written as "Object"'),s.push(e));if(o.length>0){let e=a.indexOf("object");-1!==e&&(a.splice(a,e,1),o.push("Object"))}if(a.length>0){switch(a.length){case 1:n+=`of type ${a[0]}`;break;case 2:n+=`one of type ${a[0]} or ${a[1]}`;break;default:{let e=a.pop();n+=`one of type ${a.join(", ")}, or ${e}`}}(o.length>0||s.length>0)&&(n+=" or ")}if(o.length>0){switch(o.length){case 1:n+=`an instance of ${o[0]}`;break;case 2:n+=`an instance of ${o[0]} or ${o[1]}`;break;default:{let e=o.pop();n+=`an instance of ${o.join(", ")}, or ${e}`}}s.length>0&&(n+=" or ")}switch(s.length){case 0:break;case 1:s[0].toLowerCase()!==s[0]&&(n+="an "),n+=`${s[0]}`;break;case 2:n+=`one of ${s[0]} or ${s[1]}`;break;default:{let e=s.pop();n+=`one of ${s.join(", ")}, or ${e}`}}if(null==r)n+=`. Received ${r}`;else if("function"==typeof r&&r.name)n+=`. Received function ${r.name}`;else if("object"==typeof r){var u;if(null!==(u=r.constructor)&&void 0!==u&&u.name)n+=`. Received an instance of ${r.constructor.name}`;else{let e=i(r,{depth:-1});n+=`. Received ${e}`}}else{let e=i(r,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),n+=`. Received type ${typeof r} (${e})`}return n},TypeError),m("ERR_INVALID_ARG_VALUE",(e,t,r="is invalid")=>{let n=i(t);n.length>128&&(n=n.slice(0,128)+"...");let a=e.includes(".")?"property":"argument";return`The ${a} '${e}' ${r}. Received ${n}`},TypeError),m("ERR_INVALID_RETURN_VALUE",(e,t,r)=>{var n;let i=null!=r&&null!==(n=r.constructor)&&void 0!==n&&n.name?`instance of ${r.constructor.name}`:`type ${typeof r}`;return`Expected ${e} to be returned from the "${t}" function but got ${i}.`},TypeError),m("ERR_MISSING_ARGS",(...e)=>{let t;h(e.length>0,"At least one arg needs to be specified");let r=e.length;switch(e=(Array.isArray(e)?e:[e]).map(e=>`"${e}"`).join(" or "),r){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{let r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}}return`${t} must be specified`},TypeError),m("ERR_OUT_OF_RANGE",(e,t,r)=>{let n;if(h(t,'Missing "range" argument'),Number.isInteger(r)&&Math.abs(r)>4294967296)n=p(String(r));else if("bigint"==typeof r){n=String(r);let e=BigInt(2)**BigInt(32);(r>e||r<-e)&&(n=p(n)),n+="n"}else n=i(r);return`The value of "${e}" is out of range. It must be ${t}. Received ${n}`},RangeError),m("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),m("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),m("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),m("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),m("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),m("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),m("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),m("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),m("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),m("ERR_STREAM_WRITE_AFTER_END","write after end",Error),m("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),e.exports={AbortError:v,aggregateTwoErrors:g(y),hideStackFrames:g,codes:d}},56770:function(e){"use strict";class t extends Error{constructor(e){if(!Array.isArray(e))throw TypeError(`Expected input to be an Array, got ${typeof e}`);let t="";for(let r=0;r<e.length;r++)t+=`    ${e[r].stack}
`;super(t),this.name="AggregateError",this.errors=e}}e.exports={AggregateError:t,ArrayIsArray:e=>Array.isArray(e),ArrayPrototypeIncludes:(e,t)=>e.includes(t),ArrayPrototypeIndexOf:(e,t)=>e.indexOf(t),ArrayPrototypeJoin:(e,t)=>e.join(t),ArrayPrototypeMap:(e,t)=>e.map(t),ArrayPrototypePop:(e,t)=>e.pop(t),ArrayPrototypePush:(e,t)=>e.push(t),ArrayPrototypeSlice:(e,t,r)=>e.slice(t,r),Error,FunctionPrototypeCall:(e,t,...r)=>e.call(t,...r),FunctionPrototypeSymbolHasInstance:(e,t)=>Function.prototype[Symbol.hasInstance].call(e,t),MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(e,t)=>Object.defineProperties(e,t),ObjectDefineProperty:(e,t,r)=>Object.defineProperty(e,t,r),ObjectGetOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e,t),ObjectKeys:e=>Object.keys(e),ObjectSetPrototypeOf:(e,t)=>Object.setPrototypeOf(e,t),Promise,PromisePrototypeCatch:(e,t)=>e.catch(t),PromisePrototypeThen:(e,t,r)=>e.then(t,r),PromiseReject:e=>Promise.reject(e),PromiseResolve:e=>Promise.resolve(e),ReflectApply:Reflect.apply,RegExpPrototypeTest:(e,t)=>e.test(t),SafeSet:Set,String,StringPrototypeSlice:(e,t,r)=>e.slice(t,r),StringPrototypeToLowerCase:e=>e.toLowerCase(),StringPrototypeToUpperCase:e=>e.toUpperCase(),StringPrototypeTrim:e=>e.trim(),Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet:(e,t,r)=>e.set(t,r),Boolean,Uint8Array}},1088:function(e,t,r){"use strict";let n=r(82957),{format:i,inspect:a}=r(54618),{codes:{ERR_INVALID_ARG_TYPE:o}}=r(56367),{kResistStopPropagation:s,AggregateError:l,SymbolDispose:c}=r(56770),AbortSignal=globalThis.AbortSignal||r(78918).AbortSignal,u=globalThis.AbortController||r(78918).AbortController,d=Object.getPrototypeOf(async function(){}).constructor,h=globalThis.Blob||n.Blob,p=void 0!==h?function(e){return e instanceof h}:function(e){return!1},f=(e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new o(t,"AbortSignal",e)},m=(e,t)=>{if("function"!=typeof e)throw new o(t,"Function",e)};e.exports={AggregateError:l,kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(...r){t||(t=!0,e.apply(this,r))}},createDeferredPromise:function(){let e,t;return{promise:new Promise((r,n)=>{e=r,t=n}),resolve:e,reject:t}},promisify:e=>new Promise((t,r)=>{e((e,...n)=>e?r(e):t(...n))}),debuglog:()=>function(){},format:i,inspect:a,types:{isAsyncFunction:e=>e instanceof d,isArrayBufferView:e=>ArrayBuffer.isView(e)},isBlob:p,deprecate:(e,t)=>e,addAbortListener:r(55445).addAbortListener||function(e,t){let r;if(void 0===e)throw new o("signal","AbortSignal",e);return f(e,"signal"),m(t,"listener"),e.aborted?queueMicrotask(()=>t()):(e.addEventListener("abort",t,{__proto__:null,once:!0,[s]:!0}),r=()=>{e.removeEventListener("abort",t)}),{__proto__:null,[c](){var e;null===(e=r)||void 0===e||e()}}},AbortSignalAny:AbortSignal.any||function(e){if(1===e.length)return e[0];let t=new u,r=()=>t.abort();return e.forEach(e=>{f(e,"signals"),e.addEventListener("abort",r,{once:!0})}),t.signal.addEventListener("abort",()=>{e.forEach(e=>e.removeEventListener("abort",r))},{once:!0}),t.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},54618:function(e){"use strict";e.exports={format:(e,...t)=>e.replace(/%([sdifj])/g,function(...[e,r]){let n=t.shift();if("f"===r)return n.toFixed(6);if("j"===r)return JSON.stringify(n);if("s"!==r||"object"!=typeof n)return n.toString();{let e=n.constructor!==Object?n.constructor.name:"";return`${e} {}`.trim()}}),inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return`"${e}"`;if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}return`'${e}'`;case"number":if(isNaN(e))return"NaN";if(Object.is(e,-0))return String(e);return e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}}},78674:function(e,t,r){"use strict";let{Buffer:n}=r(82957),{ObjectDefineProperty:i,ObjectKeys:a,ReflectApply:o}=r(56770),{promisify:{custom:s}}=r(1088),{streamReturningOperators:l,promiseReturningOperators:c}=r(53296),{codes:{ERR_ILLEGAL_CONSTRUCTOR:u}}=r(56367),d=r(44581),{setDefaultHighWaterMark:h,getDefaultHighWaterMark:p}=r(7181),{pipeline:f}=r(9237),{destroyer:m}=r(28589),g=r(80618),y=r(99557),v=r(96636),b=e.exports=r(17497).Stream;for(let e of(b.isDestroyed=v.isDestroyed,b.isDisturbed=v.isDisturbed,b.isErrored=v.isErrored,b.isReadable=v.isReadable,b.isWritable=v.isWritable,b.Readable=r(40476),a(l))){let t=l[e];function _(...e){if(new.target)throw u();return b.Readable.from(o(t,this,e))}i(_,"name",{__proto__:null,value:t.name}),i(_,"length",{__proto__:null,value:t.length}),i(b.Readable.prototype,e,{__proto__:null,value:_,enumerable:!1,configurable:!0,writable:!0})}for(let e of a(c)){let t=c[e];function w(...e){if(new.target)throw u();return o(t,this,e)}i(w,"name",{__proto__:null,value:t.name}),i(w,"length",{__proto__:null,value:t.length}),i(b.Readable.prototype,e,{__proto__:null,value:w,enumerable:!1,configurable:!0,writable:!0})}b.Writable=r(76243),b.Duplex=r(21544),b.Transform=r(18798),b.PassThrough=r(87173),b.pipeline=f;let{addAbortSignal:S}=r(20185);b.addAbortSignal=S,b.finished=g,b.destroy=m,b.compose=d,b.setDefaultHighWaterMark=h,b.getDefaultHighWaterMark=p,i(b,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>y}),i(f,s,{__proto__:null,enumerable:!0,get:()=>y.pipeline}),i(g,s,{__proto__:null,enumerable:!0,get:()=>y.finished}),b.Stream=b,b._isUint8Array=function(e){return e instanceof Uint8Array},b._uint8ArrayToBuffer=function(e){return n.from(e.buffer,e.byteOffset,e.byteLength)}},99557:function(e,t,r){"use strict";let{ArrayPrototypePop:n,Promise:i}=r(56770),{isIterable:a,isNodeStream:o,isWebStream:s}=r(96636),{pipelineImpl:l}=r(9237),{finished:c}=r(80618);function u(...e){return new i((t,r)=>{let i,c;let u=e[e.length-1];if(u&&"object"==typeof u&&!o(u)&&!a(u)&&!s(u)){let t=n(e);i=t.signal,c=t.end}l(e,(e,n)=>{e?r(e):t(n)},{signal:i,end:c})})}r(78674),e.exports={finished:c,pipeline:u}},73306:function(e,t,r){var n=r(82957),i=n.Buffer;function a(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=o),o.prototype=Object.create(i.prototype),a(i,o),o.from=function(e,t,r){if("number"==typeof e)throw TypeError("Argument must not be a number");return i(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw TypeError("Argument must be a number");return n.SlowBuffer(e)}},77213:function(e,t){"use strict";function r(e,t){var r=e.length;for(e.push(t);0<r;){var n=r-1>>>1,i=e[n];if(0<a(i,t))e[n]=t,e[r]=i,r=n;else break}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;for(var n=0,i=e.length,o=i>>>1;n<o;){var s=2*(n+1)-1,l=e[s],c=s+1,u=e[c];if(0>a(l,r))c<i&&0>a(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[s]=r,n=s);else if(c<i&&0>a(u,r))e[n]=u,e[c]=r,n=c;else break}}return t}function a(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var o,s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();t.unstable_now=function(){return l.now()-c}}var u=[],d=[],h=1,p=null,f=3,m=!1,g=!1,y=!1,v="function"==typeof setTimeout?setTimeout:null,b="function"==typeof clearTimeout?clearTimeout:null,_="undefined"!=typeof setImmediate?setImmediate:null;function w(e){for(var t=n(d);null!==t;){if(null===t.callback)i(d);else if(t.startTime<=e)i(d),t.sortIndex=t.expirationTime,r(u,t);else break;t=n(d)}}function S(e){if(y=!1,w(e),!g){if(null!==n(u))g=!0,O(T);else{var t=n(d);null!==t&&N(S,t.startTime-e)}}}function T(e,r){g=!1,y&&(y=!1,b(C),C=-1),m=!0;var a=f;try{for(w(r),p=n(u);null!==p&&(!(p.expirationTime>r)||e&&!I());){var o=p.callback;if("function"==typeof o){p.callback=null,f=p.priorityLevel;var s=o(p.expirationTime<=r);r=t.unstable_now(),"function"==typeof s?p.callback=s:p===n(u)&&i(u),w(r)}else i(u);p=n(u)}if(null!==p)var l=!0;else{var c=n(d);null!==c&&N(S,c.startTime-r),l=!1}return l}finally{p=null,f=a,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var x=!1,E=null,C=-1,A=5,M=-1;function I(){return!(t.unstable_now()-M<A)}function R(){if(null!==E){var e=t.unstable_now();M=e;var r=!0;try{r=E(!0,e)}finally{r?o():(x=!1,E=null)}}else x=!1}if("function"==typeof _)o=function(){_(R)};else if("undefined"!=typeof MessageChannel){var k=new MessageChannel,P=k.port2;k.port1.onmessage=R,o=function(){P.postMessage(null)}}else o=function(){v(R,0)};function O(e){E=e,x||(x=!0,o())}function N(e,r){C=v(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,O(T))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?o+a:o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return s=a+s,e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:s,sortIndex:-1},a>o?(e.sortIndex=a,r(d,e),null===n(u)&&e===n(d)&&(y?(b(C),C=-1):y=!0,N(S,a-o))):(e.sortIndex=s,r(u,e),g||m||(g=!0,O(T))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},16697:function(e,t,r){"use strict";e.exports=r(77213)},64582:function(e,t,r){"use strict";var n=r(73306).Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;if(!e)return"utf8";for(;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function o(e){var t=a(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw Error("Unknown encoding: "+e);return t||e}function s(e){var t;switch(this.encoding=o(e),this.encoding){case"utf16le":this.text=f,this.end=m,t=4;break;case"utf8":this.fillLast=d,t=4;break;case"base64":this.text=g,this.end=y,t=3;break;default:this.write=v,this.end=b;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function l(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function c(e,t,r){var n=t.length-1;if(n<r)return 0;var i=l(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||-2===i?0:(i=l(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||-2===i?0:(i=l(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}function u(e,t,r){if((192&t[0])!=128)return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if((192&t[1])!=128)return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&(192&t[2])!=128)return e.lastNeed=2,""}}function d(e){var t=this.lastTotal-this.lastNeed,r=u(this,e,t);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):void(e.copy(this.lastChar,t,0,e.length),this.lastNeed-=e.length)}function h(e,t){var r=c(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)}function p(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t}function f(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function m(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function g(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function y(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function v(e){return e.toString(this.encoding)}function b(e){return e&&e.length?this.write(e):""}t.StringDecoder=s,s.prototype.write=function(e){var t,r;if(0===e.length)return"";if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},s.prototype.end=p,s.prototype.text=h,s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},25488:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractTokenizer=void 0;let i=r(93763);class a{constructor(e){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=e||{}}async readToken(e,t=this.position){let r=n.alloc(e.len);if(await this.readBuffer(r,{position:t})<e.len)throw new i.EndOfStreamError;return e.get(r,0)}async peekToken(e,t=this.position){let r=n.alloc(e.len);if(await this.peekBuffer(r,{position:t})<e.len)throw new i.EndOfStreamError;return e.get(r,0)}async readNumber(e){if(await this.readBuffer(this.numBuffer,{length:e.len})<e.len)throw new i.EndOfStreamError;return e.get(this.numBuffer,0)}async peekNumber(e){if(await this.peekBuffer(this.numBuffer,{length:e.len})<e.len)throw new i.EndOfStreamError;return e.get(this.numBuffer,0)}async ignore(e){if(void 0!==this.fileInfo.size){let t=this.fileInfo.size-this.position;if(e>t)return this.position+=t,t}return this.position+=e,e}async close(){}normalizeOptions(e,t){if(t&&void 0!==t.position&&t.position<this.position)throw Error("`options.position` must be equal or greater than `tokenizer.position`");return t?{mayBeLess:!0===t.mayBeLess,offset:t.offset?t.offset:0,length:t.length?t.length:e.length-(t.offset?t.offset:0),position:t.position?t.position:this.position}:{mayBeLess:!1,offset:0,length:e.length,position:this.position}}}t.AbstractTokenizer=a},81158:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BufferTokenizer=void 0;let n=r(93763),i=r(25488);class a extends i.AbstractTokenizer{constructor(e,t){super(t),this.uint8Array=e,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:e.length}async readBuffer(e,t){if(t&&t.position){if(t.position<this.position)throw Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=t.position}let r=await this.peekBuffer(e,t);return this.position+=r,r}async peekBuffer(e,t){let r=this.normalizeOptions(e,t),i=Math.min(this.uint8Array.length-r.position,r.length);if(r.mayBeLess||!(i<r.length))return e.set(this.uint8Array.subarray(r.position,r.position+i),r.offset),i;throw new n.EndOfStreamError}async close(){}}t.BufferTokenizer=a},8378:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadStreamTokenizer=void 0;let n=r(25488),i=r(93763),a=256e3;class o extends n.AbstractTokenizer{constructor(e,t){super(t),this.streamReader=new i.StreamReader(e)}async getFileInfo(){return this.fileInfo}async readBuffer(e,t){let r=this.normalizeOptions(e,t),n=r.position-this.position;if(n>0)return await this.ignore(n),this.readBuffer(e,t);if(n<0)throw Error("`options.position` must be equal or greater than `tokenizer.position`");if(0===r.length)return 0;let a=await this.streamReader.read(e,r.offset,r.length);if(this.position+=a,(!t||!t.mayBeLess)&&a<r.length)throw new i.EndOfStreamError;return a}async peekBuffer(e,t){let r=this.normalizeOptions(e,t),n=0;if(r.position){let t=r.position-this.position;if(t>0){let i=new Uint8Array(r.length+t);return n=await this.peekBuffer(i,{mayBeLess:r.mayBeLess}),e.set(i.subarray(t),r.offset),n-t}if(t<0)throw Error("Cannot peek from a negative offset in a stream")}if(r.length>0){try{n=await this.streamReader.peek(e,r.offset,r.length)}catch(e){if(t&&t.mayBeLess&&e instanceof i.EndOfStreamError)return 0;throw e}if(!r.mayBeLess&&n<r.length)throw new i.EndOfStreamError}return n}async ignore(e){let t=Math.min(a,e),r=new Uint8Array(t),n=0;for(;n<e;){let i=e-n,a=await this.readBuffer(r,{length:Math.min(t,i)});if(a<0)return a;n+=a}return n}}t.ReadStreamTokenizer=o},61232:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromBuffer=t.fromStream=t.EndOfStreamError=void 0;let n=r(8378),i=r(81158);var a=r(93763);function o(e,t){return t=t||{},new n.ReadStreamTokenizer(e,t)}function s(e,t){return new i.BufferTokenizer(e,t)}Object.defineProperty(t,"EndOfStreamError",{enumerable:!0,get:function(){return a.EndOfStreamError}}),t.fromStream=o,t.fromBuffer=s},32235:function(e,t,r){"use strict";var n=r(82957).Buffer;Object.defineProperty(t,"__esModule",{value:!0}),t.AnsiStringType=t.StringType=t.BufferType=t.Uint8ArrayType=t.IgnoreType=t.Float80_LE=t.Float80_BE=t.Float64_LE=t.Float64_BE=t.Float32_LE=t.Float32_BE=t.Float16_LE=t.Float16_BE=t.INT64_BE=t.UINT64_BE=t.INT64_LE=t.UINT64_LE=t.INT32_LE=t.INT32_BE=t.INT24_BE=t.INT24_LE=t.INT16_LE=t.INT16_BE=t.INT8=t.UINT32_BE=t.UINT32_LE=t.UINT24_BE=t.UINT24_LE=t.UINT16_BE=t.UINT16_LE=t.UINT8=void 0;let i=r(68848);function a(e){return new DataView(e.buffer,e.byteOffset)}t.UINT8={len:1,get:(e,t)=>a(e).getUint8(t),put:(e,t,r)=>(a(e).setUint8(t,r),t+1)},t.UINT16_LE={len:2,get:(e,t)=>a(e).getUint16(t,!0),put:(e,t,r)=>(a(e).setUint16(t,r,!0),t+2)},t.UINT16_BE={len:2,get:(e,t)=>a(e).getUint16(t),put:(e,t,r)=>(a(e).setUint16(t,r),t+2)},t.UINT24_LE={len:3,get(e,t){let r=a(e);return r.getUint8(t)+(r.getUint16(t+1,!0)<<8)},put(e,t,r){let n=a(e);return n.setUint8(t,255&r),n.setUint16(t+1,r>>8,!0),t+3}},t.UINT24_BE={len:3,get(e,t){let r=a(e);return(r.getUint16(t)<<8)+r.getUint8(t+2)},put(e,t,r){let n=a(e);return n.setUint16(t,r>>8),n.setUint8(t+2,255&r),t+3}},t.UINT32_LE={len:4,get:(e,t)=>a(e).getUint32(t,!0),put:(e,t,r)=>(a(e).setUint32(t,r,!0),t+4)},t.UINT32_BE={len:4,get:(e,t)=>a(e).getUint32(t),put:(e,t,r)=>(a(e).setUint32(t,r),t+4)},t.INT8={len:1,get:(e,t)=>a(e).getInt8(t),put:(e,t,r)=>(a(e).setInt8(t,r),t+1)},t.INT16_BE={len:2,get:(e,t)=>a(e).getInt16(t),put:(e,t,r)=>(a(e).setInt16(t,r),t+2)},t.INT16_LE={len:2,get:(e,t)=>a(e).getInt16(t,!0),put:(e,t,r)=>(a(e).setInt16(t,r,!0),t+2)},t.INT24_LE={len:3,get(e,r){let n=t.UINT24_LE.get(e,r);return n>8388607?n-16777216:n},put(e,t,r){let n=a(e);return n.setUint8(t,255&r),n.setUint16(t+1,r>>8,!0),t+3}},t.INT24_BE={len:3,get(e,r){let n=t.UINT24_BE.get(e,r);return n>8388607?n-16777216:n},put(e,t,r){let n=a(e);return n.setUint16(t,r>>8),n.setUint8(t+2,255&r),t+3}},t.INT32_BE={len:4,get:(e,t)=>a(e).getInt32(t),put:(e,t,r)=>(a(e).setInt32(t,r),t+4)},t.INT32_LE={len:4,get:(e,t)=>a(e).getInt32(t,!0),put:(e,t,r)=>(a(e).setInt32(t,r,!0),t+4)},t.UINT64_LE={len:8,get:(e,t)=>a(e).getBigUint64(t,!0),put:(e,t,r)=>(a(e).setBigUint64(t,r,!0),t+8)},t.INT64_LE={len:8,get:(e,t)=>a(e).getBigInt64(t,!0),put:(e,t,r)=>(a(e).setBigInt64(t,r,!0),t+8)},t.UINT64_BE={len:8,get:(e,t)=>a(e).getBigUint64(t),put:(e,t,r)=>(a(e).setBigUint64(t,r),t+8)},t.INT64_BE={len:8,get:(e,t)=>a(e).getBigInt64(t),put:(e,t,r)=>(a(e).setBigInt64(t,r),t+8)},t.Float16_BE={len:2,get(e,t){return i.read(e,t,!1,10,this.len)},put(e,t,r){return i.write(e,r,t,!1,10,this.len),t+this.len}},t.Float16_LE={len:2,get(e,t){return i.read(e,t,!0,10,this.len)},put(e,t,r){return i.write(e,r,t,!0,10,this.len),t+this.len}},t.Float32_BE={len:4,get:(e,t)=>a(e).getFloat32(t),put:(e,t,r)=>(a(e).setFloat32(t,r),t+4)},t.Float32_LE={len:4,get:(e,t)=>a(e).getFloat32(t,!0),put:(e,t,r)=>(a(e).setFloat32(t,r,!0),t+4)},t.Float64_BE={len:8,get:(e,t)=>a(e).getFloat64(t),put:(e,t,r)=>(a(e).setFloat64(t,r),t+8)},t.Float64_LE={len:8,get:(e,t)=>a(e).getFloat64(t,!0),put:(e,t,r)=>(a(e).setFloat64(t,r,!0),t+8)},t.Float80_BE={len:10,get(e,t){return i.read(e,t,!1,63,this.len)},put(e,t,r){return i.write(e,r,t,!1,63,this.len),t+this.len}},t.Float80_LE={len:10,get(e,t){return i.read(e,t,!0,63,this.len)},put(e,t,r){return i.write(e,r,t,!0,63,this.len),t+this.len}};class o{constructor(e){this.len=e}get(e,t){}}t.IgnoreType=o;class s{constructor(e){this.len=e}get(e,t){return e.subarray(t,t+this.len)}}t.Uint8ArrayType=s;class l{constructor(e){this.len=e}get(e,t){return n.from(e.subarray(t,t+this.len))}}t.BufferType=l;class c{constructor(e,t){this.len=e,this.encoding=t}get(e,t){return n.from(e).toString(this.encoding,t,t+this.len)}}t.StringType=c;class u{constructor(e){this.len=e}static decode(e,t,r){let n="";for(let i=t;i<r;++i)n+=u.codePointToString(u.singleByteDecoder(e[i]));return n}static inRange(e,t,r){return t<=e&&e<=r}static codePointToString(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(((e-=65536)>>10)+55296,(1023&e)+56320)}static singleByteDecoder(e){if(u.inRange(e,0,127))return e;let t=u.windows1252[e-128];if(null===t)throw Error("invaliding encoding");return t}get(e,t=0){return u.decode(e,t,t+this.len)}}t.AnsiStringType=u,u.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},64571:function(e,t,r){"use strict";r.d(t,{b:function(){return s}});var n=r(81595),i=r(1899),a=r(5002),o=r(2265);let s=e=>{let{text:t,variant:r,color:s,sx:l,typographySx:c,fadeWidth:u=8}=e,d=(0,o.useRef)(null),h=(0,o.useRef)(null),p=(0,o.useRef)(null),[f,m]=(0,o.useState)(!1),g=(0,o.useCallback)(()=>{if(!d.current||!p.current)return;let e=d.current.offsetWidth,t=p.current.offsetWidth;for(let r of[d,h]){if(!r.current)continue;let n=r.current.style;if(e<=t&&(n.animation="none",n.setProperty("--marquee-animation-play-state","none")),e>t){let t=n.getPropertyValue("--marquee-animation-play-state");("none"===t||""===t)&&(n.animation="marquee ".concat(e/16,"s linear infinite"),n.setProperty("--marquee-animation-play-state","running"))}}if(h.current){let r=h.current.style;e<=t?(r.display="none",m(!1)):(r.display="block",m(!0))}},[]);return(0,o.useEffect)(()=>{let e=new ResizeObserver(e=>{g()});return p.current&&e.observe(p.current),()=>{e.disconnect()}},[g]),(0,o.useEffect)(()=>{g()},[t,g]),(0,n.BX)(i.Z,{component:"div",sx:{...l,overflow:"hidden",display:"flex",flexDirection:"row",...f&&{maskImage:"linear-gradient(to right, transparent 0, black ".concat(u,"px, black calc(100% - ").concat(u,"px), transparent 100%)")}},ref:p,children:[(0,n.tZ)(a.Z,{ref:d,color:s,variant:r,sx:{whiteSpace:"nowrap","@keyframes marquee":{"0%":{transform:"translateX(0%)"},"100%":{transform:"translateX(calc(-100% - 80px))"}},...c},children:t}),(0,n.tZ)(a.Z,{ref:h,color:s,variant:r,sx:{whiteSpace:"nowrap",ml:10,"@keyframes marquee":{"0%":{transform:"translateX(0%)"},"100%":{transform:"translateX(calc(-100% - 80px))"}},...c},children:t})]})}},78567:function(e,t,r){"use strict";r.d(t,{N:function(){return l}});var n=r(81595),i=r(94630),a=r(57437),o=(0,i.Z)((0,a.jsx)("path",{d:"M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3z"}),"Audiotrack"),s=r(32088);let l=r(2265).forwardRef(function(e,t){return(0,n.tZ)(s.Z,{ref:t,src:e.coverUrl,variant:"rounded",sx:{width:48,height:48,borderRadius:"10%",...e.sx,bgcolor:"rgba(255, 255, 255, 0.15)"},onClick:e.onClick,children:e.coverUrl?null:(0,n.tZ)(o,{sx:{width:"50%",height:"50%",color:"rgba(255, 255, 255, 0.7)"}})})})},2016:function(e,t,r){"use strict";r.d(t,{Ek:function(){return o},dh:function(){return a},fu:function(){return n}});let n={aac:{mimeType:"audio/aac"},mp3:{mimeType:"audio/mpeg"},ogg:{mimeType:"audio/ogg"},wav:{mimeType:"audio/wav"},flac:{mimeType:"audio/flac"},m4a:{mimeType:"audio/mp4"}},i="drive.config";function a(e){localStorage.setItem(i,JSON.stringify(e))}function o(){let e=localStorage.getItem(i);return e?JSON.parse(e):null}},64085:function(e,t,r){"use strict";r.d(t,{c3:function(){return m},dv:function(){return g},j1:function(){return f}});var n=r(81595),i=r(2016),a=r(64654),o=r(94013);let s="googleDrive.userInfo",l="googleDrive.accessToken",c="googleDrive.refreshToken",u="googleDrive.tokenExpires",d="636784171461-qe09gc3cupq8iagds8hk16cb6k6cvle4.apps.googleusercontent.com",h="AIzaSyDnV3ERZBz85HEqzGKXWIoNw79YEC8MsYQ",p="636784171461";function f(e){localStorage.setItem(l,e)}function m(e){localStorage.setItem(s,e)}async function g(){let e,t,r;console.log("createGoogleDriveClient");let f="".concat(window.location.origin).concat("/cloud-music-box","/redirect/google-drive"),m=()=>new Promise(e=>{if(window.gapi){e();return}let t=document.createElement("script");t.src="https://apis.google.com/js/api.js",t.onload=()=>{window.gapi.load("client",async()=>{await window.gapi.client.init({discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]}),e()})},document.head.appendChild(t)}),g=()=>new Promise(e=>{var t;if(null===(t=window.google)||void 0===t?void 0:t.picker){e();return}window.gapi.load("picker",()=>{e()})}),y=async()=>{let t=new URLSearchParams({client_id:d,redirect_uri:f,response_type:"token id_token",scope:"https://www.googleapis.com/auth/drive.file",include_granted_scopes:"true",nonce:Math.random().toString(36)});e?t.append("login_hint",e):t.append("prompt","select_account");let r="https://accounts.google.com/o/oauth2/v2/auth?".concat(t.toString());window.location.href=r},v=()=>{let e=e=>(0,n.BX)(n.HY,{children:[(0,n.tZ)(o.Z,{color:"error",onClick:()=>{y(),(0,a.sy)(e)},children:"Reauthorize"}),(0,n.tZ)(o.Z,{color:"error",onClick:()=>{(0,a.sy)(e)},children:"Dismiss"})]});(0,a.yv)("Requires reauthorization to access the drive",{variant:"error",persist:!0,action:e})};async function b(e){try{return await e()}catch(e){if(console.warn("API call failed",e),401===e.status||403===e.status)throw v(),Error("Drive requires reauthorization");throw e}}function _(e){var t,r,n,a,o,s;if("application/vnd.google-apps.folder"===e.mimeType)return{name:e.name||"",id:e.id||"",type:"folder",parentId:(null===(a=e.parents)||void 0===a?void 0:a[0])||""};let l=(null===(r=e.name)||void 0===r?void 0:null===(t=r.split(".").pop())||void 0===t?void 0:t.toLowerCase())||"",c=null===(n=i.fu[l])||void 0===n?void 0:n.mimeType;return void 0!==c?{name:e.name||"",id:e.id||"",type:"audio-track",parentId:(null===(o=e.parents)||void 0===o?void 0:o[0])||"",mimeType:c}:{name:e.name||"",id:e.id||"",type:"file",parentId:(null===(s=e.parents)||void 0===s?void 0:s[0])||""}}let w=()=>{let e=localStorage.getItem(u);if(!e)return!1;let t=3e5;return Date.now()<parseInt(e)-t},S=async()=>{e=localStorage.getItem(s)||void 0,t=localStorage.getItem(l)||void 0,r=localStorage.getItem(c)||void 0,console.log("Google Drive Client initialized",e)};return await S(),{userInfo:e,async resetUser(){e=void 0,t=void 0,localStorage.removeItem(s),localStorage.removeItem(l),localStorage.removeItem(u),localStorage.removeItem(c),window.gapi.client.setToken(null)},async loginRedirect(){await y()},saveAccessToken(e){localStorage.setItem(l,e)},async connect(){if(await m(),!t)throw Error("No access token available");if(!window.gapi)throw Error("GAPI client not loaded");window.gapi.client.setToken({access_token:t})},async openFilesPicker(e){if(await m(),await g(),!t)throw Error("No access token available for Picker");if(!w())throw v(),Error("Access token expired, reauthorization required");return new Promise((r,n)=>{try{let n=new window.google.picker.DocsView().setIncludeFolders(!0).setParent(e||"root");new window.google.picker.PickerBuilder().addView(n).enableFeature(window.google.picker.Feature.MULTISELECT_ENABLED).setOAuthToken(t).setDeveloperKey(h).setAppId(p).setCallback(e=>{if(e.action===window.google.picker.Action.PICKED){console.log("Picker data:",e);let t=e.docs.map(e=>{var t;return{id:e.id,name:e.name,mimeType:e.mimeType,parentId:e.parentId||(null===(t=e.parents)||void 0===t?void 0:t[0])||e.parent||void 0}});r(t)}else e.action===window.google.picker.Action.CANCEL&&r([])}).build().setVisible(!0)}catch(e){n(e)}})},async openFolderPicker(e){if(await m(),await g(),!t)throw Error("No access token available for Picker");if(!w())throw v(),Error("Access token expired, reauthorization required");return new Promise((r,n)=>{try{let n=new window.google.picker.DocsView().setIncludeFolders(!0).setMimeTypes("application/vnd.google-apps.folder").setSelectFolderEnabled(!0);console.log("Setting fileIds (string format):",e),n.setFileIds(e),new window.google.picker.PickerBuilder().addView(n).setOAuthToken(t).setDeveloperKey(h).setAppId(p).setTitle("").setCallback(t=>{if(t.action===window.google.picker.Action.PICKED){var n;let i=t.docs[0];console.log("Folder selected:",i),i.id===e?console.log(" Correct folder selected!"):console.warn(" Different folder selected. Expected:",e,"Got:",i.id),r({id:i.id,name:i.name,mimeType:i.mimeType,parentId:i.parentId||(null===(n=i.parents)||void 0===n?void 0:n[0])||void 0})}else t.action===window.google.picker.Action.CANCEL&&r(null)}).build().setVisible(!0)}catch(e){n(e)}})},async checkFolderAccess(e){try{let r=await fetch("https://www.googleapis.com/drive/v3/files/".concat(e,"?fields=name"),{headers:{Authorization:"Bearer ".concat(t)}});if(r.ok){let e=await r.json();return{hasAccess:!0,folderName:e.name}}if(401===r.status||403===r.status)return console.warn("Token invalid (401/403), requesting reauthorization"),v(),{hasAccess:!1};if(404===r.status)return{hasAccess:!1};throw Error("Failed to check folder access: ".concat(r.statusText))}catch(e){return console.error("Error checking folder access:",e),{hasAccess:!1}}},getRootFolderId:async()=>"root",async getFile(e){throw Error("getFile is not supported in Picker mode. Use file-store instead.")},getChildren:async e=>b(async()=>{console.log("Attempting to list children of folder: ".concat(e));try{let t=await window.gapi.client.drive.files.list({q:"'".concat(e,"' in parents and trashed=false"),fields:"files(id, name, mimeType, parents)",pageSize:256,orderBy:"folder,name"});console.log("API Response for folder ".concat(e,":"),t);let r=t.result.files||[];return console.log("Found ".concat(r.length," files with drive.file scope")),0===r.length&&console.warn("No files returned for folder ".concat(e,". ")+"This is expected with drive.file scope - only previously selected files are accessible."),r.map(_)}catch(t){if(console.error("Error listing children of folder ".concat(e,":"),t),403===t.status)return console.warn("403 Forbidden - drive.file scope does not grant access to list folder contents. Only files previously selected via Picker are accessible."),[];throw t}}),async fetchFileBlob(e){let r=await fetch("https://www.googleapis.com/drive/v3/files/".concat(e,"?alt=media"),{headers:{Authorization:"Bearer ".concat(t)}});if(!r.ok)throw(401===r.status||403===r.status)&&(console.warn("Token invalid (401/403) on fetchFileBlob, requesting reauthorization"),v()),Error("Failed to fetch file: ".concat(r.statusText));return await r.blob()}}}},37714:function(e,t,r){"use strict";r.d(t,{g:function(){return sJ}});var n,i,a,o,s,l,c,u,d,h=r(81595);let p={SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},f={CLIENT_ERROR_RANGE_START:400,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR_RANGE_START:500,SERVER_ERROR_RANGE_END:599},m=[p.OPENID_SCOPE,p.PROFILE_SCOPE,p.OFFLINE_ACCESS_SCOPE],g=[...m,p.EMAIL_SCOPE],y={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},v={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},b={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},_={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},w={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},S="plain",T="S256",x={QUERY:"query",FRAGMENT:"fragment"},E={...x,FORM_POST:"form_post"},C="authorization_code",A="refresh_token",M={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",GENERIC_ACCOUNT_TYPE:"Generic"},I={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},R={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},k="appmetadata",P="client_info",O="1",N="authority-metadata",L=86400,D={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},U={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},F={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},B={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},z={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},H="username",j="password",G={httpSuccess:200,httpBadRequest:400},V={FAILED_AUTO_DETECTION:"1",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},q={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},W={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},Z={Pop:"pop"},X=300;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(n||(n={}));class ${constructor(e,t,r){this.level=n.Info;let i=()=>{},a=e||$.createDefaultLoggerOptions();this.localCallback=a.loggerCallback||i,this.piiLoggingEnabled=a.piiLoggingEnabled||!1,this.level="number"==typeof a.logLevel?a.logLevel:n.Info,this.correlationId=a.correlationId||p.EMPTY_STRING,this.packageName=t||p.EMPTY_STRING,this.packageVersion=r||p.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:n.Info}}clone(e,t,r){return new $({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;let r=new Date().toUTCString(),i=`[${r}] : [${t.correlationId||this.correlationId||""}]`,a=`${i} : ${this.packageName}@${this.packageVersion} : ${n[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,a,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:n.Error,containsPii:!1,correlationId:t||p.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:n.Error,containsPii:!0,correlationId:t||p.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:n.Warning,containsPii:!1,correlationId:t||p.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:n.Warning,containsPii:!0,correlationId:t||p.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:n.Info,containsPii:!1,correlationId:t||p.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:n.Info,containsPii:!0,correlationId:t||p.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:n.Verbose,containsPii:!1,correlationId:t||p.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:n.Verbose,containsPii:!0,correlationId:t||p.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:n.Trace,containsPii:!1,correlationId:t||p.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:n.Trace,containsPii:!0,correlationId:t||p.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}let K={AAD:"AAD",OIDC:"OIDC"},Y={None:"none"},Q="unexpected_error",J="post_request_failed",ee={[Q]:"Unexpected error in authentication.",[J]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};ee[Q],ee[J];class et extends Error{constructor(e,t,r){super(t?`${e}: ${t}`:e),Object.setPrototypeOf(this,et.prototype),this.errorCode=e||p.EMPTY_STRING,this.errorMessage=t||p.EMPTY_STRING,this.subError=r||p.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function er(e,t){return new et(e,t?`${ee[e]} ${t}`:ee[e])}let en="client_info_decoding_error",ei="client_info_empty_error",ea="token_parsing_error",eo="null_or_empty_token",es="endpoints_resolution_error",el="network_error",ec="openid_config_error",eu="hash_not_deserialized",ed="invalid_state",eh="state_mismatch",ep="state_not_found",ef="nonce_mismatch",em="auth_time_not_found",eg="max_age_transpired",ey="multiple_matching_tokens",ev="multiple_matching_accounts",eb="multiple_matching_appMetadata",e_="request_cannot_be_made",ew="cannot_remove_empty_scope",eS="cannot_append_scopeset",eT="empty_input_scopeset",ex="device_code_polling_cancelled",eE="device_code_expired",eC="device_code_unknown_error",eA="no_account_in_silent_request",eM="invalid_cache_record",eI="invalid_cache_environment",eR="no_account_found",ek="no_crypto_object",eP="unexpected_credential_type",eO="invalid_assertion",eN="invalid_client_credential",eL="token_refresh_required",eD="user_timeout_reached",eU="token_claims_cnf_required_for_signedjwt",eF="authorization_code_missing_from_server_response",eB="binding_key_not_removed",ez="end_session_endpoint_not_supported",eH="key_id_missing",ej="no_network_connectivity",eG="user_canceled",eV="missing_tenant_id_error",eq="method_not_implemented",eW="nested_app_auth_bridge_disabled",eZ={[en]:"The client info could not be parsed/decoded correctly",[ei]:"The client info was empty",[ea]:"Token cannot be parsed",[eo]:"The token is null or empty",[es]:"Endpoints cannot be resolved",[el]:"Network request failed",[ec]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[eu]:"The hash parameters could not be deserialized",[ed]:"State was not the expected format",[eh]:"State mismatch error",[ep]:"State not found",[ef]:"Nonce mismatch error",[em]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[eg]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[ey]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[ev]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[eb]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[e_]:"Token request cannot be made without authorization code or refresh token.",[ew]:"Cannot remove null or empty scope from ScopeSet",[eS]:"Cannot append ScopeSet",[eT]:"Empty input ScopeSet cannot be processed",[ex]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[eE]:"Device code is expired.",[eC]:"Device code stopped polling for unknown reasons.",[eA]:"Please pass an account object, silent flow is not supported without account information",[eM]:"Cache record object was null or undefined.",[eI]:"Invalid environment when attempting to create cache entry",[eR]:"No account found in cache for given key.",[ek]:"No crypto object detected.",[eP]:"Unexpected credential type.",[eO]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[eN]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[eL]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[eD]:"User defined timeout for device code polling reached",[eU]:"Cannot generate a POP jwt if the token_claims are not populated",[eF]:"Server response does not contain an authorization code to proceed",[eB]:"Could not remove the credential's binding key from storage.",[ez]:"The provided authority does not support logout",[eH]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[ej]:"No network connectivity. Check your internet connection.",[eG]:"User cancelled the flow.",[eV]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[eq]:"This method has not been implemented",[eW]:"The nested app auth bridge is disabled"};eZ[en],eZ[ei],eZ[ea],eZ[eo],eZ[es],eZ[el],eZ[ec],eZ[eu],eZ[ed],eZ[eh],eZ[ep],eZ[ef],eZ[em],eZ[eg],eZ[ey],eZ[ev],eZ[eb],eZ[e_],eZ[ew],eZ[eS],eZ[eT],eZ[ex],eZ[eE],eZ[eC],eZ[eA],eZ[eM],eZ[eI],eZ[eR],eZ[ek],eZ[eP],eZ[eO],eZ[eN],eZ[eL],eZ[eD],eZ[eU],eZ[eF],eZ[eB],eZ[ez],eZ[eH],eZ[ej],eZ[eG],eZ[eV],eZ[eW];class eX extends et{constructor(e,t){super(e,t?`${eZ[e]}: ${t}`:eZ[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,eX.prototype)}}function e$(e,t){return new eX(e,t)}let eK={createNewGuid:()=>{throw e$(eq)},base64Decode:()=>{throw e$(eq)},base64Encode:()=>{throw e$(eq)},base64UrlEncode:()=>{throw e$(eq)},encodeKid:()=>{throw e$(eq)},async getPublicKeyThumbprint(){throw e$(eq)},async removeTokenBindingKey(){throw e$(eq)},async clearKeystore(){throw e$(eq)},async signJwt(){throw e$(eq)},async hashString(){throw e$(eq)}},eY="@azure/msal-common",eQ="14.16.1";function eJ(e,t){let r=e0(e);try{let e=t(r);return JSON.parse(e)}catch(e){throw e$(ea)}}function e0(e){if(!e)throw e$(eo);let t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw e$(ea);return t[2]}function e1(e,t){let r=3e5;if(0===t||Date.now()-r>e+t)throw e$(eg)}function e2(){return Math.round(new Date().getTime()/1e3)}function e3(e,t){let r=Number(e)||0;return e2()+t>r}function e4(e){return Number(e)>e2()}function e5(e){return[tn(e),ti(e),ta(e),to(e),ts(e)].join(I.CACHE_KEY_SEPARATOR).toLowerCase()}function e6(e,t,r,n,i){return{credentialType:R.ID_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r,realm:i}}function e8(e,t,r,n,i,a,o,s,l,c,u,d,h,p,f){let m={homeAccountId:e,credentialType:R.ACCESS_TOKEN,secret:r,cachedAt:e2().toString(),expiresOn:o.toString(),extendedExpiresOn:s.toString(),environment:t,clientId:n,realm:i,target:a,tokenType:u||F.BEARER};if(d&&(m.userAssertionHash=d),c&&(m.refreshOn=c.toString()),p&&(m.requestedClaims=p,m.requestedClaimsHash=f),m.tokenType?.toLowerCase()!==F.BEARER.toLowerCase())switch(m.credentialType=R.ACCESS_TOKEN_WITH_AUTH_SCHEME,m.tokenType){case F.POP:let g=eJ(r,l);if(!g?.cnf?.kid)throw e$(eU);m.keyId=g.cnf.kid;break;case F.SSH:m.keyId=h}return m}function e7(e,t,r,n,i,a,o){let s={credentialType:R.REFRESH_TOKEN,homeAccountId:e,environment:t,clientId:n,secret:r};return a&&(s.userAssertionHash=a),i&&(s.familyId=i),o&&(s.expiresOn=o.toString()),s}function e9(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")}function te(e){return!!e&&e9(e)&&e.hasOwnProperty("realm")&&e.hasOwnProperty("target")&&(e.credentialType===R.ACCESS_TOKEN||e.credentialType===R.ACCESS_TOKEN_WITH_AUTH_SCHEME)}function tt(e){return!!e&&e9(e)&&e.hasOwnProperty("realm")&&e.credentialType===R.ID_TOKEN}function tr(e){return!!e&&e9(e)&&e.credentialType===R.REFRESH_TOKEN}function tn(e){return[e.homeAccountId,e.environment].join(I.CACHE_KEY_SEPARATOR).toLowerCase()}function ti(e){let t=e.credentialType===R.REFRESH_TOKEN&&e.familyId||e.clientId;return[e.credentialType,t,e.realm||""].join(I.CACHE_KEY_SEPARATOR).toLowerCase()}function ta(e){return(e.target||"").toLowerCase()}function to(e){return(e.requestedClaimsHash||"").toLowerCase()}function ts(e){return e.tokenType&&e.tokenType.toLowerCase()!==F.BEARER.toLowerCase()?e.tokenType.toLowerCase():""}function tl(e,t){let r=0===e.indexOf(U.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n}function tc(e,t){let r=!1;e&&(r=0===e.indexOf(B.THROTTLING_PREFIX));let n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n}function tu({environment:e,clientId:t}){return[k,e,t].join(I.CACHE_KEY_SEPARATOR).toLowerCase()}function td(e,t){return!!t&&0===e.indexOf(k)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")}function th(e,t){return!!t&&0===e.indexOf(N)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")&&t.hasOwnProperty("jwks_uri")}function tp(){return e2()+L}function tf(e,t,r){e.authorization_endpoint=t.authorization_endpoint,e.token_endpoint=t.token_endpoint,e.end_session_endpoint=t.end_session_endpoint,e.issuer=t.issuer,e.endpointsFromNetwork=r,e.jwks_uri=t.jwks_uri}function tm(e,t,r){e.aliases=t.aliases,e.preferred_cache=t.preferred_cache,e.preferred_network=t.preferred_network,e.aliasesFromNetwork=r}function tg(e){return e.expiresAt<=e2()}let ty="redirect_uri_empty",tv="claims_request_parsing_error",tb="authority_uri_insecure",t_="url_parse_error",tw="empty_url_error",tS="empty_input_scopes_error",tT="invalid_prompt_value",tx="invalid_claims",tE="token_request_empty",tC="logout_request_empty",tA="invalid_code_challenge_method",tM="pkce_params_missing",tI="invalid_cloud_discovery_metadata",tR="invalid_authority_metadata",tk="untrusted_authority",tP="missing_ssh_jwk",tO="missing_ssh_kid",tN="missing_nonce_authentication_header",tL="invalid_authentication_header",tD="cannot_set_OIDCOptions",tU="cannot_allow_native_broker",tF="authority_mismatch",tB={[ty]:"A redirect URI is required for all calls, and none has been set.",[tv]:"Could not parse the given claims request object.",[tb]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[t_]:"URL could not be parsed into appropriate segments.",[tw]:"URL was empty or null.",[tS]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[tT]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[tx]:"Given claims parameter must be a stringified JSON object.",[tE]:"Token request was empty and not found in cache.",[tC]:"The logout request was null or undefined.",[tA]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[tM]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[tI]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[tR]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[tk]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[tP]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[tO]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[tN]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[tL]:"Invalid authentication header provided",[tD]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[tU]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[tF]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};tB[ty],tB[tv],tB[tb],tB[t_],tB[tw],tB[tS],tB[tT],tB[tx],tB[tE],tB[tC],tB[tA],tB[tM],tB[tI],tB[tR],tB[tk],tB[tP],tB[tO],tB[tN],tB[tL],tB[tD],tB[tU],tB[tF];class tz extends et{constructor(e){super(e,tB[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,tz.prototype)}}function tH(e){return new tz(e)}class tj{static isEmptyObj(e){if(e)try{let t=JSON.parse(e);return 0===Object.keys(t).length}catch(e){}return!0}static startsWith(e,t){return 0===e.indexOf(t)}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){let t={},r=e.split("&"),n=e=>decodeURIComponent(e.replace(/\+/g," "));return r.forEach(e=>{if(e.trim()){let[r,i]=e.split(/=(.+)/g,2);r&&i&&(t[n(r)]=n(i))}}),t}static trimArrayEntries(e){return e.map(e=>e.trim())}static removeEmptyStringsFromArray(e){return e.filter(e=>!!e)}static jsonParseHelper(e){try{return JSON.parse(e)}catch(e){return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}class tG{constructor(e){let t=e?tj.trimArrayEntries([...e]):[],r=t?tj.removeEmptyStringsFromArray(t):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach(e=>this.scopes.add(e))}static fromString(e){return new tG((e||p.EMPTY_STRING).split(" "))}static createSearchScopes(e){let t=new tG(e);return t.containsOnlyOIDCScopes()?t.removeScope(p.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw tH(tS)}containsScope(e){let t=new tG(this.printScopesLowerCase().split(" "));return!!e&&t.scopes.has(e.toLowerCase())}containsScopeSet(e){return!!e&&!(e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every(e=>this.containsScope(e))}containsOnlyOIDCScopes(){let e=0;return g.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(e=>this.appendScope(e))}catch(e){throw e$(eS)}}removeScope(e){if(!e)throw e$(ew);this.scopes.delete(e.trim())}removeOIDCScopes(){g.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw e$(eT);let t=new Set;return e.scopes.forEach(e=>t.add(e.toLowerCase())),this.scopes.forEach(e=>t.add(e.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw e$(eT);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();let t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r}getScopeCount(){return this.scopes.size}asArray(){let e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):p.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}function tV(e,t){if(!e)throw e$(ei);try{let r=t(e);return JSON.parse(r)}catch(e){throw e$(en)}}function tq(e){if(!e)throw e$(en);let t=e.split(I.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?p.EMPTY_STRING:t[1]}}function tW(e,t){return!!e&&!!t&&e===t.split(".")[1]}function tZ(e,t,r,n){if(!n)return{tenantId:r,localAccountId:t,isHomeTenant:tW(r,e)};{let{oid:t,sub:r,tid:i,name:a,tfp:o,acr:s}=n,l=i||o||s||"";return{tenantId:l,localAccountId:t||r||"",name:a,isHomeTenant:tW(l,e)}}}function tX(e,t,r,n){let i=e;if(t){let{isHomeTenant:r,...n}=t;i={...e,...n}}if(r){let{isHomeTenant:t,...a}=tZ(e.homeAccountId,e.localAccountId,e.tenantId,r);i={...i,...a,idTokenClaims:r,idToken:n}}return i}let t$={Default:0,Adfs:1,Dsts:2,Ciam:3};function tK(e){return e&&(e.tid||e.tfp||e.acr)||null}class tY{generateAccountId(){return[this.homeAccountId,this.environment].join(I.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return tY.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){let t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(I.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,r){let n;let i=new tY;t.authorityType===t$.Adfs?i.authorityType=M.ADFS_ACCOUNT_TYPE:t.protocolMode===K.AAD?i.authorityType=M.MSSTS_ACCOUNT_TYPE:i.authorityType=M.GENERIC_ACCOUNT_TYPE,e.clientInfo&&r&&(n=tV(e.clientInfo,r)),i.clientInfo=e.clientInfo,i.homeAccountId=e.homeAccountId,i.nativeAccountId=e.nativeAccountId;let a=e.environment||t&&t.getPreferredCache();if(!a)throw e$(eI);i.environment=a,i.realm=n?.utid||tK(e.idTokenClaims)||"",i.localAccountId=n?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";let o=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,s=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(i.username=o||s||"",i.name=e.idTokenClaims?.name||"",i.cloudGraphHostName=e.cloudGraphHostName,i.msGraphHost=e.msGraphHost,e.tenantProfiles)i.tenantProfiles=e.tenantProfiles;else{let t=tZ(e.homeAccountId,i.localAccountId,i.realm,e.idTokenClaims);i.tenantProfiles=[t]}return i}static createFromAccountInfo(e,t,r){let n=new tY;return n.authorityType=e.authorityType||M.GENERIC_ACCOUNT_TYPE,n.homeAccountId=e.homeAccountId,n.localAccountId=e.localAccountId,n.nativeAccountId=e.nativeAccountId,n.realm=e.tenantId,n.environment=e.environment,n.username=e.username,n.name=e.name,n.cloudGraphHostName=t,n.msGraphHost=r,n.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),n}static generateHomeAccountId(e,t,r,n,i){if(!(t===t$.Adfs||t===t$.Dsts)){if(e)try{let t=tV(e,n.base64Decode);if(t.uid&&t.utid)return`${t.uid}.${t.utid}`}catch(e){}r.warning("No client info in response")}return i?.sub||""}static isAccountEntity(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let n=!0;if(r){let r=e.idTokenClaims||{},i=t.idTokenClaims||{};n=r.iat===i.iat&&r.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&n}}function tQ(e){return e.startsWith("#/")?e.substring(2):e.startsWith("#")||e.startsWith("?")?e.substring(1):e}function tJ(e){if(!e||0>e.indexOf("="))return null;try{let t=tQ(e),r=Object.fromEntries(new URLSearchParams(t));if(r.code||r.error||r.error_description||r.state)return r}catch(e){throw e$(eu)}return null}class t0{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw tH(tw);e.includes("#")||(this._urlString=t0.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return tj.endsWith(t,"?")?t=t.slice(0,-1):tj.endsWith(t,"?/")&&(t=t.slice(0,-2)),tj.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch(e){throw tH(t_)}if(!e.HostNameAndPort||!e.PathSegments)throw tH(t_);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw tH(tb)}static appendQueryString(e,t){return t?0>e.indexOf("?")?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return t0.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){let t=this.getUrlComponents(),r=t.PathSegments;return e&&0!==r.length&&(r[0]===b.COMMON||r[0]===b.ORGANIZATIONS)&&(r[0]=e),t0.constructAuthorityUriFromObject(t)}getUrlComponents(){let e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw tH(t_);let r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter(e=>e&&e.length>0),r.PathSegments=n,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){let t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw tH(t_);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===p.FORWARD_SLASH){let r=new t0(t).getUrlComponents();return r.Protocol+"//"+r.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new t0(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!tJ(e)}}let t1={"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},t2={metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]},t3=new Set;function t4(e,t){let r;let n=e.canonicalAuthority;if(n){let i=new t0(n).getUrlComponents().HostNameAndPort;r=t5(i,e.cloudDiscoveryMetadata?.metadata,D.CONFIG,t)||t5(i,t2.metadata,D.HARDCODED_VALUES,t)||e.knownAuthorities}return r||[]}function t5(e,t,r,n){if(n?.trace(`getAliasesFromMetadata called with source: ${r}`),e&&t){let i=t8(t,e);if(i)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${r}, returning aliases`),i.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${r}`)}return null}function t6(e){return t8(t2.metadata,e)}function t8(e,t){for(let r=0;r<e.length;r++){let n=e[r];if(n.aliases.includes(t))return n}return null}t2.metadata.forEach(e=>{e.aliases.forEach(e=>{t3.add(e)})});let t7="cache_quota_exceeded",t9="cache_error_unknown",re={[t7]:"Exceeded cache storage capacity.",[t9]:"Unexpected error occurred when using cache storage."};class rt extends Error{constructor(e,t){let r=t||(re[e]?re[e]:re[t9]);super(`${e}: ${r}`),Object.setPrototypeOf(this,rt.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}function rr(e){return e instanceof Error?"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name||e.message.includes("exceeded the quota")?new rt(t7):new rt(e.name,e.message):new rt(t9)}class rn{constructor(e,t,r,n){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(eY,eQ),this.staticAuthorityOptions=n}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(t||{},e),e,t)}getAccountInfoFilteredBy(e,t){let r=this.getAllAccounts(t,e);return r.length>1?r.sort(e=>e.idTokenClaims?-1:1)[0]:1===r.length?r[0]:null}getBaseAccountInfo(e,t){let r=this.getAccountsFilteredBy(e,t);return r.length>0?r[0].getAccountInfo():null}buildTenantProfiles(e,t,r){return e.flatMap(e=>this.getTenantProfilesFromAccountEntity(e,t,r?.tenantId,r))}getTenantedAccountInfoByFilter(e,t,r,n,i){let a,o=null;if(i&&!this.tenantProfileMatchesFilter(r,i))return null;let s=this.getIdToken(e,n,t,r.tenantId);return s&&(a=eJ(s.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(a,i))?null:o=tX(e,r,a,s?.secret)}getTenantProfilesFromAccountEntity(e,t,r,n){let i=e.getAccountInfo(),a=i.tenantProfiles||new Map,o=this.getTokenKeys();if(r){let e=a.get(r);if(!e)return[];a=new Map([[r,e]])}let s=[];return a.forEach(e=>{let r=this.getTenantedAccountInfoByFilter(i,o,e,t,n);r&&s.push(r)}),s}tenantProfileMatchesFilter(e,t){return(!t.localAccountId||!!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId))&&(!t.name||e.name===t.name)&&(void 0===t.isHomeTenant||e.isHomeTenant===t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!t||(!t.localAccountId||!!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId))&&(!t.loginHint||!!this.matchLoginHintFromTokenClaims(e,t.loginHint))&&(!t.username||!!this.matchUsername(e.preferred_username,t.username))&&(!t.name||!!this.matchName(e,t.name))&&(!t.sid||!!this.matchSid(e,t.sid))}async saveCacheRecord(e,t,r){if(!e)throw e$(eM);try{e.account&&this.setAccount(e.account,t),e.idToken&&r?.idToken!==!1&&this.setIdTokenCredential(e.idToken,t),e.accessToken&&r?.accessToken!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&r?.refreshToken!==!1&&this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(e){if(this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),e instanceof et)throw e;throw rr(e)}}async saveAccessToken(e,t){let r={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),i=tG.fromString(e.target);n.accessToken.forEach(e=>{if(!this.accessTokenKeyMatchesFilter(e,r,!1))return;let n=this.getAccessTokenCredential(e,t);n&&this.credentialMatchesFilter(n,r)&&tG.fromString(n.target).intersectingScopeSets(i)&&this.removeAccessToken(e,t)}),this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){let r=this.getAccountKeys(),n=[];return r.forEach(r=>{if(!this.isAccountKey(r,e.homeAccountId))return;let i=this.getAccount(r,t,this.commonLogger);if(!i||e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId)||e.username&&!this.matchUsername(i.username,e.username)||e.environment&&!this.matchEnvironment(i,e.environment)||e.realm&&!this.matchRealm(i,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(i,e.authorityType))return;let a={localAccountId:e?.localAccountId,name:e?.name},o=i.tenantProfiles?.filter(e=>this.tenantProfileMatchesFilter(e,a));o&&0===o.length||n.push(i)}),n}isAccountKey(e,t,r){return!(e.split(I.CACHE_KEY_SEPARATOR).length<3)&&(!t||!!e.toLowerCase().includes(t.toLowerCase()))&&(!r||!!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(I.CACHE_KEY_SEPARATOR).length<6)return!1;let t=e.toLowerCase();if(-1===t.indexOf(R.ID_TOKEN.toLowerCase())&&-1===t.indexOf(R.ACCESS_TOKEN.toLowerCase())&&-1===t.indexOf(R.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())&&-1===t.indexOf(R.REFRESH_TOKEN.toLowerCase()))return!1;if(t.indexOf(R.REFRESH_TOKEN.toLowerCase())>-1){let e=`${R.REFRESH_TOKEN}${I.CACHE_KEY_SEPARATOR}${this.clientId}${I.CACHE_KEY_SEPARATOR}`,r=`${R.REFRESH_TOKEN}${I.CACHE_KEY_SEPARATOR}${O}${I.CACHE_KEY_SEPARATOR}`;if(-1===t.indexOf(e.toLowerCase())&&-1===t.indexOf(r.toLowerCase()))return!1}else if(-1===t.indexOf(this.clientId.toLowerCase()))return!1;return!0}credentialMatchesFilter(e,t){return(!t.clientId||!!this.matchClientId(e,t.clientId))&&(!t.userAssertionHash||!!this.matchUserAssertionHash(e,t.userAssertionHash))&&("string"!=typeof t.homeAccountId||!!this.matchHomeAccountId(e,t.homeAccountId))&&(!t.environment||!!this.matchEnvironment(e,t.environment))&&(!t.realm||!!this.matchRealm(e,t.realm))&&(!t.credentialType||!!this.matchCredentialType(e,t.credentialType))&&(!t.familyId||!!this.matchFamilyId(e,t.familyId))&&(!t.target||!!this.matchTarget(e,t.target))&&(!t.requestedClaimsHash&&!e.requestedClaimsHash||e.requestedClaimsHash===t.requestedClaimsHash)&&(e.credentialType!==R.ACCESS_TOKEN_WITH_AUTH_SCHEME||(!t.tokenType||!!this.matchTokenType(e,t.tokenType))&&(t.tokenType!==F.SSH||!t.keyId||!!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){let t=this.getKeys(),r={};return t.forEach(t=>{if(!this.isAppMetadata(t))return;let n=this.getAppMetadata(t);n&&(!e.environment||this.matchEnvironment(n,e.environment))&&(!e.clientId||this.matchClientId(n,e.clientId))&&(r[t]=n)}),r}getAuthorityMetadataByAlias(e){let t=this.getAuthorityMetadataKeys(),r=null;return t.forEach(t=>{if(!this.isAuthorityMetadata(t)||-1===t.indexOf(this.clientId))return;let n=this.getAuthorityMetadata(t);n&&-1!==n.aliases.indexOf(e)&&(r=n)}),r}async removeAllAccounts(e){let t=this.getAccountKeys(),r=[];t.forEach(t=>{r.push(this.removeAccount(t,e))}),await Promise.all(r)}async removeAccount(e,t){let r=this.getAccount(e,t,this.commonLogger);r&&(await this.removeAccountContext(r,t),this.removeItem(e,t))}async removeAccountContext(e,t){let r=this.getTokenKeys(),n=e.generateAccountId();r.idToken.forEach(e=>{0===e.indexOf(n)&&this.removeIdToken(e,t)}),r.accessToken.forEach(e=>{0===e.indexOf(n)&&this.removeAccessToken(e,t)}),r.refreshToken.forEach(e=>{0===e.indexOf(n)&&this.removeRefreshToken(e,t)}),this.getKeys().forEach(e=>{e.includes(n)&&this.removeItem(e,t)})}updateOutdatedCachedAccount(e,t,r,n){if(t&&t.isSingleTenant()){this.commonLogger?.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");let i=this.getAccountKeys().filter(e=>e.startsWith(t.homeAccountId)),a=[];i.forEach(e=>{let t=this.getCachedAccountEntity(e,r);t&&a.push(t)});let o=a.find(e=>tW(e.realm,e.homeAccountId))||a[0];o.tenantProfiles=a.map(e=>({tenantId:e.realm,localAccountId:e.localAccountId,name:e.name,isHomeTenant:tW(e.realm,e.homeAccountId)}));let s=rn.toObject(new tY,{...o}),l=s.generateAccountKey();return i.forEach(t=>{t!==l&&this.removeOutdatedAccount(e,r)}),this.setAccount(s,r),n?.verbose("Updated an outdated account entity in the cache"),s}return t}removeAccessToken(e,t){let r=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),!r||r.credentialType.toLowerCase()!==R.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||r.tokenType!==F.POP)return;let n=r.keyId;n&&this.cryptoImpl.removeTokenBindingKey(n).catch(()=>{this.commonLogger.error("Binding key could not be removed")})}removeAppMetadata(e){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t,e)}),!0}readAccountFromCache(e,t){let r=tY.generateAccountCacheKey(e);return this.getAccount(r,t,this.commonLogger)}getIdToken(e,t,r,n,i){this.commonLogger.trace("CacheManager - getIdToken called");let a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:R.ID_TOKEN,clientId:this.clientId,realm:n},o=this.getIdTokensByFilter(a,t,r),s=o.size;if(s<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(s>1){let r=o;if(!n){let t=new Map;o.forEach((r,n)=>{r.realm===e.tenantId&&t.set(n,r)});let n=t.size;if(n<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),o.values().next().value;if(1===n)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),t.values().next().value;r=t}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),r.forEach((e,r)=>{this.removeIdToken(r,t)}),i&&t&&i.addFields({multiMatchedID:o.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),o.values().next().value}getIdTokensByFilter(e,t,r){let n=r&&r.idToken||this.getTokenKeys().idToken,i=new Map;return n.forEach(r=>{if(!this.idTokenKeyMatchesFilter(r,{clientId:this.clientId,...e}))return;let n=this.getIdTokenCredential(r,t);n&&this.credentialMatchesFilter(n,e)&&i.set(r,n)}),i}idTokenKeyMatchesFilter(e,t){let r=e.toLowerCase();return(!t.clientId||-1!==r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase()))}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,r,n,i){this.commonLogger.trace("CacheManager - getAccessToken called");let a=tG.createSearchScopes(t.scopes),o=t.authenticationScheme||F.BEARER,s=o&&o.toLowerCase()!==F.BEARER.toLowerCase()?R.ACCESS_TOKEN_WITH_AUTH_SCHEME:R.ACCESS_TOKEN,l={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:s,clientId:this.clientId,realm:n||e.tenantId,target:a,tokenType:o,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},c=r&&r.accessToken||this.getTokenKeys().accessToken,u=[];c.forEach(e=>{if(this.accessTokenKeyMatchesFilter(e,l,!0)){let r=this.getAccessTokenCredential(e,t.correlationId);r&&this.credentialMatchesFilter(r,l)&&u.push(r)}});let d=u.length;return d<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):d>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),u.forEach(e=>{this.removeAccessToken(e5(e),t.correlationId)}),i&&t.correlationId&&i.addFields({multiMatchedAT:u.length},t.correlationId),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),u[0])}accessTokenKeyMatchesFilter(e,t,r){let n=e.toLowerCase();if(t.clientId&&-1===n.indexOf(t.clientId.toLowerCase())||t.homeAccountId&&-1===n.indexOf(t.homeAccountId.toLowerCase())||t.realm&&-1===n.indexOf(t.realm.toLowerCase())||t.requestedClaimsHash&&-1===n.indexOf(t.requestedClaimsHash.toLowerCase()))return!1;if(t.target){let e=t.target.asArray();for(let t=0;t<e.length;t++){if(r&&!n.includes(e[t].toLowerCase()))return!1;if(!r&&n.includes(e[t].toLowerCase()))break}}return!0}getAccessTokensByFilter(e,t){let r=this.getTokenKeys(),n=[];return r.accessToken.forEach(r=>{if(!this.accessTokenKeyMatchesFilter(r,e,!0))return;let i=this.getAccessTokenCredential(r,t);i&&this.credentialMatchesFilter(i,e)&&n.push(i)}),n}getRefreshToken(e,t,r,n,i){this.commonLogger.trace("CacheManager - getRefreshToken called");let a=t?O:void 0,o={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:R.REFRESH_TOKEN,clientId:this.clientId,familyId:a},s=n&&n.refreshToken||this.getTokenKeys().refreshToken,l=[];s.forEach(e=>{if(this.refreshTokenKeyMatchesFilter(e,o)){let t=this.getRefreshTokenCredential(e,r);t&&this.credentialMatchesFilter(t,o)&&l.push(t)}});let c=l.length;return c<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(c>1&&i&&r&&i.addFields({multiMatchedRT:c},r),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,t){let r=e.toLowerCase();return(!t.familyId||-1!==r.indexOf(t.familyId.toLowerCase()))&&(!!t.familyId||!t.clientId||-1!==r.indexOf(t.clientId.toLowerCase()))&&(!t.homeAccountId||-1!==r.indexOf(t.homeAccountId.toLowerCase()))}readAppMetadataFromCache(e){let t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),n=Object.keys(r).map(e=>r[e]),i=n.length;if(i<1)return null;if(i>1)throw e$(eb);return n[0]}isAppMetadataFOCI(e){let t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===O)}matchHomeAccountId(e,t){return!!("string"==typeof e.homeAccountId&&t===e.homeAccountId)}matchLocalAccountIdFromTokenClaims(e,t){return t===(e.oid||e.sub)}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return!(t.toLowerCase()!==e.name?.toLowerCase())}matchUsername(e,t){return!!(e&&"string"==typeof e&&t?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){let r=t4(this.staticAuthorityOptions,this.commonLogger);if(r.includes(t)&&r.includes(e.environment))return!0}let r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){return!(e.realm?.toLowerCase()!==t.toLowerCase())}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return(e.credentialType===R.ACCESS_TOKEN||e.credentialType===R.ACCESS_TOKEN_WITH_AUTH_SCHEME)&&!!e.target&&tG.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return -1!==e.indexOf(k)}isAuthorityMetadata(e){return -1!==e.indexOf(N)}generateAuthorityMetadataCacheKey(e){return`${N}-${this.clientId}-${e}`}static toObject(e,t){for(let r in t)e[r]=t[r];return e}}class ri extends rn{setAccount(){throw e$(eq)}getAccount(){throw e$(eq)}getCachedAccountEntity(){throw e$(eq)}setIdTokenCredential(){throw e$(eq)}getIdTokenCredential(){throw e$(eq)}setAccessTokenCredential(){throw e$(eq)}getAccessTokenCredential(){throw e$(eq)}setRefreshTokenCredential(){throw e$(eq)}getRefreshTokenCredential(){throw e$(eq)}setAppMetadata(){throw e$(eq)}getAppMetadata(){throw e$(eq)}setServerTelemetry(){throw e$(eq)}getServerTelemetry(){throw e$(eq)}setAuthorityMetadata(){throw e$(eq)}getAuthorityMetadata(){throw e$(eq)}getAuthorityMetadataKeys(){throw e$(eq)}setThrottlingCache(){throw e$(eq)}getThrottlingCache(){throw e$(eq)}removeItem(){throw e$(eq)}getKeys(){throw e$(eq)}getAccountKeys(){throw e$(eq)}getTokenKeys(){throw e$(eq)}updateCredentialCacheKey(){throw e$(eq)}removeOutdatedAccount(){throw e$(eq)}}let ra={tokenRenewalOffsetSeconds:X,preventCorsPreflight:!1},ro={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:n.Info,correlationId:p.EMPTY_STRING},rs={claimsBasedCachingEnabled:!1},rl={async sendGetRequestAsync(){throw e$(eq)},async sendPostRequestAsync(){throw e$(eq)}},rc={sku:p.SKU,version:eQ,cpu:p.EMPTY_STRING,os:p.EMPTY_STRING},ru={clientSecret:p.EMPTY_STRING,clientAssertion:void 0},rd={azureCloudInstance:Y.None,tenant:`${p.DEFAULT_COMMON_TENANT}`},rh={application:{appName:"",appVersion:""}};function rp({authOptions:e,systemOptions:t,loggerOptions:r,cacheOptions:n,storageInterface:i,networkInterface:a,cryptoInterface:o,clientCredentials:s,libraryInfo:l,telemetry:c,serverTelemetryManager:u,persistencePlugin:d,serializableCache:h}){let p={...ro,...r};return{authOptions:rf(e),systemOptions:{...ra,...t},loggerOptions:p,cacheOptions:{...rs,...n},storageInterface:i||new ri(e.clientId,eK,new $(p)),networkInterface:a||rl,cryptoInterface:o||eK,clientCredentials:s||ru,libraryInfo:{...rc,...l},telemetry:{...rh,...c},serverTelemetryManager:u||null,persistencePlugin:d||null,serializableCache:h||null}}function rf(e){return{clientCapabilities:[],azureCloudOptions:rd,skipAuthorityMetadataCache:!1,instanceAware:!1,...e}}function rm(e){return e.authOptions.authority.options.protocolMode===K.OIDC}let rg={sendGetRequestAsync:()=>Promise.reject(e$(eq)),sendPostRequestAsync:()=>Promise.reject(e$(eq))},ry={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"};ry.AcquireTokenByCode,ry.AcquireTokenByRefreshToken,ry.AcquireTokenSilent,ry.AcquireTokenSilentAsync,ry.AcquireTokenPopup,ry.AcquireTokenRedirect,ry.CryptoOptsGetPublicKeyThumbprint,ry.CryptoOptsSignJwt,ry.SilentCacheClientAcquireToken,ry.SilentIframeClientAcquireToken,ry.SilentRefreshClientAcquireToken,ry.SsoSilent,ry.StandardInteractionClientGetDiscoveredAuthority,ry.FetchAccountIdWithNativeBroker,ry.NativeInteractionClientAcquireToken,ry.BaseClientCreateTokenRequestHeaders,ry.NetworkClientSendPostRequestAsync,ry.RefreshTokenClientExecutePostToTokenEndpoint,ry.AuthorizationCodeClientExecutePostToTokenEndpoint,ry.BrokerHandhshake,ry.AcquireTokenByRefreshTokenInBroker,ry.AcquireTokenByBroker,ry.RefreshTokenClientExecuteTokenRequest,ry.RefreshTokenClientAcquireToken,ry.RefreshTokenClientAcquireTokenWithCachedRefreshToken,ry.RefreshTokenClientAcquireTokenByRefreshToken,ry.RefreshTokenClientCreateTokenRequestBody,ry.AcquireTokenFromCache,ry.SilentFlowClientAcquireCachedToken,ry.SilentFlowClientGenerateResultFromCacheRecord,ry.AcquireTokenBySilentIframe,ry.InitializeBaseRequest,ry.InitializeSilentRequest,ry.InitializeClientApplication,ry.SilentIframeClientTokenHelper,ry.SilentHandlerInitiateAuthRequest,ry.SilentHandlerMonitorIframeForHash,ry.SilentHandlerLoadFrame,ry.SilentHandlerLoadFrameSync,ry.StandardInteractionClientCreateAuthCodeClient,ry.StandardInteractionClientGetClientConfiguration,ry.StandardInteractionClientInitializeAuthorizationRequest,ry.StandardInteractionClientInitializeAuthorizationCodeRequest,ry.GetAuthCodeUrl,ry.HandleCodeResponseFromServer,ry.HandleCodeResponse,ry.UpdateTokenEndpointAuthority,ry.AuthClientAcquireToken,ry.AuthClientExecuteTokenRequest,ry.AuthClientCreateTokenRequestBody,ry.AuthClientCreateQueryString,ry.PopTokenGenerateCnf,ry.PopTokenGenerateKid,ry.HandleServerTokenResponse,ry.DeserializeResponse,ry.AuthorityFactoryCreateDiscoveredInstance,ry.AuthorityResolveEndpointsAsync,ry.AuthorityResolveEndpointsFromLocalSources,ry.AuthorityGetCloudDiscoveryMetadataFromNetwork,ry.AuthorityUpdateCloudDiscoveryMetadata,ry.AuthorityGetEndpointMetadataFromNetwork,ry.AuthorityUpdateEndpointMetadata,ry.AuthorityUpdateMetadataWithRegionalInformation,ry.RegionDiscoveryDetectRegion,ry.RegionDiscoveryGetRegionFromIMDS,ry.RegionDiscoveryGetCurrentVersion,ry.AcquireTokenByCodeAsync,ry.GetEndpointMetadataFromNetwork,ry.GetCloudDiscoveryMetadataFromNetworkMeasurement,ry.HandleRedirectPromiseMeasurement,ry.HandleNativeRedirectPromiseMeasurement,ry.UpdateCloudDiscoveryMetadataMeasurement,ry.UsernamePasswordClientAcquireToken,ry.NativeMessageHandlerHandshake,ry.NativeGenerateAuthResult,ry.RemoveHiddenIframe,ry.ClearTokensAndKeysWithClaims,ry.CacheManagerGetRefreshToken,ry.GeneratePkceCodes,ry.GenerateCodeVerifier,ry.GenerateCodeChallengeFromVerifier,ry.Sha256Digest,ry.GetRandomValues;let rv=1;class rb{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class r_{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:rv,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new rb}}startPerformanceMeasurement(){return new rb}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}let rw={INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},rS={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},rT={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},rx={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},rE={GET:"GET",POST:"POST"},rC={AUTHORITY:"authority",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native"},rA={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys",VERSION:"msal.version"},rM="wrapper.sku",rI="wrapper.version",rR={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};!function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent",e.None="none"}(i||(i={}));let rk={scopes:m},rP="jwk",rO="msal.db",rN=1,rL=`${rO}.keys`,rD={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},rU=[rD.Default,rD.Skip,rD.RefreshTokenAndNetwork],rF="msal.browser.log.level",rB="msal.browser.log.pii";class rz{navigateInternal(e,t){return rz.defaultNavigateWindow(e,t)}navigateExternal(e,t){return rz.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(e=>{setTimeout(()=>{e(!0)},t.timeout)})}}class rH extends et{constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,rH.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}function rj(e,t,r){return new rH(e,t,r)}let rG="pkce_not_created",rV="crypto_nonexistent",rq="empty_navigate_uri",rW="hash_empty_error",rZ="no_state_in_hash",rX="hash_does_not_contain_known_properties",r$="unable_to_parse_state",rK="state_interaction_type_mismatch",rY="interaction_in_progress",rQ="popup_window_error",rJ="empty_window_error",r0="user_cancelled",r1="monitor_popup_timeout",r2="monitor_window_timeout",r3="redirect_in_iframe",r4="block_iframe_reload",r5="block_nested_popups",r6="iframe_closed_prematurely",r8="silent_logout_unsupported",r7="no_account_error",r9="silent_prompt_value_error",ne="no_token_request_cache_error",nt="unable_to_parse_token_request_cache_error",nr="no_cached_authority_error",nn="auth_request_not_set_error",ni="invalid_cache_type",na="non_browser_environment",no="database_not_open",ns="no_network_connectivity",nl="post_request_failed",nc="get_request_failed",nu="failed_to_parse_response",nd="unable_to_load_token",nh="crypto_key_not_found",np="auth_code_required",nf="auth_code_or_nativeAccountId_required",nm="spa_code_and_nativeAccountId_present",ng="database_unavailable",ny="unable_to_acquire_token_from_native_platform",nv="native_handshake_timeout",nb="native_extension_not_installed",n_="native_connection_not_established",nw="uninitialized_public_client_application",nS="native_prompt_not_supported",nT="invalid_base64_string",nx="invalid_pop_token_request",nE="failed_to_build_headers",nC="failed_to_parse_headers",nA="For more visit: aka.ms/msaljs/browser-errors",nM={[rG]:"The PKCE code challenge and verifier could not be generated.",[rV]:"The crypto object or function is not available.",[rq]:"Navigation URI is empty. Please check stack trace for more info.",[rW]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${nA}`,[rZ]:"Hash does not contain state. Please verify that the request originated from msal.",[rX]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${nA}`,[r$]:"Unable to parse state. Please verify that the request originated from msal.",[rK]:"Hash contains state but the interaction type does not match the caller.",[rY]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${nA}`,[rQ]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[rJ]:"window.open returned null or undefined window object.",[r0]:"User cancelled the flow.",[r1]:`Token acquisition in popup failed due to timeout.  ${nA}`,[r2]:`Token acquisition in iframe failed due to timeout.  ${nA}`,[r3]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[r4]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${nA}`,[r5]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[r6]:"The iframe being monitored was closed prematurely.",[r8]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[r7]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[r9]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[ne]:"No token request found in cache.",[nt]:"The cached token request could not be parsed.",[nr]:"No cached authority found.",[nn]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[ni]:"Invalid cache type",[na]:"Login and token requests are not supported in non-browser environments.",[no]:"Database is not open!",[ns]:"No network connectivity. Check your internet connection.",[nl]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[nc]:"Network request failed. Please check the network trace to determine root cause.",[nu]:"Failed to parse network response. Check network trace.",[nd]:"Error loading token to cache.",[nh]:"Cryptographic Key or Keypair not found in browser storage.",[np]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[nf]:"An authorization code or nativeAccountId must be provided to this flow.",[nm]:"Request cannot contain both spa code and native account id.",[ng]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[ny]:`Unable to acquire token from native platform.  ${nA}`,[nv]:"Timed out while attempting to establish connection to browser extension",[nb]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[n_]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${nA}`,[nw]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${nA}`,[nS]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[nT]:"Invalid base64 encoded string.",[nx]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[nE]:"Failed to build request headers object.",[nC]:"Failed to parse response headers"};nM[rG],nM[rV],nM[rq],nM[rW],nM[rZ],nM[rX],nM[r$],nM[rK],nM[rY],nM[rQ],nM[rJ],nM[r0],nM[r1],nM[r2],nM[r3],nM[r4],nM[r5],nM[r6],nM[r8],nM[r7],nM[r9],nM[ne],nM[nt],nM[nr],nM[nn],nM[ni],nM[na],nM[no],nM[ns],nM[nl],nM[nc],nM[nu],nM[nd],nM[nh],nM[np],nM[nf],nM[nm],nM[ng],nM[ny],nM[nv],nM[nb],nM[n_],nM[nw],nM[nS],nM[nT],nM[nx];class nI extends et{constructor(e,t){super(e,nM[e],t),Object.setPrototypeOf(this,nI.prototype),this.name="BrowserAuthError"}}function nR(e,t){return new nI(e,t)}class nk{async sendGetRequestAsync(e,t){let r;let n={},i=0,a=nP(t);try{r=await fetch(e,{method:rE.GET,headers:a})}catch(e){throw nR(window.navigator.onLine?nc:ns)}n=nO(r.headers);try{return i=r.status,{headers:n,body:await r.json(),status:i}}catch(e){throw rj(nR(nu),i,n)}}async sendPostRequestAsync(e,t){let r;let n=t&&t.body||"",i=nP(t),a=0,o={};try{r=await fetch(e,{method:rE.POST,headers:i,body:n})}catch(e){throw nR(window.navigator.onLine?nl:ns)}o=nO(r.headers);try{return a=r.status,{headers:o,body:await r.json(),status:a}}catch(e){throw rj(nR(nu),a,o)}}}function nP(e){try{let t=new Headers;if(!(e&&e.headers))return t;let r=e.headers;return Object.entries(r).forEach(([e,r])=>{t.append(e,r)}),t}catch(e){throw nR(nE)}}function nO(e){try{let t={};return e.forEach((e,r)=>{t[r]=e}),t}catch(e){throw nR(nC)}}function nN(e){return encodeURIComponent(nD(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function nL(e){return nU(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function nD(e){return nU(new TextEncoder().encode(e))}function nU(e){return btoa(Array.from(e,e=>String.fromCodePoint(e)).join(""))}let nF="RSASSA-PKCS1-v1_5",nB="SHA-256",nz=2048,nH=new Uint8Array([1,0,1]),nj="0123456789abcdef",nG=new Uint32Array(1),nV="crypto_subtle_undefined",nq={name:nF,hash:nB,modulusLength:nz,publicExponent:nH};function nW(e){if(!window)throw nR(na);if(!window.crypto)throw nR(rV);if(!e&&!window.crypto.subtle)throw nR(rV,nV)}async function nZ(e,t,r){t?.addQueueMeasurement(ry.Sha256Digest,r);let n=new TextEncoder().encode(e);return window.crypto.subtle.digest(nB,n)}function nX(e){return window.crypto.getRandomValues(e)}function n$(){return window.crypto.getRandomValues(nG),nG[0]}function nK(){let e=Date.now(),t=1024*n$()+(1023&n$()),r=new Uint8Array(16),n=Math.trunc(t/1073741824),i=t&1073741824-1,a=n$();r[0]=e/1099511627776,r[1]=e/4294967296,r[2]=e/16777216,r[3]=e/65536,r[4]=e/256,r[5]=e,r[6]=112|n>>>8,r[7]=n,r[8]=128|i>>>24,r[9]=i>>>16,r[10]=i>>>8,r[11]=i,r[12]=a>>>24,r[13]=a>>>16,r[14]=a>>>8,r[15]=a;let o="";for(let e=0;e<r.length;e++)o+=nj.charAt(r[e]>>>4)+nj.charAt(15&r[e]),(3===e||5===e||7===e||9===e)&&(o+="-");return o}async function nY(e,t){return window.crypto.subtle.generateKey(nq,e,t)}async function nQ(e){return window.crypto.subtle.exportKey(rP,e)}async function nJ(e,t,r){return window.crypto.subtle.importKey(rP,e,nq,t,r)}async function n0(e,t){return window.crypto.subtle.sign(nq,e,t)}async function n1(e){return nL(new Uint8Array(await nZ(e)))}let n2="storage_not_supported",n3="stubbed_public_client_application_called",n4="in_mem_redirect_unavailable",n5={[n2]:"Given storage configuration option was not supported.",[n3]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[n4]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};n5[n2],n5[n3],n5[n4];class n6 extends et{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,n6.prototype)}}function n8(e){return new n6(e,n5[e])}function n7(e){e.location.hash="","function"==typeof e.history.replaceState&&e.history.replaceState(null,"",`${e.location.origin}${e.location.pathname}${e.location.search}`)}function n9(e){let t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""}function ie(){return window.parent!==window}function it(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(`${rw.POPUP_NAME_PREFIX}.`)}function ir(){return"undefined"!=typeof window&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function ii(){let e=new t0(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function ia(){if(t0.hashContainsKnownProperties(window.location.hash)&&ie())throw nR(r4)}function io(e){if(ie()&&!e)throw nR(r3)}function is(){if(it())throw nR(r5)}function il(){if("undefined"==typeof window)throw nR(na)}function ic(e){if(!e)throw nR(nw)}function iu(e){il(),ia(),is(),ic(e)}function id(e,t){if(iu(e),io(t.system.allowRedirectInIframe),t.cache.cacheLocation===rx.MemoryStorage&&!t.cache.storeAuthStateInCookie)throw n8(n4)}function ih(e){let t=document.createElement("link");t.rel="preconnect",t.href=new URL(e).origin,t.crossOrigin="anonymous",document.head.appendChild(t),window.setTimeout(()=>{try{document.head.removeChild(t)}catch{}},1e4)}function ip(){return nK()}let im=6e4,ig=1e4,iy=3e4,iv=2e3;function ib({auth:e,cache:t,system:r,telemetry:i},a){let o={clientId:p.EMPTY_STRING,authority:`${p.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:p.EMPTY_STRING,authorityMetadata:p.EMPTY_STRING,redirectUri:"undefined"!=typeof window?ir():"",postLogoutRedirectUri:p.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:K.AAD,OIDCOptions:{serverResponseType:x.FRAGMENT,defaultScopes:[p.OPENID_SCOPE,p.PROFILE_SCOPE,p.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:Y.None,tenant:p.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},s={cacheLocation:rx.SessionStorage,temporaryCacheLocation:rx.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!t&&t.cacheLocation===rx.LocalStorage,claimsBasedCachingEnabled:!1},l={loggerCallback:()=>{},logLevel:n.Info,piiLoggingEnabled:!1},c={...{...ra,loggerOptions:l,networkClient:a?new nk:rg,navigationClient:new rz,loadFrameTimeout:0,windowHashTimeout:r?.loadFrameTimeout||im,iframeHashTimeout:r?.loadFrameTimeout||ig,navigateFrameWait:0,redirectNavigationTimeout:iy,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:r?.nativeBrokerHandshakeTimeout||iv,pollIntervalMilliseconds:rw.DEFAULT_POLL_INTERVAL_MS},...r,loggerOptions:r?.loggerOptions||l},u={application:{appName:p.EMPTY_STRING,appVersion:p.EMPTY_STRING},client:new r_};if(e?.protocolMode!==K.OIDC&&e?.OIDCOptions&&new $(c.loggerOptions).warning(JSON.stringify(tH(tD))),e?.protocolMode&&e.protocolMode!==K.AAD&&c?.allowNativeBroker)throw tH(tU);return{auth:{...o,...e,OIDCOptions:{...o.OIDCOptions,...e?.OIDCOptions}},cache:{...s,...t},system:c,telemetry:{...u,...i}}}let i_="@azure/msal-browser",iw="3.30.0";class iS{static loggerCallback(e,t){switch(e){case n.Error:console.error(t);return;case n.Info:console.info(t);return;case n.Verbose:console.debug(t);return;case n.Warning:console.warn(t);return;default:console.log(t);return}}constructor(e){let t;this.browserEnvironment="undefined"!=typeof window,this.config=ib(e,this.browserEnvironment);try{t=window[rx.SessionStorage]}catch(e){}let r=t?.getItem(rF),i=t?.getItem(rB)?.toLowerCase(),a="true"===i||"false"!==i&&void 0,o={...this.config.system.loggerOptions},s=r&&Object.keys(n).includes(r)?n[r]:void 0;s&&(o.loggerCallback=iS.loggerCallback,o.logLevel=s),void 0!==a&&(o.piiLoggingEnabled=a),this.logger=new $(o,i_,iw),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}class iT extends iS{getModuleName(){return iT.MODULE_NAME}getId(){return iT.ID}async initialize(){return this.available="undefined"!=typeof window,this.available}}iT.MODULE_NAME="",iT.ID="StandardOperatingContext";let ix="missing_kid_error",iE="missing_alg_error",iC={[ix]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[iE]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class iA extends et{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,iA.prototype)}}function iM(e){return new iA(e,iC[e])}class iI{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw iM(ix);if(!e.alg)throw iM(iE);return JSON.stringify(new iI({typ:e.typ||Z.Pop,kid:e.kid,alg:e.alg}))}}function iR(e){return new TextDecoder().decode(ik(e))}function ik(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw nR(nT)}let r=atob(t);return Uint8Array.from(r,e=>e.codePointAt(0)||0)}class iP{constructor(){this.dbName=rO,this.version=rN,this.tableName=rL,this.dbOpen=!1}async open(){return new Promise((e,t)=>{let r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",e=>{e.target.result.createObjectStore(this.tableName)}),r.addEventListener("success",t=>{let r=t;this.db=r.target.result,this.dbOpen=!0,e()}),r.addEventListener("error",()=>t(nR(ng)))})}closeConnection(){let e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(nR(no));let n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);n.addEventListener("success",e=>{let r=e;this.closeConnection(),t(r.target.result)}),n.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((r,n)=>{if(!this.db)return n(nR(no));let i=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);i.addEventListener("success",()=>{this.closeConnection(),r()}),i.addEventListener("error",e=>{this.closeConnection(),n(e)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(nR(no));let n=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);n.addEventListener("success",()=>{this.closeConnection(),t()}),n.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(nR(no));let r=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();r.addEventListener("success",t=>{let r=t;this.closeConnection(),e(r.target.result)}),r.addEventListener("error",e=>{this.closeConnection(),t(e)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(nR(no));let n=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);n.addEventListener("success",e=>{let r=e;this.closeConnection(),t(1===r.target.result)}),n.addEventListener("error",e=>{this.closeConnection(),r(e)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{let r=window.indexedDB.deleteDatabase(rO),n=setTimeout(()=>t(!1),200);r.addEventListener("success",()=>(clearTimeout(n),e(!0))),r.addEventListener("blocked",()=>(clearTimeout(n),e(!0))),r.addEventListener("error",()=>(clearTimeout(n),t(!1)))})}}class iO{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){let e=[];return this.cache.forEach((t,r)=>{e.push(r)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}class iN{constructor(e){this.inMemoryCache=new iO,this.indexedDBCache=new iP,this.logger=e}handleDatabaseAccessError(e){if(e instanceof nI&&e.errorCode===ng)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){let t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(e){this.handleDatabaseAccessError(e)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(e){this.handleDatabaseAccessError(e)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(e){this.handleDatabaseAccessError(e)}}async getKeys(){let e=this.inMemoryCache.getKeys();if(0===e.length)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(e){this.handleDatabaseAccessError(e)}return e}async containsKey(e){let t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(e){this.handleDatabaseAccessError(e)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");let e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}class iL{constructor(e,t,r){this.logger=e,nW(r??!1),this.cache=new iN(this.logger),this.performanceClient=t}createNewGuid(){return nK()}base64Encode(e){return nD(e)}base64Decode(e){return iR(e)}base64UrlEncode(e){return nN(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){let t=this.performanceClient?.startMeasurement(ry.CryptoOptsGetPublicKeyThumbprint,e.correlationId),r=await nY(iL.EXTRACTABLE,iL.POP_KEY_USAGES),n=await nQ(r.publicKey),i=iD({e:n.e,kty:n.kty,n:n.n}),a=await this.hashString(i),o=await nQ(r.privateKey),s=await nJ(o,!1,["sign"]);return await this.cache.setItem(a,{privateKey:s,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),a}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,r,n){let i=this.performanceClient?.startMeasurement(ry.CryptoOptsSignJwt,n),a=await this.cache.getItem(t);if(!a)throw nR(nh);let o=await nQ(a.publicKey),s=iD(o),l=nN(JSON.stringify({kid:t})),c=nN(iI.getShrHeaderString({...r?.header,alg:o.alg,kid:l}));e.cnf={jwk:JSON.parse(s)};let u=nN(JSON.stringify(e)),d=`${c}.${u}`,h=new TextEncoder().encode(d),p=nL(new Uint8Array(await n0(a.privateKey,h))),f=`${d}.${p}`;return i&&i.end({success:!0}),f}async hashString(e){return n1(e)}}function iD(e){return JSON.stringify(e,Object.keys(e).sort())}function iU(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("jwks_uri")}function iF(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}function iB(e){return e.hasOwnProperty("error")&&e.hasOwnProperty("error_description")}iL.POP_KEY_USAGES=["sign","verify"],iL.EXTRACTABLE=!0;let iz=(e,t,r,n,i)=>(...a)=>{r.trace(`Executing function ${t}`);let o=n?.startMeasurement(t,i);if(i){let e=t+"CallCount";n?.incrementFields({[e]:1},i)}try{let n=e(...a);return o?.end({success:!0}),r.trace(`Returning result from ${t}`),n}catch(e){r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw o?.end({success:!1},e),e}},iH=(e,t,r,n,i)=>(...a)=>{r.trace(`Executing function ${t}`);let o=n?.startMeasurement(t,i);if(i){let e=t+"CallCount";n?.incrementFields({[e]:1},i)}return n?.setPreQueueTime(t,i),e(...a).then(e=>(r.trace(`Returning result from ${t}`),o?.end({success:!0}),e)).catch(e=>{r.trace(`Error occurred in ${t}`);try{r.trace(JSON.stringify(e))}catch(e){r.trace("Unable to print error message.")}throw o?.end({success:!1},e),e})};class ij{constructor(e,t,r,n){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=n}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(ry.RegionDiscoveryDetectRegion,this.correlationId);let r=e;if(r)t.region_source=V.ENVIRONMENT_VARIABLE;else{let e=ij.IMDS_OPTIONS;try{let n=await iH(this.getRegionFromIMDS.bind(this),ry.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(p.IMDS_VERSION,e);if(n.status===G.httpSuccess&&(r=n.body,t.region_source=V.IMDS),n.status===G.httpBadRequest){let n=await iH(this.getCurrentVersion.bind(this),ry.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(e);if(!n)return t.region_source=V.FAILED_AUTO_DETECTION,null;let i=await iH(this.getRegionFromIMDS.bind(this),ry.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(n,e);i.status===G.httpSuccess&&(r=i.body,t.region_source=V.IMDS)}}catch(e){return t.region_source=V.FAILED_AUTO_DETECTION,null}}return r||(t.region_source=V.FAILED_AUTO_DETECTION),r||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(ry.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${p.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,p.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(ry.RegionDiscoveryGetCurrentVersion,this.correlationId);try{let t=await this.networkInterface.sendGetRequestAsync(`${p.IMDS_ENDPOINT}?format=json`,e);if(t.status===G.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0)return t.body["newest-versions"][0];return null}catch(e){return null}}}ij.IMDS_OPTIONS={headers:{Metadata:"true"}};class iG{constructor(e,t,r,n,i,a,o,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=o,this.correlationId=a,this.managedIdentity=s||!1,this.regionDiscovery=new ij(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(p.CIAM_AUTH_URL))return t$.Ciam;let t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case p.ADFS:return t$.Adfs;case p.DSTS:return t$.Dsts}return t$.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new t0(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw e$(es)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw e$(es)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw e$(es)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw e$(ez);return this.replacePath(this.metadata.end_session_endpoint)}throw e$(es)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw e$(es)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw e$(es)}canReplaceTenant(e){return 1===e.PathSegments.length&&!iG.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===t$.Default&&this.protocolMode===K.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e,r=new t0(this.metadata.canonical_authority).getUrlComponents(),n=r.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((e,i)=>{let a=n[i];if(0===i&&this.canReplaceTenant(r)){let e=new t0(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];a!==e&&(this.logger.verbose(`Replacing tenant domain name ${a} with id ${e}`),a=e)}e!==a&&(t=t.replace(`/${a}/`,`/${e}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){let e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===t$.Adfs||this.protocolMode!==K.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(ry.AuthorityResolveEndpointsAsync,this.correlationId);let e=this.getCurrentMetadataEntity(),t=await iH(this.updateCloudDiscoveryMetadata.bind(this),ry.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);let r=await iH(this.updateEndpointMetadata.bind(this),ry.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:tp(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==D.CACHE&&r?.source!==D.CACHE&&(e.expiresAt=tp(),e.canonical_authority=this.canonicalAuthority);let n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(ry.AuthorityUpdateEndpointMetadata,this.correlationId);let t=this.updateEndpointMetadataFromLocalSources(e);if(t)return t.source===D.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata&&(tf(e,await iH(this.updateMetadataWithRegionalInformation.bind(this),ry.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata),!1),e.canonical_authority=this.canonicalAuthority),t.source;let r=await iH(this.getEndpointMetadataFromNetwork.bind(this),ry.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(r=await iH(this.updateMetadataWithRegionalInformation.bind(this),ry.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r)),tf(e,r,!0),D.NETWORK;throw e$(ec,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),tf(e,t,!1),{source:D.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let t=this.getEndpointMetadataFromHardcodedValues();if(t)return tf(e,t,!1),{source:D.HARDCODED_VALUES,metadata:t};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}let r=tg(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:D.CACHE}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new t0(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw tH(tR)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(ry.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);let e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{let r=await this.networkInterface.sendGetRequestAsync(t,e);if(iU(r.body))return r.body;return this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null}catch(e){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${e}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in t1?t1[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(ry.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);let t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==p.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=q.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,iG.replaceWithRegionalInformation(e,t);let r=await iH(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),ry.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(r)return this.regionDiscoveryMetadata.region_outcome=q.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=r,iG.replaceWithRegionalInformation(e,r);this.regionDiscoveryMetadata.region_outcome=q.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(ry.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);let t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;let r=await iH(this.getCloudDiscoveryMetadataFromNetwork.bind(this),ry.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return tm(e,r,!0),D.NETWORK;throw tH(tk)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||p.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||p.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||p.NOT_APPLICABLE}`);let t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),tm(e,t,!1),D.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{let t=t6(this.hostnameAndPort);if(t)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),tm(e,t,!1),D.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}let r=tg(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),D.CACHE):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===t$.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),iG.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");let e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=t8(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch(e){throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),tH(tI)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),iG.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(ry.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);let e=`${p.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={},r=null;try{let n,i;let a=await this.networkInterface.sendGetRequestAsync(e,t);if(iF(a.body))i=(n=a.body).metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${n.tenant_discovery_endpoint}`);else{if(!iB(a.body))return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${a.status}`),(n=a.body).error===p.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${n.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${n.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),i=[]}this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=t8(i,this.hostnameAndPort)}catch(e){if(e instanceof et)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${e.errorCode}
Error Description: ${e.errorMessage}`);else{let t=e;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${t.name}
Error Description: ${t.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=iG.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(e=>e&&t0.getDomainFromUrl(e).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==Y.None){let e=t.tenant?t.tenant:p.DEFAULT_COMMON_TENANT;r=`${t.azureCloudInstance}/${e}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return p.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw e$(es)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return t3.has(e)}static isPublicCloudAuthority(e){return p.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){let n=new t0(e);n.validateAsUri();let i=n.getUrlComponents(),a=`${t}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(a=`${t}.${p.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);let o=t0.constructAuthorityUriFromObject({...n.getUrlComponents(),HostNameAndPort:a}).urlString;return r?`${o}?${r}`:o}static replaceWithRegionalInformation(e,t){let r={...e};return r.authorization_endpoint=iG.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=iG.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=iG.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e,r=new t0(e).getUrlComponents();if(0===r.PathSegments.length&&r.HostNameAndPort.endsWith(p.CIAM_AUTH_URL)){let e=r.HostNameAndPort.split(".")[0];t=`${t}${e}${p.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}function iV(e){let t=new t0(e).getUrlComponents(),r=t.PathSegments.slice(-1)[0]?.toLowerCase();switch(r){case b.COMMON:case b.ORGANIZATIONS:case b.CONSUMERS:return;default:return r}}function iq(e){return e.endsWith(p.FORWARD_SLASH)?e:`${e}${p.FORWARD_SLASH}`}function iW(e){let t;let r=e.cloudDiscoveryMetadata;if(r)try{t=JSON.parse(r)}catch(e){throw tH(tI)}return{canonicalAuthority:e.authority?iq(e.authority):void 0,knownAuthorities:e.knownAuthorities,cloudDiscoveryMetadata:t}}iG.reservedTenantDomains=new Set(["{tenant}","{tenantid}",b.COMMON,b.CONSUMERS,b.ORGANIZATIONS]);let iZ="no_tokens_found",iX="native_account_unavailable",i$="refresh_token_expired",iK="bad_token",iY=["interaction_required","consent_required","login_required",iK],iQ=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],iJ={[iZ]:"No refresh token found in the cache. Please sign-in.",[iX]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[i$]:"Refresh token has expired.",[iK]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};iJ[iZ],iJ[iX],iJ[iK];class i0 extends et{constructor(e,t,r,n,i,a,o,s){super(e,t,r),Object.setPrototypeOf(this,i0.prototype),this.timestamp=n||p.EMPTY_STRING,this.traceId=i||p.EMPTY_STRING,this.correlationId=a||p.EMPTY_STRING,this.claims=o||p.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=s}}function i1(e,t,r){let n=!!e&&iY.indexOf(e)>-1,i=!!r&&iQ.indexOf(r)>-1,a=!!t&&iY.some(e=>t.indexOf(e)>-1);return n||a||i}function i2(e){return new i0(e,iJ[e])}class i3{static setRequestState(e,t,r){let n=i3.generateLibraryState(e,r);return t?`${n}${p.RESOURCE_DELIM}${t}`:n}static generateLibraryState(e,t){if(!e)throw e$(ek);let r={id:e.createNewGuid()};t&&(r.meta=t);let n=JSON.stringify(r);return e.base64Encode(n)}static parseRequestState(e,t){if(!e)throw e$(ek);if(!t)throw e$(ed);try{let r=t.split(p.RESOURCE_DELIM),n=r[0],i=r.length>1?r.slice(1).join(p.RESOURCE_DELIM):p.EMPTY_STRING,a=e.base64Decode(n),o=JSON.parse(a);return{userRequestState:i||p.EMPTY_STRING,libraryState:o}}catch(e){throw e$(ed)}}}let i4={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};class i5{constructor(){if(!window.localStorage)throw n8(n2)}getItem(e){return window.localStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}removeItem(e){window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}}class i6{constructor(){if(!window.sessionStorage)throw n8(n2)}getItem(e){return window.sessionStorage.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}function i8(e,t){if(!t)return null;try{return i3.parseRequestState(e,t).libraryState.meta}catch(e){throw e$(ed)}}let i7=864e5;class i9{getItem(e){let t=`${encodeURIComponent(e)}`,r=document.cookie.split(";");for(let e=0;e<r.length;e++){let[n,...i]=decodeURIComponent(r[e]).trim().split("="),a=i.join("=");if(n===t)return a}return""}setItem(e,t,r,n=!0){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=Lax;`;if(r){let e=ae(r);i+=`expires=${e};`}n&&(i+="Secure;"),document.cookie=i}removeItem(e){this.setItem(e,"",-1)}getKeys(){let e=document.cookie.split(";"),t=[];return e.forEach(e=>{let r=decodeURIComponent(e).trim().split("=");t.push(r[0])}),t}containsKey(e){return this.getKeys().includes(e)}}function ae(e){return new Date(new Date().getTime()+e*i7).toUTCString()}class at extends rn{constructor(e,t,r,n,i,a){super(e,r,n,i),this.cacheConfig=t,this.logger=n,this.internalStorage=new iO,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupBrowserStorage(this.cacheConfig.temporaryCacheLocation),this.cookieStorage=new i9,t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=a}setupBrowserStorage(e){try{switch(e){case rx.LocalStorage:return new i5;case rx.SessionStorage:return new i6;case rx.MemoryStorage:}}catch(e){this.logger.error(e)}return this.cacheConfig.cacheLocation=rx.MemoryStorage,new iO}migrateCacheEntries(){let e=this.browserStorage.getItem(rA.VERSION);e&&this.logger.info(`MSAL.js was last initialized with version ${e}`),e!==iw&&this.browserStorage.setItem(rA.VERSION,iw);let t=`${p.CACHE_PREFIX}.${v.ID_TOKEN}`,r=`${p.CACHE_PREFIX}.${v.CLIENT_INFO}`,n=`${p.CACHE_PREFIX}.${v.ERROR}`,i=`${p.CACHE_PREFIX}.${v.ERROR_DESC}`,a=this.browserStorage.getItem(t),o=[a,this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(i)];[v.ID_TOKEN,v.CLIENT_INFO,v.ERROR,v.ERROR_DESC].forEach((e,t)=>{let r=o[t];r&&this.setTemporaryCache(e,r,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");let e=this.cryptoImpl.createNewGuid(),t=this.getItem(rA.ACCOUNT_KEYS),r=this.getItem(`${rA.TOKEN_KEYS}.${this.clientId}`);if(t&&r){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(t=>{if(this.isCredentialKey(t)){let r=this.getItem(t);if(r){let n=this.validateAndParseJson(r);if(n&&n.hasOwnProperty("credentialType"))switch(n.credentialType){case R.ID_TOKEN:if(tt(n)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${t} found, saving key to token key map`);let r=n,i=this.updateCredentialCacheKey(t,r,e);this.addTokenKey(i,R.ID_TOKEN,e);return}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${t}`);break;case R.ACCESS_TOKEN:case R.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(te(n)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${t} found, saving key to token key map`);let r=n,i=this.updateCredentialCacheKey(t,r,e);this.addTokenKey(i,R.ACCESS_TOKEN,e);return}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${t}`);break;case R.REFRESH_TOKEN:if(tr(n)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${t} found, saving key to token key map`);let r=n,i=this.updateCredentialCacheKey(t,r,e);this.addTokenKey(i,R.REFRESH_TOKEN,e);return}this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${t}`)}}}if(this.isAccountKey(t)){let r=this.getItem(t);if(r){let n=this.validateAndParseJson(r);n&&tY.isAccountEntity(n)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${t} found, saving key to account key map`),this.addAccountKeyToMap(t,e))}}})}validateAndParseJson(e){try{let t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t,r){let n=[],i=20;for(let a=0;a<=i;a++)try{this.browserStorage.setItem(e,t),a>0&&this.removeAccessTokenKeys(n.slice(0,a),r);break}catch(s){let o=rr(s);if(o.errorCode===t7&&a<i){if(n.length||(n=e===`${rA.TOKEN_KEYS}.${this.clientId}`?JSON.parse(t).accessToken:this.getTokenKeys().accessToken),n.length<=a)throw o;this.removeAccessToken(n[a],r,!1)}else throw o}}getAccount(e,t,r){this.logger.trace("BrowserCacheManager.getAccount called");let n=this.getCachedAccountEntity(e,t);return this.updateOutdatedCachedAccount(e,n,t,r)}getCachedAccountEntity(e,t){let r=this.getItem(e);if(!r)return this.removeAccountKeyFromMap(e,t),null;let n=this.validateAndParseJson(r);return n&&tY.isAccountEntity(n)?rn.toObject(new tY,n):null}setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");let r=e.generateAccountKey();e.lastUpdatedAt=Date.now().toString(),this.setItem(r,JSON.stringify(e),t),this.addAccountKeyToMap(r,t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");let e=this.getItem(rA.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);let r=this.getAccountKeys();-1===r.indexOf(e)?(r.push(e),this.setItem(rA.ACCOUNT_KEYS,JSON.stringify(r),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);let r=this.getAccountKeys(),n=r.indexOf(e);if(n>-1){if(r.splice(n,1),0===r.length){this.removeItem(rA.ACCOUNT_KEYS);return}this.setItem(rA.ACCOUNT_KEYS,JSON.stringify(r),t),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e,t){super.removeAccount(e,t),this.removeAccountKeyFromMap(e,t)}removeOutdatedAccount(e,t){this.removeItem(e),this.removeAccountKeyFromMap(e,t)}removeIdToken(e,t){super.removeIdToken(e,t),this.removeTokenKey(e,R.ID_TOKEN,t)}removeAccessToken(e,t,r=!0){super.removeAccessToken(e,t),this.performanceClient?.incrementFields({accessTokensRemoved:1},t),r&&this.removeTokenKey(e,R.ACCESS_TOKEN,t)}removeAccessTokenKeys(e,t){this.logger.trace("removeAccessTokenKey called");let r=this.getTokenKeys(),n=0;if(e.forEach(e=>{let t=r.accessToken.indexOf(e);t>-1&&(r.accessToken.splice(t,1),n++)}),n>0){this.logger.info(`removed ${n} accessToken keys from tokenKeys map`),this.setTokenKeys(r,t);return}}removeRefreshToken(e,t){super.removeRefreshToken(e,t),this.removeTokenKey(e,R.REFRESH_TOKEN,t)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");let e=this.getItem(`${rA.TOKEN_KEYS}.${this.clientId}`);if(e){let t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}setTokenKeys(e,t){if(0===e.idToken.length&&0===e.accessToken.length&&0===e.refreshToken.length){this.removeItem(`${rA.TOKEN_KEYS}.${this.clientId}`);return}this.setItem(`${rA.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(e),t)}addTokenKey(e,t,r){this.logger.trace("BrowserCacheManager addTokenKey called");let n=this.getTokenKeys();switch(t){case R.ID_TOKEN:-1===n.idToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),n.idToken.push(e));break;case R.ACCESS_TOKEN:let i=n.accessToken.indexOf(e);-1!==i&&n.accessToken.splice(i,1),this.logger.trace(`access token ${-1===i?"added to":"updated in"} map`),n.accessToken.push(e);break;case R.REFRESH_TOKEN:-1===n.refreshToken.indexOf(e)&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),n.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),e$(eP)}this.setTokenKeys(n,r)}removeTokenKey(e,t,r,n=this.getTokenKeys()){switch(this.logger.trace("BrowserCacheManager removeTokenKey called"),t){case R.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);let i=n.idToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),n.idToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case R.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);let a=n.accessToken.indexOf(e);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),n.accessToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case R.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);let o=n.refreshToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),n.refreshToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),e$(eP)}this.setTokenKeys(n,r)}getIdTokenCredential(e,t){let r=this.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;let n=this.validateAndParseJson(r);return n&&tt(n)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)}setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");let r=e5(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(r,JSON.stringify(e),t),this.addTokenKey(r,R.ID_TOKEN,t)}getAccessTokenCredential(e,t){let r=this.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,R.ACCESS_TOKEN,t),null;let n=this.validateAndParseJson(r);return n&&te(n)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)}setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");let r=e5(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(r,JSON.stringify(e),t),this.addTokenKey(r,R.ACCESS_TOKEN,t)}getRefreshTokenCredential(e,t){let r=this.getItem(e);if(!r)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,R.REFRESH_TOKEN,t),null;let n=this.validateAndParseJson(r);return n&&tr(n)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),n):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)}setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");let r=e5(e);e.lastUpdatedAt=Date.now().toString(),this.setItem(r,JSON.stringify(e),t),this.addTokenKey(r,R.REFRESH_TOKEN,t)}getAppMetadata(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;let r=this.validateAndParseJson(t);return r&&td(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");let r=tu(e);this.setItem(r,JSON.stringify(e),t)}getServerTelemetry(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;let r=this.validateAndParseJson(t);return r&&tl(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)}setServerTelemetry(e,t,r){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),r)}getAuthorityMetadata(e){let t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;let r=this.validateAndParseJson(t);return r&&th(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(e=>this.isAuthorityMetadata(e))}setWrapperMetadata(e,t){this.internalStorage.setItem(rM,e),this.internalStorage.setItem(rI,t)}getWrapperMetadata(){return[this.internalStorage.getItem(rM)||p.EMPTY_STRING,this.internalStorage.getItem(rI)||p.EMPTY_STRING]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){let t=this.generateCacheKey(v.ACTIVE_ACCOUNT_FILTERS),r=this.getItem(t);if(!r){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");let t=this.generateCacheKey(v.ACTIVE_ACCOUNT),r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;let n=this.getAccountInfoFilteredBy({localAccountId:r},e);return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(n,e),n):null}let n=this.validateAndParseJson(r);return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:n.homeAccountId,localAccountId:n.localAccountId,tenantId:n.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){let r=this.generateCacheKey(v.ACTIVE_ACCOUNT_FILTERS),n=this.generateCacheKey(v.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");let i={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:Date.now().toString()};this.setItem(r,JSON.stringify(i),t),this.setItem(n,e.localAccountId,t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(r),this.browserStorage.removeItem(n)}getThrottlingCache(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;let r=this.validateAndParseJson(t);return r&&tc(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)}setThrottlingCache(e,t,r){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),r)}getTemporaryCache(e,t){let r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){let e=this.cookieStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),e}let n=this.temporaryCacheStorage.getItem(r);if(!n){if(this.cacheConfig.cacheLocation===rx.LocalStorage){let e=this.browserStorage.getItem(r);if(e)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),e}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),n}setTemporaryCache(e,t,r){let n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(n,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(e){await this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(e=>{(-1!==e.indexOf(p.CACHE_PREFIX)||-1!==e.indexOf(this.clientId))&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(-1!==e.indexOf(p.CACHE_PREFIX)||-1!==e.indexOf(this.clientId))&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(ry.ClearTokensAndKeysWithClaims,t);let r=this.getTokenKeys(),n=0;r.accessToken.forEach(e=>{let r=this.getAccessTokenCredential(e,t);r?.requestedClaimsHash&&e.includes(r.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(e,t),n++)}),n>0&&this.logger.warning(`${n} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):tj.startsWith(e,p.CACHE_PREFIX)||tj.startsWith(e,v.ADAL_ID_TOKEN)?e:`${p.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){let{libraryState:{id:t}}=i3.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${rC.AUTHORITY}.${t}`)}generateNonceKey(e){let{libraryState:{id:t}}=i3.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${rC.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){let{libraryState:{id:t}}=i3.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${rC.REQUEST_STATE}.${t}`)}getCachedAuthority(e){let t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;let n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)}updateCacheEntries(e,t,r,n,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");let a=this.generateStateKey(e);this.setTemporaryCache(a,e,!1);let o=this.generateNonceKey(e);this.setTemporaryCache(o,t,!1);let s=this.generateAuthorityKey(e);if(this.setTemporaryCache(s,r,!1),i){let e={credential:i.homeAccountId,type:i4.HOME_ACCOUNT_ID};this.setTemporaryCache(rC.CCS_CREDENTIAL,JSON.stringify(e),!0)}else if(n){let e={credential:n,type:i4.UPN};this.setTemporaryCache(rC.CCS_CREDENTIAL,JSON.stringify(e),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{-1!==t.indexOf(e)&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(rC.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(rC.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(rC.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(rC.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(rC.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(rC.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){let t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r||p.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(-1===t.indexOf(rC.REQUEST_STATE))return;let r=this.temporaryCacheStorage.getItem(t);if(!r)return;let n=i8(this.cryptoImpl,r);n&&n.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r))}),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");let t=nD(JSON.stringify(e));this.setTemporaryCache(rC.REQUEST_PARAMS,t,!0)}getCachedRequest(e){let t;this.logger.trace("BrowserCacheManager.getCachedRequest called");let r=this.getTemporaryCache(rC.REQUEST_PARAMS,!0);if(!r)throw nR(ne);try{t=JSON.parse(iR(r))}catch(e){throw this.logger.errorPii(`Attempted to parse: ${r}`),this.logger.error(`Parsing cached token request threw with error: ${e}`),nR(nt)}if(this.removeTemporaryItem(this.generateCacheKey(rC.REQUEST_PARAMS)),!t.authority){let r=this.generateAuthorityKey(e),n=this.getTemporaryCache(r);if(!n)throw nR(nr);t.authority=n}return t}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");let e=this.getTemporaryCache(rC.NATIVE_REQUEST,!0);return e?this.validateAndParseJson(e)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null):(this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null)}isInteractionInProgress(e){let t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){let e=`${p.CACHE_PREFIX}.${rC.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){let t=`${p.CACHE_PREFIX}.${rC.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw nR(rY);this.setTemporaryCache(t,this.clientId,!1)}else e||this.getInteractionInProgress()!==this.clientId||this.removeTemporaryItem(t)}getLegacyLoginHint(){let e=this.getTemporaryCache(v.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(v.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));let t=this.getTemporaryCache(v.ID_TOKEN,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(v.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));let r=t||e;if(r){let e=eJ(r,iR);if(e.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),e.preferred_username;if(e.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),e.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t,r){let n=e5(t);if(e!==n){let i=this.getItem(e);if(i)return this.browserStorage.removeItem(e),this.setItem(n,i,r),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}async hydrateCache(e,t){let r;let n=e6(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);t.claims&&(r=await this.cryptoImpl.hashString(t.claims));let i={idToken:n,accessToken:e8(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,iR,void 0,e.tokenType,void 0,t.sshKid,t.claims,r)};return this.saveCacheRecord(i,e.correlationId)}async saveCacheRecord(e,t,r){try{await super.saveCacheRecord(e,t,r)}catch(e){if(e instanceof rt&&this.performanceClient&&t)try{let e=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:e.refreshToken.length,cacheIdCount:e.idToken.length,cacheAtCount:e.accessToken.length},t)}catch(e){}throw e}}}let ar=(e,t)=>new at(e,{cacheLocation:rx.MemoryStorage,temporaryCacheLocation:rx.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1},eK,t);function an(e,t,r,n,i){return e.verbose("getAllAccounts called"),r?t.getAllAccounts(n,i):[]}function ai(e,t,r,n){if(t.trace("getAccount called"),0===Object.keys(e).length)return t.warning("getAccount: No accountFilter provided"),null;let i=r.getAccountInfoFilteredBy(e,n);return i?(t.verbose("getAccount: Account matching provided filter found, returning"),i):(t.verbose("getAccount: No matching account found, returning null"),null)}function aa(e,t,r,n){if(t.trace("getAccountByUsername called"),!e)return t.warning("getAccountByUsername: No username provided"),null;let i=r.getAccountInfoFilteredBy({username:e},n);return i?(t.verbose("getAccountByUsername: Account matching username found, returning"),t.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${e}`),i):(t.verbose("getAccountByUsername: No matching account found, returning null"),null)}function ao(e,t,r,n){if(t.trace("getAccountByHomeId called"),!e)return t.warning("getAccountByHomeId: No homeAccountId provided"),null;let i=r.getAccountInfoFilteredBy({homeAccountId:e},n);return i?(t.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),t.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${e}`),i):(t.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function as(e,t,r,n){if(t.trace("getAccountByLocalId called"),!e)return t.warning("getAccountByLocalId: No localAccountId provided"),null;let i=r.getAccountInfoFilteredBy({localAccountId:e},n);return i?(t.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),t.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${e}`),i):(t.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function al(e,t,r){t.setActiveAccount(e,r)}function ac(e,t){return e.getActiveAccount(t)}let au={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};class ad{constructor(e){this.eventCallbacks=new Map,this.logger=e||new $({})}addEventCallback(e,t,r){if("undefined"!=typeof window){let n=r||ip();return this.eventCallbacks.has(n)?(this.logger.error(`Event callback with id: ${n} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(n,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${n}`),n)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,r,n){if("undefined"!=typeof window){let i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.eventCallbacks.forEach(([t,r],n)=>{(0===r.length||r.includes(e))&&(this.logger.verbose(`Emitting event to callback ${n}: ${e}`),t.apply(null,[i]))})}}}class ah extends et{constructor(e,t,r,n,i){super(e,t,r),this.name="ServerError",this.errorNo=n,this.status=i,Object.setPrototypeOf(this,ah.prototype)}}class ap{static generateThrottlingStorageKey(e){return`${B.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t,r){let n=ap.generateThrottlingStorageKey(t),i=e.getThrottlingCache(n);if(i){if(i.throttleTime<Date.now()){e.removeItem(n,r);return}throw new ah(i.errorCodes?.join(" ")||p.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,t,r,n){if(ap.checkResponseStatus(r)||ap.checkResponseForRetryAfter(r)){let i={throttleTime:ap.calculateThrottleTime(parseInt(r.headers[y.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(ap.generateThrottlingStorageKey(t),i,n)}}static checkResponseStatus(e){return 429===e.status||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return!!e.headers&&e.headers.hasOwnProperty(y.RETRY_AFTER)&&(e.status<200||e.status>=300)}static calculateThrottleTime(e){let t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||B.DEFAULT_THROTTLE_TIME_SECONDS),r+B.DEFAULT_MAX_THROTTLE_TIME_SECONDS))}static removeThrottle(e,t,r,n){let i={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},a=this.generateThrottlingStorageKey(i);e.removeItem(a,r.correlationId)}}let af="client_id",am="redirect_uri",ag="response_type",ay="response_mode",av="grant_type",ab="claims",a_="scope",aw="refresh_token",aS="state",aT="nonce",ax="prompt",aE="code",aC="code_challenge",aA="code_challenge_method",aM="code_verifier",aI="client-request-id",aR="x-client-SKU",ak="x-client-VER",aP="x-client-OS",aO="x-client-CPU",aN="x-client-current-telemetry",aL="x-client-last-telemetry",aD="x-ms-lib-capability",aU="x-app-name",aF="x-app-ver",aB="post_logout_redirect_uri",az="id_token_hint",aH="device_code",aj="client_secret",aG="client_assertion",aV="client_assertion_type",aq="token_type",aW="req_cnf",aZ="assertion",aX="requested_token_use",a$="return_spa_code",aK="nativebroker",aY="logout_hint",aQ="sid",aJ="login_hint",a0="domain_hint",a1="x-client-xtra-sku",a2="brk_client_id",a3="brk_redirect_uri";class a4{static validateRedirectUri(e){if(!e)throw tH(ty)}static validatePrompt(e){let t=[];for(let e in w)t.push(w[e]);if(0>t.indexOf(e))throw tH(tT)}static validateClaims(e){try{JSON.parse(e)}catch(e){throw tH(tx)}}static validateCodeChallengeParams(e,t){if(e&&t)this.validateCodeChallengeMethod(t);else throw tH(tM)}static validateCodeChallengeMethod(e){if(0>[S,T].indexOf(e))throw tH(tA)}}function a5(e,t,r){if(!t)return;let n=e.get(af);n&&e.has(a2)&&r?.addFields({embeddedClientId:n,embeddedRedirectUri:e.get(am)},t)}class a6{constructor(e,t){this.parameters=new Map,this.performanceClient=t,this.correlationId=e}addResponseTypeCode(){this.parameters.set(ag,encodeURIComponent(p.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(ag,encodeURIComponent(`${p.TOKEN_RESPONSE_TYPE} ${p.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(ay,encodeURIComponent(e||E.QUERY))}addNativeBroker(){this.parameters.set(aK,encodeURIComponent("1"))}addScopes(e,t=!0,r=m){!t||r.includes("openid")||e.includes("openid")||r.push("openid");let n=new tG(t?[...e||[],...r]:e||[]);this.parameters.set(a_,encodeURIComponent(n.printScopes()))}addClientId(e){this.parameters.set(af,encodeURIComponent(e))}addRedirectUri(e){a4.validateRedirectUri(e),this.parameters.set(am,encodeURIComponent(e))}addPostLogoutRedirectUri(e){a4.validateRedirectUri(e),this.parameters.set(aB,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(az,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(a0,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(aJ,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(y.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(y.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(aQ,encodeURIComponent(e))}addClaims(e,t){let r=this.addClientCapabilitiesToClaims(e,t);a4.validateClaims(r),this.parameters.set(ab,encodeURIComponent(r))}addCorrelationId(e){this.parameters.set(aI,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(aR,e.sku),this.parameters.set(ak,e.version),e.os&&this.parameters.set(aP,e.os),e.cpu&&this.parameters.set(aO,e.cpu)}addApplicationTelemetry(e){e?.appName&&this.parameters.set(aU,e.appName),e?.appVersion&&this.parameters.set(aF,e.appVersion)}addPrompt(e){a4.validatePrompt(e),this.parameters.set(`${ax}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(aS,encodeURIComponent(e))}addNonce(e){this.parameters.set(aT,encodeURIComponent(e))}addCodeChallengeParams(e,t){if(a4.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(aC,encodeURIComponent(e)),this.parameters.set(aA,encodeURIComponent(t));else throw tH(tM)}addAuthorizationCode(e){this.parameters.set(aE,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(aH,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(aw,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(aM,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(aj,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(aG,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(aV,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(aZ,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(aX,encodeURIComponent(e))}addGrantType(e){this.parameters.set(av,encodeURIComponent(e))}addClientInfo(){this.parameters.set(P,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([e,t])=>{!this.parameters.has(e)&&t&&this.parameters.set(e,t)})}addClientCapabilitiesToClaims(e,t){let r;if(e)try{r=JSON.parse(e)}catch(e){throw tH(tx)}else r={};return t&&t.length>0&&(r.hasOwnProperty(_.ACCESS_TOKEN)||(r[_.ACCESS_TOKEN]={}),r[_.ACCESS_TOKEN][_.XMS_CC]={values:t}),JSON.stringify(r)}addUsername(e){this.parameters.set(H,encodeURIComponent(e))}addPassword(e){this.parameters.set(j,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(aq,F.POP),this.parameters.set(aW,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(aq,F.SSH),this.parameters.set(aW,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(aN,e.generateCurrentRequestHeaderValue()),this.parameters.set(aL,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(aD,B.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(aY,encodeURIComponent(e))}addBrokerParameters(e){let t={};t[a2]=e.brokerClientId,t[a3]=e.brokerRedirectUri,this.addExtraQueryParameters(t)}createQueryString(){let e=[];return this.parameters.forEach((t,r)=>{e.push(`${r}=${t}`)}),a5(this.parameters,this.correlationId,this.performanceClient),e.join("&")}}async function a8(e,t,r,n,i,a,o){o?.addQueueMeasurement(ry.AuthorityFactoryCreateDiscoveredInstance,a);let s=iG.transformCIAMAuthority(iq(e)),l=new iG(s,t,r,n,i,a,o);try{return await iH(l.resolveEndpointsAsync.bind(l),ry.AuthorityResolveEndpointsAsync,i,o,a)(),l}catch(e){throw e$(es)}}class a7{constructor(e,t){this.config=rp(e),this.logger=new $(this.config.loggerOptions,eY,eQ),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){let t={};if(t[y.CONTENT_TYPE]=p.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case i4.HOME_ACCOUNT_ID:try{let r=tq(e.credential);t[y.CCS_HEADER]=`Oid:${r.uid}@${r.utid}`}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case i4.UPN:t[y.CCS_HEADER]=`UPN: ${e.credential}`}return t}async executePostToTokenEndpoint(e,t,r,n,i,a){a&&this.performanceClient?.addQueueMeasurement(a,i);let o=await this.sendPostRequest(n,e,{body:t,headers:r},i);return this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),o}async sendPostRequest(e,t,r,n){let i;ap.preProcess(this.cacheManager,e,n);try{let e=(i=await iH(this.networkClient.sendPostRequestAsync.bind(this.networkClient),ry.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,n)(t,r)).headers||{};this.performanceClient?.addFields({refreshTokenSize:i.body.refresh_token?.length||0,httpVerToken:e[y.X_MS_HTTP_VERSION]||"",requestId:e[y.X_MS_REQUEST_ID]||""},n)}catch(e){if(e instanceof rH){let t=e.responseHeaders;throw t&&this.performanceClient?.addFields({httpVerToken:t[y.X_MS_HTTP_VERSION]||"",requestId:t[y.X_MS_REQUEST_ID]||"",contentTypeHeader:t[y.CONTENT_TYPE]||void 0,contentLengthHeader:t[y.CONTENT_LENGTH]||void 0,httpStatus:e.httpStatus},n),e.error}if(e instanceof et)throw e;throw e$(el)}return ap.postProcess(this.cacheManager,e,i,n),i}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(ry.UpdateTokenEndpointAuthority,t);let r=`https://${e}/${this.authority.tenant}/`,n=await a8(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=n}createTokenQueryParameters(e){let t=new a6(e.correlationId,this.performanceClient);return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.addCorrelationId(e.correlationId),t.createQueryString()}}let a9="sw";class oe{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(ry.PopTokenGenerateCnf,e.correlationId);let r=await iH(this.generateKid.bind(this),ry.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),n=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:n}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(ry.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:a9}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,n){let{resourceRequestMethod:i,resourceRequestUri:a,shrClaims:o,shrNonce:s,shrOptions:l}=r,c=a?new t0(a):void 0,u=c?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:e2(),m:i?.toUpperCase(),u:u?.HostNameAndPort,nonce:s||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:o||void 0,...n},t,l,r.correlationId)}}class ot{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}function or(e){let t="code=",r=e.error_uri?.lastIndexOf(t);return r&&r>=0?e.error_uri?.substring(r+t.length):void 0}class on{constructor(e,t,r,n,i,a,o){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=i,this.persistencePlugin=a,this.performanceClient=o}validateServerAuthorizationCodeResponse(e,t){let r,n;if(!e.state||!t)throw e.state?e$(ep,"Cached State"):e$(ep,"Server State");try{r=decodeURIComponent(e.state)}catch(t){throw e$(ed,e.state)}try{n=decodeURIComponent(t)}catch(t){throw e$(ed,e.state)}if(r!==n)throw e$(eh);if(e.error||e.error_description||e.suberror){let t=or(e);if(i1(e.error,e.error_description,e.suberror))throw new i0(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",t);throw new ah(e.error||"",e.error_description,e.suberror,t)}}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){let r=`Error(s): ${e.error_codes||p.NOT_AVAILABLE} - Timestamp: ${e.timestamp||p.NOT_AVAILABLE} - Description: ${e.error_description||p.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||p.NOT_AVAILABLE} - Trace ID: ${e.trace_id||p.NOT_AVAILABLE}`,n=e.error_codes?.length?e.error_codes[0]:void 0,i=new ah(e.error,r,e.suberror,n,e.status);if(t&&e.status&&e.status>=f.SERVER_ERROR_RANGE_START&&e.status<=f.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${i}`);return}if(t&&e.status&&e.status>=f.CLIENT_ERROR_RANGE_START&&e.status<=f.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${i}`);return}if(i1(e.error,e.error_description,e.suberror))throw new i0(e.error,e.error_description,e.suberror,e.timestamp||p.EMPTY_STRING,e.trace_id||p.EMPTY_STRING,e.correlation_id||p.EMPTY_STRING,e.claims||p.EMPTY_STRING,n);throw i}}async handleServerTokenResponse(e,t,r,n,i,a,o,s,l){let c,u,d;if(this.performanceClient?.addQueueMeasurement(ry.HandleServerTokenResponse,e.correlation_id),e.id_token){if(c=eJ(e.id_token||p.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&c.nonce!==i.nonce)throw e$(ef);if(n.maxAge||0===n.maxAge){let e=c.auth_time;if(!e)throw e$(em);e1(e,n.maxAge)}}this.homeAccountIdentifier=tY.generateHomeAccountId(e.client_info||p.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,c),i&&i.state&&(u=i3.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||n.sshKid||void 0;let h=this.generateCacheRecord(e,t,r,n,c,a,i);try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),d=new ot(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(d)),o&&!s&&h.account){let e=h.account.generateAccountKey();if(!this.cacheStorage.getAccount(e,n.correlationId,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await on.generateAuthenticationResult(this.cryptoObj,t,h,!1,n,c,u,void 0,l)}await this.cacheStorage.saveCacheRecord(h,n.correlationId,n.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&d&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(d))}return on.generateAuthenticationResult(this.cryptoObj,t,h,!1,n,c,u,e,l)}generateCacheRecord(e,t,r,n,i,a,o){let s,l;let c=t.getPreferredCache();if(!c)throw e$(eI);let u=tK(i);e.id_token&&i&&(s=e6(this.homeAccountIdentifier,c,e.id_token,this.clientId,u||""),l=oi(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,n.correlationId,i,e.client_info,c,u,o,void 0,this.logger));let d=null;if(e.access_token){let i=e.scope?tG.fromString(e.scope):new tG(n.scopes||[]),o=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,s=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,l=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,h=r+o,p=h+s,f=l&&l>0?r+l:void 0;d=e8(this.homeAccountIdentifier,c,e.access_token,this.clientId,u||t.tenant||"",i.printScopes(),h,p,this.cryptoObj.base64Decode,f,e.token_type,a,e.key_id,n.claims,n.requestedClaimsHash)}let h=null;if(e.refresh_token){let t;e.refresh_token_expires_in&&(t=r+("string"==typeof e.refresh_token_expires_in?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in)),h=e7(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,a,t)}let p=null;return e.foci&&(p={clientId:this.clientId,environment:c,familyId:e.foci}),{account:l,idToken:s,accessToken:d,refreshToken:h,appMetadata:p}}static async generateAuthenticationResult(e,t,r,n,i,a,o,s,l){let c,u,d=p.EMPTY_STRING,h=[],f=null,m=p.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType!==F.POP||i.popKid)d=r.accessToken.secret;else{let t=new oe(e),{secret:n,keyId:a}=r.accessToken;if(!a)throw e$(eH);d=await t.signPopToken(n,a,i)}h=tG.fromString(r.accessToken.target).asArray(),f=new Date(1e3*Number(r.accessToken.expiresOn)),c=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),r.accessToken.refreshOn&&(u=new Date(1e3*Number(r.accessToken.refreshOn)))}r.appMetadata&&(m=r.appMetadata.familyId===O?O:"");let g=a?.oid||a?.sub||"",y=a?.tid||"";s?.spa_accountid&&r.account&&(r.account.nativeAccountId=s?.spa_accountid);let v=r.account?tX(r.account.getAccountInfo(),void 0,a,r.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:g,tenantId:y,scopes:h,account:v,idToken:r?.idToken?.secret||"",idTokenClaims:a||{},accessToken:d,fromCache:n,expiresOn:f,extExpiresOn:c,refreshOn:u,correlationId:i.correlationId,requestId:l||p.EMPTY_STRING,familyId:m,tokenType:r.accessToken?.tokenType||p.EMPTY_STRING,state:o?o.userRequestState:p.EMPTY_STRING,cloudGraphHostName:r.account?.cloudGraphHostName||p.EMPTY_STRING,msGraphHost:r.account?.msGraphHost||p.EMPTY_STRING,code:s?.spa_code,fromNativeBroker:!1}}}function oi(e,t,r,n,i,a,o,s,l,c,u,d){d?.verbose("setCachedAccount called");let h=e.getAccountKeys().find(e=>e.startsWith(r)),p=null;h&&(p=e.getAccount(h,i,d));let f=p||tY.createAccount({homeAccountId:r,idTokenClaims:a,clientInfo:o,environment:s,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:u},t,n),m=f.tenantProfiles||[],g=l||f.realm;if(g&&!m.find(e=>e.tenantId===g)){let e=tZ(r,f.localAccountId,g,a);m.push(e)}return f.tenantProfiles=m,f}async function oa(e,t,r){return"string"==typeof e?e:e({clientId:t,tokenEndpoint:r})}class oo extends a7{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async getAuthCodeUrl(e){this.performanceClient?.addQueueMeasurement(ry.GetAuthCodeUrl,e.correlationId);let t=await iH(this.createAuthCodeUrlQueryString.bind(this),ry.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return t0.appendQueryString(this.authority.authorizationEndpoint,t)}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(ry.AuthClientAcquireToken,e.correlationId),!e.code)throw e$(e_);let r=e2(),n=await iH(this.executeTokenRequest.bind(this),ry.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=n.headers?.[y.X_MS_REQUEST_ID],a=new on(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return a.validateTokenResponse(n.body),iH(a.handleServerTokenResponse.bind(a),ry.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,r,e,t,void 0,void 0,void 0,i)}handleFragmentResponse(e,t){if(new on(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw e$(eF);return e}getLogoutUri(e){if(!e)throw tH(tC);let t=this.createLogoutUrlQueryString(e);return t0.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){let r;this.performanceClient?.addQueueMeasurement(ry.AuthClientExecuteTokenRequest,t.correlationId);let n=this.createTokenQueryParameters(t),i=t0.appendQueryString(e.tokenEndpoint,n),a=await iH(this.createTokenRequestBody.bind(this),ry.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);if(t.clientInfo)try{let e=tV(t.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${e.uid}${I.CLIENT_INFO_SEPARATOR}${e.utid}`,type:i4.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}let o=this.createTokenRequestHeaders(r||t.ccsCredential),s={clientId:t.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return iH(this.executePostToTokenEndpoint.bind(this),ry.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(i,a,o,s,t.correlationId,ry.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){let t;this.performanceClient?.addQueueMeasurement(ry.AuthClientCreateTokenRequestBody,e.correlationId);let r=new a6(e.correlationId,this.performanceClient);if(r.addClientId(e.embeddedClientId||e.tokenBodyParameters?.[af]||this.config.authOptions.clientId),this.includeRedirectUri?r.addRedirectUri(e.redirectUri):a4.validateRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,this.oidcDefaultScopes),r.addAuthorizationCode(e.code),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!rm(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&r.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let t=this.config.clientCredentials.clientAssertion;r.addClientAssertion(await oa(t.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(t.assertionType)}if(r.addGrantType(C),r.addClientInfo(),e.authenticationScheme===F.POP){let t;let n=new oe(this.cryptoUtils,this.performanceClient);t=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await iH(n.generateCnf.bind(n),ry.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(t)}else if(e.authenticationScheme===F.SSH){if(e.sshJwk)r.addSshJwk(e.sshJwk);else throw tH(tP)}if((!tj.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.clientInfo)try{let r=tV(e.clientInfo,this.cryptoUtils.base64Decode);t={credential:`${r.uid}${I.CLIENT_INFO_SEPARATOR}${r.utid}`,type:i4.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else t=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&t)switch(t.type){case i4.HOME_ACCOUNT_ID:try{let e=tq(t.credential);r.addCcsOid(e)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case i4.UPN:r.addCcsUpn(t.credential)}return e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),!e.enableSpaAuthorizationCode||e.tokenBodyParameters&&e.tokenBodyParameters[a$]||r.addExtraQueryParameters({[a$]:"1"}),r.createQueryString()}async createAuthCodeUrlQueryString(e){let t=e.correlationId||this.config.cryptoInterface.createNewGuid();this.performanceClient?.addQueueMeasurement(ry.AuthClientCreateQueryString,t);let r=new a6(t,this.performanceClient);r.addClientId(e.embeddedClientId||e.extraQueryParameters?.[af]||this.config.authOptions.clientId);let n=[...e.scopes||[],...e.extraScopesToConsent||[]];if(r.addScopes(n,!0,this.oidcDefaultScopes),r.addRedirectUri(e.redirectUri),r.addCorrelationId(t),r.addResponseMode(e.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),rm(this.config)||r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&r.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&r.addPrompt(e.prompt),e.domainHint&&r.addDomainHint(e.domainHint),e.prompt!==w.SELECT_ACCOUNT){if(e.sid&&e.prompt===w.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(e.sid);else if(e.account){let t=this.extractAccountSid(e.account),n=this.extractLoginHint(e.account);if(n&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),n=null),n){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(n);try{let t=tq(e.account.homeAccountId);r.addCcsOid(t)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(t&&e.prompt===w.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(t);try{let t=tq(e.account.homeAccountId);r.addCcsOid(t)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(e.account.username);try{let t=tq(e.account.homeAccountId);r.addCcsOid(t)}catch(e){this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint))}else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&r.addNonce(e.nonce),e.state&&r.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),this.addExtraQueryParams(e,r),e.nativeBroker&&(r.addNativeBroker(),e.authenticationScheme===F.POP)){let t;let n=new oe(this.cryptoUtils);t=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await iH(n.generateCnf.bind(n),ry.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(t)}return r.createQueryString()}createLogoutUrlQueryString(e){let t=new a6(e.correlationId,this.performanceClient);return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){return e.idTokenClaims?.sid||null}extractLoginHint(e){return e.idTokenClaims?.login_hint||null}}let os=",",ol="|";function oc(e){let{skus:t,libraryName:r,libraryVersion:n,extensionName:i,extensionVersion:a}=e,o=new Map([[0,[r,n]],[2,[i,a]]]),s=[];if(t?.length){if((s=t.split(os)).length<4)return t}else s=Array.from({length:4},()=>ol);return o.forEach((e,t)=>{2===e.length&&e[0]?.length&&e[1]?.length&&ou({skuArr:s,index:t,skuName:e[0],skuVersion:e[1]})}),s.join(os)}function ou(e){let{skuArr:t,index:r,skuName:n,skuVersion:i}=e;r>=t.length||(t[r]=[n,i].join(ol))}class od{constructor(e,t){this.cacheOutcome=W.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||p.EMPTY_STRING,this.wrapperVer=e.wrapperVer||p.EMPTY_STRING,this.telemetryCacheKey=U.CACHE_KEY+I.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){let e=`${this.apiId}${U.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r?.length&&t.push(`broker_error=${r}`);let n=t.join(U.VALUE_SEPARATOR),i=[e,this.getRegionDiscoveryFields()].join(U.VALUE_SEPARATOR);return[U.SCHEMA_VERSION,i,n].join(U.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){let e=this.getLastRequests(),t=od.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(U.VALUE_SEPARATOR),n=e.errors.slice(0,t).join(U.VALUE_SEPARATOR),i=e.errors.length,a=t<i?U.OVERFLOW_TRUE:U.OVERFLOW_FALSE,o=[i,a].join(U.VALUE_SEPARATOR);return[U.SCHEMA_VERSION,e.cacheHits,r,n,o].join(U.CATEGORY_SEPARATOR)}cacheFailedRequest(e){let t=this.getLastRequests();t.errors.length>=U.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof et?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(U.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){let e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){let e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){let e=this.getLastRequests(),t=od.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{let r={failedRequests:e.failedRequests.slice(2*t),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,r,this.correlationId)}}static maxErrorsToSend(e){let t;let r=0,n=0,i=e.errors.length;for(t=0;t<i;t++){let i=e.failedRequests[2*t]||p.EMPTY_STRING,a=e.failedRequests[2*t+1]||p.EMPTY_STRING,o=e.errors[t]||p.EMPTY_STRING;if((n+=i.toString().length+a.toString().length+o.length+3)<U.MAX_LAST_HEADER_BYTES)r+=1;else break}return r}getRegionDiscoveryFields(){let e=[];return e.push(this.regionUsed||p.EMPTY_STRING),e.push(this.regionSource||p.EMPTY_STRING),e.push(this.regionOutcome||p.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){let t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){let e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return oc(e)}}class oh{constructor(e,t,r,n,i,a,o,s,l){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=a,this.nativeMessageHandler=s,this.correlationId=l||nK(),this.logger=n.clone(rw.MSAL_SKU,iw,this.correlationId),this.performanceClient=o}async clearCacheOnLogout(e){if(e){tY.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(this.correlationId),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null,this.correlationId));try{await this.browserStorage.removeAccount(tY.generateAccountCacheKey(e),this.correlationId),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch(e){this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(this.correlationId),await this.browserCrypto.clearKeystore()}catch(e){this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");let t=e||this.config.auth.redirectUri;return t0.getAbsoluteUrl(t,ir())}initializeServerTelemetryManager(e,t){return this.logger.verbose("initializeServerTelemetryManager called"),new od({clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]},this.browserStorage)}async getDiscoveredAuthority(e){let{account:t}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(ry.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);let n={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e.requestAuthority||this.config.auth.authority,a=r?.length?"true"===r:this.config.auth.instanceAware,o=t&&a?this.config.auth.authority.replace(t0.getDomainFromUrl(i),t.environment):i,s=iG.generateAuthority(o,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),l=await iH(a8,ry.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,n,this.logger,this.correlationId,this.performanceClient);if(t&&!l.isAlias(t.environment))throw tH(tF);return l}}let op=32;async function of(e,t,r){e.addQueueMeasurement(ry.GeneratePkceCodes,r);let n=iz(om,ry.GenerateCodeVerifier,t,e,r)(e,t,r),i=await iH(og,ry.GenerateCodeChallengeFromVerifier,t,e,r)(n,e,t,r);return{verifier:n,challenge:i}}function om(e,t,r){try{let n=new Uint8Array(op);return iz(nX,ry.GetRandomValues,t,e,r)(n),nL(n)}catch(e){throw nR(rG)}}async function og(e,t,r,n){t.addQueueMeasurement(ry.GenerateCodeChallengeFromVerifier,n);try{let i=await iH(nZ,ry.Sha256Digest,r,t,n)(e,t,n);return nL(new Uint8Array(i))}catch(e){throw nR(rG)}}async function oy(e,t,r,n){r.addQueueMeasurement(ry.InitializeBaseRequest,e.correlationId);let i=e.authority||t.auth.authority,a=[...e&&e.scopes||[]],o={...e,correlationId:e.correlationId,authority:i,scopes:a};if(o.authenticationScheme){if(o.authenticationScheme===F.SSH){if(!e.sshJwk)throw tH(tP);if(!e.sshKid)throw tH(tO)}n.verbose(`Authentication Scheme set to "${o.authenticationScheme}" as configured in Auth request`)}else o.authenticationScheme=F.BEARER,n.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return t.cache.claimsBasedCachingEnabled&&e.claims&&!tj.isEmptyObj(e.claims)&&(o.requestedClaimsHash=await n1(e.claims)),o}async function ov(e,t,r,n,i){n.addQueueMeasurement(ry.InitializeSilentRequest,e.correlationId);let a=await iH(oy,ry.InitializeBaseRequest,i,n,e.correlationId)(e,r,n,i);return{...e,...a,account:t,forceRefresh:e.forceRefresh||!1}}class ob extends oh{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(ry.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);let t=await iH(of,ry.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),r={...e,redirectUri:e.redirectUri,code:p.EMPTY_STRING,codeVerifier:t.verifier};return e.codeChallenge=t.challenge,e.codeChallengeMethod=p.S256_CODE_CHALLENGE_METHOD,r}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);let t={correlationId:this.correlationId||nK(),...e};if(e){if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){let r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set")}else this.logger.verbose("logoutHint will not be set since no logout request was configured");return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=t0.getAbsoluteUrl(e.postLogoutRedirectUri,ir())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=t0.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,ir())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=t0.getAbsoluteUrl(ir(),ir())),t}getLogoutHintFromIdTokenClaims(e){let t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){return this.performanceClient.addQueueMeasurement(ry.StandardInteractionClientCreateAuthCodeClient,this.correlationId),new oo(await iH(this.getClientConfiguration.bind(this),ry.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e),this.performanceClient)}async getClientConfiguration(e){let{serverTelemetryManager:t,requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:i,account:a}=e;this.performanceClient.addQueueMeasurement(ry.StandardInteractionClientGetClientConfiguration,this.correlationId);let o=await iH(this.getDiscoveredAuthority.bind(this),ry.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:n,requestExtraQueryParameters:i,account:a}),s=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:rw.MSAL_SKU,version:iw,cpu:p.EMPTY_STRING,os:p.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(ry.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);let r=this.getRedirectUri(e.redirectUri),n={interactionType:t},i=i3.setRequestState(this.browserCrypto,e&&e.state||p.EMPTY_STRING,n),a={...await iH(oy,ry.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:i,nonce:e.nonce||nK(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return a;let o=e.account||this.browserStorage.getActiveAccount(this.correlationId);if(o&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${o.homeAccountId}`,this.correlationId),a.account=o),!a.loginHint&&!o){let e=this.browserStorage.getLegacyLoginHint();e&&(a.loginHint=e)}return a}}let o_="ContentError",ow="user_switch",oS="USER_INTERACTION_REQUIRED",oT="USER_CANCEL",ox="NO_NETWORK",oE="PERSISTENT_ERROR",oC="DISABLED",oA="ACCOUNT_UNAVAILABLE",oM=-2147186943,oI={[ow]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class oR extends et{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,oR.prototype),this.name="NativeAuthError",this.ext=r}}function ok(e){return!!e.ext&&!!e.ext.status&&(e.ext.status===oE||e.ext.status===oC)||!!e.ext&&!!e.ext.error&&e.ext.error===oM||e.errorCode===o_}function oP(e,t,r){if(r&&r.status)switch(r.status){case oA:return i2(iX);case oS:return new i0(e,t);case oT:return nR(r0);case ox:return nR(ns)}return new oR(e,oI[e]||t,r)}let oO=300;class oN extends a7{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(ry.RefreshTokenClientAcquireToken,e.correlationId);let t=e2(),r=await iH(this.executeTokenRequest.bind(this),ry.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),n=r.headers?.[y.X_MS_REQUEST_ID],i=new on(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(r.body),iH(i.handleServerTokenResponse.bind(i),ry.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,n)}async acquireTokenByRefreshToken(e){if(!e)throw tH(tE);if(this.performanceClient?.addQueueMeasurement(ry.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw e$(eA);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await iH(this.acquireTokenWithCachedRefreshToken.bind(this),ry.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(r){let e=r instanceof i0&&r.errorCode===iZ,t=r instanceof ah&&r.errorCode===z.INVALID_GRANT_ERROR&&r.subError===z.CLIENT_MISMATCH_ERROR;if(e||t);else throw r}return iH(this.acquireTokenWithCachedRefreshToken.bind(this),ry.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(ry.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);let r=iz(this.cacheManager.getRefreshToken.bind(this.cacheManager),ry.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!r)throw i2(iZ);if(r.expiresOn&&e3(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||oO))throw i2(i$);let n={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||F.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:i4.HOME_ACCOUNT_ID}};try{return await iH(this.acquireToken.bind(this),ry.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(n)}catch(t){if(t instanceof i0&&t.subError===iK){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");let t=e5(r);this.cacheManager.removeRefreshToken(t,e.correlationId)}throw t}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(ry.RefreshTokenClientExecuteTokenRequest,e.correlationId);let r=this.createTokenQueryParameters(e),n=t0.appendQueryString(t.tokenEndpoint,r),i=await iH(this.createTokenRequestBody.bind(this),ry.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),a=this.createTokenRequestHeaders(e.ccsCredential),o={clientId:e.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return iH(this.executePostToTokenEndpoint.bind(this),ry.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(n,i,a,o,e.correlationId,ry.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(ry.RefreshTokenClientCreateTokenRequestBody,e.correlationId);let t=new a6(e.correlationId,this.performanceClient);if(t.addClientId(e.embeddedClientId||e.tokenBodyParameters?.[af]||this.config.authOptions.clientId),e.redirectUri&&t.addRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),t.addGrantType(A),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!rm(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let r=this.config.clientCredentials.clientAssertion;t.addClientAssertion(await oa(r.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(r.assertionType)}if(e.authenticationScheme===F.POP){let r;let n=new oe(this.cryptoUtils,this.performanceClient);r=e.popKid?this.cryptoUtils.encodeKid(e.popKid):(await iH(n.generateCnf.bind(n),ry.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(r)}else if(e.authenticationScheme===F.SSH){if(e.sshJwk)t.addSshJwk(e.sshJwk);else throw tH(tP)}if((!tj.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case i4.HOME_ACCOUNT_ID:try{let r=tq(e.ccsCredential.credential);t.addCcsOid(r)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case i4.UPN:t.addCcsUpn(e.ccsCredential.credential)}return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),t.createQueryString()}}class oL extends a7{constructor(e,t){super(e,t)}async acquireToken(e){try{let[t,r]=await this.acquireCachedToken({...e,scopes:e.scopes?.length?e.scopes:[...m]});return r===W.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new oN(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),t}catch(t){if(t instanceof eX&&t.errorCode===eL)return new oN(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw t}}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(ry.SilentFlowClientAcquireCachedToken,e.correlationId);let t=W.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!tj.isEmptyObj(e.claims))throw this.setCacheOutcome(W.FORCE_REFRESH_OR_CLAIMS,e.correlationId),e$(eL);if(!e.account)throw e$(eA);let r=e.account.tenantId||iV(e.authority),n=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,n,r,this.performanceClient);if(i){if(e4(i.cachedAt)||e3(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(W.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),e$(eL);i.refreshOn&&e3(i.refreshOn,0)&&(t=W.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(W.NO_CACHED_ACCESS_TOKEN,e.correlationId),e$(eL);let a=e.authority||this.authority.getPreferredCache(),o={account:this.cacheManager.readAccountFromCache(e.account,e.correlationId),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,n,r,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await iH(this.generateResultFromCacheRecord.bind(this),ry.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(o,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==W.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){let r;if(this.performanceClient?.addQueueMeasurement(ry.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId),e.idToken&&(r=eJ(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||0===t.maxAge){let e=r?.auth_time;if(!e)throw e$(em);e1(e,t.maxAge)}return on.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}class oD extends ob{async acquireToken(e){this.performanceClient.addQueueMeasurement(ry.SilentCacheClientAcquireToken,e.correlationId);let t=this.initializeServerTelemetryManager(rR.acquireTokenSilent_silentFlow),r=new oL(await iH(this.getClientConfiguration.bind(this),ry.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),this.performanceClient);this.logger.verbose("Silent auth client created");try{let t=(await iH(r.acquireCachedToken.bind(r),ry.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),t}catch(e){throw e instanceof nI&&e.errorCode===nh&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),e}}logout(e){this.logger.verbose("logoutRedirect called");let t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}}class oU extends oh{constructor(e,t,r,n,i,a,o,s,l,c,u,d){super(e,t,r,n,i,a,s,l,d),this.apiId=o,this.accountId=c,this.nativeMessageHandler=l,this.nativeStorageManager=u,this.silentCacheClient=new oD(e,this.nativeStorageManager,r,n,i,a,s,l,d),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);let h=this.nativeMessageHandler.getExtensionId()===rS.PREFERRED_EXTENSION_ID?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=od.makeExtraSkuString({libraryName:rw.MSAL_SKU,libraryVersion:iw,extensionName:h,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[a1]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(ry.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");let t=this.performanceClient.startMeasurement(ry.NativeInteractionClientAcquireToken,e.correlationId),r=e2();try{let n=await this.initializeNativeRequest(e);try{let e=await this.acquireTokensFromCache(this.accountId,n);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),e}catch(e){this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}let{...i}=n,a={method:rT.GetToken,request:i},o=await this.nativeMessageHandler.sendMessage(a),s=this.validateNativeResponse(o);return await this.handleNativeResponse(s,n,r).then(e=>(t.end({success:!0,isNativeBroker:!0,requestId:e.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),e)).catch(e=>{throw t.end({success:!1,errorCode:e.errorCode,subErrorCode:e.subError,isNativeBroker:!0}),e})}catch(e){throw e instanceof oR&&this.serverTelemetryManager.setNativeBrokerErrorCode(e.errorCode),e}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:tG.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),e$(eR);let r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},t.correlationId);if(!r)throw e$(eR);try{let e=this.createSilentCacheRequest(t,r),n=await this.silentCacheClient.acquireToken(e),i={...r,idTokenClaims:n?.idTokenClaims,idToken:n?.idToken};return{...n,account:i}}catch(e){throw e}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");let{...r}=e;delete r.onRedirectNavigate;let n=await this.initializeNativeRequest(r),i={method:rT.GetToken,request:n};try{let e=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(e)}catch(e){if(e instanceof oR&&(this.serverTelemetryManager.setNativeBrokerErrorCode(e.errorCode),ok(e)))throw e}this.browserStorage.setTemporaryCache(rC.NATIVE_REQUEST,JSON.stringify(n),!0);let a={apiId:rR.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(o,a)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;let r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;let{prompt:n,...i}=r;n&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(rC.NATIVE_REQUEST));let a={method:rT.GetToken,request:i},o=e2();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");let e=await this.nativeMessageHandler.sendMessage(a);this.validateNativeResponse(e);let t=this.handleNativeResponse(e,i,o);this.browserStorage.setInteractionInProgress(!1);let r=await t;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),r}catch(e){throw this.browserStorage.setInteractionInProgress(!1),e}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");let n=eJ(e.id_token,iR),i=this.createHomeAccountIdentifier(e,n);if(i!==this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId)?.homeAccountId&&e.account.id!==t.accountId)throw oP(ow);let a=await this.getDiscoveredAuthority({requestAuthority:t.authority}),o=oi(this.browserStorage,a,i,iR,this.correlationId,n,e.client_info,void 0,n.tid,void 0,e.account.id,this.logger),s=await this.generateAuthenticationResult(e,t,n,o,a.canonicalAuthority,r);return this.cacheAccount(o),this.cacheNativeTokens(e,t,i,n,e.access_token,s.tenantId,r),s}createHomeAccountIdentifier(e,t){return tY.generateHomeAccountId(e.client_info||p.EMPTY_STRING,t$.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?tG.fromString(e.scope):tG.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType!==F.POP||!t.signPopToken)return e.access_token;{if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;let r=new oe(this.browserCrypto),n={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw e$(eH);return r.signPopToken(e.access_token,t.keyId,n)}}async generateAuthenticationResult(e,t,r,n,i,a){let o=this.addTelemetryFromNativeResponse(e),s=e.scope?tG.fromString(e.scope):tG.fromString(t.scope),l=e.account.properties||{},c=l.UID||r.oid||r.sub||p.EMPTY_STRING,u=l.TenantId||r.tid||p.EMPTY_STRING,d=tX(n.getAccountInfo(),void 0,r,e.id_token);d.nativeAccountId!==e.account.id&&(d.nativeAccountId=e.account.id);let h=await this.generatePopAccessToken(e,t),f=t.tokenType===F.POP?F.POP:F.BEARER;return{authority:i,uniqueId:c,tenantId:u,scopes:s.asArray(),account:d,idToken:e.id_token,idTokenClaims:r,accessToken:h,fromCache:!!o&&this.isResponseFromCache(o),expiresOn:new Date(1e3*Number(a+e.expires_in)),tokenType:f,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e,this.correlationId).catch(e=>{this.logger.error(`Error occurred while removing account context from browser storage. ${e}`)})}cacheNativeTokens(e,t,r,n,i,a,o){let s=e6(r,t.authority,e.id_token||"",t.clientId,n.tid||""),l=o+(t.tokenType===F.POP?p.SHR_NONCE_VALIDITY:("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0),c=this.generateScopes(e,t),u={idToken:s,accessToken:e8(r,t.authority,i,t.clientId,n.tid||a,c.printScopes(),l,0,iR,void 0,t.tokenType,void 0,t.keyId)};this.nativeStorageManager.saveCacheRecord(u,t.correlationId,t.storeInCache)}addTelemetryFromNativeResponse(e){let t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw er(Q,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch(e){this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return void 0===e.is_cached?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");let t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});let r=new t0(t);r.validateAsUri();let{scopes:n,...i}=e,a=new tG(n||[]);a.appendScopes(m);let o=()=>{switch(this.apiId){case rR.ssoSilent:case rR.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),w.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case w.NONE:case w.CONSENT:case w.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),nR(nS)}},s={...i,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:a.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:o(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(s.signPopToken&&e.popKid)throw nR(nx);if(this.handleExtraBrokerParams(s),s.extraParameters=s.extraParameters||{},s.extraParameters.telemetry=rS.MATS_TELEMETRY,e.authenticationScheme===F.POP){let t;let r={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},n=new oe(this.browserCrypto);if(s.keyId)t=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:s.keyId})),s.signPopToken=!1;else{let i=await iH(n.generateCnf.bind(n),ry.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(r,this.logger);t=i.reqCnfString,s.keyId=i.kid,s.signPopToken=!0}s.reqCnf=t}return this.addRequestSKUs(s),s}handleExtraBrokerParams(e){let t=e.extraParameters&&e.extraParameters.hasOwnProperty(a2)&&e.extraParameters.hasOwnProperty(a3)&&e.extraParameters.hasOwnProperty(af);if(!e.embeddedClientId&&!t)return;let r="",n=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[a3],r=e.extraParameters[af]),e.extraParameters={child_client_id:r,child_redirect_uri:n},this.performanceClient?.addFields({embeddedClientId:r,embeddedRedirectUri:n},e.correlationId)}}class oF{constructor(e,t,r,n){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=n,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(ry.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");let t={channel:rS.CHANNEL_ID,extensionId:this.extensionId,responseId:nK(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise((e,r)=>{this.resolvers.set(t.responseId,{resolve:e,reject:r})})}static async createProvider(e,t,r){e.trace("NativeMessageHandler - createProvider called.");try{let n=new oF(e,t,r,rS.PREFERRED_EXTENSION_ID);return await n.sendHandshakeRequest(),n}catch(i){let n=new oF(e,t,r);return await n.sendHandshakeRequest(),n}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);let e={channel:rS.CHANNEL_ID,extensionId:this.extensionId,responseId:nK(),body:{method:rT.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=e=>{this.onChannelMessage(e)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(nR(nv)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;let t=e.data;if(t.channel&&t.channel===rS.CHANNEL_ID&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===rT.HandshakeRequest){let e=this.handshakeResolvers.get(t.responseId);if(!e){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),e.reject(nR(nb))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");let t=e.data,r=this.resolvers.get(t.responseId),n=this.handshakeResolvers.get(t.responseId);try{let e=t.body.method;if(e===rT.Response){if(!r)return;let e=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(e)}`),"Success"!==e.status)r.reject(oP(e.code,e.description,e.ext));else if(e.result)e.result.code&&e.result.description?r.reject(oP(e.result.code,e.result.description,e.result.ext)):r.resolve(e.result);else throw er(Q,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(e===rT.HandshakeResponse){if(!n){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),n.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(t){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${t}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(t):n&&n.reject(t)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,r,n){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(n)switch(n){case F.BEARER:case F.POP:t.trace("isNativeAvailable: authenticationScheme is supported, returning true");break;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}class oB{constructor(e,t,r,n,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=i}async handleCodeResponse(e,t){let r;this.performanceClient.addQueueMeasurement(ry.HandleCodeResponse,t.correlationId);try{r=this.authModule.handleFragmentResponse(e,t.state)}catch(e){if(e instanceof ah&&e.subError===r0)throw nR(r0);throw e}return iH(this.handleCodeResponseFromServer.bind(this),ry.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t,r=!0){if(this.performanceClient.addQueueMeasurement(ry.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await iH(this.authModule.updateAuthority.bind(this.authModule),ry.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{let e=this.createCcsCredentials(t);e&&(this.authCodeRequest.ccsCredential=e)}return await iH(this.authModule.acquireToken.bind(this.authModule),ry.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:i4.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:i4.UPN}:null}}function oz(e,t,r){let n=tJ(e);if(!n){if(tQ(e))throw r.error(`A ${t} is present in the iframe but it does not contain known properties. It's likely that the ${t} has been replaced by code running on the redirectUri page.`),r.errorPii(`The ${t} detected is: ${e}`),nR(rX);throw r.error(`The request has returned to the redirectUri but a ${t} is not present. It's likely that the ${t} has been removed or the page has been redirected by code running on the redirectUri page.`),nR(rW)}return n}function oH(e,t,r){if(!e.state)throw nR(rZ);let n=i8(t,e.state);if(!n)throw nR(r$);if(n.interactionType!==r)throw nR(rK)}class oj extends ob{constructor(e,t,r,n,i,a,o,s,l,c){super(e,t,r,n,i,a,o,l,c),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=s}acquireToken(e){try{let t={popupName:this.generatePopupName(e.scopes||m,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t);return this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),t.popup=this.openSizedPopup("about:blank",t),this.acquireTokenPopupAsync(e,t)}catch(e){return Promise.reject(e)}}logout(e){try{this.logger.verbose("logoutPopup called");let t=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},n=e&&e.authority,i=e&&e.mainWindowRedirectUri;if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,n,i);return this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(t,r,n,i)}catch(e){return Promise.reject(e)}}async acquireTokenPopupAsync(e,t){this.logger.verbose("acquireTokenPopupAsync called");let r=this.initializeServerTelemetryManager(rR.acquireTokenPopup),n=await iH(this.initializeAuthorizationRequest.bind(this),ry.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,i.Popup);ih(n.authority);try{let a;let o=await iH(this.initializeAuthorizationCodeRequest.bind(this),ry.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(n),s=await iH(this.createAuthCodeClient.bind(this),ry.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),l=oF.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);l&&(a=this.performanceClient.startMeasurement(ry.FetchAccountIdWithNativeBroker,e.correlationId));let c=await s.getAuthCodeUrl({...n,nativeBroker:l}),u=new oB(s,this.browserStorage,o,this.logger,this.performanceClient),d=this.initiateAuthRequest(c,t);this.eventHandler.emitEvent(au.POPUP_OPENED,i.Popup,{popupWindow:d},null);let h=await this.monitorPopupForHash(d,t.popupWindowParent),p=iz(oz,ry.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(h,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(ap.removeThrottle(this.browserStorage,this.config.auth.clientId,o),p.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),a&&a.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw nR(n_);let e=new oU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,rR.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,p.accountId,this.nativeStorage,n.correlationId),{userRequestState:t}=i3.parseRequestState(this.browserCrypto,n.state);return await e.acquireToken({...n,state:t,prompt:void 0})}return await u.handleCodeResponse(p,n)}catch(e){throw t.popup?.close(),e instanceof et&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),e}}async logoutPopupAsync(e,t,r,n){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(au.LOGOUT_START,i.Popup,e);let a=this.initializeServerTelemetryManager(rR.logoutPopup);try{await this.clearCacheOnLogout(e.account);let o=await iH(this.createAuthCodeClient.bind(this),ry.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:a,requestAuthority:r,account:e.account||void 0});try{o.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&o.authority.protocolMode===K.OIDC){if(this.browserStorage.removeAccount(e.account?.homeAccountId,this.correlationId),this.eventHandler.emitEvent(au.LOGOUT_SUCCESS,i.Popup,e),n){let e={apiId:rR.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=t0.getAbsoluteUrl(n,ir());await this.navigationClient.navigateInternal(t,e)}t.popup?.close();return}}let s=o.getLogoutUri(e);this.eventHandler.emitEvent(au.LOGOUT_SUCCESS,i.Popup,e);let l=this.openPopup(s,t);if(this.eventHandler.emitEvent(au.POPUP_OPENED,i.Popup,{popupWindow:l},null),await this.monitorPopupForHash(l,t.popupWindowParent).catch(()=>{}),n){let e={apiId:rR.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},t=t0.getAbsoluteUrl(n,ir());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${t}`),await this.navigationClient.navigateInternal(t,e)}else this.logger.verbose("No main window navigation requested")}catch(e){throw t.popup?.close(),e instanceof et&&(e.setCorrelationId(this.correlationId),a.cacheFailedRequest(e)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(au.LOGOUT_FAILURE,i.Popup,null,e),this.eventHandler.emitEvent(au.LOGOUT_END,i.Popup),e}this.eventHandler.emitEvent(au.LOGOUT_END,i.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),nR(rq)}monitorPopupForHash(e,t){return new Promise((t,r)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");let n=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(n),r(nR(r0));return}let i="";try{i=e.location.href}catch(e){}if(!i||"about:blank"===i)return;clearInterval(n);let a="",o=this.config.auth.OIDCOptions.serverResponseType;e&&(a=o===x.QUERY?e.location.search:e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(a)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,t)),!r)throw nR(rJ);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.setInteractionInProgress(!1),nR(rQ)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:r,popupWindowParent:n}){let i=n.screenLeft?n.screenLeft:n.screenX,a=n.screenTop?n.screenTop:n.screenY,o=n.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=n.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=r.popupSize?.width,c=r.popupSize?.height,u=r.popupPosition?.top,d=r.popupPosition?.left;return(!l||l<0||l>o)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),l=rw.POPUP_WIDTH),(!c||c<0||c>s)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),c=rw.POPUP_HEIGHT),(!u||u<0||u>s)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,s/2-rw.POPUP_HEIGHT/2+a)),(!d||d<0||d>o)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),d=Math.max(0,o/2-rw.POPUP_WIDTH/2+i)),n.open(e,t,`width=${l}, height=${c}, top=${u}, left=${d}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(i.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${rw.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){let t=e.account&&e.account.homeAccountId;return`${rw.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}class oG{constructor(e,t,r,n,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=n,this.performanceClient=i}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(rC.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(rC.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);let r={apiId:rR.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if("function"==typeof t.onRedirectNavigate){if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1!==t.onRedirectNavigate(e)){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await t.navigationClient.navigateExternal(e,r);return}this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await t.navigationClient.navigateExternal(e,r);return}throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),nR(rq)}async handleCodeResponse(e,t){let r;this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);let n=this.browserStorage.generateStateKey(t),i=this.browserStorage.getTemporaryCache(n);if(!i)throw e$(ep,"Cached State");try{r=this.authModule.handleFragmentResponse(e,i)}catch(e){if(e instanceof ah&&e.subError===r0)throw nR(r0);throw e}let a=this.browserStorage.generateNonceKey(i),o=this.browserStorage.getTemporaryCache(a);if(this.authCodeRequest.code=r.code,r.cloud_instance_host_name&&await iH(this.authModule.updateAuthority.bind(this.authModule),ry.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(r.cloud_instance_host_name,this.authCodeRequest.correlationId),r.nonce=o||void 0,r.state=i,r.client_info)this.authCodeRequest.clientInfo=r.client_info;else{let e=this.checkCcsCredentials();e&&(this.authCodeRequest.ccsCredential=e)}let s=await this.authModule.acquireToken(this.authCodeRequest,r);return this.browserStorage.cleanRequestByState(t),s}checkCcsCredentials(){let e=this.browserStorage.getTemporaryCache(rC.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}}function oV(){if("undefined"==typeof window||void 0===window.performance||"function"!=typeof window.performance.getEntriesByType)return;let e=window.performance.getEntriesByType("navigation"),t=e.length?e[0]:void 0;return t?.type}class oq extends ob{constructor(e,t,r,n,i,a,o,s,l,c){super(e,t,r,n,i,a,o,l,c),this.nativeStorage=s}async acquireToken(e){let t=await iH(this.initializeAuthorizationRequest.bind(this),ry.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,i.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);let r=this.initializeServerTelemetryManager(rR.acquireTokenRedirect),n=e=>{e.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(au.RESTORE_FROM_BFCACHE,i.Redirect))};try{let i=await iH(this.initializeAuthorizationCodeRequest.bind(this),ry.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),a=await iH(this.createAuthCodeClient.bind(this),ry.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),o=new oG(a,this.browserStorage,i,this.logger,this.performanceClient),s=await a.getAuthCodeUrl({...t,nativeBroker:oF.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),l=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${l}`),window.addEventListener("pageshow",n),await o.initiateAuthRequest(s,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:l,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(e){throw e instanceof et&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),window.removeEventListener("pageshow",n),this.browserStorage.cleanRequestByState(t.state),e}}async handleRedirectPromise(e="",t){let r=this.initializeServerTelemetryManager(rR.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;let[n,a]=this.getRedirectResponse(e||"");if(!n)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(i.Redirect),"back_forward"!==oV()?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;let o=this.browserStorage.getTemporaryCache(rC.ORIGIN_URI,!0)||p.EMPTY_STRING,s=t0.removeHashFromUrl(o),l=t0.removeHashFromUrl(window.location.href);if(s===l&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),o.indexOf("#")>-1&&n9(o),await this.handleResponse(n,r);if(!this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(n,r);if(!ie()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(rC.URL_HASH,a,!0);let e={apiId:rR.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},t=!0;if(o&&"null"!==o)this.logger.verbose(`Navigating to loginRequestUrl: ${o}`),t=await this.navigationClient.navigateInternal(o,e);else{let r=ii();this.browserStorage.setTemporaryCache(rC.ORIGIN_URI,r,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),t=await this.navigationClient.navigateInternal(r,e)}if(!t)return await this.handleResponse(n,r)}return null}catch(e){throw e instanceof et&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),this.browserStorage.cleanRequestByInteractionType(i.Redirect),e}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(t=this.config.auth.OIDCOptions.serverResponseType===x.QUERY?window.location.search:window.location.hash);let r=tJ(t);if(r){try{oH(r,this.browserCrypto,i.Redirect)}catch(e){return e instanceof et&&this.logger.error(`Interaction type validation failed due to ${e.errorCode}: ${e.errorMessage}`),[null,""]}return n7(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}let n=this.browserStorage.getTemporaryCache(rC.URL_HASH,!0);return(this.browserStorage.removeItem(this.browserStorage.generateCacheKey(rC.URL_HASH)),n&&(r=tJ(n)))?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,n]):[null,""]}async handleResponse(e,t){let r=e.state;if(!r)throw nR(rZ);let n=this.browserStorage.getCachedRequest(r);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw nR(n_);let t=new oU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,rR.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,n.correlationId),{userRequestState:i}=i3.parseRequestState(this.browserCrypto,r);return t.acquireToken({...n,state:i,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(r)})}let i=this.browserStorage.getCachedAuthority(r);if(!i)throw nR(nr);let a=await iH(this.createAuthCodeClient.bind(this),ry.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:i});return ap.removeThrottle(this.browserStorage,this.config.auth.clientId,n),new oG(a,this.browserStorage,n,this.logger,this.performanceClient).handleCodeResponse(e,r)}async logout(e){this.logger.verbose("logoutRedirect called");let t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(rR.logout);try{this.eventHandler.emitEvent(au.LOGOUT_START,i.Redirect,e),await this.clearCacheOnLogout(t.account);let n={apiId:rR.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=await iH(this.createAuthCodeClient.bind(this),ry.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(a.authority.protocolMode===K.OIDC)try{a.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId){this.browserStorage.removeAccount(t.account?.homeAccountId,this.correlationId),this.eventHandler.emitEvent(au.LOGOUT_SUCCESS,i.Redirect,t);return}}let o=a.getLogoutUri(t);if(this.eventHandler.emitEvent(au.LOGOUT_SUCCESS,i.Redirect,t),e&&"function"==typeof e.onRedirectNavigate){let t=e.onRedirectNavigate(o);if(!1!==t){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(o,n);return}this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation")}else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(o,n);return}}catch(e){throw e instanceof et&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),this.eventHandler.emitEvent(au.LOGOUT_FAILURE,i.Redirect,null,e),this.eventHandler.emitEvent(au.LOGOUT_END,i.Redirect),e}this.eventHandler.emitEvent(au.LOGOUT_END,i.Redirect)}getRedirectStartPage(e){let t=e||window.location.href;return t0.getAbsoluteUrl(t,ir())}}async function oW(e,t,r,n,i){if(t.addQueueMeasurement(ry.SilentHandlerInitiateAuthRequest,n),!e)throw r.info("Navigate url is empty"),nR(rq);return i?iH(oX,ry.SilentHandlerLoadFrame,r,t,n)(e,i,t,n):iz(o$,ry.SilentHandlerLoadFrameSync,r,t,n)(e)}async function oZ(e,t,r,n,i,a,o){return n.addQueueMeasurement(ry.SilentHandlerMonitorIframeForHash,a),new Promise((n,a)=>{t<ig&&i.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${t}ms) than the default (${ig}ms). This may result in timeouts.`);let s=window.setTimeout(()=>{window.clearInterval(l),a(nR(r2))},t),l=window.setInterval(()=>{let t="",r=e.contentWindow;try{t=r?r.location.href:""}catch(e){}if(!t||"about:blank"===t)return;let i="";r&&(i=o===x.QUERY?r.location.search:r.location.hash),window.clearTimeout(s),window.clearInterval(l),n(i)},r)}).finally(()=>{iz(oY,ry.RemoveHiddenIframe,i,n,a)(e)})}function oX(e,t,r,n){return r.addQueueMeasurement(ry.SilentHandlerLoadFrame,n),new Promise((r,n)=>{let i=oK();window.setTimeout(()=>{if(!i){n("Unable to load iframe");return}i.src=e,r(i)},t)})}function o$(e){let t=oK();return t.src=e,t}function oK(){let e=document.createElement("iframe");return e.className="msalSilentIframe",e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(e),e}function oY(e){document.body===e.parentNode&&document.body.removeChild(e)}class oQ extends ob{constructor(e,t,r,n,i,a,o,s,l,c,u){super(e,t,r,n,i,a,s,c,u),this.apiId=o,this.nativeStorage=l}async acquireToken(e){let t;this.performanceClient.addQueueMeasurement(ry.SilentIframeClientAcquireToken,e.correlationId),e.loginHint||e.sid||e.account&&e.account.username||this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");let r={...e};r.prompt?r.prompt!==w.NONE&&r.prompt!==w.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${r.prompt} with ${w.NONE}`),r.prompt=w.NONE):r.prompt=w.NONE;let n=await iH(this.initializeAuthorizationRequest.bind(this),ry.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(r,i.Silent);ih(n.authority);let a=this.initializeServerTelemetryManager(this.apiId);try{return t=await iH(this.createAuthCodeClient.bind(this),ry.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:a,requestAuthority:n.authority,requestAzureCloudOptions:n.azureCloudOptions,requestExtraQueryParameters:n.extraQueryParameters,account:n.account}),await iH(this.silentTokenHelper.bind(this),ry.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(t,n)}catch(o){if(o instanceof et&&(o.setCorrelationId(this.correlationId),a.cacheFailedRequest(o)),!t||!(o instanceof et)||o.errorCode!==rw.INVALID_GRANT_ERROR)throw o;this.performanceClient.addFields({retryError:o.errorCode},this.correlationId);let n=await iH(this.initializeAuthorizationRequest.bind(this),ry.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(r,i.Silent);return await iH(this.silentTokenHelper.bind(this),ry.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(t,n)}}logout(){return Promise.reject(nR(r8))}async silentTokenHelper(e,t){let r=t.correlationId;this.performanceClient.addQueueMeasurement(ry.SilentIframeClientTokenHelper,r);let n=await iH(this.initializeAuthorizationCodeRequest.bind(this),ry.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,r)(t),i=await iH(e.getAuthCodeUrl.bind(e),ry.GetAuthCodeUrl,this.logger,this.performanceClient,r)({...t,nativeBroker:oF.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),a=new oB(e,this.browserStorage,n,this.logger,this.performanceClient),o=await iH(oW,ry.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(i,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),s=this.config.auth.OIDCOptions.serverResponseType,l=await iH(oZ,ry.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(o,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,s),c=iz(oz,ry.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(l,s,this.logger);if(c.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw nR(n_);let e=new oU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,c.accountId,this.browserStorage,r),{userRequestState:n}=i3.parseRequestState(this.browserCrypto,t.state);return iH(e.acquireToken.bind(e),ry.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,r)({...t,state:n,prompt:t.prompt||w.NONE})}return iH(a.handleCodeResponse.bind(a),ry.HandleCodeResponse,this.logger,this.performanceClient,r)(c,t)}}class oJ extends ob{async acquireToken(e){this.performanceClient.addQueueMeasurement(ry.SilentRefreshClientAcquireToken,e.correlationId);let t=await iH(oy,ry.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...t};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));let n=this.initializeServerTelemetryManager(rR.acquireTokenSilent_silentFlow),i=await this.createRefreshTokenClient({serverTelemetryManager:n,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return iH(i.acquireTokenByRefreshToken.bind(i),ry.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(r).catch(e=>{throw e.setCorrelationId(this.correlationId),n.cacheFailedRequest(e),e})}logout(){return Promise.reject(nR(r8))}async createRefreshTokenClient(e){return new oN(await iH(this.getClientConfiguration.bind(this),ry.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),this.performanceClient)}}class o0{constructor(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}loadExternalTokens(e,t,r){if(!this.isBrowserEnvironment)throw nR(na);let n=e.correlationId||nK(),i=t.id_token?eJ(t.id_token,iR):void 0,a={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.authority?new iG(iG.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,a,this.logger,e.correlationId||nK()):void 0,s=this.loadAccount(e,r.clientInfo||t.client_info||"",n,i,o),l=this.loadIdToken(t,s.homeAccountId,s.environment,s.realm,n),c=this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,r,n),u=this.loadRefreshToken(t,s.homeAccountId,s.environment,n);return this.generateAuthenticationResult(e,{account:s,idToken:l,accessToken:c,refreshToken:u},i,o)}loadAccount(e,t,r,n,i){if(this.logger.verbose("TokenCache - loading account"),e.account){let t=tY.createFromAccountInfo(e.account);return this.storage.setAccount(t,r),t}if(!i||!t&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),nR(nd);let a=tY.generateHomeAccountId(t,i.authorityType,this.logger,this.cryptoObj,n),o=n?.tid,s=oi(this.storage,i,a,iR,r,n,t,i.hostnameAndPort,o,void 0,void 0,this.logger);return this.storage.setAccount(s,r),s}loadIdToken(e,t,r,n,i){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");let a=e6(t,r,e.id_token,this.config.auth.clientId,n);return this.storage.setIdTokenCredential(a,i),a}loadAccessToken(e,t,r,n,i,a,o){if(!t.access_token)return this.logger.verbose("TokenCache - no access token found in response"),null;if(!t.expires_in)return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null;this.logger.verbose("TokenCache - loading access token");let s=t.scope?tG.fromString(t.scope):new tG(e.scopes),l=a.expiresOn||t.expires_in+new Date().getTime()/1e3,c=a.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+new Date().getTime()/1e3,u=e8(r,n,t.access_token,this.config.auth.clientId,i,s.printScopes(),l,c,iR);return this.storage.setAccessTokenCredential(u,o),u}loadRefreshToken(e,t,r,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");let i=e7(t,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(i,n),i}generateAuthenticationResult(e,t,r,n){let i,a="",o=[],s=null;t?.accessToken&&(a=t.accessToken.secret,o=tG.fromString(t.accessToken.target).asArray(),s=new Date(1e3*Number(t.accessToken.expiresOn)),i=new Date(1e3*Number(t.accessToken.extendedExpiresOn)));let l=t.account;return{authority:n?n.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:o,account:l.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:r||{},accessToken:a,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:i,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:l.cloudGraphHostName||"",msGraphHost:l.msGraphHost||"",fromNativeBroker:!1}}}class o1 extends oo{constructor(e){super(e),this.includeRedirectUri=!1}}class o2 extends ob{constructor(e,t,r,n,i,a,o,s,l,c){super(e,t,r,n,i,a,s,l,c),this.apiId=o}async acquireToken(e){if(!e.code)throw nR(np);let t=await iH(this.initializeAuthorizationRequest.bind(this),ry.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,i.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{let n={...t,code:e.code},i=await iH(this.getClientConfiguration.bind(this),ry.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),a=new o1(i);this.logger.verbose("Auth code client created");let o=new oB(a,this.browserStorage,n,this.logger,this.performanceClient);return await iH(o.handleCodeResponseFromServer.bind(o),ry.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(e){throw e instanceof et&&(e.setCorrelationId(this.correlationId),r.cacheFailedRequest(e)),e}}logout(){return Promise.reject(nR(r8))}}function o3(e){let t=e?.idTokenClaims;return t?.tfp||t?.acr?"B2C":t?.tid?t?.tid==="9188040d-6c67-4c5b-b112-36a304b66dad"?"MSA":"AAD":void 0}function o4(e,t){try{iu(e)}catch(e){throw t.end({success:!1},e),e}}class o5{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new iL(this.logger,this.performanceClient):eK,this.eventHandler=new ad(this.logger),this.browserStorage=this.isBrowserEnvironment?new at(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,iW(this.config.auth),this.performanceClient):ar(this.config.auth.clientId,this.logger);let t={cacheLocation:rx.MemoryStorage,temporaryCacheLocation:rx.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new at(this.config.auth.clientId,t,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new o0(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}static async createController(e,t){let r=new o5(e);return await r.initialize(t),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(au.INITIALIZE_END);return}let t=e?.correlationId||this.getRequestCorrelationId(),r=this.config.system.allowNativeBroker,n=this.performanceClient.startMeasurement(ry.InitializeClientApplication,t);if(this.eventHandler.emitEvent(au.INITIALIZE_START),r)try{this.nativeExtensionProvider=await oF.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(e){this.logger.verbose(e)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await iH(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),ry.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.initialized=!0,this.eventHandler.emitEvent(au.INITIALIZE_END),n.end({allowNativeBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),ic(this.initialized),this.isBrowserEnvironment){let t=e||"",r=this.redirectResponse.get(t);return void 0===r?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){let t;let r=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),a=n&&oF.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,o=a?n?.correlationId:this.browserStorage.getTemporaryCache(rC.CORRELATION_ID,!0)||"",s=this.performanceClient.startMeasurement(ry.AcquireTokenRedirect,o);if(this.eventHandler.emitEvent(au.HANDLE_REDIRECT_START,i.Redirect),a&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");let e=new oU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,rR.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);t=iH(e.handleRedirectPromise.bind(e),ry.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(this.performanceClient,s.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");let r=this.createRedirectClient(o);t=iH(r.handleRedirectPromise.bind(r),ry.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(e,s)}return t.then(e=>(e?(r.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(au.LOGIN_SUCCESS,i.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_SUCCESS,i.Redirect,e),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),s.end({success:!0,accountType:o3(e.account)})):s.event.errorCode?s.end({success:!1}):s.discard(),this.eventHandler.emitEvent(au.HANDLE_REDIRECT_END,i.Redirect),e)).catch(e=>{let t=e;throw r.length>0?this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_FAILURE,i.Redirect,null,t):this.eventHandler.emitEvent(au.LOGIN_FAILURE,i.Redirect,null,t),this.eventHandler.emitEvent(au.HANDLE_REDIRECT_END,i.Redirect),s.end({success:!1},t),e})}async acquireTokenRedirect(e){let t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);let r=this.performanceClient.startMeasurement(ry.AcquireTokenPreRedirect,t);r.add({accountType:o3(e.account),scenarioId:e.scenarioId});let n=e.onRedirectNavigate;if(n)e.onRedirectNavigate=e=>{let t="function"==typeof n?n(e):void 0;return!1!==t?r.end({success:!0}):r.discard(),t};else{let e=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=t=>{let n="function"==typeof e?e(t):void 0;return!1!==n?r.end({success:!0}):r.discard(),n}}let a=this.getAllAccounts().length>0;try{let n;return id(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),a?this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_START,i.Redirect,e):this.eventHandler.emitEvent(au.LOGIN_START,i.Redirect,e),n=this.nativeExtensionProvider&&this.canUseNative(e)?new oU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,rR.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,r).catch(r=>{if(r instanceof oR&&ok(r))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(r instanceof i0)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),r}):this.createRedirectClient(t).acquireToken(e),await n}catch(e){throw r.end({success:!1},e),a?this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_FAILURE,i.Redirect,null,e):this.eventHandler.emitEvent(au.LOGIN_FAILURE,i.Redirect,null,e),e}}acquireTokenPopup(e){let t;let r=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(ry.AcquireTokenPopup,r);n.add({scenarioId:e.scenarioId,accountType:o3(e.account)});try{this.logger.verbose("acquireTokenPopup called",r),o4(this.initialized,n),this.browserStorage.setInteractionInProgress(!0)}catch(e){return Promise.reject(e)}let a=this.getAllAccounts();return a.length>0?this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_START,i.Popup,e):this.eventHandler.emitEvent(au.LOGIN_START,i.Popup,e),(t=this.canUseNative(e)?this.acquireTokenNative({...e,correlationId:r},rR.acquireTokenPopup).then(e=>(this.browserStorage.setInteractionInProgress(!1),n.end({success:!0,isNativeBroker:!0,accountType:o3(e.account)}),e)).catch(t=>{if(t instanceof oR&&ok(t))return this.nativeExtensionProvider=void 0,this.createPopupClient(r).acquireToken(e);if(t instanceof i0)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(r).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),t}):this.createPopupClient(r).acquireToken(e)).then(e=>(a.length<this.getAllAccounts().length?this.eventHandler.emitEvent(au.LOGIN_SUCCESS,i.Popup,e):this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_SUCCESS,i.Popup,e),n.end({success:!0,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:o3(e.account)}),e)).catch(e=>(a.length>0?this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_FAILURE,i.Popup,null,e):this.eventHandler.emitEvent(au.LOGIN_FAILURE,i.Popup,null,e),n.end({success:!1},e),Promise.reject(e)))}trackPageVisibilityWithMeasurement(){let e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){let t;let r=this.getRequestCorrelationId(e),n={...e,prompt:e.prompt,correlationId:r};return this.ssoSilentMeasurement=this.performanceClient.startMeasurement(ry.SsoSilent,r),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:o3(e.account)}),o4(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",r),this.eventHandler.emitEvent(au.SSO_SILENT_START,i.Silent,n),(t=this.canUseNative(n)?this.acquireTokenNative(n,rR.ssoSilent).catch(e=>{if(e instanceof oR&&ok(e))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(n.correlationId).acquireToken(n);throw e}):this.createSilentIframeClient(n.correlationId).acquireToken(n)).then(e=>(this.eventHandler.emitEvent(au.SSO_SILENT_SUCCESS,i.Silent,e),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:o3(e.account)}),e)).catch(e=>{throw this.eventHandler.emitEvent(au.SSO_SILENT_FAILURE,i.Silent,null,e),this.ssoSilentMeasurement?.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){let t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);let r=this.performanceClient.startMeasurement(ry.AcquireTokenByCode,t);o4(this.initialized,r),this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_BY_CODE_START,i.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw nR(nm);if(e.code){let n=e.code,a=this.hybridAuthCodeResponses.get(n);return a?(this.logger.verbose("Existing acquireTokenByCode request found",t),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),a=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(e=>(this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_BY_CODE_SUCCESS,i.Silent,e),this.hybridAuthCodeResponses.delete(n),r.end({success:!0,isNativeBroker:e.fromNativeBroker,accessTokenSize:e.accessToken.length,idTokenSize:e.idToken.length,accountType:o3(e.account)}),e)).catch(e=>{throw this.hybridAuthCodeResponses.delete(n),this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_BY_CODE_FAILURE,i.Silent,null,e),r.end({success:!1},e),e}),this.hybridAuthCodeResponses.set(n,a)),await a}if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId)){let n=await this.acquireTokenNative({...e,correlationId:t},rR.acquireTokenByCode,e.nativeAccountId).catch(e=>{throw e instanceof oR&&ok(e)&&(this.nativeExtensionProvider=void 0),e});return r.end({accountType:o3(n.account),success:!0}),n}throw nR(ny)}throw nR(nf)}catch(e){throw this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_BY_CODE_FAILURE,i.Silent,null,e),r.end({success:!1},e),e}}async acquireTokenByCodeAsync(e){this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(ry.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement);let t=this.createSilentAuthCodeClient(e.correlationId);return await t.acquireToken(e).then(e=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:e.fromCache,isNativeBroker:e.fromNativeBroker}),e)).catch(e=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},e),e}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(ry.AcquireTokenFromCache,e.correlationId),t){case rD.Default:case rD.AccessToken:case rD.AccessTokenAndRefreshToken:let r=this.createSilentCacheClient(e.correlationId);return iH(r.acquireToken.bind(r),ry.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw e$(eL)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(ry.AcquireTokenByRefreshToken,e.correlationId),t){case rD.Default:case rD.AccessTokenAndRefreshToken:case rD.RefreshToken:case rD.RefreshTokenAndNetwork:let r=this.createSilentRefreshClient(e.correlationId);return iH(r.acquireToken.bind(r),ry.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw e$(eL)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(ry.AcquireTokenBySilentIframe,e.correlationId);let t=this.createSilentIframeClient(e.correlationId);return iH(t.acquireToken.bind(t),ry.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){let t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){let t=this.getRequestCorrelationId(e);return id(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{let t=this.getRequestCorrelationId(e);return iu(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(e){return Promise.reject(e)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}let t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){let t=this.getRequestCorrelationId();return an(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){let t=this.getRequestCorrelationId();return ai(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){let t=this.getRequestCorrelationId();return aa(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){let t=this.getRequestCorrelationId();return ao(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){let t=this.getRequestCorrelationId();return as(e,this.logger,this.browserStorage,t)}setActiveAccount(e){let t=this.getRequestCorrelationId();al(e,this.browserStorage,t)}getActiveAccount(){let e=this.getRequestCorrelationId();return ac(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");let r=tY.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return(this.browserStorage.setAccount(r,e.correlationId),e.fromNativeBroker)?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,r){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw nR(n_);return new oU(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!oF.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case w.NONE:case w.CONSENT:case w.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!!(t||this.getNativeAccountId(e))||(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1)}getNativeAccountId(e){let t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new oj(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new oq(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new oQ(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,rR.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new oD(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new oJ(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new o2(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,rR.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return il(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}handleAccountCacheChange(e){try{e.key?.includes(v.ACTIVE_ACCOUNT_FILTERS)&&this.eventHandler.emitEvent(au.ACTIVE_ACCOUNT_CHANGED);let t=e.newValue||e.oldValue;if(!t)return;let r=JSON.parse(t);if("object"!=typeof r||!tY.isAccountEntity(r))return;let n=rn.toObject(new tY,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent(au.ACCOUNT_ADDED,void 0,n)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent(au.ACCOUNT_REMOVED,void 0,n))}catch(e){return}}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?nK():p.EMPTY_STRING}async loginRedirect(e){let t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||rk})}loginPopup(e){let t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||rk})}async acquireTokenSilent(e){let t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(ry.AcquireTokenSilent,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),o4(this.initialized,r),this.logger.verbose("acquireTokenSilent called",t);let n=e.account||this.getActiveAccount();if(!n)throw nR(r7);r.add({accountType:o3(n)});let i=JSON.stringify({clientId:this.config.auth.clientId,authority:e.authority||p.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:n.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions}),a=this.activeSilentTokenRequests.get(i);if(void 0!==a)return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.discard(),{...await a,state:e.state};{this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);let a=iH(this.acquireTokenSilentAsync.bind(this),ry.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)({...e,correlationId:t},n).then(t=>(this.activeSilentTokenRequests.delete(i),r.end({success:!0,fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,accessTokenSize:t.accessToken.length,idTokenSize:t.idToken.length}),t)).catch(e=>{throw this.activeSilentTokenRequests.delete(i),r.end({success:!1},e),e});return this.activeSilentTokenRequests.set(i,a),{...await a,state:e.state}}}async acquireTokenSilentAsync(e,t){let r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(ry.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_START,i.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);let n=await iH(ov,ry.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),a=e.cacheLookupPolicy||rD.Default;return this.acquireTokenSilentNoIframe(n,a).catch(async e=>{if(o6(e,a)){if(this.activeIframeRequest){if(a===rD.Skip)return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",n.correlationId),iH(this.acquireTokenBySilentIframe.bind(this),ry.AcquireTokenBySilentIframe,this.logger,this.performanceClient,n.correlationId)(n);{let[t,r]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${r}`,n.correlationId);let i=this.performanceClient.startMeasurement(ry.AwaitConcurrentIframe,n.correlationId);i.add({awaitIframeCorrelationId:r});let o=await t;if(i.end({success:o}),o)return this.logger.verbose(`Parallel iframe request with correlationId: ${r} succeeded. Retrying cache and/or RT redemption`,n.correlationId),this.acquireTokenSilentNoIframe(n,a);throw this.logger.info(`Iframe request with correlationId: ${r} failed. Interaction is required.`),e}}{let e;return this.activeIframeRequest=[new Promise(t=>{e=t}),n.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",n.correlationId),iH(this.acquireTokenBySilentIframe.bind(this),ry.AcquireTokenBySilentIframe,this.logger,this.performanceClient,n.correlationId)(n).then(t=>(e(!0),t)).catch(t=>{throw e(!1),t}).finally(()=>{this.activeIframeRequest=void 0})}}throw e}).then(t=>(this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_SUCCESS,i.Silent,t),e.correlationId&&this.performanceClient.addFields({fromCache:t.fromCache,isNativeBroker:t.fromNativeBroker},e.correlationId),t)).catch(e=>{throw this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_FAILURE,i.Silent,null,e),e}).finally(()=>{document.removeEventListener("visibilitychange",r)})}async acquireTokenSilentNoIframe(e,t){return oF.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,rR.acquireTokenSilent_silentFlow).catch(async e=>{if(e instanceof oR&&ok(e))throw this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,e$(eL);throw e})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),iH(this.acquireTokenFromCache.bind(this),ry.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(r=>{if(t===rD.AccessToken)throw r;return this.eventHandler.emitEvent(au.ACQUIRE_TOKEN_NETWORK_START,i.Silent,e),iH(this.acquireTokenByRefreshToken.bind(this),ry.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))}}function o6(e,t){let r=!(e instanceof i0&&e.subError!==iK),n=e.errorCode===rw.INVALID_GRANT_ERROR||e.errorCode===eL,i=r&&n||e.errorCode===iZ||e.errorCode===i$,a=rU.includes(t);return i&&a}async function o8(e,t){let r=new iT(e);return await r.initialize(),o5.createController(r,t)}class o7{static async createPublicClientApplication(e){let t=await o8(e);return new o7(e,t)}constructor(e,t){this.controller=t||new o5(new iT(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}var o9=r(2016);function se(e,t,r,n){function i(e){return e instanceof r?e:new r(function(t){t(e)})}return new(r||(r=Promise))(function(r,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function s(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?r(e.value):i(e.value).then(o,s)}l((n=n.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError,function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(a||(a={}));var st=r(82957).Buffer;class sr{static validateDependencies(e){let t=e=>{let t=e.entries(),r=t.next();for(;!r.done;){let e=r.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;r=t.next()}return!0},r=e=>{let t=e.entries(),r=t.next(),n=r.value[1];if(void 0!==n.dependsOn&&n.dependsOn.length>0)return!1;let i=r;for(r=t.next();!r.done;){let e=r.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==i.value[1].id)return!1;i=r,r=t.next()}return!0},n=e=>{let t;let r=e.entries(),n=r.next(),i=n.value[1];if(void 0===i.dependsOn||0===i.dependsOn.length)t=i.id;else{if(1!==i.dependsOn.length)return!1;{let r=i.dependsOn[0];if(!(r!==i.id&&e.has(r)))return!1;t=r}}for(n=r.next();!n.done;){let e=n.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&t!==e.id||void 0!==e.dependsOn&&0!==e.dependsOn.length&&(1===e.dependsOn.length&&(e.id===t||e.dependsOn[0]!==t)||e.dependsOn.length>1))return!1;n=r.next()}return!0};if(0===e.size){let e=Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return t(e)||r(e)||n(e)}static getRequestData(e){return se(this,void 0,void 0,function*(){let t={url:""},r=RegExp("^https?://");t.url=r.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;let n={};return e.headers.forEach((e,t)=>{n[t]=e}),Object.keys(n).length&&(t.headers=n),(e.method===a.PATCH||e.method===a.POST||e.method===a.PUT)&&(t.body=yield sr.getRequestBody(e)),t})}static getRequestBody(e){return se(this,void 0,void 0,function*(){let t,r=!1;try{let n=e.clone();t=yield n.json(),r=!0}catch(e){}if(!r)try{if("undefined"!=typeof Blob){let r=yield e.blob(),n=new FileReader;t=yield new Promise(e=>{n.addEventListener("load",()=>{let t=n.result,r=RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(r[4])},!1),n.readAsDataURL(r)})}else void 0!==st&&(t=(yield e.buffer()).toString("base64"));r=!0}catch(e){}return t})}constructor(e){if(this.requests=new Map,void 0!==e){let t=sr.requestLimit;if(e.length>t){let e=Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(let t of e)this.addRequest(t)}}addRequest(e){let t=sr.requestLimit;if(""===e.id){let e=Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){let e=Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){let t=Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){let t=this.requests.delete(e),r=this.requests.entries(),n=r.next();for(;!n.done;){let t=n.value[1].dependsOn;if(void 0!==t){let r=t.indexOf(e);-1!==r&&t.splice(r,1),0===t.length&&delete n.value[1].dependsOn}n=r.next()}return t}getContent(){return se(this,void 0,void 0,function*(){let e=[],t={requests:e},r=this.requests.entries(),n=r.next();if(n.done){let e=Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!sr.validateDependencies(this.requests)){let e=Error(`Invalid dependency found, Dependency should be:
1. Parallel - no individual request states a dependency in the dependsOn property.
2. Serial - all individual requests depend on the previous individual request.
3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.`);throw e.name="Invalid Dependency",e}for(;!n.done;){let t=n.value[1],i=yield sr.getRequestData(t.request);if(void 0!==i.body&&(void 0===i.headers||void 0===i.headers["content-type"])){let e=Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}i.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(i.dependsOn=t.dependsOn),e.push(i),n=r.next()}return t.requests=e,t})}addDependency(e,t){if(!this.requests.has(e)){let t=Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){let e=Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){let r=this.requests.get(e);if(void 0===r.dependsOn&&(r.dependsOn=[]),-1!==r.dependsOn.indexOf(t)){let r=Error(`Dependency ${t} is already added for the request ${e}`);throw r.name="Duplicate Dependency",r}r.dependsOn.push(t)}else{let r;let n=this.requests.entries(),i=n.next();for(;!i.done&&i.value[1].id!==e;)r=i,i=n.next();if(void 0!==r){let t=r.value[0];if(void 0===i.value[1].dependsOn&&(i.value[1].dependsOn=[]),-1!==i.value[1].dependsOn.indexOf(t)){let r=Error(`Dependency ${t} is already added for the request ${e}`);throw r.name="Duplicate Dependency",r}i.value[1].dependsOn.push(t)}else{let e=Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}}}removeDependency(e,t){let r=this.requests.get(e);if(void 0===r||void 0===r.dependsOn||0===r.dependsOn.length)return!1;if(void 0===t)return delete r.dependsOn,!0;{let e=r.dependsOn.indexOf(t);return -1!==e&&(r.dependsOn.splice(e,1),!0)}}}sr.requestLimit=20;let sn="v1.0",si="https://graph.microsoft.com/",sa=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class so extends Error{static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new so).customError=e,t}constructor(e){super(e),Object.setPrototypeOf(this,so.prototype)}}var ss=r(82957).Buffer;let sl=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],sc=e=>{let t=e=>e.replace(/\/+$/,""),r=e=>e.replace(/^\/+/,""),n=(e,n)=>[t(e),r(n)].join("/");return Array.prototype.slice.call(e).reduce(n)},su=e=>{let t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=ss.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=ss.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw Error("Unable to stringify the content")}return e},sd=e=>sp(e),sh=(e,t)=>(t.forEach(e=>sf(e)),sp(e,t)),sp=(e,t=sa)=>{if(-1!==(e=e.toLowerCase()).indexOf("https://")){let r=(e=e.replace("https://","")).indexOf(":"),n=e.indexOf("/"),i="";if(-1!==n)return i=-1!==r&&r<n?e.substring(0,r):e.substring(0,n),t.has(i)}return!1},sf=e=>{if(-1!==e.indexOf("/"))throw new so("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class sm{constructor(e=[]){for(let t of(this.middlewareOptions=new Map,e)){let e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}let sg=()=>{let e="";for(let t=0;t<32;t++)(8===t||12===t||16===t||20===t)&&(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},sy=(e,t,r)=>{let n=null;if("undefined"!=typeof Request&&e instanceof Request)n=e.headers.get(r);else if(void 0!==t&&void 0!==t.headers){if("undefined"!=typeof Headers&&t.headers instanceof Headers)n=t.headers.get(r);else if(t.headers instanceof Array){let e=t.headers;for(let t=0,i=e.length;t<i;t++)if(e[t][0]===r){n=e[t][1];break}}else void 0!==t.headers[r]&&(n=t.headers[r])}return n},sv=(e,t,r,n)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(r,n);else if(void 0!==t){if(void 0===t.headers)t.headers=new Headers({[r]:n});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(r,n);else if(t.headers instanceof Array){let e=0,i=t.headers.length;for(;e<i;e++){let i=t.headers[e];if(i[0]===r){i[1]=n;break}}e===i&&t.headers.push([r,n])}else Object.assign(t.headers,{[r]:n})}},sb=(e,t,r,n)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(r,n):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[r]:n}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(r,n):t.headers instanceof Array?t.headers.push([r,n]):void 0===t.headers?t.headers={[r]:n}:void 0===t.headers[r]?t.headers[r]=n:t.headers[r]+=`, ${n}`)},s_=(e,t)=>se(void 0,void 0,void 0,function*(){let r=t.headers.get("Content-Type")?yield t.blob():yield Promise.resolve(void 0),{method:n,headers:i,referrer:a,referrerPolicy:o,mode:s,credentials:l,cache:c,redirect:u,integrity:d,keepalive:h,signal:p}=t;return new Request(e,{method:n,headers:i,body:r,referrer:a,referrerPolicy:o,mode:s,credentials:l,cache:c,redirect:u,integrity:d,keepalive:h,signal:p})});class sw{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(o||(o={}));class sS{constructor(){this.featureUsage=o.NONE}static updateFeatureUsageFlag(e,t){let r;e.middlewareControl instanceof sm?r=e.middlewareControl.getMiddlewareOptions(sS):e.middlewareControl=new sm,void 0===r&&(r=new sS,e.middlewareControl.setMiddlewareOptions(sS,r)),r.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class sT{constructor(e){this.authenticationProvider=e}execute(e){return se(this,void 0,void 0,function*(){let t="string"==typeof e.request?e.request:e.request.url;if(sd(t)||e.customHosts&&sh(t,e.customHosts)){let t,r,n;e.middlewareControl instanceof sm&&(t=e.middlewareControl.getMiddlewareOptions(sw)),t&&(r=t.authenticationProvider,n=t.authenticationProviderOptions),r||(r=this.authenticationProvider);let i=yield r.getAccessToken(n),a=`Bearer ${i}`;sb(e.request,e.options,sT.AUTHORIZATION_HEADER,a),sS.updateFeatureUsageFlag(e,o.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[sT.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}sT.AUTHORIZATION_HEADER="Authorization";class sx{constructor(e=sx.DEFAULT_DELAY,t=sx.DEFAULT_MAX_RETRIES,r=sx.defaultShouldRetry){if(e>sx.MAX_DELAY&&t>sx.MAX_MAX_RETRIES){let e=Error(`Delay and MaxRetries should not be more than ${sx.MAX_DELAY} and ${sx.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>sx.MAX_DELAY){let e=Error(`Delay should not be more than ${sx.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>sx.MAX_MAX_RETRIES){let e=Error(`MaxRetries should not be more than ${sx.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){let e=Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}else if(e<0){let e=Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}else if(t<0){let e=Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,sx.MAX_DELAY),this.maxRetries=Math.min(t,sx.MAX_MAX_RETRIES),this.shouldRetry=r}getMaxDelay(){return sx.MAX_DELAY}}sx.DEFAULT_DELAY=3,sx.DEFAULT_MAX_RETRIES=3,sx.MAX_DELAY=180,sx.MAX_MAX_RETRIES=10,sx.defaultShouldRetry=()=>!0;class sE{constructor(e=new sx){this.options=e}isRetry(e){return -1!==sE.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(e,t){let r="string"==typeof e?t.method:e.method;return r!==a.PUT&&r!==a.PATCH&&r!==a.POST||"application/octet-stream"!==sy(e,t,"Content-Type")}getDelay(e,t,r){let n;let i=()=>Number(Math.random().toFixed(3)),a=void 0!==e.headers?e.headers.get(sE.RETRY_AFTER_HEADER):null;return Math.min(n=null!==a?Number.isNaN(Number(a))?Math.round((new Date(a).getTime()-Date.now())/1e3):Number(a):t>=2?this.getExponentialBackOffTime(t)+r+i():r+i(),this.options.getMaxDelay()+i())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return se(this,void 0,void 0,function*(){let t=1e3*e;return new Promise(e=>setTimeout(e,t))})}getOptions(e){let t;return e.middlewareControl instanceof sm&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new sx,this.options)),t}executeWithRetry(e,t,r){return se(this,void 0,void 0,function*(){if(yield this.nextMiddleware.execute(e),t<r.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&r.shouldRetry(r.delay,t,e.request,e.options,e.response)){++t,sv(e.request,e.options,sE.RETRY_ATTEMPT_HEADER,t.toString());let n=this.getDelay(e.response,t,r.delay);return yield this.sleep(n),yield this.executeWithRetry(e,t,r)}})}execute(e){return se(this,void 0,void 0,function*(){let t=0,r=this.getOptions(e);return sS.updateFeatureUsageFlag(e,o.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,t,r)})}setNext(e){this.nextMiddleware=e}}sE.RETRY_STATUS_CODES=[429,503,504],sE.RETRY_ATTEMPT_HEADER="Retry-Attempt",sE.RETRY_AFTER_HEADER="Retry-After";class sC{constructor(e=sC.DEFAULT_MAX_REDIRECTS,t=sC.defaultShouldRedirect){if(e>sC.MAX_MAX_REDIRECTS){let e=Error(`MaxRedirects should not be more than ${sC.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){let e=Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}sC.DEFAULT_MAX_REDIRECTS=5,sC.MAX_MAX_REDIRECTS=20,sC.defaultShouldRedirect=()=>!0;class sA{constructor(e=new sC){this.options=e}isRedirect(e){return -1!==sA.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(sA.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(sA.LOCATION_HEADER)}isRelativeURL(e){return -1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){let r,n;let i=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,a=i.exec(e);null!==a&&(r=a[0]);let o=i.exec(t);return null!==o&&(n=o[0]),void 0!==r&&void 0!==n&&r!==n}updateRequestUrl(e,t){return se(this,void 0,void 0,function*(){t.request="string"==typeof t.request?e:yield s_(e,t.request)})}getOptions(e){let t;return e.middlewareControl instanceof sm&&(t=e.middlewareControl.getMiddlewareOptions(sC)),void 0===t&&(t=Object.assign(new sC,this.options)),t}executeWithRedirect(e,t,r){return se(this,void 0,void 0,function*(){yield this.nextMiddleware.execute(e);let n=e.response;if(t<r.maxRedirects&&this.isRedirect(n)&&this.hasLocationHeader(n)&&r.shouldRedirect(n)){if(++t,n.status===sA.STATUS_CODE_SEE_OTHER)e.options.method=a.GET,delete e.options.body;else{let t=this.getLocationHeader(n);!this.isRelativeURL(t)&&this.shouldDropAuthorizationHeader(n.url,t)&&delete e.options.headers[sA.AUTHORIZATION_HEADER],yield this.updateRequestUrl(t,e)}yield this.executeWithRedirect(e,t,r)}})}execute(e){return se(this,void 0,void 0,function*(){let t=0,r=this.getOptions(e);return e.options.redirect=sA.MANUAL_REDIRECT,sS.updateFeatureUsageFlag(e,o.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,t,r)})}setNext(e){this.nextMiddleware=e}}sA.REDIRECT_STATUS_CODES=[301,302,303,307,308],sA.STATUS_CODE_SEE_OTHER=303,sA.LOCATION_HEADER="Location",sA.AUTHORIZATION_HEADER="Authorization",sA.MANUAL_REDIRECT="manual";let sM="3.0.7";class sI{execute(e){return se(this,void 0,void 0,function*(){let t="string"==typeof e.request?e.request:e.request.url;if(sd(t)||e.customHosts&&sh(t,e.customHosts)){let t,r=sy(e.request,e.options,sI.CLIENT_REQUEST_ID_HEADER);r||(r=sg(),sv(e.request,e.options,sI.CLIENT_REQUEST_ID_HEADER,r));let n=`${sI.PRODUCT_NAME}/${sM}`;if(e.middlewareControl instanceof sm&&(t=e.middlewareControl.getMiddlewareOptions(sS)),t){let e=t.getFeatureUsage();n+=` (${sI.FEATURE_USAGE_STRING}=${e})`}sb(e.request,e.options,sI.SDK_VERSION_HEADER,n)}else delete e.options.headers[sI.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[sI.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}sI.CLIENT_REQUEST_ID_HEADER="client-request-id",sI.SDK_VERSION_HEADER="SdkVersion",sI.PRODUCT_NAME="graph-js",sI.FEATURE_USAGE_STRING="featureUsage",r(25566),function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"}(s||(s={})),function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(l||(l={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(c||(c={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(u||(u={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(d||(d={}));class sR{static parseDocumentResponse(e,t){return"undefined"!=typeof DOMParser?new Promise((r,n)=>{e.text().then(e=>{try{let n=new DOMParser().parseFromString(e,t);r(n)}catch(e){n(e)}})}):Promise.resolve(e.body)}static convertResponse(e,t){return se(this,void 0,void 0,function*(){let r;if(204===e.status)return Promise.resolve();let n=e.headers.get("Content-type");switch(t){case l.ARRAYBUFFER:r=yield e.arrayBuffer();break;case l.BLOB:r=yield e.blob();break;case l.DOCUMENT:r=yield sR.parseDocumentResponse(e,c.TEXT_XML);break;case l.JSON:r=yield e.json();break;case l.STREAM:r=yield Promise.resolve(e.body);break;case l.TEXT:r=yield e.text();break;default:if(null!==n){let t=n.split(";")[0];r=new RegExp(d.DOCUMENT).test(t)?yield sR.parseDocumentResponse(e,t):new RegExp(d.IMAGE).test(t)?e.blob():t===u.TEXT_PLAIN?yield e.text():t===u.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else r=Promise.resolve(e.body)}return r})}static getResponse(e,t,r){return se(this,void 0,void 0,function*(){if(t===l.RAW)return Promise.resolve(e);{let n=yield sR.convertResponse(e,t);if(e.ok){if("function"!=typeof r)return n;r(null,n)}else throw n}})}}class sk{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class sP{get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}constructor(e,t){this._location=t,this._responseBody=e}static CreateUploadResult(e,t){return new sP(e,t.get("location"))}}class sO{static createUploadSession(e,t,r,n={}){return se(this,void 0,void 0,function*(){let i=yield e.api(t).headers(n).post(r);return{url:i.uploadUrl,expiry:new Date(i.expirationDateTime),isCancelled:!1}})}constructor(e,t,r,n={}){if(this.DEFAULT_FILE_SIZE=5242880,this.client=e,t.sliceFile)this.file=t;else throw new so("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,n.rangeSize||(n.rangeSize=this.DEFAULT_FILE_SIZE),this.options=n,this.uploadSession=r,this.nextRange=new sk(0,this.options.rangeSize-1)}parseRange(e){let t=e[0];if(void 0===t||""===t)return new sk;let r=t.split("-"),n=parseInt(r[0],10),i=parseInt(r[1],10);return Number.isNaN(i)&&(i=this.file.size-1),new sk(n,i)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;let e=this.nextRange.minValue,t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new sk(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new so("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return se(this,void 0,void 0,function*(){let e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){let t=this.getNextRange();if(-1===t.maxValue){let e=Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}let r=yield this.file.sliceFile(t),n=yield this.uploadSliceGetRawResponse(r,t,this.file.size);if(!n)throw new so("Something went wrong! Large file upload slice response is null.");let i=yield sR.getResponse(n);if(201===n.status||200===n.status&&i.id)return this.reportProgress(e,t),sP.CreateUploadResult(i,n.headers);let a={expirationDateTime:i.expirationDateTime||i.ExpirationDateTime,nextExpectedRanges:i.NextExpectedRanges||i.nextExpectedRanges};this.updateTaskStatus(a),this.reportProgress(e,t)}})}reportProgress(e,t){e&&e.progress&&e.progress(t,e.extraCallbackParam)}uploadSlice(e,t,r){return se(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":`${t.maxValue-t.minValue+1}`,"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${r}`,"Content-Type":"application/octet-stream"}).put(e)})}uploadSliceGetRawResponse(e,t,r){return se(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":`${t.maxValue-t.minValue+1}`,"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${r}`,"Content-Type":"application/octet-stream"}).responseType(l.RAW).put(e)})}cancel(){return se(this,void 0,void 0,function*(){let e=yield this.client.api(this.uploadSession.url).responseType(l.RAW).delete();return 204===e.status&&(this.uploadSession.isCancelled=!0),e})}getStatus(){return se(this,void 0,void 0,function*(){let e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e})}resume(){return se(this,void 0,void 0,function*(){return yield this.getStatus(),yield this.upload()})}getUploadSession(){return this.uploadSession}}class sN{constructor(e,t,r){if(this.content=e,this.name=t,this.size=r,!e||!t||!r)throw new so("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}let sL=5242880,sD=e=>(e>327680&&(e=327680*Math.floor(e/327680)),e),sU=(e=sL)=>{let t=62914560;return e>62914560&&(e=t),sD(e)};class sF extends sO{static constructCreateSessionUrl(e,t=sF.DEFAULT_UPLOAD_PATH){return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t=`/${t}`),"/"!==t[t.length-1]&&(t=`${t}/`),`/me/drive/root:${t.split("/").map(e=>encodeURIComponent(e)).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static getFileInfo(e,t){let r,n;if("undefined"!=typeof Blob&&e instanceof Blob)n=(r=new File([e],t)).size;else if("undefined"!=typeof File&&e instanceof File)n=(r=e).size;else if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array){let t=e;n=t.byteLength,r=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}return{content:r,size:n}}static create(e,t,r){return se(this,void 0,void 0,function*(){if(!e||!t||!r)throw new so("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");let n=r.fileName,i=sF.getFileInfo(t,n),a=new sN(i.content,n,i.size);return this.createTaskWithFileObject(e,a,r)})}static createTaskWithFileObject(e,t,r){return se(this,void 0,void 0,function*(){if(!e||!t||!r)throw new so("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");let n=r.uploadSessionURL?r.uploadSessionURL:sF.constructCreateSessionUrl(r.fileName,r.path),i={fileName:r.fileName,fileDescription:r.fileDescription,conflictBehavior:r.conflictBehavior},a=yield sF.createUploadSession(e,n,i);return new sF(e,t,a,{rangeSize:sU(r.rangeSize),uploadEventHandlers:r.uploadEventHandlers})})}static createUploadSession(e,t,r){let n=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return se(this,void 0,void 0,function*(){let i={item:{"@microsoft.graph.conflictBehavior":(null==r?void 0:r.conflictBehavior)||"rename",name:null==r?void 0:r.fileName,description:null==r?void 0:r.fileDescription}};return n.createUploadSession.call(this,e,t,i)})}constructor(e,t,r,n){super(e,t,r,n)}commit(e,t="rename"){return se(this,void 0,void 0,function*(){let r={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(r)})}}sF.DEFAULT_UPLOAD_PATH="/",r(82957).Buffer;class sB{constructor(e){this.provider=e}getAccessToken(){return se(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.provider((r,n)=>se(this,void 0,void 0,function*(){n?e(n):(r||(r=new so("Access token is undefined or empty.						Please provide a valid token.						For more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md")),t((yield so.setGraphClientError(r))))}))})})}}class sz extends Error{constructor(e=-1,t,r){super(t||r&&r.message),Object.setPrototypeOf(this,sz.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=r?r.stack:this.stack}}class sH{static constructError(e,t,r){let n=new sz(t,"",e);return void 0!==e.name&&(n.code=e.name),n.body=e.toString(),n.date=new Date,n.headers=null==r?void 0:r.headers,n}static constructErrorFromResponse(e,t,r){let n=e.error,i=new sz(t,n.message);return i.code=n.code,void 0!==n.innerError&&(i.requestId=n.innerError["request-id"],i.date=new Date(n.innerError.date)),i.body=JSON.stringify(n),i.headers=null==r?void 0:r.headers,i}static getError(e=null,t=-1,r,n){return se(this,void 0,void 0,function*(){let i;if(e&&e.error?i=sH.constructErrorFromResponse(e,t,n):e instanceof Error?i=sH.constructError(e,t,n):(i=new sz(t)).body=e,"function"!=typeof r)return i;r(i,null)})}}class sj{constructor(e,t,r){this.parsePath=e=>{if(-1!==e.indexOf("https://")){let t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));let r=e.indexOf("/");-1!==r&&(this.urlComponents.version=e.substring(0,r),e=e.substring(r+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));let t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else for(let r of(this.urlComponents.path=e.substr(0,t),e.substring(t+1,e.length).split("&")))this.parseQueryParameter(r)},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(r)}addCsvQueryParameter(e,t,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let n=[];r.length>1&&"string"==typeof t?n=Array.prototype.slice.call(r):"string"==typeof t?n.push(t):n=n.concat(t),this.urlComponents.oDataQueryParams[e]+=n.join(",")}buildFullUrl(){let e=sc([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){let e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(let r in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,r)&&t.push(r+"="+e.oDataQueryParams[r]);if(0!==Object.keys(e.otherURLQueryParams).length)for(let r in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,r)&&t.push(r+"="+e.otherURLQueryParams[r]);if(0!==e.otherURLQueryOptions.length)for(let r of e.otherURLQueryOptions)t.push(r);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"==typeof e){if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&"))for(let t of e.split("&"))this.parseQueryParamenterString(t);else this.parseQueryParamenterString(e)}else if(e.constructor===Object)for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){let t=e.indexOf("="),r=e.substring(0,t),n=e.substring(t+1);this.setURLComponentsQueryParamater(r,n)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==sl.indexOf(e)){let r=this.urlComponents.oDataQueryParams[e],n=r&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=n?r+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){let t=e.indexOf("=");return!(-1===t||-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){let t=Object.assign({},e.headers);void 0!==this.config.fetchOptions&&(Object.assign(e,Object.assign({},this.config.fetchOptions)),this.config.fetchOptions.headers,e.headers=Object.assign({},this.config.fetchOptions.headers)),Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,r){var n;return se(this,void 0,void 0,function*(){let i;let a=new sm(this._middlewareOptions);this.updateRequestOptions(t);let o=null===(n=this.config)||void 0===n?void 0:n.customHosts;try{return i=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:a,customHosts:o})).response,yield sR.getResponse(i,this._responseType,r)}catch(t){let e;if(t instanceof so)throw t;throw i&&(e=i.status),yield sH.getError(t,e,r,i)}})}setHeaderContentType(){if(!this._headers){this.header("Content-Type","application/json");return}for(let e of Object.keys(this._headers))if("content-type"===e.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return se(this,void 0,void 0,function*(){let t=this.buildFullUrl(),r={method:a.GET};return yield this.send(t,r,e)})}post(e,t){return se(this,void 0,void 0,function*(){let r=this.buildFullUrl(),n={method:a.POST,body:su(e)};return"FormData"===(e&&e.constructor&&e.constructor.name)?n.headers={}:(this.setHeaderContentType(),n.headers=this._headers),yield this.send(r,n,t)})}create(e,t){return se(this,void 0,void 0,function*(){return yield this.post(e,t)})}put(e,t){return se(this,void 0,void 0,function*(){let r=this.buildFullUrl();this.setHeaderContentType();let n={method:a.PUT,body:su(e)};return yield this.send(r,n,t)})}patch(e,t){return se(this,void 0,void 0,function*(){let r=this.buildFullUrl();this.setHeaderContentType();let n={method:a.PATCH,body:su(e)};return yield this.send(r,n,t)})}update(e,t){return se(this,void 0,void 0,function*(){return yield this.patch(e,t)})}delete(e){return se(this,void 0,void 0,function*(){let t=this.buildFullUrl(),r={method:a.DELETE};return yield this.send(t,r,e)})}del(e){return se(this,void 0,void 0,function*(){return yield this.delete(e)})}getStream(e){return se(this,void 0,void 0,function*(){let t=this.buildFullUrl(),r={method:a.GET};return this.responseType(l.STREAM),yield this.send(t,r,e)})}putStream(e,t){return se(this,void 0,void 0,function*(){let r=this.buildFullUrl(),n={method:a.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(r,n,t)})}}class sG{constructor(...e){if(!e||!e.length){let e=Error();throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach((t,r)=>{r<e.length-1&&t.setNext(e[r+1])}),this.middleware=e[0]}sendRequest(e){return se(this,void 0,void 0,function*(){if("string"==typeof e.request&&void 0===e.options){let e=Error();throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e})}}class sV{execute(e){return se(this,void 0,void 0,function*(){e.response=yield fetch(e.request,e.options)})}}var sq=r(25566);let sW=()=>"object"==typeof sq;class sZ{static createWithAuthenticationProvider(e){let t=new sT(e),r=new sE(new sx),n=new sI,i=new sV;if(t.setNext(r),sW()){let e=new sA(new sC);r.setNext(e),e.setNext(n)}else r.setNext(n);return n.setNext(i),sZ.createWithMiddleware(t)}static createWithMiddleware(...e){return new sG(...e)}}let sX=()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){let e=Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){let e=Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){let e=Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}return!0};class s${static init(e){let t={};for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]="authProvider"===r?new sB(e[r]):e[r]);return s$.initWithMiddleware(t)}static initWithMiddleware(e){return new s$(e)}constructor(e){let t;for(let t in this.config={baseUrl:si,debugLogging:!1,defaultVersion:sn},sX(),e)Object.prototype.hasOwnProperty.call(e,t)&&(this.config[t]=e[t]);if(void 0!==e.authProvider&&void 0!==e.middleware){let e=Error();throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=sZ.createWithAuthenticationProvider(e.authProvider);else if(void 0!==e.middleware)t=new sG(...[].concat(e.middleware));else{let e=Error();throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}this.httpClient=t}api(e){return new sj(this.httpClient,this.config,e)}}var sK=r(64654),sY=r(94013);let sQ="onedrive.accountInfo";async function sJ(){let e,t,r;console.log("createOneDriveClient");let n=new o7({auth:{clientId:"28af6fb9-c605-4ad3-8039-3e90df0933cb",redirectUri:"".concat(window.location.origin).concat("/cloud-music-box","/redirect/onedrive")},cache:{cacheLocation:"localStorage"}});function i(e){if(e.folder)return{name:e.name,id:e.id,type:"folder",parentId:e.parentReference.id};if(e.file){var t;let r=e.name.split(".").pop(),n=null===(t=o9.fu[r])||void 0===t?void 0:t.mimeType;if(void 0!==n)return{name:e.name,id:e.id,type:"audio-track",parentId:e.parentReference.id,mimeType:n}}return{name:e.name,id:e.id,type:"file",parentId:e.parentReference.id}}async function a(i){if(401===i.statusCode&&t)try{let i={scopes:["Files.Read","Sites.Read.All"],account:t,forceRefresh:!0};return e=(await n.acquireTokenSilent(i)).accessToken,console.log("Token refreshed successfully"),r=s$.init({authProvider:t=>{t(null,e||null)}}),!0}catch(e){if(e instanceof i0)throw s(),Error("Drive requires reauthorization");throw e}return!1}async function o(e){try{return await e()}catch(t){if(console.warn("API call failed",t),await a(t))return await e();throw t}}await n.initialize();let s=()=>{let e=e=>(0,h.BX)(h.HY,{children:[(0,h.tZ)(sY.Z,{color:"error",onClick:()=>{n&&t&&(n.acquireTokenRedirect({scopes:["Files.Read","Sites.Read.All"],account:t}),(0,sK.sy)(e))},children:"Reauthorize"}),(0,h.tZ)(sY.Z,{color:"error",onClick:()=>{(0,sK.sy)(e)},children:"Dismiss"})]});(0,sK.yv)("Requires reauthorization to access the drive",{variant:"error",persist:!0,action:e})},l=async()=>{let r=localStorage.getItem(sQ);r&&(t=JSON.parse(r));try{let r=await n.handleRedirectPromise();r&&(e=r.accessToken,t=r.account,localStorage.setItem(sQ,JSON.stringify(t)))}catch(e){console.error(e)}};return await l(),{pca:n,accountInfo:t,async resetUser(){e=void 0,t=void 0,r=void 0,localStorage.removeItem(sQ)},async connect(){if(!e&&t){let r={scopes:["Files.Read","Sites.Read.All"],account:t};try{let i=await n.acquireTokenSilent(r);i&&(e=i.accessToken,t=i.account,localStorage.setItem(sQ,JSON.stringify(t)))}catch(e){if(console.error(e),s(),e instanceof i0)throw Error("Drive requires reauthorization");throw e}}if(!e)throw Error("No access token");r=s$.init({authProvider:t=>{t(null,e||null)}})},async getRootFolderId(){if(!r)throw Error("Not connected");return(await o(()=>r.api("/me/drive/root").get())).id},async getFile(e){if(!r)throw Error("Not connected");return i(await o(()=>r.api("/me/drive/items/".concat(e)).get()))},async getChildren(e){if(!r)throw Error("Not connected");return(await o(async()=>r.api("/me/drive/items/".concat(e,"/children")).get())).value.map(e=>i(e))},async fetchFileBlob(e){if(!r)throw Error("Not connected");let t=(await o(()=>r.api("/me/drive/items/".concat(e,"?select=id,@microsoft.graph.downloadUrl")).get()))["@microsoft.graph.downloadUrl"],n=await fetch(t);return await n.blob()}}}},28757:function(e,t,r){"use strict";r.d(t,{pG:function(){return u},tv:function(){return l}});var n=r(81595),i=r(2265),a=r(99376);let o=(0,i.createContext)({pathname:"",hash:""}),s=(0,i.createContext)(()=>{}),l=()=>{let e=(0,i.useContext)(o);(0,i.useContext)(s);let t=a.useRouter();return[e,(0,i.useMemo)(()=>({goFile:e=>{let r="/files#".concat(encodeURIComponent(e));t.push(r,{scroll:!1}),window.localStorage.setItem("lastHref",r)},goAlbum:e=>{let r="/albums".concat(e?"#".concat(encodeURIComponent(e)):"");t.push(r,{scroll:!1}),window.localStorage.setItem("lastHref",r)},goHome:e=>{let{reload:r=!1}=e||{},n="/home";window.localStorage.setItem("lastHref",n),r?window.location.assign("".concat("/cloud-music-box").concat(n)):t.push(n,{scroll:!1})},goLastHref:()=>{let e=window.localStorage.getItem("lastHref");return e&&t.push(e,{scroll:!1}),e},goSettings:()=>{let e="/settings";t.push(e,{scroll:!1})},goBack:()=>{t.back()},go:e=>{t.push(e,{scroll:!1}),window.localStorage.setItem("lastHref",e)}}),[t])]},c=(e,t)=>{if("setLocation"===t.type){let{pathname:r,hash:n}=t.payload;return{...e,pathname:r,hash:n}}throw Error("Invalid action")},u=e=>{let{children:t}=e,[r,l]=(0,i.useReducer)(c,{pathname:"",hash:""}),u=a.useParams(),d=a.usePathname();return(0,i.useEffect)(()=>{l({type:"setLocation",payload:{pathname:d,hash:window.location.hash}})},[u,d]),(0,n.tZ)(o.Provider,{value:r,children:(0,n.tZ)(s.Provider,{value:l,children:t})})}},86083:function(e,t,r){"use strict";r.d(t,{O_:function(){return m},m0:function(){return T}});var n=r(81595),i=r(64654),a=r(2265),o=r(33109),s=r(39963),l=r(4784),c=r.n(l),u=r(2016),d=r(37714),h=r(64085);let p=(0,a.createContext)({fileDb:void 0,driveClient:void 0,rootFolderId:void 0,configured:!1,syncingTrackFiles:{},syncQueue:[],driveStatus:"not-configured"}),f=(0,a.createContext)(()=>{}),m=()=>{let e=(0,a.useContext)(p),t=(0,a.useContext)(f),r=(0,a.useRef)(e);return r.current=e,[e,(0,a.useMemo)(()=>({getFileById:async e=>{if(!r.current.configured)throw Error("File store not configured");if(!r.current.fileDb)throw Error("File database not initialized");{let t=await g(r.current.fileDb,e);if(t)return t}if(!r.current.driveClient)throw Error("Drive client not connected");let t=await r.current.driveClient.getFile(e);return await v(t,r.current.fileDb)},getChildrenLocal:async e=>{let t;if(!r.current.configured)throw Error("File store not configured");if(!r.current.fileDb)throw Error("File database not initialized");let n=(await g(r.current.fileDb,e)).childrenIds;if(n){let e=n.map(e=>{if(!r.current.fileDb)throw Error("File database not initialized");return g(r.current.fileDb,e)});t=(await Promise.all(e)).filter(e=>void 0!==e)}return t},getChildrenRemote:async e=>{if(!r.current.configured)throw Error("File store not configured");if(!r.current.fileDb)throw Error("File database not initialized");if(!r.current.driveClient)throw Error("Drive client not connected");let t=await g(r.current.fileDb,e),n=await r.current.driveClient.getChildren(e),i=await Promise.all(n.map(e=>{if(!r.current.fileDb)throw Error("File database not initialized");return v(e,r.current.fileDb)}));if(t){let e=i.map(e=>e.id);t.childrenIds=e,r.current.fileDb.transaction("files","readwrite").objectStore("files").put(t)}return i},hasTrackBlobInLocal:async e=>{if(!r.current.configured)throw Error("File store not configured");if(!r.current.fileDb)throw Error("File database not initialized");return await b(r.current.fileDb.transaction("blobs").objectStore("blobs").count(e))>0},requestDownloadTrack:async e=>{if(!r.current.configured)throw Error("File store not configured");let{fileDb:n,driveClient:i}=r.current;if(!n)throw Error("File database not initialized");if(await b(n.transaction("blobs").objectStore("blobs").count(e))>0)return;let a=new Promise((r,n)=>{let i={fileId:e,resolve:()=>{r()},reject:e=>{n(e)}};t({type:"setSyncingTrackFile",payload:{id:e,syncing:!0}}),t({type:"pushSyncTask",payload:[i]})});await a},getTrackContent:async e=>{if(!r.current.configured)throw Error("File store not configured");let{fileDb:n}=r.current;if(!n)throw Error("File database not initialized");{let t=await g(n,e);if("audio-track"!==t.type)throw Error("Item is not a track");let r=await b(n.transaction("blobs","readonly").objectStore("blobs").get(e));if(r)return w(n,e,r),{blob:r,file:t}}let i=new Promise((r,n)=>{let i={fileId:e,resolve:r,reject:n};t({type:"setSyncingTrackFile",payload:{id:e,syncing:!0}}),t({type:"pushSyncTask",payload:[i]})}),{file:a,blob:o}=await i;if(!a||!o)throw Error("File or blob not found");return{blob:o,file:a}},getAlbumById:async e=>{if(!r.current.configured)throw Error("File store not configured");if(!r.current.fileDb)throw Error("File database not initialized");return await y(r.current.fileDb,e)},getAlbumIds:async()=>{if(!r.current.configured)throw Error("File store not configured");if(!r.current.fileDb)throw Error("File database not initialized");return await b(r.current.fileDb.transaction("albums").objectStore("albums").getAllKeys())},setBlobsStorageMaxBytes:e=>{t({type:"setBlobsStorageMaxBytes",payload:e})},clearAllLocalBlobs:async()=>{if(!r.current.configured)throw Error("File store not configured");if(!r.current.fileDb)throw Error("File database not initialized");await b(r.current.fileDb.transaction("blobs","readwrite").objectStore("blobs").clear()),await b(r.current.fileDb.transaction("blobs-meta","readwrite").objectStore("blobs-meta").clear()),localStorage.setItem("blobsStorageUsageBytes","0"),t({type:"setBlobsStorageUsageBytes",payload:0})},addPickerGroup:async(e,t)=>{if(console.log("addPickerGroup called with files:",e),console.log("folderNames:",t),!r.current.configured)throw Error("File store not configured");if(!r.current.fileDb)throw Error("File database not initialized");let n=new Map;for(let t of e){let e=t.parentId||"unknown";n.has(e)||n.set(e,[]),n.get(e).push(t)}let i=r.current.fileDb.transaction("files","readwrite"),a=i.objectStore("files"),o=[];for(let[e,r]of Array.from(n.entries())){let n=e,i=a.get(n),l=await new Promise(e=>{i.onsuccess=()=>{e(i.result)},i.onerror=()=>{e(void 0)}}),c=(null==l?void 0:l.name)||(null==t?void 0:t.get(e))||"Folder ".concat(e.substring(0,8)),d=new Set((null==l?void 0:l.childrenIds)||[]);r.forEach(e=>d.add(e.id));let h={id:n,name:c,type:"folder",parentId:"root",childrenIds:Array.from(d)};for(let e of(console.log("Creating/Updating folder:",h),a.put(h),o.push(n),r)){var s;let t=(null===(s=e.name.split(".").pop())||void 0===s?void 0:s.toLowerCase())||"",r=u.fu[t],i={id:e.id,name:e.name,type:r?"audio-track":"file",parentId:n,...r&&{mimeType:r.mimeType}};console.log("Creating file:",i),a.put(i)}}let l=a.get("root");return l.onsuccess=()=>{let e=l.result;if(e){let t=new Set(e.childrenIds||[]);o.forEach(e=>t.add(e)),e.childrenIds=Array.from(t),a.put(e),console.log("Updated root folder childrenIds:",e.childrenIds)}},await new Promise((e,t)=>{i.oncomplete=()=>{console.log("Transaction completed successfully"),e()},i.onerror=()=>{console.error("Transaction error:",i.error),t(i.error)}}),console.log("Created folder IDs:",o),o[0]||"root"}}),[])]};function g(e,t){return new Promise((r,n)=>{let i=e.transaction("files","readwrite").objectStore("files").get(t);i.onsuccess=e=>{r(e.target.result)},i.onerror=e=>{n(e.target.error)}})}function y(e,t){return new Promise((r,n)=>{let i=e.transaction("albums","readwrite").objectStore("albums").get(t);i.onsuccess=e=>{r(e.target.result)},i.onerror=e=>{n(e.target.error)}})}async function v(e,t){let r={...await g(t,e.id)};return Object.keys(e).forEach(t=>{void 0!==e[t]&&(r[t]=e[t])}),t.transaction("files","readwrite").objectStore("files").put(r),r}function b(e){return new Promise((t,r)=>{e.onsuccess=e=>{t(e.target.result)},e.onerror=e=>{r(e.target.error)}})}function _(e,t,r){return r<=t?Promise.resolve(r):new Promise((n,i)=>{let a=e.transaction("blobs-meta","readwrite").objectStore("blobs-meta").index("last-accessed").openCursor();a.onsuccess=i=>{let a=i.target.result;if(a){let i=a.primaryKey;if(r-=a.value.blobSize,e.transaction("blobs","readwrite").objectStore("blobs").delete(i),a.delete(),r<=t){n();return}a.continue()}else n()},a.onerror=e=>{i(e.target.error)}}).then(()=>r)}async function w(e,t,r){let n={appended:!1},i=await b(e.transaction("blobs-meta","readonly").objectStore("blobs-meta").get(t));return void 0===i&&(i={id:t,lastAccessed:Date.now(),blobSize:r.size},n.appended=!0),i.lastAccessed=Date.now(),await b(e.transaction("blobs-meta","readwrite").objectStore("blobs-meta").put(i)),n}let S=(e,t)=>{switch(t.type){case"setFileDb":return{...e,fileDb:t.payload};case"setDriveClient":return{...e,driveClient:t.payload};case"setRootFolderId":return{...e,rootFolderId:t.payload};case"setConfigured":return{...e,configured:t.payload};case"pushSyncTask":{let r=[...e.syncQueue,...t.payload];return{...e,syncQueue:r}}case"setSyncingTrackFile":{let{id:r,syncing:n}=t.payload,i={...e.syncingTrackFiles};return n?i[r]=!0:delete i[r],{...e,syncingTrackFiles:i}}case"popSyncTask":{let r=t.payload,n=e.syncQueue.filter(e=>!r.some(t=>t.fileId===e.fileId));return{...e,syncQueue:n}}case"setDriveStatus":return{...e,driveStatus:t.payload};case"setBlobsStorageMaxBytes":return{...e,blobsStorageMaxBytes:t.payload};case"setBlobsStorageUsageBytes":return{...e,blobsStorageUsageBytes:t.payload};default:throw Error("Invalid action")}},T=e=>{let{children:t}=e,[r,l]=(0,a.useReducer)(S,{fileDb:void 0,driveClient:void 0,rootFolderId:void 0,configured:!1,syncingTrackFiles:{},syncQueue:[],driveStatus:"not-configured"}),m=(0,a.useRef)(Promise.resolve()),v=(0,a.useRef)(void 0),T=(0,a.useRef)(void 0),x=(0,o.A7)(),E=(0,a.useRef)(!1);(0,a.useEffect)(()=>{if(!E.current)return(async()=>{let e;let t=window.localStorage;try{(e=await new Promise((e,t)=>{let r=indexedDB.open("file-db");r.onsuccess=()=>{e(r.result)},r.onerror=()=>{t(r.error)},r.onupgradeneeded=e=>{let t=r.result;t.createObjectStore("files",{keyPath:"id"}),t.createObjectStore("blobs"),t.createObjectStore("albums"),t.createObjectStore("blobs-meta",{keyPath:"id"}).createIndex("last-accessed","lastAccessed")}})).onversionchange=e=>{let{oldVersion:t,newVersion:r}=e},l({type:"setFileDb",payload:e})}catch(e){throw console.error(e),(0,i.yv)("".concat(e),{variant:"error"}),e}{l({type:"setRootFolderId",payload:t.getItem("rootFolderId")||void 0});let e=parseInt(t.getItem("blobsStorageMaxBytes")||"NaN");if(isNaN(e)){let e=.7*((await navigator.storage.estimate()).quota||100);t.setItem("blobsStorageMaxBytes","".concat(Math.floor(e))),l({type:"setBlobsStorageMaxBytes",payload:e}),v.current=e}else l({type:"setBlobsStorageMaxBytes",payload:e}),v.current=e;let r=parseInt(t.getItem("blobsStorageUsageBytes")||"NaN");isNaN(r)?(t.setItem("blobsStorageUsageBytes","0"),l({type:"setBlobsStorageUsageBytes",payload:0}),T.current=0):(l({type:"setBlobsStorageUsageBytes",payload:r}),T.current=r)}{let r=(0,u.Ek)();if((null==r?void 0:r.type)==="onedrive"){let e=await (0,d.g)();l({type:"setDriveClient",payload:e}),void 0===e.accountInfo?l({type:"setDriveStatus",payload:"no-account"}):l({type:"setDriveStatus",payload:"offline"})}else if((null==r?void 0:r.type)==="google-drive"){let r=await (0,h.dv)();if(l({type:"setDriveClient",payload:r}),r.userInfo?l({type:"setDriveStatus",payload:"offline"}):l({type:"setDriveStatus",payload:"no-account"}),e){let r={id:"root",name:"Google Drive Files",type:"folder",childrenIds:[]};await b(e.transaction("files").objectStore("files").get("root"))||await b(e.transaction("files","readwrite").objectStore("files").put(r)),t.setItem("rootFolderId","root"),l({type:"setRootFolderId",payload:"root"})}}else l({type:"setDriveStatus",payload:"no-account"})}})().then(()=>{l({type:"setConfigured",payload:!0})}).catch(e=>{console.error(e),(0,i.yv)("".concat(e),{variant:"error"})}),()=>{E.current=!0}},[]);let C=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{if(C.current||!r.configured)return;let e=r.driveClient;if(e&&("online"===r.driveStatus||"offline"===r.driveStatus)){if(!x.isOnline){l({type:"setDriveStatus",payload:"offline"});return}"online"!==r.driveStatus&&(C.current=!0,(async()=>{try{await e.connect(),(0,i.yv)("Drive Client Connected")}catch(e){(0,i.yv)("".concat(e),{variant:"error"}),C.current=!1;return}try{let t=await e.getRootFolderId();window.localStorage.setItem("rootFolderId",t),l({type:"setRootFolderId",payload:t})}catch(e){console.error(e),(0,i.yv)("".concat(e),{variant:"error"})}l({type:"setDriveStatus",payload:"online"}),C.current=!1})())}},[x,r.configured,r.driveClient,r.driveStatus]),(0,a.useEffect)(()=>{let e=r.syncQueue;if(0===e.length)return;let t=m.current;c()(void 0!==t),m.current=e.reduce((e,t)=>{let{fileId:n,resolve:i,reject:a}=t,o=r.fileDb,u=r.driveClient;return e.then(()=>{if(!u)throw Error("Drive client not connected");return u.fetchFileBlob(n)}).then(e=>s.Aj(e).then(t=>({blob:e,metadata:t}))).then(e=>{let t,{blob:r,metadata:i}=e;if(!o)throw Error("File database not initialized");return w(o,n,r).then(e=>{let{appended:t}=e;if(c()(void 0!==v.current&&void 0!==T.current),t){let e=T.current+r.size;return _(o,v.current,e).then(e=>{localStorage.setItem("blobsStorageUsageBytes","".concat(e)),l({type:"setBlobsStorageUsageBytes",payload:e}),T.current=e})}return null}).then(()=>g(o,n)).then(e=>{if(!e)throw Error("Item not found");if("audio-track"!==e.type)throw Error("Item is not a track");c()(void 0!==T.current),(t=e).metadata=i,o.transaction("files","readwrite").objectStore("files").put(t),T.current>0&&o.transaction("blobs","readwrite").objectStore("blobs").put(r,n);let a=i.common.album;return void 0===a&&(a="Unknown Album"),y(o,a=a.replace(/\0+$/,"")).then(e=>{if(e?e.fileIds.includes(n)||e.fileIds.push(n):e={name:a,fileIds:[n],cover:void 0},void 0===e.cover){let t=s.S5(i.common.picture);t&&(e.cover=new Blob([new Uint8Array(t.data)],{type:t.format}))}return o.transaction("albums","readwrite").objectStore("albums").put(e,a),{file:t,blob:r}})})}).then(e=>{i(e)}).catch(e=>{a(e)}).then(()=>{l({type:"setSyncingTrackFile",payload:{id:n,syncing:!1}})})},t),l({type:"popSyncTask",payload:e})},[r.syncQueue,r.fileDb,r.driveClient]),(0,n.tZ)(p.Provider,{value:r,children:(0,n.tZ)(f.Provider,{value:l,children:t})})}},33109:function(e,t,r){"use strict";r.d(t,{A7:function(){return o},Fx:function(){return s}});var n=r(81595),i=r(2265);let a=(0,i.createContext)({isOnline:!1}),o=()=>(0,i.useContext)(a),s=e=>{let{children:t}=e,[r,o]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{o(navigator.onLine);let e=()=>o(!1),t=()=>o(!0);return window.addEventListener("offline",e),window.addEventListener("online",t),()=>{window.removeEventListener("offline",e),window.removeEventListener("online",t)}},[]),(0,n.tZ)(a.Provider,{value:{isOnline:r},children:t})}},70594:function(e,t,r){"use strict";r.d(t,{Hc:function(){return h},nP:function(){return c}});var n=r(81595),i=r(2265),a=r(86083),o=r(64654);let s=(0,i.createContext)({isPlaying:!1,activeTrack:null,tracks:[],activeTrackIndex:-1,isActiveTrackLoading:!1,currentTime:0,currentTimeChanged:!1,duration:0}),l=(0,i.createContext)(()=>{}),c=()=>{let e=(0,i.useContext)(s),t=(0,i.useContext)(l),r=(0,i.useRef)(e);r.current=e;let[,n]=(0,a.O_)();return[e,(0,i.useMemo)(()=>{let e=(e,i,a)=>{let o=r.current.tracks;i&&(o=i.map(e=>({file:e}))),u(e,o,n,t);let s=!o[e].blob;t({type:"playTrack",payload:{index:e,tracks:o,isActiveTrackLoading:s,playSourceUrl:a||r.current.playSourceUrl}})};return{play:()=>t({type:"play"}),pause:()=>t({type:"pause"}),playTrack:(t,r,n)=>e(t,r,n),playNextTrack:()=>(console.log("Playing next track",r.current),0===r.current.tracks.length)?void 0:-1===r.current.activeTrackIndex?e(0):e(r.current.tracks.length===r.current.activeTrackIndex+1?0:r.current.activeTrackIndex+1),playPreviousTrack:()=>{if(0===r.current.tracks.length)return;let t=r.current.activeTrackIndex;return -1===t&&(t=0),r.current.currentTime<4&&(t=0===r.current.activeTrackIndex?r.current.tracks.length-1:r.current.activeTrackIndex-1),e(t)},setCurrentTime:e=>{t({type:"setCurrentTime",payload:{currentTime:e,changed:!1}})},changeCurrentTime:e=>{t({type:"setCurrentTime",payload:{currentTime:e,changed:!0}})},setDuration:e=>{t({type:"setDuration",payload:{duration:e}})}}},[])]},u=(e,t,r,n)=>{if(0===t.length)return;let i=e-1<0?t.length-1:e-1,a=e+1>=t.length?0:e+1;[e,a,i].forEach(i=>{let a=t[i];a.blob||r.getTrackContent(a.file.id).then(e=>e||Promise.reject("No content")).then(t=>{let{blob:r,file:o}=t;a.blob=r,o&&(a.file=o),i===e&&n({type:"trackLoaded",payload:{track:a}})}).catch(e=>{console.error(e),(0,o.yv)("".concat(e),{variant:"error"})})})},d=(e,t)=>{switch(t.type){case"play":{let t=e.activeTrack;return{...e,isPlaying:null!==t}}case"playTrack":{let{index:r,tracks:n,isActiveTrackLoading:i,playSourceUrl:a}=t.payload;return{...e,isPlaying:!0,activeTrack:n[r],activeTrackIndex:r,isActiveTrackLoading:i,tracks:n,currentTime:0,currentTimeChanged:!0,playSourceUrl:a}}case"pause":return{...e,isPlaying:!1};case"trackLoaded":{let{track:r}=t.payload;if(e.activeTrack!==r)return e;return{...e,isActiveTrackLoading:!1}}case"setCurrentTime":return{...e,currentTime:t.payload.currentTime,currentTimeChanged:t.payload.changed};case"setDuration":return{...e,duration:t.payload.duration};default:throw Error("Unknown action: ".concat(t))}},h=e=>{let{children:t}=e,[r,a]=i.useReducer(d,{isPlaying:!1,activeTrack:null,tracks:[],activeTrackIndex:-1,isActiveTrackLoading:!1,currentTime:0,currentTimeChanged:!1,duration:0});return(0,n.tZ)(s.Provider,{value:r,children:(0,n.tZ)(l.Provider,{value:a,children:t})})}},32879:function(e,t,r){"use strict";r.d(t,{ThemeStoreProvider:function(){return K},fl:function(){return X}});var n,i=r(81595),a=r(26230),o=r.n(a),s=r(1119),l=r(80399);function c(e){return String(parseFloat(e)).length===String(e).length}function u(e){return String(e).match(/[\d.\-+]*\s*(.*)/)[1]||""}function d(e){return parseFloat(e)}function h(e){return(t,r)=>{let n=u(t);if(n===r)return t;let i=d(t);"px"!==n&&("em"===n?i=d(t)*d(e):"rem"===n&&(i=d(t)*d(e)));let a=i;if("px"!==r){if("em"===r)a=i/d(e);else{if("rem"!==r)return t;a=i/d(e)}}return parseFloat(a.toFixed(5))+r}}function p(e){let{size:t,grid:r}=e,n=t-t%r,i=n+r;return t-n<i-t?n:i}function f(e){let{lineHeight:t,pixels:r,htmlFontSize:n}=e;return r/(t*n)}function m(e){let{cssProperty:t,min:r,max:n,unit:i="rem",breakpoints:a=[600,900,1200],transform:o=null}=e,s={[t]:"".concat(r).concat(i)},l=(n-r)/a[a.length-1];return a.forEach(e=>{let n=r+l*e;null!==o&&(n=o(n)),s["@media (min-width:".concat(e,"px)")]={[t]:"".concat(Math.round(1e4*n)/1e4).concat(i)}}),s}function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{breakpoints:r=["sm","md","lg"],disableAlign:n=!1,factor:i=2,variants:a=["h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","caption","button","overline"]}=t,o=(0,s.Z)({},e);o.typography=(0,s.Z)({},o.typography);let u=o.typography,d=h(u.htmlFontSize),g=r.map(e=>o.breakpoints.values[e]);return a.forEach(e=>{let t=u[e];if(!t)return;let r=parseFloat(d(t.fontSize,"rem"));if(r<=1)return;let a=r,o=1+(a-1)/i,{lineHeight:h}=t;if(!c(h)&&!n)throw Error((0,l.Z)(6));c(h)||(h=parseFloat(d(h,"rem"))/parseFloat(r));let y=null;n||(y=e=>p({size:e,grid:f({pixels:4,lineHeight:h,htmlFontSize:u.htmlFontSize})})),u[e]=(0,s.Z)({},t,m({cssProperty:"fontSize",min:o,max:a,unit:"rem",breakpoints:g,transform:y}))}),o}var y=r(66075),v=r(74610),b=r(2265),_=b.createContext(null);function w(){return b.useContext(_)}var S="function"==typeof Symbol&&Symbol.for?Symbol.for("mui.nested"):"__THEME_NESTED__",T=r(57437);function x(e,t){return"function"==typeof t?t(e):(0,s.Z)({},e,t)}var E=function(e){let{children:t,theme:r}=e,n=w(),i=b.useMemo(()=>{let e=null===n?r:x(n,r);return null!=e&&(e[S]=null!==n),e},[r,n]);return(0,T.jsx)(_.Provider,{value:i,children:t})},C=r(25246),A=r(62570),M=r(77126),I=r(17804),R=r(3450),k=r(53025),P=r(21075);function O(e){let t=(0,A.Z)(),r=(0,k.Z)()||"",{modularCssLayers:n}=e,i="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return(i=n&&null===t?"string"==typeof n?n.replace(/mui(?!\.)/g,i):"@layer ".concat(i,";"):"",(0,R.Z)(()=>{var e,t;let n=document.querySelector("head");if(!n)return;let a=n.firstChild;if(i){if(a&&null!=(e=a.hasAttribute)&&e.call(a,"data-mui-layer-order")&&a.getAttribute("data-mui-layer-order")===r)return;let t=document.createElement("style");t.setAttribute("data-mui-layer-order",r),t.textContent=i,n.prepend(t)}else null==(t=n.querySelector('style[data-mui-layer-order="'.concat(r,'"]')))||t.remove()},[i,r]),i)?(0,T.jsx)(P.Z,{styles:i}):null}let N={};function L(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return b.useMemo(()=>{let i=e&&t[e]||t;if("function"==typeof r){let a=r(i),o=e?(0,s.Z)({},t,{[e]:a}):a;return n?()=>o:o}return e?(0,s.Z)({},t,{[e]:r}):(0,s.Z)({},t,r)},[e,t,r,n])}var D=function(e){let{children:t,theme:r,themeId:n}=e,i=(0,A.Z)(N),a=w()||N,o=L(n,i,r),s=L(n,a,r,!0),l="rtl"===o.direction,c=O(o);return(0,T.jsx)(E,{theme:s,children:(0,T.jsx)(C.T.Provider,{value:o,children:(0,T.jsx)(M.Z,{value:l,children:(0,T.jsxs)(I.Z,{value:null==o?void 0:o.components,children:[c,t]})})})})},U=r(22166);let F=["theme"];function B(e){let{theme:t}=e,r=(0,v.Z)(e,F),n=t[U.Z],i=n||t;return"function"!=typeof t&&(n&&!n.vars?i=(0,s.Z)({},n,{vars:null}):t&&!t.vars&&(i=(0,s.Z)({},t,{vars:null}))),(0,T.jsx)(D,(0,s.Z)({},r,{themeId:n?U.Z:void 0,theme:i}))}var z=r(37995),H=r(41723);let j=async e=>new Promise((t,n)=>{let i=new Worker(r.tu(new URL(r.p+r.u(619),r.b)));i.onmessage=e=>{e.data.success?t(e.data.sourceColor):n(e.data.error)},i.onerror=e=>{n(e)},i.postMessage(e)});!function(e){e[e.MONOCHROME=0]="MONOCHROME",e[e.NEUTRAL=1]="NEUTRAL",e[e.TONAL_SPOT=2]="TONAL_SPOT",e[e.VIBRANT=3]="VIBRANT",e[e.EXPRESSIVE=4]="EXPRESSIVE",e[e.FIDELITY=5]="FIDELITY",e[e.CONTENT=6]="CONTENT"}(n||(n={}));let G=1455175;function V(e){let t=z.OP.fromInt(e);return new z.Af({sourceColorArgb:e,variant:2,contrastLevel:.3,isDark:!0,primaryPalette:z.hv.fromHueAndChroma(t.hue,Math.min(t.chroma+16,36)),secondaryPalette:z.hv.fromHueAndChroma(t.hue,16),tertiaryPalette:z.hv.fromHueAndChroma((0,z.sG)(t.hue+60),24),neutralPalette:z.hv.fromHueAndChroma(t.hue,6),neutralVariantPalette:z.hv.fromHueAndChroma(t.hue,8)})}let q=V(1455175),W=(0,b.createContext)({scheme:q,sourceColor:G}),Z=(0,b.createContext)(()=>{}),X=()=>{let e=(0,b.useContext)(W),t=(0,b.useContext)(Z);return(0,b.useRef)(e).current=e,[e,(0,b.useMemo)(()=>({applyThemeFromImage:async e=>{let r=await j(e);t({type:"setTheme",payload:{scheme:V(r),sourceColor:r}})},resetSourceColor:()=>{t({type:"setTheme",payload:{scheme:V(G),sourceColor:G}})}}),[])]},$=(e,t)=>{if("setTheme"===t.type){let{scheme:r,sourceColor:n}=t.payload;return e.sourceColor===n?e:{...e,scheme:r,sourceColor:n}}return e},K=e=>{let{children:t}=e,[r,n]=(0,b.useReducer)($,{scheme:q,sourceColor:G}),a=g((0,y.Z)({palette:{mode:"dark",primary:{main:(0,z.PQ)(z.YI.primary.getArgb(r.scheme))},secondary:{main:(0,z.PQ)(z.YI.secondary.getArgb(r.scheme))},background:{default:(0,z.PQ)(z.YI.surface.getArgb(r.scheme)),paper:(0,z.PQ)(z.YI.surfaceContainer.getArgb(r.scheme))},error:{main:(0,z.PQ)(z.YI.error.getArgb(r.scheme))},text:{primary:(0,z.PQ)(z.YI.onSurface.getArgb(r.scheme))}},typography:{fontFamily:o().style.fontFamily}}));return(0,i.BX)(B,{theme:a,children:[(0,i.tZ)(H.Z,{styles:e=>({body:{transition:e.transitions.create(["background-color","transform"])}})}),(0,i.tZ)(W.Provider,{value:r,children:(0,i.tZ)(Z.Provider,{value:n,children:t})})]})}},47960:function(){},26230:function(e){e.exports={style:{fontFamily:"'__Noto_Sans_JP_a8d55a', '__Noto_Sans_JP_Fallback_a8d55a'",fontStyle:"normal"},className:"__className_a8d55a"}},25566:function(e){var t,r,n,i=e.exports={};function a(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}function l(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var c=[],u=!1,d=-1;function h(){u&&n&&(u=!1,n.length?c=n.concat(c):d=-1,c.length&&p())}function p(){if(!u){var e=s(h);u=!0;for(var t=c.length;t;){for(n=c,c=[];++d<t;)n&&n[d].run();d=-1,t=c.length}n=null,u=!1,l(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new f(e,t)),1!==c.length||u||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}},12722:function(e){function t(){return e.exports=t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},9973:function(e){function t(e){return e&&e.__esModule?e:{default:e}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},63916:function(e){function t(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},59758:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadableWebToNodeStream=void 0;let n=r(80578);class i extends n.Readable{constructor(e){super(),this.bytesRead=0,this.released=!1,this.reader=e.getReader()}_read(){if(this.released){this.push(null);return}this.pendingRead=this.reader.read().then(e=>{delete this.pendingRead,e.done||this.released?this.push(null):(this.bytesRead+=e.value.length,this.push(e.value))}).catch(e=>{this.destroy(e)})}async waitForReadToComplete(){this.pendingRead&&await this.pendingRead}async close(){await this.syncAndRelease()}async syncAndRelease(){this.released=!0,await this.waitForReadToComplete(),await this.reader.releaseLock()}}t.ReadableWebToNodeStream=i},1119:function(e,t,r){"use strict";function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}r.d(t,{Z:function(){return n}})},88671:function(e,t,r){"use strict";function n(e,t){return(n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t)}r.d(t,{Z:function(){return i}})},74610:function(e,t,r){"use strict";function n(e,t){if(null==e)return{};var r={};for(var n in e)if(({}).hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}r.d(t,{Z:function(){return n}})},37995:function(e,t,r){"use strict";r.d(t,{Ct:function(){return u},Af:function(){return T},OP:function(){return c},YI:function(){return w},hv:function(){return S},PQ:function(){return I.P},sG:function(){return a.Vy}});var n,i=r(54122),a=r(57206);class o{static make(e=i.pQ(),t=200/Math.PI*i.cj(50)/100,r=50,n=2,s=!1){let l=e,c=.401288*l[0]+.650173*l[1]+-.051461*l[2],u=-.250268*l[0]+1.204414*l[1]+.045854*l[2],d=-.002079*l[0]+.048952*l[1]+.953127*l[2],h=.8+n/10,p=h>=.9?a.t7(.59,.69,(h-.9)*10):a.t7(.525,.59,(h-.8)*10),f=s?1:h*(1-1/3.6*Math.exp((-t-42)/92)),m=h,g=[100/c*(f=f>1?1:f<0?0:f)+1-f,100/u*f+1-f,100/d*f+1-f],y=1/(5*t+1),v=y*y*y*y,b=1-v,_=v*t+.1*b*b*Math.cbrt(5*t),w=i.cj(r)/e[1],S=1.48+Math.sqrt(w),T=.725/Math.pow(w,.2),x=T,E=[Math.pow(_*g[0]*c/100,.42),Math.pow(_*g[1]*u/100,.42),Math.pow(_*g[2]*d/100,.42)],C=[400*E[0]/(E[0]+27.13),400*E[1]/(E[1]+27.13),400*E[2]/(E[2]+27.13)];return new o(w,(2*C[0]+C[1]+.05*C[2])*T,T,x,p,m,g,_,Math.pow(_,.25),S)}constructor(e,t,r,n,i,a,o,s,l,c){this.n=e,this.aw=t,this.nbb=r,this.ncb=n,this.c=i,this.nc=a,this.rgbD=o,this.fl=s,this.fLRoot=l,this.z=c}}o.DEFAULT=o.make();class s{constructor(e,t,r,n,i,a,o,s,l){this.hue=e,this.chroma=t,this.j=r,this.q=n,this.m=i,this.s=a,this.jstar=o,this.astar=s,this.bstar=l}distance(e){let t=this.jstar-e.jstar,r=this.astar-e.astar,n=this.bstar-e.bstar;return 1.41*Math.pow(Math.sqrt(t*t+r*r+n*n),.63)}static fromInt(e){return s.fromIntInViewingConditions(e,o.DEFAULT)}static fromIntInViewingConditions(e,t){let r=(16711680&e)>>16,n=(65280&e)>>8,o=255&e,l=i.m_(r),c=i.m_(n),u=i.m_(o),d=.41233895*l+.35762064*c+.18051042*u,h=.2126*l+.7152*c+.0722*u,p=.01932141*l+.11916382*c+.95034478*u,f=.401288*d+.650173*h-.051461*p,m=-.250268*d+1.204414*h+.045854*p,g=-.002079*d+.048952*h+.953127*p,y=t.rgbD[0]*f,v=t.rgbD[1]*m,b=t.rgbD[2]*g,_=Math.pow(t.fl*Math.abs(y)/100,.42),w=Math.pow(t.fl*Math.abs(v)/100,.42),S=Math.pow(t.fl*Math.abs(b)/100,.42),T=400*a.EQ(y)*_/(_+27.13),x=400*a.EQ(v)*w/(w+27.13),E=400*a.EQ(b)*S/(S+27.13),C=(11*T+-12*x+E)/11,A=(T+x-2*E)/9,M=(20*T+20*x+21*E)/20,I=180*Math.atan2(A,C)/Math.PI,R=I<0?I+360:I>=360?I-360:I,k=R*Math.PI/180,P=100*Math.pow((40*T+20*x+E)/20*t.nbb/t.aw,t.c*t.z),O=4/t.c*Math.sqrt(P/100)*(t.aw+4)*t.fLRoot,N=Math.pow(5e4/13*(.25*(Math.cos((R<20.14?R+360:R)*Math.PI/180+2)+3.8))*t.nc*t.ncb*Math.sqrt(C*C+A*A)/(M+.305),.9)*Math.pow(1.64-Math.pow(.29,t.n),.73),L=N*Math.sqrt(P/100),D=L*t.fLRoot,U=50*Math.sqrt(N*t.c/(t.aw+4)),F=(1+100*.007)*P/(1+.007*P),B=1/.0228*Math.log(1+.0228*D);return new s(R,L,P,O,D,U,F,B*Math.cos(k),B*Math.sin(k))}static fromJch(e,t,r){return s.fromJchInViewingConditions(e,t,r,o.DEFAULT)}static fromJchInViewingConditions(e,t,r,n){let i=4/n.c*Math.sqrt(e/100)*(n.aw+4)*n.fLRoot,a=t*n.fLRoot,o=50*Math.sqrt(t/Math.sqrt(e/100)*n.c/(n.aw+4)),l=r*Math.PI/180,c=(1+100*.007)*e/(1+.007*e),u=1/.0228*Math.log(1+.0228*a);return new s(r,t,e,i,a,o,c,u*Math.cos(l),u*Math.sin(l))}static fromUcs(e,t,r){return s.fromUcsInViewingConditions(e,t,r,o.DEFAULT)}static fromUcsInViewingConditions(e,t,r,n){let i=t,a=r,o=(Math.exp(.0228*Math.sqrt(i*i+a*a))-1)/.0228/n.fLRoot,l=180/Math.PI*Math.atan2(a,i);l<0&&(l+=360);let c=e/(1-(e-100)*.007);return s.fromJchInViewingConditions(c,o,l,n)}toInt(){return this.viewed(o.DEFAULT)}viewed(e){let t=Math.pow((0===this.chroma||0===this.j?0:this.chroma/Math.sqrt(this.j/100))/Math.pow(1.64-Math.pow(.29,e.n),.73),1/.9),r=this.hue*Math.PI/180,n=.25*(Math.cos(r+2)+3.8),o=e.aw*Math.pow(this.j/100,1/e.c/e.z),s=5e4/13*n*e.nc*e.ncb,l=o/e.nbb,c=Math.sin(r),u=Math.cos(r),d=23*(l+.305)*t/(23*s+11*t*u+108*t*c),h=d*u,p=d*c,f=(460*l+451*h+288*p)/1403,m=(460*l-891*h-261*p)/1403,g=(460*l-220*h-6300*p)/1403,y=Math.max(0,27.13*Math.abs(f)/(400-Math.abs(f))),v=a.EQ(f)*(100/e.fl)*Math.pow(y,1/.42),b=Math.max(0,27.13*Math.abs(m)/(400-Math.abs(m))),_=a.EQ(m)*(100/e.fl)*Math.pow(b,1/.42),w=Math.max(0,27.13*Math.abs(g)/(400-Math.abs(g))),S=a.EQ(g)*(100/e.fl)*Math.pow(w,1/.42),T=v/e.rgbD[0],x=_/e.rgbD[1],E=S/e.rgbD[2],C=1.86206786*T-1.01125463*x+.14918677*E,A=.38752654*T+.62144744*x-.00897398*E,M=-.0158415*T-.03412294*x+1.04996444*E;return i._2(C,A,M)}static fromXyzInViewingConditions(e,t,r,n){let i=.401288*e+.650173*t-.051461*r,o=-.250268*e+1.204414*t+.045854*r,l=-.002079*e+.048952*t+.953127*r,c=n.rgbD[0]*i,u=n.rgbD[1]*o,d=n.rgbD[2]*l,h=Math.pow(n.fl*Math.abs(c)/100,.42),p=Math.pow(n.fl*Math.abs(u)/100,.42),f=Math.pow(n.fl*Math.abs(d)/100,.42),m=400*a.EQ(c)*h/(h+27.13),g=400*a.EQ(u)*p/(p+27.13),y=400*a.EQ(d)*f/(f+27.13),v=(11*m+-12*g+y)/11,b=(m+g-2*y)/9,_=(20*m+20*g+21*y)/20,w=180*Math.atan2(b,v)/Math.PI,S=w<0?w+360:w>=360?w-360:w,T=S*Math.PI/180,x=100*Math.pow((40*m+20*g+y)/20*n.nbb/n.aw,n.c*n.z),E=4/n.c*Math.sqrt(x/100)*(n.aw+4)*n.fLRoot,C=Math.pow(5e4/13*(.25*(Math.cos((S<20.14?S+360:S)*Math.PI/180+2)+3.8))*n.nc*n.ncb*Math.sqrt(v*v+b*b)/(_+.305),.9)*Math.pow(1.64-Math.pow(.29,n.n),.73),A=C*Math.sqrt(x/100),M=A*n.fLRoot,I=50*Math.sqrt(C*n.c/(n.aw+4)),R=(1+100*.007)*x/(1+.007*x),k=Math.log(1+.0228*M)/.0228;return new s(S,A,x,E,M,I,R,k*Math.cos(T),k*Math.sin(T))}xyzInViewingConditions(e){let t=Math.pow((0===this.chroma||0===this.j?0:this.chroma/Math.sqrt(this.j/100))/Math.pow(1.64-Math.pow(.29,e.n),.73),1/.9),r=this.hue*Math.PI/180,n=.25*(Math.cos(r+2)+3.8),i=e.aw*Math.pow(this.j/100,1/e.c/e.z),o=5e4/13*n*e.nc*e.ncb,s=i/e.nbb,l=Math.sin(r),c=Math.cos(r),u=23*(s+.305)*t/(23*o+11*t*c+108*t*l),d=u*c,h=u*l,p=(460*s+451*d+288*h)/1403,f=(460*s-891*d-261*h)/1403,m=(460*s-220*d-6300*h)/1403,g=Math.max(0,27.13*Math.abs(p)/(400-Math.abs(p))),y=a.EQ(p)*(100/e.fl)*Math.pow(g,1/.42),v=Math.max(0,27.13*Math.abs(f)/(400-Math.abs(f))),b=a.EQ(f)*(100/e.fl)*Math.pow(v,1/.42),_=Math.max(0,27.13*Math.abs(m)/(400-Math.abs(m))),w=a.EQ(m)*(100/e.fl)*Math.pow(_,1/.42),S=y/e.rgbD[0],T=b/e.rgbD[1],x=w/e.rgbD[2];return[1.86206786*S-1.01125463*T+.14918677*x,.38752654*S+.62144744*T-.00897398*x,-.0158415*S-.03412294*T+1.04996444*x]}}class l{static sanitizeRadians(e){return(e+8*Math.PI)%(2*Math.PI)}static trueDelinearized(e){let t=e/100,r=0;return 255*(r=t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}static chromaticAdaptation(e){let t=Math.pow(Math.abs(e),.42);return 400*a.EQ(e)*t/(t+27.13)}static hueOf(e){let t=a.h9(e,l.SCALED_DISCOUNT_FROM_LINRGB),r=l.chromaticAdaptation(t[0]),n=l.chromaticAdaptation(t[1]),i=l.chromaticAdaptation(t[2]),o=(11*r+-12*n+i)/11;return Math.atan2((r+n-2*i)/9,o)}static areInCyclicOrder(e,t,r){return l.sanitizeRadians(t-e)<l.sanitizeRadians(r-e)}static intercept(e,t,r){return(t-e)/(r-e)}static lerpPoint(e,t,r){return[e[0]+(r[0]-e[0])*t,e[1]+(r[1]-e[1])*t,e[2]+(r[2]-e[2])*t]}static setCoordinate(e,t,r,n){let i=l.intercept(e[n],t,r[n]);return l.lerpPoint(e,i,r)}static isBounded(e){return 0<=e&&e<=100}static nthVertex(e,t){let r=l.Y_FROM_LINRGB[0],n=l.Y_FROM_LINRGB[1],i=l.Y_FROM_LINRGB[2],a=t%4<=1?0:100,o=t%2==0?0:100;if(t<4){let t=a,s=o,c=(e-t*n-s*i)/r;return l.isBounded(c)?[c,t,s]:[-1,-1,-1]}if(t<8){let t=a,s=o,c=(e-s*r-t*i)/n;return l.isBounded(c)?[s,c,t]:[-1,-1,-1]}{let t=a,s=o,c=(e-t*r-s*n)/i;return l.isBounded(c)?[t,s,c]:[-1,-1,-1]}}static bisectToSegment(e,t){let r=[-1,-1,-1],n=r,i=0,a=0,o=!1,s=!0;for(let c=0;c<12;c++){let u=l.nthVertex(e,c);if(u[0]<0)continue;let d=l.hueOf(u);if(!o){r=u,n=u,i=d,a=d,o=!0;continue}(s||l.areInCyclicOrder(i,d,a))&&(s=!1,l.areInCyclicOrder(i,t,d)?(n=u,a=d):(r=u,i=d))}return[r,n]}static midpoint(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2,(e[2]+t[2])/2]}static criticalPlaneBelow(e){return Math.floor(e-.5)}static criticalPlaneAbove(e){return Math.ceil(e-.5)}static bisectToLimit(e,t){let r=l.bisectToSegment(e,t),n=r[0],i=l.hueOf(n),a=r[1];for(let e=0;e<3;e++)if(n[e]!==a[e]){let r=-1,o=255;n[e]<a[e]?(r=l.criticalPlaneBelow(l.trueDelinearized(n[e])),o=l.criticalPlaneAbove(l.trueDelinearized(a[e]))):(r=l.criticalPlaneAbove(l.trueDelinearized(n[e])),o=l.criticalPlaneBelow(l.trueDelinearized(a[e])));for(let s=0;s<8&&!(1>=Math.abs(o-r));s++){let s=Math.floor((r+o)/2),c=l.CRITICAL_PLANES[s],u=l.setCoordinate(n,c,a,e),d=l.hueOf(u);l.areInCyclicOrder(i,t,d)?(a=u,o=s):(n=u,i=d,r=s)}}return l.midpoint(n,a)}static inverseChromaticAdaptation(e){let t=Math.abs(e),r=Math.max(0,27.13*t/(400-t));return a.EQ(e)*Math.pow(r,1/.42)}static findResultByJ(e,t,r){let n=11*Math.sqrt(r),s=o.DEFAULT,c=1/Math.pow(1.64-Math.pow(.29,s.n),.73),u=5e4/13*(.25*(Math.cos(e+2)+3.8))*s.nc*s.ncb,d=Math.sin(e),h=Math.cos(e);for(let e=0;e<5;e++){let o=n/100,p=Math.pow((0===t||0===n?0:t/Math.sqrt(o))*c,1/.9),f=s.aw*Math.pow(o,1/s.c/s.z)/s.nbb,m=23*(f+.305)*p/(23*u+11*p*h+108*p*d),g=m*h,y=m*d,v=(460*f+451*g+288*y)/1403,b=(460*f-891*g-261*y)/1403,_=(460*f-220*g-6300*y)/1403,w=l.inverseChromaticAdaptation(v),S=l.inverseChromaticAdaptation(b),T=l.inverseChromaticAdaptation(_),x=a.h9([w,S,T],l.LINRGB_FROM_SCALED_DISCOUNT);if(x[0]<0||x[1]<0||x[2]<0)break;let E=l.Y_FROM_LINRGB[0],C=l.Y_FROM_LINRGB[1],A=l.Y_FROM_LINRGB[2],M=E*x[0]+C*x[1]+A*x[2];if(M<=0)break;if(4===e||.002>Math.abs(M-r)){if(x[0]>100.01||x[1]>100.01||x[2]>100.01)return 0;return i.Xr(x)}n-=(M-r)*n/(2*M)}return 0}static solveToInt(e,t,r){if(t<1e-4||r<1e-4||r>99.9999)return i.ly(r);let n=(e=a.Vy(e))/180*Math.PI,o=i.cj(r),s=l.findResultByJ(n,t,o);if(0!==s)return s;let c=l.bisectToLimit(o,n);return i.Xr(c)}static solveToCam(e,t,r){return s.fromInt(l.solveToInt(e,t,r))}}l.SCALED_DISCOUNT_FROM_LINRGB=[[.001200833568784504,.002389694492170889,2795742885861124e-19],[5891086651375999e-19,.0029785502573438758,3270666104008398e-19],[10146692491640572e-20,5364214359186694e-19,.0032979401770712076]],l.LINRGB_FROM_SCALED_DISCOUNT=[[1373.2198709594231,-1100.4251190754821,-7.278681089101213],[-271.815969077903,559.6580465940733,-32.46047482791194],[1.9622899599665666,-57.173814538844006,308.7233197812385]],l.Y_FROM_LINRGB=[.2126,.7152,.0722],l.CRITICAL_PLANES=[.015176349177441876,.045529047532325624,.07588174588720938,.10623444424209313,.13658714259697685,.16693984095186062,.19729253930674434,.2276452376616281,.2579979360165119,.28835063437139563,.3188300904430532,.350925934958123,.3848314933096426,.42057480301049466,.458183274052838,.4976837250274023,.5391024159806381,.5824650784040898,.6277969426914107,.6751227633498623,.7244668422128921,.775853049866786,.829304845476233,.8848452951698498,.942497089126609,1.0022825574869039,1.0642236851973577,1.1283421258858297,1.1946592148522128,1.2631959812511864,1.3339731595349034,1.407011200216447,1.4823302800086415,1.5599503113873272,1.6398909516233677,1.7221716113234105,1.8068114625156377,1.8938294463134073,1.9832442801866852,2.075074464868551,2.1693382909216234,2.2660538449872063,2.36523901573795,2.4669114995532007,2.5710888059345764,2.6777882626779785,2.7870270208169257,2.898822059350997,3.0131901897720907,3.1301480604002863,3.2497121605402226,3.3718988244681087,3.4967242352587946,3.624204428461639,3.754355295633311,3.887192587735158,4.022731918402185,4.160988767090289,4.301978482107941,4.445716283538092,4.592217266055746,4.741496401646282,4.893568542229298,5.048448422192488,5.20615066083972,5.3666897647573375,5.5300801301023865,5.696336044816294,5.865471690767354,6.037501145825082,6.212438385869475,6.390297286737924,6.571091626112461,6.7548350853498045,6.941541251256611,7.131223617812143,7.323895587840543,7.5195704746346665,7.7182615035334345,7.919981813454504,8.124744458384042,8.332562408825165,8.543448553206703,8.757415699253682,8.974476575321063,9.194643831691977,9.417930041841839,9.644347703669503,9.873909240696694,10.106627003236781,10.342513269534024,10.58158024687427,10.8238400726681,11.069304815507364,11.317986476196008,11.569896988756009,11.825048221409341,12.083451977536606,12.345119996613247,12.610063955123938,12.878295467455942,13.149826086772048,13.42466730586372,13.702830557985108,13.984327217668513,14.269168601521828,14.55736596900856,14.848930523210871,15.143873411576273,15.44220572664832,15.743938506781891,16.04908273684337,16.35764934889634,16.66964922287304,16.985093187232053,17.30399201960269,17.62635644741625,17.95219714852476,18.281524751807332,18.614349837764564,18.95068293910138,19.290534541298456,19.633915083172692,19.98083495742689,20.331304511189067,20.685334046541502,21.042933821039977,21.404114048223256,21.76888489811322,22.137256497705877,22.50923893145328,22.884842241736916,23.264076429332462,23.6469514538663,24.033477234264016,24.42366364919083,24.817520537484558,25.21505769858089,25.61628489293138,26.021211842414342,26.429848230738664,26.842203703840827,27.258287870275353,27.678110301598522,28.10168053274597,28.529008062403893,28.96010235337422,29.39497283293396,29.83362889318845,30.276079891419332,30.722335150426627,31.172403958865512,31.62629557157785,32.08401920991837,32.54558406207592,33.010999283389665,33.4802739966603,33.953417292456834,34.430438229418264,34.911345834551085,35.39614910352207,35.88485700094671,36.37747846067349,36.87402238606382,37.37449765026789,37.87891309649659,38.38727753828926,38.89959975977785,39.41588851594697,39.93615253289054,40.460400508064545,40.98864111053629,41.520882981230194,42.05713473317016,42.597404951718396,43.141702194811224,43.6900349931913,44.24241185063697,44.798841244188324,45.35933162437017,45.92389141541209,46.49252901546552,47.065252796817916,47.64207110610409,48.22299226451468,48.808024568002054,49.3971762874833,49.9904556690408,50.587870934119984,51.189430279724725,51.79514187861014,52.40501387947288,53.0190544071392,53.637271562750364,54.259673423945976,54.88626804504493,55.517063457223934,56.15206766869424,56.79128866487574,57.43473440856916,58.08241284012621,58.734331877617365,59.39049941699807,60.05092333227251,60.715611475655585,61.38457167773311,62.057811747619894,62.7353394731159,63.417162620860914,64.10328893648692,64.79372614476921,65.48848194977529,66.18756403501224,66.89098006357258,67.59873767827808,68.31084450182222,69.02730813691093,69.74813616640164,70.47333615344107,71.20291564160104,71.93688215501312,72.67524319850172,73.41800625771542,74.16517879925733,74.9167682708136,75.67278210128072,76.43322770089146,77.1981124613393,77.96744375590167,78.74122893956174,79.51947534912904,80.30219030335869,81.08938110306934,81.88105503125999,82.67721935322541,83.4778813166706,84.28304815182372,85.09272707154808,85.90692527145302,86.72564993000343,87.54890820862819,88.3767072518277,89.2090541872801,90.04595612594655,90.88742016217518,91.73345337380438,92.58406282226491,93.43925555268066,94.29903859396902,95.16341895893969,96.03240364439274,96.9059996312159,97.78421388448044,98.6670533535366,99.55452497210776];class c{static from(e,t,r){return new c(l.solveToInt(e,t,r))}static fromInt(e){return new c(e)}toInt(){return this.argb}get hue(){return this.internalHue}set hue(e){this.setInternalState(l.solveToInt(e,this.internalChroma,this.internalTone))}get chroma(){return this.internalChroma}set chroma(e){this.setInternalState(l.solveToInt(this.internalHue,e,this.internalTone))}get tone(){return this.internalTone}set tone(e){this.setInternalState(l.solveToInt(this.internalHue,this.internalChroma,e))}constructor(e){this.argb=e;let t=s.fromInt(e);this.internalHue=t.hue,this.internalChroma=t.chroma,this.internalTone=i.gb(e),this.argb=e}setInternalState(e){let t=s.fromInt(e);this.internalHue=t.hue,this.internalChroma=t.chroma,this.internalTone=i.gb(e),this.argb=e}inViewingConditions(e){let t=s.fromInt(this.toInt()).xyzInViewingConditions(e),r=s.fromXyzInViewingConditions(t[0],t[1],t[2],o.make());return c.from(r.hue,r.chroma,i.cN(t[1]))}}class u{static harmonize(e,t){let r=c.fromInt(e),n=c.fromInt(t),i=Math.min(.5*a.ae(r.hue,n.hue),15),o=a.Vy(r.hue+i*a.vt(r.hue,n.hue));return c.from(o,r.chroma,r.tone).toInt()}static hctHue(e,t,r){let n=u.cam16Ucs(e,t,r),a=s.fromInt(n),o=s.fromInt(e);return c.from(a.hue,o.chroma,i.gb(e)).toInt()}static cam16Ucs(e,t,r){let n=s.fromInt(e),i=s.fromInt(t),a=n.jstar,o=n.astar,l=n.bstar,c=i.jstar,u=i.astar,d=i.bstar,h=a+(c-a)*r,p=o+(u-o)*r,f=l+(d-l)*r;return s.fromUcs(h,p,f).toInt()}}class d{static isDisliked(e){let t=Math.round(e.hue)>=90&&111>=Math.round(e.hue),r=Math.round(e.chroma)>16,n=65>Math.round(e.tone);return t&&r&&n}static fixIfDisliked(e){return d.isDisliked(e)?c.from(e.hue,e.chroma,70):e}}!function(e){e[e.MONOCHROME=0]="MONOCHROME",e[e.NEUTRAL=1]="NEUTRAL",e[e.TONAL_SPOT=2]="TONAL_SPOT",e[e.VIBRANT=3]="VIBRANT",e[e.EXPRESSIVE=4]="EXPRESSIVE",e[e.FIDELITY=5]="FIDELITY",e[e.CONTENT=6]="CONTENT",e[e.RAINBOW=7]="RAINBOW",e[e.FRUIT_SALAD=8]="FRUIT_SALAD"}(n||(n={}));class h{constructor(e,t,r,n){this.low=e,this.normal=t,this.medium=r,this.high=n}getContrast(e){return e<=-1?this.low:e<0?a.t7(this.low,this.normal,(e- -1)/1):e<.5?a.t7(this.normal,this.medium,(e-0)/.5):e<1?a.t7(this.medium,this.high,(e-.5)/.5):this.high}}class p{static ratioOfTones(e,t){return e=a.SJ(0,100,e),t=a.SJ(0,100,t),p.ratioOfYs(i.cj(e),i.cj(t))}static ratioOfYs(e,t){let r=e>t?e:t,n=r===t?e:t;return(r+5)/(n+5)}static lighter(e,t){if(e<0||e>100)return -1;let r=i.cj(e),n=t*(r+5)-5,a=p.ratioOfYs(n,r),o=Math.abs(a-t);if(a<t&&o>.04)return -1;let s=i.cN(n)+.4;return s<0||s>100?-1:s}static darker(e,t){if(e<0||e>100)return -1;let r=i.cj(e),n=(r+5)/t-5,a=p.ratioOfYs(r,n),o=Math.abs(a-t);if(a<t&&o>.04)return -1;let s=i.cN(n)-.4;return s<0||s>100?-1:s}static lighterUnsafe(e,t){let r=p.lighter(e,t);return r<0?100:r}static darkerUnsafe(e,t){let r=p.darker(e,t);return r<0?0:r}}class f{static fromPalette(e){return new f(e.name??"",e.palette,e.tone,e.isBackground??!1,e.background,e.secondBackground,e.contrastCurve,e.toneDeltaPair)}constructor(e,t,r,n,i,a,o,s){if(this.name=e,this.palette=t,this.tone=r,this.isBackground=n,this.background=i,this.secondBackground=a,this.contrastCurve=o,this.toneDeltaPair=s,this.hctCache=new Map,!i&&a)throw Error(`Color ${e} has secondBackgrounddefined, but background is not defined.`);if(!i&&o)throw Error(`Color ${e} has contrastCurvedefined, but background is not defined.`);if(i&&!o)throw Error(`Color ${e} has backgrounddefined, but contrastCurve is not defined.`)}getArgb(e){return this.getHct(e).toInt()}getHct(e){let t=this.hctCache.get(e);if(null!=t)return t;let r=this.getTone(e),n=this.palette(e).getHct(r);return this.hctCache.size>4&&this.hctCache.clear(),this.hctCache.set(e,n),n}getTone(e){let t=e.contrastLevel<0;if(this.toneDeltaPair){let r=this.toneDeltaPair(e),n=r.roleA,i=r.roleB,o=r.delta,s=r.polarity,l=r.stayTogether,c=this.background(e).getTone(e),u="nearer"===s||"lighter"===s&&!e.isDark||"darker"===s&&e.isDark,d=u?n:i,h=u?i:n,m=this.name===d.name,g=e.isDark?1:-1,y=d.contrastCurve.getContrast(e.contrastLevel),v=h.contrastCurve.getContrast(e.contrastLevel),b=d.tone(e),_=p.ratioOfTones(c,b)>=y?b:f.foregroundTone(c,y),w=h.tone(e),S=p.ratioOfTones(c,w)>=v?w:f.foregroundTone(c,v);return t&&(_=f.foregroundTone(c,y),S=f.foregroundTone(c,v)),(S-_)*g>=o||((S=a.SJ(0,100,_+o*g))-_)*g>=o||(_=a.SJ(0,100,S-o*g)),50<=_&&_<60?S=g>0?Math.max(S,(_=60)+o*g):Math.min(S,(_=49)+o*g):50<=S&&S<60&&(S=l?g>0?Math.max(S,(_=60)+o*g):Math.min(S,(_=49)+o*g):g>0?60:49),m?_:S}{let r=this.tone(e);if(null==this.background)return r;let n=this.background(e).getTone(e),i=this.contrastCurve.getContrast(e.contrastLevel);if(p.ratioOfTones(n,r)>=i||(r=f.foregroundTone(n,i)),t&&(r=f.foregroundTone(n,i)),this.isBackground&&50<=r&&r<60&&(r=p.ratioOfTones(49,n)>=i?49:60),this.secondBackground){let[t,n]=[this.background,this.secondBackground],[a,o]=[t(e).getTone(e),n(e).getTone(e)],[s,l]=[Math.max(a,o),Math.min(a,o)];if(p.ratioOfTones(s,r)>=i&&p.ratioOfTones(l,r)>=i)return r;let c=p.lighter(s,i),u=p.darker(l,i),d=[];return(-1!==c&&d.push(c),-1!==u&&d.push(u),f.tonePrefersLightForeground(a)||f.tonePrefersLightForeground(o))?c<0?100:c:1===d.length?d[0]:u<0?0:u}return r}}static foregroundTone(e,t){let r=p.lighterUnsafe(e,t),n=p.darkerUnsafe(e,t),i=p.ratioOfTones(r,e),a=p.ratioOfTones(n,e);if(!f.tonePrefersLightForeground(e))return a>=t||a>=i?n:r;{let e=.1>Math.abs(i-a)&&i<t&&a<t;return i>=t||i>=a||e?r:n}}static tonePrefersLightForeground(e){return 60>Math.round(e)}static toneAllowsLightForeground(e){return 49>=Math.round(e)}static enableLightForeground(e){return f.tonePrefersLightForeground(e)&&!f.toneAllowsLightForeground(e)?49:e}}class m{constructor(e,t,r,n,i){this.roleA=e,this.roleB=t,this.delta=r,this.polarity=n,this.stayTogether=i}}function g(e){return e.variant===n.FIDELITY||e.variant===n.CONTENT}function y(e){return e.variant===n.MONOCHROME}function v(e,t,r,n){let i=r,a=c.from(e,t,r);if(a.chroma<t){let r=a.chroma;for(;a.chroma<t;){i+=n?-1:1;let o=c.from(e,t,i);if(r>o.chroma||.4>Math.abs(o.chroma-t))break;Math.abs(o.chroma-t)<Math.abs(a.chroma-t)&&(a=o),r=Math.max(r,o.chroma)}}return i}function b(e){return o.make(void 0,void 0,e.isDark?30:80,void 0,void 0)}function _(e,t){let r=e.inViewingConditions(b(t));return f.tonePrefersLightForeground(e.tone)&&!f.toneAllowsLightForeground(r.tone)?f.enableLightForeground(e.tone):f.enableLightForeground(r.tone)}class w{static highestSurface(e){return e.isDark?w.surfaceBright:w.surfaceDim}}w.contentAccentToneDelta=15,w.primaryPaletteKeyColor=f.fromPalette({name:"primary_palette_key_color",palette:e=>e.primaryPalette,tone:e=>e.primaryPalette.keyColor.tone}),w.secondaryPaletteKeyColor=f.fromPalette({name:"secondary_palette_key_color",palette:e=>e.secondaryPalette,tone:e=>e.secondaryPalette.keyColor.tone}),w.tertiaryPaletteKeyColor=f.fromPalette({name:"tertiary_palette_key_color",palette:e=>e.tertiaryPalette,tone:e=>e.tertiaryPalette.keyColor.tone}),w.neutralPaletteKeyColor=f.fromPalette({name:"neutral_palette_key_color",palette:e=>e.neutralPalette,tone:e=>e.neutralPalette.keyColor.tone}),w.neutralVariantPaletteKeyColor=f.fromPalette({name:"neutral_variant_palette_key_color",palette:e=>e.neutralVariantPalette,tone:e=>e.neutralVariantPalette.keyColor.tone}),w.background=f.fromPalette({name:"background",palette:e=>e.neutralPalette,tone:e=>e.isDark?6:98,isBackground:!0}),w.onBackground=f.fromPalette({name:"on_background",palette:e=>e.neutralPalette,tone:e=>e.isDark?90:10,background:e=>w.background,contrastCurve:new h(3,3,4.5,7)}),w.surface=f.fromPalette({name:"surface",palette:e=>e.neutralPalette,tone:e=>e.isDark?6:98,isBackground:!0}),w.surfaceDim=f.fromPalette({name:"surface_dim",palette:e=>e.neutralPalette,tone:e=>e.isDark?6:87,isBackground:!0}),w.surfaceBright=f.fromPalette({name:"surface_bright",palette:e=>e.neutralPalette,tone:e=>e.isDark?24:98,isBackground:!0}),w.surfaceContainerLowest=f.fromPalette({name:"surface_container_lowest",palette:e=>e.neutralPalette,tone:e=>e.isDark?4:100,isBackground:!0}),w.surfaceContainerLow=f.fromPalette({name:"surface_container_low",palette:e=>e.neutralPalette,tone:e=>e.isDark?10:96,isBackground:!0}),w.surfaceContainer=f.fromPalette({name:"surface_container",palette:e=>e.neutralPalette,tone:e=>e.isDark?12:94,isBackground:!0}),w.surfaceContainerHigh=f.fromPalette({name:"surface_container_high",palette:e=>e.neutralPalette,tone:e=>e.isDark?17:92,isBackground:!0}),w.surfaceContainerHighest=f.fromPalette({name:"surface_container_highest",palette:e=>e.neutralPalette,tone:e=>e.isDark?22:90,isBackground:!0}),w.onSurface=f.fromPalette({name:"on_surface",palette:e=>e.neutralPalette,tone:e=>e.isDark?90:10,background:e=>w.highestSurface(e),contrastCurve:new h(4.5,7,11,21)}),w.surfaceVariant=f.fromPalette({name:"surface_variant",palette:e=>e.neutralVariantPalette,tone:e=>e.isDark?30:90,isBackground:!0}),w.onSurfaceVariant=f.fromPalette({name:"on_surface_variant",palette:e=>e.neutralVariantPalette,tone:e=>e.isDark?80:30,background:e=>w.highestSurface(e),contrastCurve:new h(3,4.5,7,11)}),w.inverseSurface=f.fromPalette({name:"inverse_surface",palette:e=>e.neutralPalette,tone:e=>e.isDark?90:20}),w.inverseOnSurface=f.fromPalette({name:"inverse_on_surface",palette:e=>e.neutralPalette,tone:e=>e.isDark?20:95,background:e=>w.inverseSurface,contrastCurve:new h(4.5,7,11,21)}),w.outline=f.fromPalette({name:"outline",palette:e=>e.neutralVariantPalette,tone:e=>e.isDark?60:50,background:e=>w.highestSurface(e),contrastCurve:new h(1.5,3,4.5,7)}),w.outlineVariant=f.fromPalette({name:"outline_variant",palette:e=>e.neutralVariantPalette,tone:e=>e.isDark?30:80,background:e=>w.highestSurface(e),contrastCurve:new h(1,1,3,7)}),w.shadow=f.fromPalette({name:"shadow",palette:e=>e.neutralPalette,tone:e=>0}),w.scrim=f.fromPalette({name:"scrim",palette:e=>e.neutralPalette,tone:e=>0}),w.surfaceTint=f.fromPalette({name:"surface_tint",palette:e=>e.primaryPalette,tone:e=>e.isDark?80:40,isBackground:!0}),w.primary=f.fromPalette({name:"primary",palette:e=>e.primaryPalette,tone:e=>y(e)?e.isDark?100:0:e.isDark?80:40,isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(3,4.5,7,11),toneDeltaPair:e=>new m(w.primaryContainer,w.primary,15,"nearer",!1)}),w.onPrimary=f.fromPalette({name:"on_primary",palette:e=>e.primaryPalette,tone:e=>y(e)?e.isDark?10:90:e.isDark?20:100,background:e=>w.primary,contrastCurve:new h(4.5,7,11,21)}),w.primaryContainer=f.fromPalette({name:"primary_container",palette:e=>e.primaryPalette,tone:e=>g(e)?_(e.sourceColorHct,e):y(e)?e.isDark?85:25:e.isDark?30:90,isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(1,1,3,7),toneDeltaPair:e=>new m(w.primaryContainer,w.primary,15,"nearer",!1)}),w.onPrimaryContainer=f.fromPalette({name:"on_primary_container",palette:e=>e.primaryPalette,tone:e=>g(e)?f.foregroundTone(w.primaryContainer.tone(e),4.5):y(e)?e.isDark?0:100:e.isDark?90:10,background:e=>w.primaryContainer,contrastCurve:new h(4.5,7,11,21)}),w.inversePrimary=f.fromPalette({name:"inverse_primary",palette:e=>e.primaryPalette,tone:e=>e.isDark?40:80,background:e=>w.inverseSurface,contrastCurve:new h(3,4.5,7,11)}),w.secondary=f.fromPalette({name:"secondary",palette:e=>e.secondaryPalette,tone:e=>e.isDark?80:40,isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(3,4.5,7,11),toneDeltaPair:e=>new m(w.secondaryContainer,w.secondary,15,"nearer",!1)}),w.onSecondary=f.fromPalette({name:"on_secondary",palette:e=>e.secondaryPalette,tone:e=>y(e)?e.isDark?10:100:e.isDark?20:100,background:e=>w.secondary,contrastCurve:new h(4.5,7,11,21)}),w.secondaryContainer=f.fromPalette({name:"secondary_container",palette:e=>e.secondaryPalette,tone:e=>{let t=e.isDark?30:90;if(y(e))return e.isDark?30:85;if(!g(e))return t;let r=v(e.secondaryPalette.hue,e.secondaryPalette.chroma,t,!e.isDark);return _(e.secondaryPalette.getHct(r),e)},isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(1,1,3,7),toneDeltaPair:e=>new m(w.secondaryContainer,w.secondary,15,"nearer",!1)}),w.onSecondaryContainer=f.fromPalette({name:"on_secondary_container",palette:e=>e.secondaryPalette,tone:e=>g(e)?f.foregroundTone(w.secondaryContainer.tone(e),4.5):e.isDark?90:10,background:e=>w.secondaryContainer,contrastCurve:new h(4.5,7,11,21)}),w.tertiary=f.fromPalette({name:"tertiary",palette:e=>e.tertiaryPalette,tone:e=>y(e)?e.isDark?90:25:e.isDark?80:40,isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(3,4.5,7,11),toneDeltaPair:e=>new m(w.tertiaryContainer,w.tertiary,15,"nearer",!1)}),w.onTertiary=f.fromPalette({name:"on_tertiary",palette:e=>e.tertiaryPalette,tone:e=>y(e)?e.isDark?10:90:e.isDark?20:100,background:e=>w.tertiary,contrastCurve:new h(4.5,7,11,21)}),w.tertiaryContainer=f.fromPalette({name:"tertiary_container",palette:e=>e.tertiaryPalette,tone:e=>{if(y(e))return e.isDark?60:49;if(!g(e))return e.isDark?30:90;let t=_(e.tertiaryPalette.getHct(e.sourceColorHct.tone),e),r=e.tertiaryPalette.getHct(t);return d.fixIfDisliked(r).tone},isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(1,1,3,7),toneDeltaPair:e=>new m(w.tertiaryContainer,w.tertiary,15,"nearer",!1)}),w.onTertiaryContainer=f.fromPalette({name:"on_tertiary_container",palette:e=>e.tertiaryPalette,tone:e=>y(e)?e.isDark?0:100:g(e)?f.foregroundTone(w.tertiaryContainer.tone(e),4.5):e.isDark?90:10,background:e=>w.tertiaryContainer,contrastCurve:new h(4.5,7,11,21)}),w.error=f.fromPalette({name:"error",palette:e=>e.errorPalette,tone:e=>e.isDark?80:40,isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(3,4.5,7,11),toneDeltaPair:e=>new m(w.errorContainer,w.error,15,"nearer",!1)}),w.onError=f.fromPalette({name:"on_error",palette:e=>e.errorPalette,tone:e=>e.isDark?20:100,background:e=>w.error,contrastCurve:new h(4.5,7,11,21)}),w.errorContainer=f.fromPalette({name:"error_container",palette:e=>e.errorPalette,tone:e=>e.isDark?30:90,isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(1,1,3,7),toneDeltaPair:e=>new m(w.errorContainer,w.error,15,"nearer",!1)}),w.onErrorContainer=f.fromPalette({name:"on_error_container",palette:e=>e.errorPalette,tone:e=>e.isDark?90:10,background:e=>w.errorContainer,contrastCurve:new h(4.5,7,11,21)}),w.primaryFixed=f.fromPalette({name:"primary_fixed",palette:e=>e.primaryPalette,tone:e=>y(e)?40:90,isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(1,1,3,7),toneDeltaPair:e=>new m(w.primaryFixed,w.primaryFixedDim,10,"lighter",!0)}),w.primaryFixedDim=f.fromPalette({name:"primary_fixed_dim",palette:e=>e.primaryPalette,tone:e=>y(e)?30:80,isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(1,1,3,7),toneDeltaPair:e=>new m(w.primaryFixed,w.primaryFixedDim,10,"lighter",!0)}),w.onPrimaryFixed=f.fromPalette({name:"on_primary_fixed",palette:e=>e.primaryPalette,tone:e=>y(e)?100:10,background:e=>w.primaryFixedDim,secondBackground:e=>w.primaryFixed,contrastCurve:new h(4.5,7,11,21)}),w.onPrimaryFixedVariant=f.fromPalette({name:"on_primary_fixed_variant",palette:e=>e.primaryPalette,tone:e=>y(e)?90:30,background:e=>w.primaryFixedDim,secondBackground:e=>w.primaryFixed,contrastCurve:new h(3,4.5,7,11)}),w.secondaryFixed=f.fromPalette({name:"secondary_fixed",palette:e=>e.secondaryPalette,tone:e=>y(e)?80:90,isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(1,1,3,7),toneDeltaPair:e=>new m(w.secondaryFixed,w.secondaryFixedDim,10,"lighter",!0)}),w.secondaryFixedDim=f.fromPalette({name:"secondary_fixed_dim",palette:e=>e.secondaryPalette,tone:e=>y(e)?70:80,isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(1,1,3,7),toneDeltaPair:e=>new m(w.secondaryFixed,w.secondaryFixedDim,10,"lighter",!0)}),w.onSecondaryFixed=f.fromPalette({name:"on_secondary_fixed",palette:e=>e.secondaryPalette,tone:e=>10,background:e=>w.secondaryFixedDim,secondBackground:e=>w.secondaryFixed,contrastCurve:new h(4.5,7,11,21)}),w.onSecondaryFixedVariant=f.fromPalette({name:"on_secondary_fixed_variant",palette:e=>e.secondaryPalette,tone:e=>y(e)?25:30,background:e=>w.secondaryFixedDim,secondBackground:e=>w.secondaryFixed,contrastCurve:new h(3,4.5,7,11)}),w.tertiaryFixed=f.fromPalette({name:"tertiary_fixed",palette:e=>e.tertiaryPalette,tone:e=>y(e)?40:90,isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(1,1,3,7),toneDeltaPair:e=>new m(w.tertiaryFixed,w.tertiaryFixedDim,10,"lighter",!0)}),w.tertiaryFixedDim=f.fromPalette({name:"tertiary_fixed_dim",palette:e=>e.tertiaryPalette,tone:e=>y(e)?30:80,isBackground:!0,background:e=>w.highestSurface(e),contrastCurve:new h(1,1,3,7),toneDeltaPair:e=>new m(w.tertiaryFixed,w.tertiaryFixedDim,10,"lighter",!0)}),w.onTertiaryFixed=f.fromPalette({name:"on_tertiary_fixed",palette:e=>e.tertiaryPalette,tone:e=>y(e)?100:10,background:e=>w.tertiaryFixedDim,secondBackground:e=>w.tertiaryFixed,contrastCurve:new h(4.5,7,11,21)}),w.onTertiaryFixedVariant=f.fromPalette({name:"on_tertiary_fixed_variant",palette:e=>e.tertiaryPalette,tone:e=>y(e)?90:30,background:e=>w.tertiaryFixedDim,secondBackground:e=>w.tertiaryFixed,contrastCurve:new h(3,4.5,7,11)});class S{static fromInt(e){let t=c.fromInt(e);return S.fromHct(t)}static fromHct(e){return new S(e.hue,e.chroma,e)}static fromHueAndChroma(e,t){return new S(e,t,S.createKeyColor(e,t))}constructor(e,t,r){this.hue=e,this.chroma=t,this.keyColor=r,this.cache=new Map}static createKeyColor(e,t){let r=50,n=c.from(e,t,r),i=Math.abs(n.chroma-t);for(let a=1;a<50&&Math.round(t)!==Math.round(n.chroma);a+=1){let o=c.from(e,t,r+a),s=Math.abs(o.chroma-t);s<i&&(i=s,n=o);let l=c.from(e,t,r-a),u=Math.abs(l.chroma-t);u<i&&(i=u,n=l)}return n}tone(e){let t=this.cache.get(e);return void 0===t&&(t=c.from(this.hue,this.chroma,e).toInt(),this.cache.set(e,t)),t}getHct(e){return c.fromInt(this.tone(e))}}class T{constructor(e){this.sourceColorArgb=e.sourceColorArgb,this.variant=e.variant,this.contrastLevel=e.contrastLevel,this.isDark=e.isDark,this.sourceColorHct=c.fromInt(e.sourceColorArgb),this.primaryPalette=e.primaryPalette,this.secondaryPalette=e.secondaryPalette,this.tertiaryPalette=e.tertiaryPalette,this.neutralPalette=e.neutralPalette,this.neutralVariantPalette=e.neutralVariantPalette,this.errorPalette=S.fromHueAndChroma(25,84)}static getRotatedHue(e,t,r){let n=e.hue;if(t.length!==r.length)throw Error(`mismatch between hue length ${t.length} & rotations ${r.length}`);if(1===r.length)return a.Vy(e.hue+r[0]);let i=t.length;for(let e=0;e<=i-2;e++){let i=t[e],o=t[e+1];if(i<n&&n<o)return a.Vy(n+r[e])}return n}}class x extends T{constructor(e,t,r){super({sourceColorArgb:e.toInt(),variant:n.EXPRESSIVE,contrastLevel:r,isDark:t,primaryPalette:S.fromHueAndChroma(a.Vy(e.hue+240),40),secondaryPalette:S.fromHueAndChroma(T.getRotatedHue(e,x.hues,x.secondaryRotations),24),tertiaryPalette:S.fromHueAndChroma(T.getRotatedHue(e,x.hues,x.tertiaryRotations),32),neutralPalette:S.fromHueAndChroma(e.hue+15,8),neutralVariantPalette:S.fromHueAndChroma(e.hue+15,12)})}}x.hues=[0,21,51,121,151,191,271,321,360],x.secondaryRotations=[45,95,45,20,45,90,45,45,45],x.tertiaryRotations=[120,120,20,45,20,15,20,120,120];class E extends T{constructor(e,t,r){super({sourceColorArgb:e.toInt(),variant:n.VIBRANT,contrastLevel:r,isDark:t,primaryPalette:S.fromHueAndChroma(e.hue,200),secondaryPalette:S.fromHueAndChroma(T.getRotatedHue(e,E.hues,E.secondaryRotations),24),tertiaryPalette:S.fromHueAndChroma(T.getRotatedHue(e,E.hues,E.tertiaryRotations),32),neutralPalette:S.fromHueAndChroma(e.hue,10),neutralVariantPalette:S.fromHueAndChroma(e.hue,12)})}}E.hues=[0,41,61,101,131,181,251,301,360],E.secondaryRotations=[18,15,10,12,15,18,15,12,12],E.tertiaryRotations=[35,30,20,25,30,35,30,25,25];let C={desired:4,fallbackColorARGB:4282549748,filter:!0};function A(e,t){return e.score>t.score?-1:e.score<t.score?1:0}class M{constructor(){}static score(e,t){let{desired:r,fallbackColorARGB:n,filter:i}={...C,...t},o=[],s=Array(360).fill(0),l=0;for(let[t,r]of e.entries()){let e=c.fromInt(t);o.push(e);let n=Math.floor(e.hue);s[n]+=r,l+=r}let u=Array(360).fill(0);for(let e=0;e<360;e++){let t=s[e]/l;for(let r=e-14;r<e+16;r++){let e=a.i5(r);u[e]+=t}}let d=[];for(let e of o){let t=u[a.i5(Math.round(e.hue))];if(i&&(e.chroma<M.CUTOFF_CHROMA||t<=M.CUTOFF_EXCITED_PROPORTION))continue;let r=100*t*M.WEIGHT_PROPORTION,n=e.chroma<M.TARGET_CHROMA?M.WEIGHT_CHROMA_BELOW:M.WEIGHT_CHROMA_ABOVE,o=r+(e.chroma-M.TARGET_CHROMA)*n;d.push({hct:e,score:o})}d.sort(A);let h=[];for(let e=90;e>=15;e--){for(let{hct:t}of(h.length=0,d))if(h.find(r=>a.ae(t.hue,r.hue)<e)||h.push(t),h.length>=r)break;if(h.length>=r)break}let p=[];for(let e of(0===h.length&&p.push(n),h))p.push(e.toInt());return p}}M.TARGET_CHROMA=48,M.WEIGHT_PROPORTION=.7,M.WEIGHT_CHROMA_ABOVE=.3,M.WEIGHT_CHROMA_BELOW=.1,M.CUTOFF_CHROMA=5,M.CUTOFF_EXCITED_PROPORTION=.01;var I=r(77154)},54122:function(e,t,r){"use strict";r.d(t,{Hd:function(){return u},Xr:function(){return l},_2:function(){return h},cN:function(){return v},cj:function(){return y},gb:function(){return g},gz:function(){return d},ly:function(){return m},m_:function(){return b},pQ:function(){return w},qm:function(){return f},vZ:function(){return c}});var n=r(57206);let i=[[.41233895,.35762064,.18051042],[.2126,.7152,.0722],[.01932141,.11916382,.95034478]],a=[[3.2413774792388685,-1.5376652402851851,-.49885366846268053],[-.9691452513005321,1.8758853451067872,.04156585616912061],[.05562093689691305,-.20395524564742123,1.0571799111220335]],o=[95.047,100,108.883];function s(e,t,r){return(-16777216|(255&e)<<16|(255&t)<<8|255&r)>>>0}function l(e){return s(_(e[0]),_(e[1]),_(e[2]))}function c(e){return e>>16&255}function u(e){return e>>8&255}function d(e){return 255&e}function h(e,t,r){let n=a,i=n[0][0]*e+n[0][1]*t+n[0][2]*r,o=n[1][0]*e+n[1][1]*t+n[1][2]*r,l=n[2][0]*e+n[2][1]*t+n[2][2]*r;return s(_(i),_(o),_(l))}function p(e){let t=b(c(e)),r=b(u(e)),a=b(d(e));return n.h9([t,r,a],i)}function f(e){let t=b(c(e)),r=b(u(e)),n=b(d(e)),a=i,s=a[0][0]*t+a[0][1]*r+a[0][2]*n,l=a[1][0]*t+a[1][1]*r+a[1][2]*n,h=a[2][0]*t+a[2][1]*r+a[2][2]*n,p=o,f=s/p[0],m=l/p[1],g=h/p[2],y=S(f),v=S(m);return[116*v-16,500*(y-v),200*(v-S(g))]}function m(e){let t=_(y(e));return s(t,t,t)}function g(e){return 116*S(p(e)[1]/100)-16}function y(e){return 100*T((e+16)/116)}function v(e){return 116*S(e/100)-16}function b(e){let t=e/255;return t<=.040449936?t/12.92*100:100*Math.pow((t+.055)/1.055,2.4)}function _(e){let t=e/100,r=0;return r=t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,n.Qc(0,255,Math.round(255*r))}function w(){return o}function S(e){let t=24389/27;return e>216/24389?Math.pow(e,1/3):(t*e+16)/116}function T(e){let t=24389/27,r=e*e*e;return r>216/24389?r:(116*e-16)/t}},57206:function(e,t,r){"use strict";function n(e){return e<0?-1:0===e?0:1}function i(e,t,r){return(1-r)*e+r*t}function a(e,t,r){return r<e?e:r>t?t:r}function o(e,t,r){return r<e?e:r>t?t:r}function s(e){return(e%=360)<0&&(e+=360),e}function l(e){return(e%=360)<0&&(e+=360),e}function c(e,t){return 180>=l(t-e)?1:-1}function u(e,t){return 180-Math.abs(Math.abs(e-t)-180)}function d(e,t){return[e[0]*t[0][0]+e[1]*t[0][1]+e[2]*t[0][2],e[0]*t[1][0]+e[1]*t[1][1]+e[2]*t[1][2],e[0]*t[2][0]+e[1]*t[2][1]+e[2]*t[2][2]]}r.d(t,{EQ:function(){return n},Qc:function(){return a},SJ:function(){return o},Vy:function(){return l},ae:function(){return u},h9:function(){return d},i5:function(){return s},t7:function(){return i},vt:function(){return c}})},77154:function(e,t,r){"use strict";r.d(t,{P:function(){return i}});var n=r(54122);function i(e){let t=n.vZ(e),r=n.Hd(e),i=n.gz(e),a=[t.toString(16),r.toString(16),i.toString(16)];for(let[e,t]of a.entries())1===t.length&&(a[e]="0"+t);return"#"+a.join("")}},45008:function(e,t,r){"use strict";function n(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}r.d(t,{_:function(){return n}})},61994:function(e,t,r){"use strict";function n(e){var t,r,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e){if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=n(e[t]))&&(i&&(i+=" "),i+=r)}else for(r in e)e[r]&&(i&&(i+=" "),i+=r)}return i}function i(){for(var e,t,r=0,i="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=n(e))&&(i&&(i+=" "),i+=t);return i}t.Z=i}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[555,587,744],function(){return t(37915)}),_N_E=e.O()}]);